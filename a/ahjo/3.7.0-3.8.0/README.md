# Comparing `tmp/ahjo-3.7.0-py3-none-any.whl.zip` & `tmp/ahjo-3.8.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,78 +1,85 @@
-Zip file size: 102805 bytes, number of entries: 76
--rw-rw-rw-  2.0 fat      123 b- defN 24-Mar-12 08:46 ahjo/__init__.py
--rw-rw-rw-  2.0 fat    10559 b- defN 24-Mar-12 08:46 ahjo/action.py
--rw-rw-rw-  2.0 fat     9516 b- defN 24-Mar-20 07:31 ahjo/context.py
--rw-rw-rw-  2.0 fat     4032 b- defN 24-Mar-12 08:46 ahjo/credential_handler.py
--rw-rw-rw-  2.0 fat     4945 b- defN 24-Mar-12 08:46 ahjo/interface_methods.py
--rw-rw-rw-  2.0 fat     1437 b- defN 24-Mar-20 07:31 ahjo/operation_manager.py
--rw-rw-rw-  2.0 fat      427 b- defN 24-Mar-20 09:05 ahjo/version.py
--rw-rw-rw-  2.0 fat      775 b- defN 24-Mar-20 07:31 ahjo/database_utilities/__init__.py
--rw-rw-rw-  2.0 fat     5836 b- defN 24-Mar-20 07:31 ahjo/database_utilities/conn_info.py
--rw-rw-rw-  2.0 fat     2412 b- defN 24-Mar-20 07:31 ahjo/database_utilities/pyodbc_utilities.py
--rw-rw-rw-  2.0 fat    20518 b- defN 24-Mar-15 12:43 ahjo/database_utilities/sqla_utilities.py
--rw-rw-rw-  2.0 fat     3793 b- defN 24-Mar-12 08:46 ahjo/database_utilities/sqlcmd.py
--rw-rw-rw-  2.0 fat      180 b- defN 24-Mar-12 08:46 ahjo/logging/__init__.py
--rw-rw-rw-  2.0 fat     1257 b- defN 24-Feb-08 08:03 ahjo/logging/winEventLogger.py
--rw-rw-rw-  2.0 fat      753 b- defN 24-Mar-12 08:46 ahjo/operations/__init__.py
--rw-rw-rw-  2.0 fat      997 b- defN 24-Mar-12 08:46 ahjo/operations/general/__init__.py
--rw-rw-rw-  2.0 fat     2969 b- defN 24-Mar-12 08:46 ahjo/operations/general/alembic.py
--rw-rw-rw-  2.0 fat     4038 b- defN 24-Mar-20 07:31 ahjo/operations/general/bulk_insert.py
--rw-rw-rw-  2.0 fat      971 b- defN 24-Mar-12 08:46 ahjo/operations/general/db_info.py
--rw-rw-rw-  2.0 fat     4023 b- defN 24-Mar-20 07:31 ahjo/operations/general/git_hook.py
--rw-rw-rw-  2.0 fat    10309 b- defN 24-Mar-20 07:31 ahjo/operations/general/git_version.py
--rw-rw-rw-  2.0 fat     4595 b- defN 24-Mar-12 08:46 ahjo/operations/general/initialization.py
--rw-rw-rw-  2.0 fat     4689 b- defN 24-Mar-20 07:31 ahjo/operations/general/multi_project_build.py
--rw-rw-rw-  2.0 fat    18590 b- defN 24-Mar-20 07:31 ahjo/operations/general/scan.py
--rw-rw-rw-  2.0 fat    11364 b- defN 24-Mar-12 08:46 ahjo/operations/general/sqlfiles.py
--rw-rw-rw-  2.0 fat     8873 b- defN 24-Mar-12 08:46 ahjo/operations/general/upgrade.py
--rw-rw-rw-  2.0 fat      633 b- defN 24-Mar-12 08:46 ahjo/operations/tsql/__init__.py
--rw-rw-rw-  2.0 fat     4247 b- defN 24-Mar-12 08:46 ahjo/operations/tsql/create_db.py
--rw-rw-rw-  2.0 fat     3079 b- defN 24-Mar-12 08:46 ahjo/operations/tsql/create_db_login.py
--rw-rw-rw-  2.0 fat     1312 b- defN 24-Mar-12 08:46 ahjo/operations/tsql/create_db_permissions.py
--rw-rw-rw-  2.0 fat      613 b- defN 24-Mar-12 08:46 ahjo/operations/tsql/create_db_structure.py
--rw-rw-rw-  2.0 fat     3779 b- defN 24-Mar-12 08:46 ahjo/operations/tsql/db_info.py
--rw-rw-rw-  2.0 fat    12850 b- defN 24-Mar-20 07:31 ahjo/operations/tsql/db_object_properties.py
--rw-rw-rw-  2.0 fat      837 b- defN 24-Mar-12 08:46 ahjo/operations/tsql/set_statements.py
--rw-rw-rw-  2.0 fat      556 b- defN 24-Mar-12 08:46 ahjo/operations/tsql/sqlfiles.py
--rw-rw-rw-  2.0 fat     1125 b- defN 24-Mar-20 07:31 ahjo/resources/logger.ini
--rw-rw-rw-  2.0 fat     2231 b- defN 24-Mar-20 07:31 ahjo/resources/logger_sqlalchemy.ini
--rw-rw-rw-  2.0 fat     1382 b- defN 24-Mar-12 08:46 ahjo/resources/logger_winLog.ini
+Zip file size: 111344 bytes, number of entries: 83
+-rw-rw-rw-  2.0 fat      123 b- defN 24-May-06 06:00 ahjo/__init__.py
+-rw-rw-rw-  2.0 fat    10507 b- defN 24-May-20 06:05 ahjo/action.py
+-rw-rw-rw-  2.0 fat    10623 b- defN 24-May-20 06:05 ahjo/context.py
+-rw-rw-rw-  2.0 fat     4032 b- defN 24-May-06 06:00 ahjo/credential_handler.py
+-rw-rw-rw-  2.0 fat     4945 b- defN 24-May-15 09:13 ahjo/interface_methods.py
+-rw-rw-rw-  2.0 fat     1103 b- defN 24-May-20 06:05 ahjo/operation_manager.py
+-rw-rw-rw-  2.0 fat      427 b- defN 24-May-20 06:11 ahjo/version.py
+-rw-rw-rw-  2.0 fat      775 b- defN 24-May-06 06:00 ahjo/database_utilities/__init__.py
+-rw-rw-rw-  2.0 fat     5836 b- defN 24-May-06 06:00 ahjo/database_utilities/conn_info.py
+-rw-rw-rw-  2.0 fat     2412 b- defN 24-May-06 06:00 ahjo/database_utilities/pyodbc_utilities.py
+-rw-rw-rw-  2.0 fat    22236 b- defN 24-May-20 06:05 ahjo/database_utilities/sqla_utilities.py
+-rw-rw-rw-  2.0 fat     3793 b- defN 24-May-06 06:00 ahjo/database_utilities/sqlcmd.py
+-rw-rw-rw-  2.0 fat     6049 b- defN 24-May-20 06:05 ahjo/logging/__init__.py
+-rw-rw-rw-  2.0 fat     1111 b- defN 24-May-20 06:05 ahjo/logging/db_formatter.py
+-rw-rw-rw-  2.0 fat     4478 b- defN 24-May-20 06:05 ahjo/logging/db_handler.py
+-rw-rw-rw-  2.0 fat     4987 b- defN 24-May-20 06:05 ahjo/logging/db_logger.py
+-rw-rw-rw-  2.0 fat     1257 b- defN 24-Apr-30 05:21 ahjo/logging/winEventLogger.py
+-rw-rw-rw-  2.0 fat     1257 b- defN 24-May-20 06:05 ahjo/logging/win_event_logger.py
+-rw-rw-rw-  2.0 fat      775 b- defN 24-May-20 06:05 ahjo/operations/__init__.py
+-rw-rw-rw-  2.0 fat     1019 b- defN 24-May-20 06:05 ahjo/operations/general/__init__.py
+-rw-rw-rw-  2.0 fat     4302 b- defN 24-May-20 06:05 ahjo/operations/general/alembic.py
+-rw-rw-rw-  2.0 fat     4038 b- defN 24-May-06 06:00 ahjo/operations/general/bulk_insert.py
+-rw-rw-rw-  2.0 fat      971 b- defN 24-May-06 06:00 ahjo/operations/general/db_info.py
+-rw-rw-rw-  2.0 fat     4023 b- defN 24-May-06 06:00 ahjo/operations/general/git_hook.py
+-rw-rw-rw-  2.0 fat    10309 b- defN 24-May-06 06:00 ahjo/operations/general/git_version.py
+-rw-rw-rw-  2.0 fat     4595 b- defN 24-May-06 06:00 ahjo/operations/general/initialization.py
+-rw-rw-rw-  2.0 fat     5582 b- defN 24-May-20 06:05 ahjo/operations/general/multi_project_build.py
+-rw-rw-rw-  2.0 fat    18590 b- defN 24-May-06 06:00 ahjo/operations/general/scan.py
+-rw-rw-rw-  2.0 fat    11402 b- defN 24-May-20 06:05 ahjo/operations/general/sqlfiles.py
+-rw-rw-rw-  2.0 fat     8869 b- defN 24-May-20 06:05 ahjo/operations/general/upgrade.py
+-rw-rw-rw-  2.0 fat      633 b- defN 24-May-06 06:00 ahjo/operations/tsql/__init__.py
+-rw-rw-rw-  2.0 fat     4247 b- defN 24-May-06 06:00 ahjo/operations/tsql/create_db.py
+-rw-rw-rw-  2.0 fat     3079 b- defN 24-May-06 06:00 ahjo/operations/tsql/create_db_login.py
+-rw-rw-rw-  2.0 fat     1312 b- defN 24-May-06 06:00 ahjo/operations/tsql/create_db_permissions.py
+-rw-rw-rw-  2.0 fat      613 b- defN 24-May-06 06:00 ahjo/operations/tsql/create_db_structure.py
+-rw-rw-rw-  2.0 fat     3779 b- defN 24-May-06 06:00 ahjo/operations/tsql/db_info.py
+-rw-rw-rw-  2.0 fat    12850 b- defN 24-May-06 06:00 ahjo/operations/tsql/db_object_properties.py
+-rw-rw-rw-  2.0 fat      837 b- defN 24-May-06 06:00 ahjo/operations/tsql/set_statements.py
+-rw-rw-rw-  2.0 fat      556 b- defN 24-May-06 06:00 ahjo/operations/tsql/sqlfiles.py
+-rw-rw-rw-  2.0 fat     1125 b- defN 24-Apr-30 05:21 ahjo/resources/logger.ini
+-rw-rw-rw-  2.0 fat      420 b- defN 24-May-20 06:05 ahjo/resources/logger_alembic.ini
+-rw-rw-rw-  2.0 fat      418 b- defN 24-May-20 06:05 ahjo/resources/logger_root.ini
+-rw-rw-rw-  2.0 fat     2231 b- defN 24-May-06 06:00 ahjo/resources/logger_sqlalchemy.ini
+-rw-rw-rw-  2.0 fat     1382 b- defN 24-Apr-30 05:21 ahjo/resources/logger_winLog.ini
 -rw-rw-rw-  2.0 fat     1257 b- defN 23-Nov-24 08:01 ahjo/resources/winEventLogger.py
--rw-rw-rw-  2.0 fat      395 b- defN 24-Feb-08 08:03 ahjo/resources/files/.gitignore
+-rw-rw-rw-  2.0 fat      395 b- defN 24-Apr-19 05:47 ahjo/resources/files/.gitignore
 -rw-rw-rw-  2.0 fat      362 b- defN 23-Nov-15 08:21 ahjo/resources/files/ahjo_actions.py
 -rw-rw-rw-  2.0 fat     2041 b- defN 23-May-02 09:34 ahjo/resources/files/alembic.ini
 -rw-rw-rw-  2.0 fat      235 b- defN 23-Nov-15 08:21 ahjo/resources/files/alembic_dummy
--rw-rw-rw-  2.0 fat      397 b- defN 24-Feb-08 08:03 ahjo/resources/files/config_development.json
--rw-rw-rw-  2.0 fat     3966 b- defN 24-Feb-08 08:03 ahjo/resources/files/config_development.jsonc
--rw-rw-rw-  2.0 fat     3778 b- defN 24-Feb-08 08:03 ahjo/resources/files/config_development.yaml
--rw-rw-rw-  2.0 fat     4404 b- defN 24-Feb-08 08:03 ahjo/resources/files/env.py
+-rw-rw-rw-  2.0 fat      397 b- defN 24-Apr-19 05:47 ahjo/resources/files/config_development.json
+-rw-rw-rw-  2.0 fat     4132 b- defN 24-May-20 06:05 ahjo/resources/files/config_development.jsonc
+-rw-rw-rw-  2.0 fat     3900 b- defN 24-May-20 06:05 ahjo/resources/files/config_development.yaml
+-rw-rw-rw-  2.0 fat     4404 b- defN 24-May-06 06:00 ahjo/resources/files/env.py
 -rw-rw-rw-  2.0 fat      518 b- defN 23-May-02 09:34 ahjo/resources/files/script.py.mako
 -rw-rw-rw-  2.0 fat      840 b- defN 24-Feb-29 10:57 ahjo/resources/files/git_hooks/pre-commit
--rw-rw-rw-  2.0 fat     1266 b- defN 24-Mar-12 08:46 ahjo/resources/sql/queries/extended_properties_columns.sql
--rw-rw-rw-  2.0 fat      621 b- defN 24-Mar-12 08:46 ahjo/resources/sql/queries/extended_properties_functions.sql
--rw-rw-rw-  2.0 fat      569 b- defN 24-Mar-12 08:46 ahjo/resources/sql/queries/extended_properties_procedures.sql
--rw-rw-rw-  2.0 fat      490 b- defN 24-Mar-12 08:46 ahjo/resources/sql/queries/extended_properties_schemas.sql
--rw-rw-rw-  2.0 fat      661 b- defN 24-Mar-12 08:46 ahjo/resources/sql/queries/extended_properties_tables.sql
--rw-rw-rw-  2.0 fat      579 b- defN 24-Mar-12 08:46 ahjo/resources/sql/queries/extended_properties_views.sql
+-rw-rw-rw-  2.0 fat     1266 b- defN 24-May-06 06:00 ahjo/resources/sql/queries/extended_properties_columns.sql
+-rw-rw-rw-  2.0 fat      621 b- defN 24-May-06 06:00 ahjo/resources/sql/queries/extended_properties_functions.sql
+-rw-rw-rw-  2.0 fat      569 b- defN 24-May-06 06:00 ahjo/resources/sql/queries/extended_properties_procedures.sql
+-rw-rw-rw-  2.0 fat      490 b- defN 24-May-06 06:00 ahjo/resources/sql/queries/extended_properties_schemas.sql
+-rw-rw-rw-  2.0 fat      661 b- defN 24-May-06 06:00 ahjo/resources/sql/queries/extended_properties_tables.sql
+-rw-rw-rw-  2.0 fat      579 b- defN 24-May-06 06:00 ahjo/resources/sql/queries/extended_properties_views.sql
 -rw-rw-rw-  2.0 fat      710 b- defN 23-May-02 09:34 ahjo/resources/sql/templates/schema.functionName.sql
 -rw-rw-rw-  2.0 fat      576 b- defN 23-May-02 09:34 ahjo/resources/sql/templates/schema.procedureName.sql
 -rw-rw-rw-  2.0 fat      391 b- defN 23-May-02 09:34 ahjo/resources/sql/templates/schema.tableName.sql
 -rw-rw-rw-  2.0 fat      497 b- defN 23-Nov-15 08:21 ahjo/resources/sql/templates/schema.viewName.sql
--rw-rw-rw-  2.0 fat      123 b- defN 24-Mar-12 08:46 ahjo/scripts/__init__.py
--rw-rw-rw-  2.0 fat     1631 b- defN 24-Mar-12 08:46 ahjo/scripts/config.py
--rw-rw-rw-  2.0 fat     1227 b- defN 24-Mar-12 08:46 ahjo/scripts/init_project.py
--rw-rw-rw-  2.0 fat      918 b- defN 24-Mar-20 07:31 ahjo/scripts/install_git_hook.py
--rw-rw-rw-  2.0 fat     4798 b- defN 24-Mar-20 07:31 ahjo/scripts/master.py
--rw-rw-rw-  2.0 fat    12975 b- defN 24-Mar-12 08:46 ahjo/scripts/master_actions.py
--rw-rw-rw-  2.0 fat      850 b- defN 24-Mar-12 08:46 ahjo/scripts/multi_project_build.py
--rw-rw-rw-  2.0 fat     2297 b- defN 24-Mar-20 07:31 ahjo/scripts/scan_project.py
--rw-rw-rw-  2.0 fat     1837 b- defN 24-Mar-20 07:31 ahjo/scripts/upgrade_project.py
--rw-rw-rw-  2.0 fat      177 b- defN 24-Feb-08 08:03 ahjo/util/__init__.py
--rw-rw-rw-  2.0 fat     8632 b- defN 24-Feb-08 08:03 ahjo/util/jsonc.py
--rw-rw-rw-  2.0 fat    11556 b- defN 24-Mar-20 09:05 ahjo-3.7.0.dist-info/LICENSE
--rw-rw-rw-  2.0 fat    36372 b- defN 24-Mar-20 09:05 ahjo-3.7.0.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 24-Mar-20 09:05 ahjo-3.7.0.dist-info/WHEEL
--rw-rw-rw-  2.0 fat      356 b- defN 24-Mar-20 09:05 ahjo-3.7.0.dist-info/entry_points.txt
--rw-rw-rw-  2.0 fat        5 b- defN 24-Mar-20 09:05 ahjo-3.7.0.dist-info/top_level.txt
--rw-rw-r--  2.0 fat     6912 b- defN 24-Mar-20 09:05 ahjo-3.7.0.dist-info/RECORD
-76 files, 285936 bytes uncompressed, 91685 bytes compressed:  67.9%
+-rw-rw-rw-  2.0 fat      123 b- defN 24-May-06 06:00 ahjo/scripts/__init__.py
+-rw-rw-rw-  2.0 fat      616 b- defN 24-May-20 06:05 ahjo/scripts/alembic_api.py
+-rw-rw-rw-  2.0 fat     1321 b- defN 24-May-20 06:05 ahjo/scripts/config.py
+-rw-rw-rw-  2.0 fat     1133 b- defN 24-May-20 06:05 ahjo/scripts/init_project.py
+-rw-rw-rw-  2.0 fat      815 b- defN 24-May-20 06:05 ahjo/scripts/install_git_hook.py
+-rw-rw-rw-  2.0 fat     5088 b- defN 24-May-20 06:05 ahjo/scripts/master.py
+-rw-rw-rw-  2.0 fat    13595 b- defN 24-May-20 06:05 ahjo/scripts/master_actions.py
+-rw-rw-rw-  2.0 fat      850 b- defN 24-May-06 06:00 ahjo/scripts/multi_project_build.py
+-rw-rw-rw-  2.0 fat     2194 b- defN 24-May-20 06:05 ahjo/scripts/scan_project.py
+-rw-rw-rw-  2.0 fat     2520 b- defN 24-May-20 06:05 ahjo/scripts/upgrade_project.py
+-rw-rw-rw-  2.0 fat      177 b- defN 24-May-06 06:00 ahjo/util/__init__.py
+-rw-rw-rw-  2.0 fat     8632 b- defN 24-May-06 06:00 ahjo/util/jsonc.py
+-rw-rw-rw-  2.0 fat    11556 b- defN 24-May-20 06:11 ahjo-3.8.0.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat    37085 b- defN 24-May-20 06:11 ahjo-3.8.0.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 24-May-20 06:11 ahjo-3.8.0.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat      400 b- defN 24-May-20 06:11 ahjo-3.8.0.dist-info/entry_points.txt
+-rw-rw-rw-  2.0 fat        5 b- defN 24-May-20 06:11 ahjo-3.8.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat     7512 b- defN 24-May-20 06:11 ahjo-3.8.0.dist-info/RECORD
+83 files, 312463 bytes uncompressed, 99290 bytes compressed:  68.2%
```

## zipnote {}

```diff
@@ -33,17 +33,29 @@
 
 Filename: ahjo/database_utilities/sqlcmd.py
 Comment: 
 
 Filename: ahjo/logging/__init__.py
 Comment: 
 
+Filename: ahjo/logging/db_formatter.py
+Comment: 
+
+Filename: ahjo/logging/db_handler.py
+Comment: 
+
+Filename: ahjo/logging/db_logger.py
+Comment: 
+
 Filename: ahjo/logging/winEventLogger.py
 Comment: 
 
+Filename: ahjo/logging/win_event_logger.py
+Comment: 
+
 Filename: ahjo/operations/__init__.py
 Comment: 
 
 Filename: ahjo/operations/general/__init__.py
 Comment: 
 
 Filename: ahjo/operations/general/alembic.py
@@ -102,14 +114,20 @@
 
 Filename: ahjo/operations/tsql/sqlfiles.py
 Comment: 
 
 Filename: ahjo/resources/logger.ini
 Comment: 
 
+Filename: ahjo/resources/logger_alembic.ini
+Comment: 
+
+Filename: ahjo/resources/logger_root.ini
+Comment: 
+
 Filename: ahjo/resources/logger_sqlalchemy.ini
 Comment: 
 
 Filename: ahjo/resources/logger_winLog.ini
 Comment: 
 
 Filename: ahjo/resources/winEventLogger.py
@@ -174,14 +192,17 @@
 
 Filename: ahjo/resources/sql/templates/schema.viewName.sql
 Comment: 
 
 Filename: ahjo/scripts/__init__.py
 Comment: 
 
+Filename: ahjo/scripts/alembic_api.py
+Comment: 
+
 Filename: ahjo/scripts/config.py
 Comment: 
 
 Filename: ahjo/scripts/init_project.py
 Comment: 
 
 Filename: ahjo/scripts/install_git_hook.py
@@ -204,26 +225,26 @@
 
 Filename: ahjo/util/__init__.py
 Comment: 
 
 Filename: ahjo/util/jsonc.py
 Comment: 
 
-Filename: ahjo-3.7.0.dist-info/LICENSE
+Filename: ahjo-3.8.0.dist-info/LICENSE
 Comment: 
 
-Filename: ahjo-3.7.0.dist-info/METADATA
+Filename: ahjo-3.8.0.dist-info/METADATA
 Comment: 
 
-Filename: ahjo-3.7.0.dist-info/WHEEL
+Filename: ahjo-3.8.0.dist-info/WHEEL
 Comment: 
 
-Filename: ahjo-3.7.0.dist-info/entry_points.txt
+Filename: ahjo-3.8.0.dist-info/entry_points.txt
 Comment: 
 
-Filename: ahjo-3.7.0.dist-info/top_level.txt
+Filename: ahjo-3.8.0.dist-info/top_level.txt
 Comment: 
 
-Filename: ahjo-3.7.0.dist-info/RECORD
+Filename: ahjo-3.8.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## ahjo/action.py

```diff
@@ -179,15 +179,15 @@
     engine: sqlalchemy.engine.Engine
         SQL Alchemy engine.
     skip_confirmation: bool
         If True, user confirmation is disabled.
     context: ahjo.context.Context
         Context object. If None, a new one is created.
     """
-    logger.info('------')
+    logger.info("------", extra={"record_class": "line"})
     with OperationManager('Starting to execute "' + action_name + '"'):
         if context is None:
             context = Context(config_filename, engine)
         # validity check
         action_valid = check_action_validity(
             action_name, 
             context.configuration.get('allowed_actions', []), 
@@ -206,20 +206,18 @@
     if context.get_enable_transaction(): 
         context.commit_and_close_transaction()
 
     return action_output
 
 
 def list_actions():
-    logger.info('-------------------------------')
-    logger.info('List of available actions')
-    logger.info('-------------------------------')
+    print('List of available actions')
+    print('-------------------------------')
     for key, registeration in sorted(registered_actions.items()):
-        logger.info(
-            f"'{key}': {registeration.function.__doc__ or 'No description available.'}")
+        print(f"'{key}': {registeration.function.__doc__ or 'No description available.'}")
 
 
 def import_actions(ahjo_action_files: list = DEFAULT_ACTIONS_SRC, reload_module: bool = False) -> None:
     """Import actions from user defined action files. 
     
     Arguments
     ---------
```

## ahjo/context.py

```diff
@@ -8,14 +8,15 @@
 import yaml
 import json
 from logging import getLogger
 from typing import Union, Any
 from sqlalchemy.engine import Engine, Connection
 from ahjo.database_utilities import (create_conn_info, create_sqlalchemy_engine, create_sqlalchemy_url)
 from ahjo.interface_methods import load_conf, load_json_conf, load_yaml_conf
+from sqlalchemy import event
 
 logger = getLogger('ahjo')
 
 
 def _get_app_path() -> str:
     """Get the current app path"""
     # see https://cx-freeze.readthedocs.io/en/latest/faq.html#using-data-files
@@ -40,29 +41,37 @@
         self.connection = None
         self.transaction = None
         self.enable_transaction = None
         self.connectivity_type = None
         self.config_filename = config_filename
         self.configuration = load_conf(config_filename)
         self.command_line_args = command_line_args
+        self.conn_info = None
         if self.configuration is None:
             raise Exception("No configuration found")
         
 
     def get_conn_info(self) -> dict:
-        return create_conn_info(self.configuration)
+        if self.conn_info is None:
+            self.conn_info = create_conn_info(self.configuration)
+        return self.conn_info
     
 
     def get_connectable(self) -> Union[Engine, Connection]:
         """Return Engine or Connection depending on connectivity type."""
         if self.connectivity_type is None:
             self.connectivity_type = self.configuration.get("context_connectable_type", "engine").lower()
         if self.connectivity_type == "connection":
             return self.get_connection()
         return self.get_engine()
+    
+    
+    def set_connectable(self, connectable_type: str):
+        """Set connectivity type to connectable_type."""
+        self.connectivity_type = connectable_type
 
 
     def get_engine(self) -> Engine:
         """Create engine when needed first time."""
         if self.engine is None:
             conn_info = self.get_conn_info()
             self.engine = create_sqlalchemy_engine(
@@ -83,19 +92,39 @@
                     use_master_db=True
                 ), 
                 token = conn_info.get("token"),
                 **conn_info.get("sqla_engine_params")
             )
         return self.master_engine
     
-    
+
     def get_connection(self) -> Connection:
         """Create connection when needed first time."""
         if self.connection is None:
-            self.connection = self.get_engine().connect()
+
+            connection = self.get_engine().connect()
+
+            @event.listens_for(connection, "commit")
+            def receive_after_commit(conn):
+                for handler in logger.handlers:
+                    if handler.name == "handler_database":
+                        handler.set_lock(False)
+                        handler.flush()
+                        break
+
+            @event.listens_for(connection, "rollback")
+            def receive_after_rollback(conn):
+                for handler in logger.handlers:
+                    if handler.name == "handler_database":
+                        handler.buffer = [record for record in handler.buffer if record.levelname != "INFO"]
+                        handler.set_lock(False)
+                        break
+   
+            self.connection = connection
+            
         if self.enable_transaction is None:
             if self.configuration.get("transaction_mode", "begin_once").lower() == "begin_once":
                 self.enable_transaction = True
             else:
                 self.enable_transaction = False
         if self.enable_transaction:
             if self.transaction is None:
```

## ahjo/operation_manager.py

```diff
@@ -1,19 +1,17 @@
 # Ahjo - Database deployment framework
 #
 # Copyright 2019 - 2024 ALM Partners Oy
 # SPDX-License-Identifier: Apache-2.0
 
 """Module for logging, printing and error handling deployment process."""
-import os
-import ahjo
+
 from datetime import datetime
 from logging import getLogger
 from traceback import format_exception
-from logging.config import fileConfig
 
 logger = getLogger('ahjo')
 
 
 class OperationManager:
     """Class for handling operation context.
     Prints the message and lines at the end.
@@ -25,23 +23,15 @@
     def __enter__(self):
         logger.info(format_message(self.message))
 
     def __exit__(self, exc_type, exc_value, traceback):
         if traceback is not None:
             logger.error(''.join(format_exception(
                 exc_type, exc_value, traceback)))
-        logger.info('------')
+        logger.info('------', extra={"record_class": "line"})
 
 
 def format_message(mssg: str) -> str:
     '''Add timestamp before the message.'''
     timestamp = datetime.now()
     time_string = timestamp.strftime('%Y-%m-%d %H:%M:%S')
     return '[{}] {}'.format(time_string, mssg)
-
-
-def load_sqlalchemy_logger():
-    fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger_sqlalchemy.ini'), disable_existing_loggers=False)
-    getLogger('sqlalchemy.engine')
-    getLogger('sqlalchemy.pool')
-    getLogger('sqlalchemy.dialects')
-    getLogger('sqlalchemy.orm')
```

## ahjo/version.py

```diff
@@ -8,9 +8,9 @@
     VERSION_TUPLE = object
 
 version: str
 __version__: str
 __version_tuple__: VERSION_TUPLE
 version_tuple: VERSION_TUPLE
 
-__version__ = version = '3.7.0'
-__version_tuple__ = version_tuple = (3, 7, 0)
+__version__ = version = '3.8.0'
+__version_tuple__ = version_tuple = (3, 8, 0)
```

## ahjo/database_utilities/sqla_utilities.py

```diff
@@ -109,23 +109,70 @@
 
     Returns
     -------
     sqlalchemy.engine.Engine
         SQL Alchemy engine.
     """
     engine = create_engine(sqlalchemy_url, **kwargs)
+
     if token is not None:
         @event.listens_for(engine, "do_connect")
         def provide_token(dialect, conn_rec, cargs, cparams):
             SQL_COPT_SS_ACCESS_TOKEN = 1256  # Connection option for access tokens, as defined in msodbcsql.h
             cargs[0] = cargs[0].replace(";Trusted_Connection=Yes", "") # remove the "Trusted_Connection" parameter that SQLAlchemy adds
             cparams["attrs_before"] = {SQL_COPT_SS_ACCESS_TOKEN: token} # apply it to keyword arguments
+
+    db_logger_handler = get_db_logger_handler()
+    if db_logger_handler is not None:
+        return add_db_logger_listeners_to_engine(engine, db_logger_handler)
+        
+    return engine
+
+
+def add_db_logger_listeners_to_engine(engine: Engine, db_logger_handler: object):
+    """Add database logger listeners to engine.
+
+    Arguments
+    ---------
+    engine
+        SQL Alchemy engine.
+    """
+
+    @event.listens_for(engine, "commit")
+    def receive_commit(conn):
+        db_logger_handler.set_lock(False)
+
+    @event.listens_for(engine, "begin")
+    def receive_begin(conn):
+        db_logger_handler.set_lock(True)
+
+    @event.listens_for(engine, "connect")
+    def receive_connect(dbapi_connection, connection_record):
+        db_logger_handler.set_lock(True)
+
+    @event.listens_for(engine, 'engine_disposed')
+    def receive_engine_disposed(engine):
+        db_logger_handler.set_lock(False)
+
     return engine
 
 
+def get_db_logger_handler():
+    """ Return database logger handler (if exists).
+    
+    Returns
+    -------
+    ahjo.logging.db_handler.DatabaseHandler
+        Database logger handler.
+    """
+    for handler in logger.handlers:
+        if handler.name == "handler_database":
+            return handler
+
+
 @rearrange_params({"engine": "connectable"})
 def execute_query(connectable: Union[Engine, Connection, Session], query: str, variables: Union[dict, list, tuple] = None, 
         isolation_level: str = 'AUTOCOMMIT', include_headers: bool = False) -> List[Iterable]:
     """Execute query with chosen isolation level.
 
     Arguments
     ---------
@@ -228,15 +275,16 @@
     errors = {}
     n_files = len(files)
     loop_files = files.copy()
     looped_files = set()
     try:
         for _ in range(n_files):
             for file in loop_files:
-                if file not in looped_files: logger.info(path.basename(file))
+                if file not in looped_files: 
+                    logger.info(path.basename(file), extra={"record_class": "deployment"})
                 looped_files.add(file)
                 batches = _file_to_batches(dialect_name, file, scripting_variables)
                 try:
                     results = _execute_batches(connection_obj, batches, include_headers=include_headers, commit_transaction=False, rollback_on_error=False)
                 except:
                     errors[file] = '\n------\n' + format_exc()
                     continue
@@ -490,14 +538,35 @@
 def get_schema_names(connectable: Union[Engine, Connection]) -> List[str]:
     """Return schema names from database."""
     inspector = inspect(connectable)
     db_list = inspector.get_schema_names()
     return db_list
 
 
+def database_exists(engine: Engine):
+    """ Test database connection. 
+    
+    Arguments
+    ---------
+    engine
+        SQL Alchemy Engine.
+        
+    Returns
+    -------
+    bool
+        True if connection is successful, False otherwise.
+    """
+    try:
+        connection = engine.connect()
+        connection.close()
+    except:
+        return False
+    return True
+
+
 def get_dialect_patterns(dialect_name: str) -> dict:
     """Return dialect patterns (used in SQL parsing), given dialect name.
     If dialect name not recorded, return empty dictionary.
     """
     # Notice, that if DIALECT_PATTERS is a global variable, pyparsing slows down remarkably.
     DIALECT_PATTERNS = {
         'mssql': {
```

## ahjo/logging/__init__.py

```diff
@@ -1,6 +1,192 @@
 # Ahjo - Database deployment framework
 #
 # Copyright 2019 - 2024 ALM Partners Oy
 # SPDX-License-Identifier: Apache-2.0
 
-from ahjo.logging.winEventLogger import winEventHandler
+import os
+import ahjo
+from logging.config import fileConfig, dictConfig
+from logging import getLogger
+from ahjo.context import Context
+from ahjo.logging.db_logger import load_log_table
+from ahjo.database_utilities.sqla_utilities import database_exists
+
+
+AHJO_LOG_CONFIG = {
+    "version": 1,
+    "disable_existing_loggers": False,
+    "loggers":{
+        "root": {
+            "level": "WARN",
+            "handlers": ["handler_console"]
+        },
+        "ahjo":{
+            "level": "DEBUG",
+            "handlers": ["handler_file", "handler_console"],
+            "propagate": False
+        },
+        "alembic":{
+            "level": "INFO",
+            "handlers": ["handler_alembic_console", "handler_file"],
+            "propagate": False
+        },
+    },
+    "handlers":{ 
+        "handler_console":{
+            "class": "logging.StreamHandler",
+            "stream": "ext://sys.stdout",
+            "level": "INFO",
+            "formatter": "formatter_console"
+        },
+        "handler_alembic_console":{
+            "class": "logging.StreamHandler",
+            "stream": "ext://sys.stdout",
+            "level": "INFO",
+            "formatter": "formatter_alembic_console"
+        },
+        "handler_file":{
+            "class": "logging.handlers.RotatingFileHandler",
+            "filename": "ahjo.log",
+            "mode": "a+",
+            "maxBytes": 1000000,
+            "backupCount": 1,
+            "level": "DEBUG",
+            "formatter": "formatter_file"
+        }
+    },
+    "formatters":{
+        "formatter_console":{
+            "format": "%(message)s"
+        },
+        "formatter_alembic_console":{
+            "format": "%(levelname).7s [%(name)s] %(message)s",
+            "datefmt": "%H:%M:%S"
+        },
+        "formatter_file":{
+            "format": "[%(asctime)s] [%(name)s] %(levelname).7s %(message)s",
+            "datefmt": "%Y-%m-%d %H:%M:%S"
+        },
+        "formatter_db":{
+            "()": "ahjo.logging.db_formatter.DatabaseFormatter",
+        }
+
+    }
+}
+
+def setup_ahjo_logger(enable_database_log: bool = True, enable_windows_event_log: bool = False, 
+        enable_sqlalchemy_log: bool = False, context = None, test_db_connection = True):
+    """ Set up the logger configuration for ahjo. 
+    
+    Parameters:
+    -----------
+    enable_database_log: bool
+        Enable database logging.
+    enable_windows_event_log: bool
+        Enable Windows event logging.
+    enable_sqlalchemy_log: bool
+        Enable SQLAlchemy logging.
+
+    Returns:
+    -----------
+    logging.Logger:
+        Logger object for ahjo.
+    """
+    try:
+        # Load root logger configuration
+        fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger_root.ini'))
+
+        # Setup optional loggers
+        if enable_database_log:
+            setup_db_logger(context, test_db_connection = test_db_connection)
+
+        if enable_windows_event_log:
+            setup_win_event_handler()
+
+        if enable_sqlalchemy_log:
+            setup_sqlalchemy_logger()
+        
+        # Load ahjo logger
+        dictConfig(AHJO_LOG_CONFIG)
+
+        return getLogger('ahjo')
+
+    except Exception as error:
+        raise error
+
+
+def setup_db_logger(context: Context, test_db_connection = True):
+    """ Setup database logger. 
+    
+    Parameters:
+    -----------
+    context: Context
+        The context object holding the configuration and connection information.
+    test_db_connection: bool
+        Test the database connection before setting up the logger.
+    
+    Returns:
+    -----------
+    logging.Logger:
+        Logger object for ahjo.
+    """
+    # Assume that the database exists if we are not testing the connection
+    db_exists = database_exists(context.get_engine()) if test_db_connection else True
+
+    if db_exists:
+
+        add_db_handler(
+            context = context, 
+            log_table = load_log_table(
+                context, 
+                context.configuration.get(
+                    "log_table_schema", 
+                    "dbo"
+                ), 
+                context.configuration.get(
+                    "log_table", 
+                    "ahjo_log"
+                )
+            )
+        )
+
+        dictConfig(AHJO_LOG_CONFIG)
+
+        return getLogger('ahjo')
+
+def setup_sqlalchemy_logger():
+    """ Load the logger configuration for SQLAlchemy. """
+    fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger_sqlalchemy.ini'), disable_existing_loggers=False)
+    getLogger('sqlalchemy.engine')
+    getLogger('sqlalchemy.pool')
+    getLogger('sqlalchemy.dialects')
+    getLogger('sqlalchemy.orm')
+
+
+def add_db_handler(context: Context, log_table):
+    """ Add database handler to the logger configuration. 
+    
+    Parameters:
+    -----------
+    context: Context
+        The context object holding the configuration and connection information.
+    log_table: sqlalchemy.Table
+        The log table to which the log records are stored.
+    """
+    AHJO_LOG_CONFIG["loggers"]["ahjo"]["handlers"].append("handler_database")
+    AHJO_LOG_CONFIG["loggers"]["alembic"]["handlers"].append("handler_database")
+    AHJO_LOG_CONFIG["handlers"]["handler_database"] = {
+        "class": "ahjo.logging.db_handler.DatabaseHandler",
+        "level": "DEBUG",
+        "formatter": "formatter_db",
+        "context": context,
+        "log_table": log_table
+    }
+
+def setup_win_event_handler():
+    """ Add Windows event handler to the logger configuration. """
+    AHJO_LOG_CONFIG["loggers"]["ahjo"]["handlers"].append("handler_win_event")
+    AHJO_LOG_CONFIG["handlers"]["handler_win_event"] = {
+        "class": "ahjo.logging.win_event_logger.winEventHandler",
+        "level": "INFO",
+        "formatter": "formatter_console",
+    }
```

## ahjo/operations/__init__.py

```diff
@@ -14,15 +14,16 @@
     print_git_version,
     create_local_config_base,
     create_new_project,
     populate_project,
     bulk_insert_into_database,
     drop_sqlfile_objects,
     deploy_sqlfiles,
-    upgrade
+    upgrade,
+    alembic_command
 )
 
 from ahjo.operations.tsql import (
     create_db,
     create_db_login,
     create_db_permissions,
     create_db_structure,
```

## ahjo/operations/general/__init__.py

```diff
@@ -5,15 +5,16 @@
 
 """Operations common to all database backends.
 """
 
 from ahjo.operations.general.alembic import (
     downgrade_db_to_alembic_base,
     print_alembic_version,
-    upgrade_db_to_latest_alembic_version
+    upgrade_db_to_latest_alembic_version,
+    alembic_command
 )
 
 from ahjo.operations.general.bulk_insert import (
     bulk_insert_into_database
 )
 
 from ahjo.operations.general.git_version import (
```

## ahjo/operations/general/alembic.py

```diff
@@ -15,14 +15,19 @@
 from sqlalchemy.engine import Engine
 from sqlalchemy.engine import Connection
 from typing import Union
 
 from alembic import command
 from alembic.config import Config
 
+ALEMBIC_API_COMMANDS = {
+    "check", "upgrade", "downgrade", "current", "history", "heads", "branches", "stamp", 
+    "revision", "edit", "ensure_version", "init", "list_templates", "merge", "show"
+}
+
 logger = getLogger('ahjo')
 
 
 def alembic_config(config_filename: str, connection: Connection = None) -> Config:
     """Return altered Alembic config.
 
     First, read project's alembic configuration (alembic.ini).
@@ -37,18 +42,51 @@
     main_section = config.config_ini_section
     # main section options are set when main section is read
     config.get_section(main_section)
     config.cmd_opts = Namespace(x=["main_config=" + config_filename])
     if connection:
         config.attributes["connection"] = connection
     config.config_file_name = path.join(
-        AHJO_PATH, 'resources/logger.ini')
+        AHJO_PATH, 'resources/logger_alembic.ini')
     return config
 
 
+def alembic_command(config_filename: str, command_name: str, connection: Connection = None, *args, **kwargs):
+    """ Wrapper for alembic API commands. 
+    
+    Arguments
+    ---------
+    config_filename : str
+        Path to the project's configuration file.
+    command_name : str
+        Alembic API command to run. 
+        Command names can be found from https://alembic.sqlalchemy.org/en/latest/api/commands.html.
+    connection : Connection
+        SQL Alchemy Connection object.
+    *args, **kwargs
+        Arguments to pass to the Alembic command.
+    
+    Raises
+    ------
+    ValueError
+        If command_name is not in ALEMBIC_API_COMMANDS.
+    """
+    if command_name not in ALEMBIC_API_COMMANDS:
+        raise ValueError(f"Command {command_name} not in Alembic API commands.")
+    with OperationManager(f"Running Alembic command: {command_name}"):
+        getattr(command, command_name)(
+            config = alembic_config(
+                config_filename, 
+                connection = connection
+            ),
+            *args, 
+            **kwargs
+        )
+
+
 def upgrade_db_to_latest_alembic_version(config_filename: str, connection: Connection = None):
     """Run Alembic 'upgrade head' in the same python-process
     by calling Alembic's API.
     """
     with OperationManager("Running all upgrade migrations"):
         command.upgrade(alembic_config(config_filename, connection = connection), 'head')
```

## ahjo/operations/general/multi_project_build.py

```diff
@@ -6,17 +6,17 @@
 import ahjo.scripts.master_actions
 import os
 import importlib
 import sys
 from ahjo.database_utilities import create_conn_info, create_sqlalchemy_url, create_sqlalchemy_engine
 from ahjo.interface_methods import load_conf, are_you_sure
 from ahjo.action import execute_action, registered_actions, DEFAULT_ACTIONS_SRC
-from ahjo.operation_manager import format_message, load_sqlalchemy_logger
-from logging import getLogger
-from logging.config import fileConfig
+from ahjo.logging import setup_ahjo_logger
+from ahjo.operation_manager import format_message
+from ahjo.context import Context
 from pathlib import Path
 
 
 def run_multi_project_build(master_config_path: str, skip_project_confirmation = True):
     """
         Run all selected actions from different projects at once.
 
@@ -60,25 +60,30 @@
         importlib.reload(ahjo.scripts.master_actions)
 
         # Load project config
         project_path = str(Path(anchor_path, ahjo_project))
         project_actions = ahjo_projects[ahjo_project]["actions"]
         project_config_path = ahjo_projects[ahjo_project]["config"]
         
-        # Load logging config
-        os.chdir(project_path)
-        sys.path.append(os.getcwd())
-        project_config_dict = load_conf(project_config_path)
-        if project_config_dict.get("windows_event_log", False):
-            fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger_winLog.ini'))
-        else:
-            fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger.ini'))
-        logger = getLogger('ahjo')
-        if project_config_dict.get("enable_sqlalchemy_logging", False):
-            load_sqlalchemy_logger()
+        # Load ahjo logger
+        try:
+            os.chdir(project_path)
+            sys.path.append(os.getcwd())
+            project_config_dict = load_conf(project_config_path)
+            #context = Context(project_config_path, master_engine = master_engine)
+            #enable_db_logging = context.configuration.get("enable_database_logging", False)
+            logger = setup_ahjo_logger(
+                enable_database_log = False,
+                enable_windows_event_log = project_config_dict.get("windows_event_log", False),
+                enable_sqlalchemy_log = project_config_dict.get("enable_sqlalchemy_logging", False)
+                #context = context
+            )
+        except Exception as e:
+            print(f"Error setting up logger: {str(e)}")
+            raise
 
         logger.info('------')
         logger.info('Building ahjo project: ' + ahjo_project)
 
         # Import ahjo project actions
         os.chdir(anchor_parent_path_str)
 
@@ -106,15 +111,37 @@
         except Exception as e:
             logger.error(format_message(f"Error while loading ahjo actions: {e}"))
             raise
 
         os.chdir(project_path)
 
         # Run ahjo actions
+        action_failed = False
         for project_action in project_actions:
-            execute_action(
-                project_action, 
-                project_config_path, 
-                engine = master_engine, 
-                skip_confirmation = skip_project_confirmation
-            )
-        
+            try:
+                execute_action(
+                    project_action, 
+                    project_config_path, 
+                    #context=context,
+                    engine = master_engine, 
+                    skip_confirmation = skip_project_confirmation
+                )
+            except Exception:
+                """
+                if enable_db_logging:
+                    context.connection = None
+                    context.engine = None
+                    context.set_connectable("engine")
+                """
+                action_failed = True
+                break
+        """
+        if enable_db_logging:
+            for handler in logger.handlers:
+                if handler.name == "handler_database":
+                    handler.flush()
+        """
+
+        if action_failed:
+            sys.exit(1)
+
+    sys.exit(0)
```

## ahjo/operations/general/sqlfiles.py

```diff
@@ -211,15 +211,15 @@
         connectable,
         file_path=file,
         scripting_variables=scripting_variables,
         include_headers=True,
         file_transaction=file_transaction,
         commit_transaction=commit_transaction
     )
-    logger.info(path.basename(file))
+    logger.info(path.basename(file), extra={"record_class": "deployment"})
     if display_output:
         logger.info(format_to_table(output))
 
 
 def drop_sql_from_file(file: str, engine: Engine, object_type: str):
     '''Run DROP OBJECT command for object in SQL script file.
```

## ahjo/operations/general/upgrade.py

```diff
@@ -1,37 +1,36 @@
 # Ahjo - Database deployment framework
 #
 # Copyright 2019 - 2024 ALM Partners Oy
 # SPDX-License-Identifier: Apache-2.0
 
 import copy
 import sys
-import importlib
 import os
 import ahjo.scripts.master_actions
-from logging import getLogger
-from logging.config import fileConfig
 from ahjo.interface_methods import load_conf, are_you_sure
 from ahjo.operations.general.git_version import _get_all_tags, _get_git_version, _get_previous_tag, _checkout_tag
 from ahjo.operations.general.db_info import print_db_collation
 from ahjo.action import execute_action, import_actions, DEFAULT_ACTIONS_SRC
 from ahjo.context import Context
+from logging import getLogger
 
 
 sys.path.append(os.getcwd())
 logger = getLogger('ahjo')
 
-
-def upgrade(config_filename: str, version: str = None, skip_confirmation: bool = False):
+def upgrade(config_filename: str, context: Context, version: str = None, skip_confirmation: bool = False):
     """Upgrade database with upgrade actions.
     
     Parameters
     ----------
     config_filename : str
         Path to the configuration file.
+    context : ahjo.context.Context
+        Context object.
     version : str, optional
         Version to be upgraded. If not defined, the next upgradable version is upgraded.
     skip_confirmation : bool, optional
         Skip confirmation prompt. Default is False.
     
     Returns
     -------
@@ -41,34 +40,28 @@
     try:
         # Load settings
         config = load_conf(config_filename)
         upgrade_actions = load_conf(config.get("upgrade_actions_file", f"./upgrade_actions.jsonc"))
         git_table_schema = config.get('git_table_schema', 'dbo')
         git_table = config.get('git_table', 'git_version')
         connectable_type = config.get("context_connectable_type", "engine")
-        if config.get("windows_event_log", False):
-            fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger_winLog.ini'))
-        else:
-            fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger.ini'))
-        logger = getLogger('ahjo')
         updated_versions = []
 
-        # Create context
-        context = Context(config_filename)
-        context.set_enable_transaction(False)
-        
         # Display database collation
         if context.configuration.get("display_db_info", True):
             print_db_collation(context)
 
         # Get the current git commit from database
         _, _, current_db_version = _get_git_version(context.get_connectable(), git_table_schema, git_table)
 
         # Select versions to be deployed
         version_actions = get_upgradable_version_actions(upgrade_actions, current_db_version)
+        if len(list(version_actions.keys())) == 0:
+            logger.info("Database is already up to date. Current database version is " + current_db_version)
+            return True
 
         # Validate user input
         if version is not None:
             version_actions = validate_version(version, version_actions, upgrade_actions, current_db_version)
 
         if not skip_confirmation:
             # Format are_you_sure message
@@ -82,17 +75,25 @@
             # Confirm action
             if not are_you_sure(are_you_sure_msg, False): return False
 
         for git_version in version_actions:
 
             # Checkout the next upgradable git version
             _checkout_tag(git_version)
+            config = load_conf(config_filename)
+
+            # Update version info in the database logger
+            if config.get("enable_database_logging", True):
+                for handler in logger.handlers:
+                    if handler.name == "handler_database":
+                        handler.flush()
+                        handler.db_logger.set_git_commit(git_version)
+                        break
 
             # Reload ahjo actions
-            config = load_conf(config_filename)
             import_actions(
                 ahjo_action_files = config.get("ahjo_action_files", DEFAULT_ACTIONS_SRC), 
                 reload_module = True
             )
 
             # Deploy version upgrades
             actions = version_actions[git_version]
@@ -193,17 +194,14 @@
             raise ValueError(f"Git tag {version} does not exist in the repository.")
         
         if previous_version is not None:
             git_previous_tag = _get_previous_tag(version)
             if previous_version != git_previous_tag:
                 raise ValueError(f"Git versions in upgrade_actions are not listed in the correct order: {previous_version} -> {version}")
         previous_version = version
-
-    if len(list(version_actions.keys())) == 0:
-        raise ValueError(f"Database is already up to date. Current database version is {current_version}.")
         
     return version_actions
 
 
 def validate_version(version: str, version_actions: dict, upgrade_actions: dict, current_db_version: str):
     """Validate that the version is upgradable."""
     if version not in upgrade_actions:
```

## ahjo/resources/files/config_development.jsonc

```diff
@@ -25,14 +25,17 @@
         //,"database_log_path": "/var/opt/mssql/data/<DB NAME>.ldf"
         // Database extra options (optional for init)
         //,"database_init_size": 100
         //,"database_max_size": 10000
         //,"database_file_growth": 500
         //,"database_compatibility_level": 140
         //,"database_collation": "Latin1_General_CS_AS"
+        //,"enable_database_logging": false
+        //,"log_table_schema": "dbo"
+        //,"log_table": "ahjo_log"
         // Storing credentials to files is not secure, and not recommended in a production environment!
         //The files for usernames and passwords should be different, or commented out for no password saving
         //,"username_file": "C:\\Hash\\username_ahjo.txt"
         //,"password_file": "C:\\Hash\\password_ahjo.txt"
         // The table that alembic creates automatically for migration version handling
         //,"alembic_version_table": "alembic_version"
         //,"alembic_version_table_schema": "dbo"
@@ -57,9 +60,10 @@
         // If the defined setting is different from the database setting, a warning is logged. Applies only to Azure SQL Database.
         //,"catalog_collation_type_desc": "DATABASE_DEFAULT"
         // Type of SQLAlchmey object returned by Context.get_connectable(). Possible values are "engine" and "connection".
         //,"context_connectable_type": "engine"
         // Transaction management style for ahjo actions. Applied only if context_connectable_type is "connection". 
         // Possible values are "begin_once" and "commit_as_you_go".
         //,"transaction_mode": "begin_once"
+        //,"enable_sqlalchemy_logging": false
     }
 }
```

## ahjo/resources/files/config_development.yaml

```diff
@@ -23,14 +23,17 @@
   #database_log_path: /var/opt/mssql/data/<DB NAME>.ldf
   ## Database extra options (optional for init).
   #database_init_size: 100
   #database_max_size: 10000
   #database_file_growth: 500
   #database_compatibility_level: 140
   #database_collation: Latin1_General_CS_AS
+  #enable_database_logging: false
+  #log_table_schema: dbo
+  #log_table: ahjo_log
   ## Credentials for database connection.
   ## Storing credentials to files is not secure, and not recommended in a production environment!
   ## The files for usernames and passwords should be different, or commented out for no password saving.
   #username_file: C:\Hash\username_ahjo.txt
   #password_file: C:\Hash\password_ahjo.txt
   ## Authentication type to Azure AD.
   ## Possible values: "ActiveDirectoryPassword", "ActiveDirectoryInteractive", 
@@ -62,8 +65,9 @@
   ## JSON file format: {"repository": "<url>", "commit": "<commit hash>", "branch": "<branch name>"}
   #git_version_info_path: git_version.json
   ## A dictionary containing [SQLAlchemy URL query connection parameters](https://docs.sqlalchemy.org/en/20/core/engines.html#sqlalchemy.engine.URL.query).
   #sqla_url_query_map:
   #  TrustServerCertificate: no
   #  Encrypt: yes
   ## SQLAlchemy database URL. If defined, overrides the values of dialect, sql_port, sql_driver, target_server_hostname and target_database_name.
-  #sqlalchemy.url: mssql+pyodbc://user:password@localhost:14330/DB_NAME?driver=ODBC+Driver+18+for+SQL+Server&Encrypt=no&TrustServerCertificate=yes
+  #sqlalchemy.url: mssql+pyodbc://user:password@localhost:14330/DB_NAME?driver=ODBC+Driver+18+for+SQL+Server&Encrypt=no&TrustServerCertificate=yes
+  #enable_sqlalchemy_logging: false
```

## ahjo/scripts/config.py

```diff
@@ -3,23 +3,18 @@
 # Copyright 2019 - 2024 ALM Partners Oy
 # SPDX-License-Identifier: Apache-2.0
 
 '''
     Ahjo config command entrypoint.
 '''
 import argparse
-import os
-import ahjo
-from logging import getLogger
-from logging.config import fileConfig
 from ahjo.context import convert_config_to_yaml, convert_config_to_json
-from ahjo.interface_methods import load_conf
+from ahjo.logging import setup_ahjo_logger
 
-fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger.ini'))
-logger = getLogger('ahjo')
+logger = setup_ahjo_logger(enable_database_log = False)
 
 def main():
 
     parser = argparse.ArgumentParser()
     parser.add_argument(
         "--convert-to", "-co",
         help="Convert ahjo config file to another format. Supported formats: yaml, json, jsonc", 
@@ -34,16 +29,14 @@
     parser.add_argument(
         "--output", "-o",
         help="Path to output file.",
         required=True
     )
 
     args = parser.parse_args()
-    if load_conf(args.config).get("windows_event_log", False):
-        fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger_winLog.ini'))
 
     if args.convert_to in ["yaml", "yml"]:
         convert_config_to_yaml(
             config_path = args.config,
             output_path = args.output
         )
     if args.convert_to in ["json", "jsonc"]:
```

## ahjo/scripts/init_project.py

```diff
@@ -1,24 +1,21 @@
 # Ahjo - Database deployment framework
 #
 # Copyright 2019 - 2024 ALM Partners Oy
 # SPDX-License-Identifier: Apache-2.0
 
 '''Ahjo project initialization command entrypoint.
 '''
-from os import getcwd, path
-from logging.config import fileConfig
-
+from os import getcwd
 from ahjo.interface_methods import are_you_sure, remove_special_chars
 from ahjo.operations import create_new_project
-import ahjo # unqualified import for ahjo.__file__ location
+from ahjo.logging import setup_ahjo_logger
 
 INIT_LOCATION = getcwd()
-
-fileConfig(path.join(path.dirname(ahjo.__file__), 'resources/logger.ini'))
+setup_ahjo_logger(enable_database_log = False)
 
 
 def main():
     print('This is Ahjo project initialization command.')
     project_name_raw = input('Enter project name: ')
     project_name = remove_special_chars(project_name_raw)
     project_config_format = input("Select configuration file format (yaml/json/jsonc): ")
```

## ahjo/scripts/install_git_hook.py

```diff
@@ -3,22 +3,18 @@
 # Copyright 2019 - 2024 ALM Partners Oy
 # SPDX-License-Identifier: Apache-2.0
 
 '''
     Ahjo scan command entrypoint.
 '''
 import argparse
-import os
-import ahjo
 from ahjo.operations.general.git_hook import install_precommit_scan
-from logging import getLogger
-from logging.config import fileConfig
+from ahjo.logging import setup_ahjo_logger
 
-fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger.ini'))
-logger = getLogger('ahjo')
+logger = setup_ahjo_logger(enable_database_log = False)
 
 def main():
     parser = argparse.ArgumentParser()
     parser.add_argument("-r", "--search-rules", required=False, help="Path to ahjo scan rules config file.")
     parser.add_argument("-ig", "--ignore-config", required=False, help="Path to ahjo scan ignore config file.")
     args = parser.parse_args()
     install_precommit_scan(scan_rules_path = args.search_rules, ignore_file_path = args.ignore_config)
```

## ahjo/scripts/master.py

```diff
@@ -1,36 +1,30 @@
 # Ahjo - Database deployment framework
 #
 # Copyright 2019 - 2024 ALM Partners Oy
 # SPDX-License-Identifier: Apache-2.0
 
 import argparse
-import os
 import sys
 import ahjo.scripts.master_actions
 
-from logging import getLogger
-from logging.config import fileConfig
 from ahjo.action import execute_action, list_actions, import_actions, action_affects_db, DEFAULT_ACTIONS_SRC
 from ahjo.context import config_is_valid, Context
 from ahjo.interface_methods import get_config_path
 from ahjo.operations.general.db_info import print_db_collation
-from ahjo.operation_manager import load_sqlalchemy_logger
+from ahjo.logging import setup_ahjo_logger
 
 try:
     from ahjo.version import version as AHJO_VERSION
 except ImportError:
     AHJO_VERSION = "?.?.?"
 
 # Indicator for a frozen executable (e.g. running from an msi installation)
 CX_FROZEN_TAG = " (frozen)" if getattr(sys, "frozen", False) else ""
 
-fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger.ini'))
-logger = getLogger('ahjo')
-
 info_msg = f"    Ahjo - Database deployment framework v{AHJO_VERSION}{CX_FROZEN_TAG}   "
 line = "-" * len(info_msg)
 print(line)
 print(info_msg)
 print(line)
 
 
@@ -61,49 +55,66 @@
             i += 1
             while i < len(rest_args) and not rest_args[i].startswith("-") and not rest_args[i].startswith("--"):
                 rest_args_dict[key].append(rest_args[i])
                 i += 1
 
     args_dict.update(rest_args_dict)
 
-    logger.debug(f'Action:  {ahjo_action}')
-    logger.debug(f'Config file:  {args.config_filename}')
-    logger.debug(f'File(s):  {args.files}')
-    logger.debug(f'Object type:  {args.object_type}')
-
     config_path = get_config_path(args.config_filename)
     context = Context(config_path, command_line_args = args_dict)
 
-    if context.configuration.get("enable_sqlalchemy_logging", False):
-        load_sqlalchemy_logger()
-
     import_actions(
         ahjo_action_files = context.configuration.get("ahjo_action_files", DEFAULT_ACTIONS_SRC)
     )
 
     if ahjo_action == 'list':
         list_actions()
     else:
 
+        action_succeeded = False
         non_interactive = args.non_interactive
+        enable_db_logging = context.configuration.get("enable_database_logging", False)
+        
+        try:
+            logger = setup_ahjo_logger(
+                enable_database_log = enable_db_logging,
+                enable_windows_event_log = context.configuration.get("windows_event_log", False),
+                enable_sqlalchemy_log = context.configuration.get("enable_sqlalchemy_logging", False),
+                context = context
+            )
+        except Exception as error:
+            print(f"Error setting up logger: {str(error)}")
+            sys.exit(1)
+
         if not config_is_valid(config_path, non_interactive = non_interactive):
-            return
+            sys.exit(1)
         
         if context.configuration.get("display_db_info", True) and action_affects_db(ahjo_action):
             print_db_collation(context)
         
-        # Use different logger configuration for Windows Event Log
-        # Preferably we should have only one logger configuration, but this is a workaround for now
-        if context.configuration.get("windows_event_log", False):
-            fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger_winLog.ini'))
-
         kwargs = {"context": context}
         if len(args.files) > 0 : kwargs['files'] = args.files
         if len(args.object_type) > 0 : kwargs['object_type'] = args.object_type[0]
         if non_interactive : kwargs['skip_confirmation'] = True
-        execute_action(
-            *[ahjo_action, config_path],
-            **kwargs
-        )
+
+        try:
+            execute_action(
+                *[ahjo_action, config_path],
+                **kwargs
+            )
+            action_succeeded = True
+        except Exception:
+            if enable_db_logging:
+                context.connection = None
+                context.engine = None
+                context.set_connectable("engine")
+
+        if enable_db_logging:
+            for handler in logger.handlers:
+                if handler.name == "handler_database":
+                    handler.flush()
+                    break
+
+        sys.exit(0) if action_succeeded else sys.exit(1)
 
 if __name__ == '__main__':
     main()
```

## ahjo/scripts/master_actions.py

```diff
@@ -13,14 +13,15 @@
 
 import ahjo.operations as op
 import ahjo.database_utilities as du
 from ahjo.action import action, create_multiaction, registered_actions
 from ahjo.operations.tsql.sqlfiles import deploy_mssql_sqlfiles
 from sqlalchemy.sql import text
 from sqlalchemy.engine import Connection
+from ahjo.logging import setup_db_logger
 
 logger = getLogger('ahjo')
 
 
 @action()
 def init_config(context):
     """Create a local configuration file."""
@@ -44,17 +45,32 @@
         init_size = context.configuration.get('database_init_size', 100)
         max_size = context.configuration.get('database_max_size', 10000)
         file_growth = context.configuration.get('database_file_growth', 500)
         compatibility_level = context.configuration.get('database_compatibility_level')
         collation = context.configuration.get('database_collation', 'Latin1_General_CS_AS')
         op.create_db(master_engine, db_name, db_path, log_path, init_size,
                      max_size, file_growth, compatibility_level, collation)
+    except:
+        raise
     finally:
         if dispose_master_engine:
+
             master_engine.dispose()
+
+            if context.configuration.get("enable_database_logging", False):
+                # Create database log table
+                try:
+                    setup_db_logger(context, test_db_connection = False)
+                except Exception as error:
+                    logger.error(f"Error setting up logger: {str(error)}")
+                    raise
+                for handler in logger.handlers:
+                    if handler.name == "handler_database":
+                        handler.flush()
+                        break
         else:
             with master_engine.connect() as con:
                 con.execute(text('USE ' + db_name + ';'))
 
 
 @action(affects_database=True, dependencies=['init'])
 def create_db_login(context):
```

## ahjo/scripts/scan_project.py

```diff
@@ -3,24 +3,20 @@
 # Copyright 2019 - 2024 ALM Partners Oy
 # SPDX-License-Identifier: Apache-2.0
 
 '''
     Ahjo scan command entrypoint.
 '''
 import argparse
-import os
 import sys
-import ahjo
-from logging import getLogger
-from logging.config import fileConfig
 from ahjo.operations.general.scan import scan_project, initialize_scan_config
 from ahjo.interface_methods import load_yaml_conf
+from ahjo.logging import setup_ahjo_logger
 
-fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger.ini'))
-logger = getLogger('ahjo')
+logger = setup_ahjo_logger(enable_database_log = False)
 
 def main():
     parser = argparse.ArgumentParser()
     parser.add_argument("-r", "--search-rules", required=False, help="Path to ahjo scan rules config file.", default="ahjo_scan_rules.yaml")
     parser.add_argument("-ig", "--ignore-config", required=False, help="Path to ahjo scan ignore config file.", default="ahjo_scan_ignore.yaml")
     parser.add_argument("-st", "--stage", action="store_true", required=False, help="Scan files in git staging area instead of working directory.")
     parser.add_argument("-q", "--quiet", action="store_true", required=False,
```

## ahjo/scripts/upgrade_project.py

```diff
@@ -4,54 +4,74 @@
 # SPDX-License-Identifier: Apache-2.0
 
 '''
     Ahjo upgrade-project command entrypoint.
 '''
 
 import argparse
-import os
 import ahjo.scripts.master_actions
 import sys
-from logging import getLogger
-from logging.config import fileConfig
 from ahjo.operations.general.upgrade import upgrade
-from ahjo.context import config_is_valid
+from ahjo.context import Context, config_is_valid
+from ahjo.logging import setup_ahjo_logger
 from ahjo.interface_methods import get_config_path, load_conf
-from ahjo.operation_manager import load_sqlalchemy_logger
-
-
-# load logging config
-fileConfig(os.path.join(os.path.dirname(ahjo.__file__), 'resources/logger.ini'))
-logger = getLogger('ahjo')
 
 info_msg = "Ahjo upgrade-project"
 line = "-" * len(info_msg)
-logger.info(line)
-logger.info(info_msg)
-logger.info(line)
+print(line)
+print(info_msg)
+print(line)
 
 def main():
     parser = argparse.ArgumentParser()
     parser.add_argument("config_filename", help="Configuration filename.", type=str, nargs="?")
     parser.add_argument("-v", "--version", type=str, help="Version to upgrade to.", required=False)
     parser.add_argument('-ni', '--non-interactive', action='store_true', help='Optional parameter to run ahjo in a non-interactive mode', required=False)
     args = parser.parse_args()
 
     config_filename = get_config_path(args.config_filename)
     config_dict = load_conf(config_filename)
     non_interactive = args.non_interactive
     if not config_is_valid(config_dict, non_interactive = non_interactive):
         sys.exit(1)
 
-    if config_dict.get("enable_sqlalchemy_logging", False):
-        load_sqlalchemy_logger()
+    # Create context
+    context = Context(config_filename)
+    context.set_enable_transaction(False)
+
+    # Setup logger
+    enable_db_logging = context.configuration.get("enable_database_logging", False)
+    try:
+        logger = setup_ahjo_logger(
+            enable_database_log = enable_db_logging,
+            enable_windows_event_log = context.configuration.get("windows_event_log", False),
+            enable_sqlalchemy_log = context.configuration.get("enable_sqlalchemy_logging", False),
+            context = context
+        )
+    except Exception as e:
+        print(f"Error setting up logger: {str(e)}")
+        sys.exit(1)
 
     upgrade_succeeded = upgrade(
         config_filename,
-        args.version,
+        context,
+        version = args.version,
         skip_confirmation = non_interactive
     )
+
+    if enable_db_logging:
+
+        if not upgrade_succeeded:
+            context.connection = None
+            context.engine = None
+            context.set_connectable("engine")
+
+        for handler in logger.handlers:
+            if handler.name == "handler_database":
+                handler.flush()
+                break
+
     sys.exit(0) if upgrade_succeeded else sys.exit(1)
 
     
 if __name__ == '__main__':
     main()
```

## Comparing `ahjo-3.7.0.dist-info/LICENSE` & `ahjo-3.8.0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `ahjo-3.7.0.dist-info/METADATA` & `ahjo-3.8.0.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,33 +1,30 @@
 Metadata-Version: 2.1
 Name: ahjo
-Version: 3.7.0
+Version: 3.8.0
 Summary: Database deployment framework
 Home-page: https://github.com/ALMPartners/ahjo
 Author: ALM Partners Oy
 Author-email: servicedesk@almpartners.fi
 Keywords: ahjo
 Classifier: Intended Audience :: Developers
 Classifier: License :: OSI Approved :: Apache Software License
 Classifier: Topic :: Database
-Classifier: Programming Language :: Python :: 3.8
-Classifier: Programming Language :: Python :: 3.9
-Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Programming Language :: Python :: 3.12
 Requires-Python: >=3.8
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: alembic <1.14,>=1.9
 Requires-Dist: pyparsing <3.2,>=3.0
 Requires-Dist: sqlalchemy <2.1,>=2.0
 Requires-Dist: PyYAML <6.1,>=6.0
 Requires-Dist: lark <1.2,>=1.1
 Provides-Extra: azure
-Requires-Dist: azure-identity <1.16,>=1.14 ; extra == 'azure'
+Requires-Dist: azure-identity <1.17,>=1.14 ; extra == 'azure'
 Provides-Extra: mssql
 Requires-Dist: pyodbc <5.1,>=5.0 ; extra == 'mssql'
 
 Ahjo Framework
 ====================
 
 [![PyPI - Python Version](https://img.shields.io/pypi/pyversions/ahjo)](https://pypi.org/project/ahjo/) [![PyPI](https://img.shields.io/pypi/v/ahjo)](https://pypi.org/project/ahjo/)
@@ -91,18 +88,16 @@
 
 ### Building an MSI installation package
 
 This assumes you have cloned the source code repository and have it open in a shell.
 
 Create a new, empty build venv and install build requirements into it.
 
-**Notice:** at the time of writing this (10/2023), [the latest stable cx_freeze version](https://cx-freeze.readthedocs.io/en/stable) (6.15.10) **does not support Python 3.12** yet. As soon as new cx_freeze version with Python 3.12 support is released, it should be taken in to use.
-
 ```
-py -3.11 -m venv venv_msi_build
+python -m venv venv_msi_build
 .\venv_msi_build\Scripts\Activate.ps1 
 pip install -r .\msi_build_requirements.txt
 ```
 
 **Notice:** the last command installs ahjo with the most common options. You may need to update msi_build_requirements.txt to suit your needs.
 
 **Notice:** if you make changes to the source code, you must install ahjo into build venv again to have those changes included in the next build. Editable pip install doesn't work here, so don't use it.
@@ -386,14 +381,17 @@
 | `database_collation` | No | Collation of database. If the defined collation is different from the database collation, a warning is logged. | `str` | `"Latin1_General_CS_AS"` |
 | `database_compatibility_level` | No | Compatibility level of database. | `int` | Depends on server. SQL Server 2017 default is `140`. |
 | `database_data_path` | No | Path of database data file. | `str` | |
 | `database_file_growth` | No | The size (MB) of how much database data file will grow when it runs out of space. | `int` | `500` |
 | `database_init_size` | No | Initial size (MB) of database data file. | `int` | `100` |
 | `database_log_path` | No | Path of database log file. | `str` | |
 | `database_max_size` | No | Maximum size (MB) of database data file. | `int` | `10000` |
+| `enable_database_logging` | No | Enable logging to database. | `boolean` | `false` |
+| `log_table_schema` | No | Schema of log table. | `str` | `"dbo"` |
+| `log_table` | No | Name of ahjo log table. | `str` | `"ahjo_log"` |
 | `git_table` | No | Name of git hash table. Table holds current branch, commit hash and URL of remote repository. | `str` | `"git_version"` |
 | `git_table_schema` | No | Schema of git hash table. | `str` | `"dbo"` |
 | `metadata_allowed_schemas` | No | List of schemas that extended properties will be written to JSON files and updated to database. If list left empty, nothing is documented or updated. | list of str | |
 | `password_file` | No | Path of file where password will be stored. If no path given, credentials are asked everytime any database altering action is run. | `str` | |
 | `sql_dialect` | No | Dialect used by SQL Alchemy. | `str` | `"mssql+pyodbc"` |
 | `sql_driver` | No | Name of ODBC driver. | `str` | |
 | `sql_port` | Yes | Port number of target database server. | `int` | |
@@ -431,14 +429,26 @@
 Usage example:
 ```
 alembic -x main_config=config_development.jsonc downgrade -1
 ```
 
 The [env.py](./ahjo/resources/files/env.py) is created in initialize-project command.
 
+## Alembic API commands
+Ahjo supports running alembic commands with the following command:
+```bash
+alembic-api <arguments>
+```
+Alembic API can be used for example in a situation where Ahjo is installed with MSI package and one needs to run alembic commands without python environment.
+
+Examples:
+```bash
+alembic-api revision -m "create table <table_name>"
+alembic-api -x main_config=config_development.jsonc upgrade +1
+```
 
 # <u> Authentication </u>
 Depending on the configuration, the database credentials can be stored into files or be asked when needed, once per application run. The credential handling is shared with alembic with custom [env.py](./ahjo/resources/files/env.py) file. The username and password files can be defined in the config file with the keys `username_file` and `password_file`. If no path is given, credentials are asked every time any database altering action is run. The password and username files are created automatically if they do not exist.
 
 ## Microsoft Entra
 Ahjo supports authentication with Microsoft Entra / Azure AD. The authentication type is defined in the config file with the key `azure_authentication`. The possible values are `"ActiveDirectoryPassword"`, `"ActiveDirectoryInteractive"`, `"ActiveDirectoryIntegrated"` and `"AzureIdentity"`. The authentication type `"AzureIdentity"` is used for authentication with azure-identity library (see [Azure-identity](#Azure-identity)).
 
@@ -603,16 +613,24 @@
 ```
 ahjo-install-git-hook
 ```
 The script creates a file named `pre-commit` to Git hooks directory. By default, Git hooks are located in the `.git/hooks` directory of the repository. This can be changed by setting the `core.hooksPath` configuration variable to the desired path. See [Git documentation](https://git-scm.com/docs/githooks) for more information.
 
 
 # <u>Logging</u>
-Ahjo's logging is very inclusive. Everything Ahjo prints to console, is also written into log file `ahjo.log`. 
+### Log files
+Everything Ahjo prints to console, is also written into log file `ahjo.log` in the project root directory. The log files are created automatically if they do not exist.
+
+### Database log
+Ahjo supports database logging. The logging can be enabled by setting `enable_database_logging` to `true` in the config file. The log entries are written into a log table. The name and schema of the log table can be defined in the config file with keys `log_table` and `log_table_schema`. The log table is created automatically if it does not exist.
+
+### Windows Event Log
 Logging can be done to Windows Event Log by setting `windows_event_log` to `true` in config file. This feature can be utilized for Azure Monitor activities, for example. 
+
+### SQLAlchemy log
 SQL Alchemy logging can be enabled by setting `enable_sqlalchemy_logging` to `true` in config file. The logging is done to a file named `sqlalchemy.log` in the project root directory. The log files are created automatically if they do not exist.
 
 # <u>Customization</u>
 
 ## Setting up custom action files
 Every default Ahjo action and multiaction can be overwritten in project's Ahjo actions file. By default, the file is located in `ahjo_actions.py`, but the location can be changed in config file with key `ahjo_action_files`. It is possible to define multiple Ahjo actions files. This can be useful for example when you want to use different actions for different environments or separate actions that are compatible with MSI-installed ahjo from actions that are compatible with pip-installed ahjo. The action files are loaded in order, so if you define multiple actions for the same action name, the last loaded action file will be used. If a multi-action uses actions from different files, remember to load all the subactions before the multi-action. Here is an example of `ahjo_action_files` configuration:
 ```jsonc
```

## Comparing `ahjo-3.7.0.dist-info/RECORD` & `ahjo-3.8.0.dist-info/RECORD`

 * *Files 11% similar despite different names*

```diff
@@ -1,76 +1,83 @@
 ahjo/__init__.py,sha256=ReZrA9U3WOuOny-hvBbB12833gjxpDAWomXQEGuPNyw,123
-ahjo/action.py,sha256=PNdKIzfLTSeEaZoN7I1hUZ3MBgx-CUarw9kGFVy6u30,10559
-ahjo/context.py,sha256=nJLRBRz4GVnI93q81OT1MJwZstw5_R8wjSQk5Ib23qA,9516
+ahjo/action.py,sha256=uW-TZeUxjnSdUH50AyjimVXipN4l1sgPZZdeIUrASYE,10507
+ahjo/context.py,sha256=Mnr5Y25YsTst5NlxVm0Fty-FgPQVnyTzolkZugY-JiE,10623
 ahjo/credential_handler.py,sha256=0g6F-onqhH2exZxlfE_9EzOyIadb5kgZta00AP-BNHI,4032
 ahjo/interface_methods.py,sha256=Q9OJe_Lh0hCw_5F5owbHVFyk-17BLDwb4QjAGhLWji8,4945
-ahjo/operation_manager.py,sha256=uERjaG9IyMF2Dc2jb6_JuVE-lSInQn7m6_pmIcYizxA,1437
-ahjo/version.py,sha256=6lJjXXyfa5WT7Mnspx3agglrbQqsXsFHZrx8mmNdDJo,427
+ahjo/operation_manager.py,sha256=mTN5Dgf1zAORw99c0GVp-dC4EDX4PacLmUZur5-UhNE,1103
+ahjo/version.py,sha256=OMWzppATQ5LAOdYrudE2oDHRqHCdzIbr4e2ZprKjFS8,427
 ahjo/database_utilities/__init__.py,sha256=L08vaYcKVq45I-8JYmqgcATwqGsD_gdtbVhMYSQ-Ewg,775
 ahjo/database_utilities/conn_info.py,sha256=EwN2glRsMebdjJN-vcQJZfeXM-4mVTVc3THYBLhIYag,5836
 ahjo/database_utilities/pyodbc_utilities.py,sha256=1q_BHCRlKJCjlep7InfCOfrT0Eo2k7p0fo6a9RK2zV4,2412
-ahjo/database_utilities/sqla_utilities.py,sha256=DzqAdOj4GrN8UYRj6yPcOJSlC5iNGV6ZCHvYfia9cms,20518
+ahjo/database_utilities/sqla_utilities.py,sha256=2Z3sQH-QZYnxFOhYgwzrumh2L8v-WP5a0QAKxKCnvIs,22236
 ahjo/database_utilities/sqlcmd.py,sha256=nK--V5aJYR8TnyWMKW-eKXJ50v-MD-_KNi5QHoufG_o,3793
-ahjo/logging/__init__.py,sha256=nZTujLUbLyLCmVc9kFM5HweDLewxUT-DMXbc1AevaxY,180
+ahjo/logging/__init__.py,sha256=vqvbE0nkNXgkE6W86kQs-THsC1X6QaKEx3o8U8oZ934,6049
+ahjo/logging/db_formatter.py,sha256=isQjJNDlAOPADj-e3rRmHEyoOQ4ILEAzoV16FV1W-JQ,1111
+ahjo/logging/db_handler.py,sha256=Ftt3P-51R9sOdZRRXIq0QPJbYIbs3BiXhOB37mQ_GFE,4478
+ahjo/logging/db_logger.py,sha256=aAosy_KmMSabXzsRIWSJDLc5trxmm2DbYWOYqLnZpQ8,4987
 ahjo/logging/winEventLogger.py,sha256=NsafEIdAyxLaIIJroeZPJobYzGeoX9ts8lDWj4hTZ_A,1257
-ahjo/operations/__init__.py,sha256=hQMTVnfYCAF9joHFueRQu_166TxL3qQpo9wVRbDKASs,753
-ahjo/operations/general/__init__.py,sha256=YQSsFmXQRmQsvuu4CFYOzO8MLdUjlnHL7F4QAuQMYK4,997
-ahjo/operations/general/alembic.py,sha256=-G-VW7wjwthP_HSe9XIZCELhrdNzOJD4cSYbCZXkEMc,2969
+ahjo/logging/win_event_logger.py,sha256=NsafEIdAyxLaIIJroeZPJobYzGeoX9ts8lDWj4hTZ_A,1257
+ahjo/operations/__init__.py,sha256=RXFa9tmBfpSUPbkYvv3Zs2hN4OL6A694UkuGcG0-i8A,775
+ahjo/operations/general/__init__.py,sha256=0w_sm0HE-PVUKt5vieKol6O1WJGVzMdJOfaKRSOkfPc,1019
+ahjo/operations/general/alembic.py,sha256=YjZ62PoHWJjSnq3-v7c_5eP-mW-uNHdqUBi-SUoIxIc,4302
 ahjo/operations/general/bulk_insert.py,sha256=WD8jf-Y4yZcMTjshWIz913ue32QkPtPsqKweykoA0Pg,4038
 ahjo/operations/general/db_info.py,sha256=40Dm4XvO94kgZSgAZV0HvS6jXMdiqZuNvxjEUGZBSVQ,971
 ahjo/operations/general/git_hook.py,sha256=v6RnbW8V6oiw_n7aVxoCs90WlNUTSW4isOcetK6CR6s,4023
 ahjo/operations/general/git_version.py,sha256=-ZLzEdhGlsTbal3b1egotIt2jVwMdez_K9lzNFEqKA8,10309
 ahjo/operations/general/initialization.py,sha256=OaV3mJBiYj2dkbFQ-kbL9W0VjGg8HizLbXckLRnxg2E,4595
-ahjo/operations/general/multi_project_build.py,sha256=dQORfI97Zk4jpETBqBQ8Z0ShdVIk2U-S9orLFwxQ7Cs,4689
+ahjo/operations/general/multi_project_build.py,sha256=0T2giE5JGvzDNc6E1oFWbBIBkeBQOkOApddHQO-1MPQ,5582
 ahjo/operations/general/scan.py,sha256=4T5_-9aEXvueKXG56zDnlkVgY9Mfrtr4-G9fhB1RFQ0,18590
-ahjo/operations/general/sqlfiles.py,sha256=cYUhIh69Kqu8yhkem7jDBK6dKMYc8WMhJrsd6XoUnAY,11364
-ahjo/operations/general/upgrade.py,sha256=B89MhmOpt4CIq_tXpDSoLLxf8peYxuh2qTUrVirl-jg,8873
+ahjo/operations/general/sqlfiles.py,sha256=UWrQHkQoSy5tM3bmUlAfdnjs6mlfSvqgEfePa-Do8VA,11402
+ahjo/operations/general/upgrade.py,sha256=WSIRARQdRLMQo7O6ghQ-ukTbie1GfK29ak7SURvTCLw,8869
 ahjo/operations/tsql/__init__.py,sha256=BSlcm5Ylwm-74ljAPE_if3B3-Y6VtkeBTwwDxhBCFnw,633
 ahjo/operations/tsql/create_db.py,sha256=lKoqmssd4F_tzAu7nMYb9cbsj4sGZav0C73QLq-lSdI,4247
 ahjo/operations/tsql/create_db_login.py,sha256=1G5CO33iFetaJe8hjWTcsWn8T1_DMpqRWzuKGwgUgc0,3079
 ahjo/operations/tsql/create_db_permissions.py,sha256=6QBXuN8Lev0zWjWDxFP4sBLEiw_0_6_IE3J1JWYDpa4,1312
 ahjo/operations/tsql/create_db_structure.py,sha256=9vPQ7ElTvxREowHvBqHzAkvl29DfuB6xshl2LkAUytU,613
 ahjo/operations/tsql/db_info.py,sha256=JjPeSQ7f01CqLw0KPCid9Lp1WD6uTOZluqxUJMU5aNs,3779
 ahjo/operations/tsql/db_object_properties.py,sha256=eIAbcJ94L7lKZ69U6pmJ1tG3xtgok0uuEo76EbVcKHA,12850
 ahjo/operations/tsql/set_statements.py,sha256=8-bd63xAus3Tg6q-eqeAUh2Iop_V-WCH-G87zv3q-S8,837
 ahjo/operations/tsql/sqlfiles.py,sha256=ena4CJl1-nOpwpfDtHj3uLg93lx2vfbL4o_8INbfQ6Q,556
 ahjo/resources/logger.ini,sha256=4mRGBgungRXdP858x7wlu6Yn4f2bNz7x5-FzJGQ-Qfw,1125
+ahjo/resources/logger_alembic.ini,sha256=yrEbkQZrOQjTN8O58YiElPclQtkF4ypQV-dzEbJF6pw,420
+ahjo/resources/logger_root.ini,sha256=CuGBrYykdinDFjb5ZM-0RFogRRLQnoXU003y6_KBkmU,418
 ahjo/resources/logger_sqlalchemy.ini,sha256=00by_gwC8plMuJ0m2Xz0zfSl00UvRqe6H40Td3su2Ak,2231
 ahjo/resources/logger_winLog.ini,sha256=VOz4MgjVbpFqb-o9ekBQMeOrqGNAMvXNgqjG0XIqHTc,1382
 ahjo/resources/winEventLogger.py,sha256=NsafEIdAyxLaIIJroeZPJobYzGeoX9ts8lDWj4hTZ_A,1257
 ahjo/resources/files/.gitignore,sha256=8PMgKh2ayI4TzP6_HmPG7Znl1ya-cB3BYf2YhnCNnjk,395
 ahjo/resources/files/ahjo_actions.py,sha256=XGB5QaIb0poaTp1JpJKHWIDiDcKmJrP1HWtKDEJRF-I,362
 ahjo/resources/files/alembic.ini,sha256=fUoLjp-cDKJ5dU1y-ifymmMyMXRIVC8jxe7wILHgaHU,2041
 ahjo/resources/files/alembic_dummy,sha256=MfZAyQxpRXNTy-LFhDAACr7M9Tr_a7JCUs6KZmo6X1Y,235
 ahjo/resources/files/config_development.json,sha256=B2GNSzTR5plHD82Ug41YReWPj8YAWRzwT5YG4yGZwW4,397
-ahjo/resources/files/config_development.jsonc,sha256=wHxWtOnp5s2QKDGbEE86Yo5NJREZ-KvXvbEL627E-rk,3966
-ahjo/resources/files/config_development.yaml,sha256=KCvWu5lhhrFnoQD0RA6Ikaq5gVtyi3G9KNQnh87f_Vo,3778
+ahjo/resources/files/config_development.jsonc,sha256=uTMCKKVGpuMDQmG3gH3lpNelv0B8I0RkUNJDlepSGMM,4132
+ahjo/resources/files/config_development.yaml,sha256=kfWuUnPYTChBQolbNsnznKNScYBGtQQV2mdhI5Ai61E,3900
 ahjo/resources/files/env.py,sha256=CFl0JBgh_PBvivbwqLEWCb3HUnP6bf9T0gyCTZHQgPI,4404
 ahjo/resources/files/script.py.mako,sha256=ie8RZD226b2-MjOQiCOZk54MCsYDom6dcF85Uai6SWM,518
 ahjo/resources/files/git_hooks/pre-commit,sha256=pcfK8S-BxeQNCOQhdqc_ck8d38mOM0-TeyUeg6w8XOQ,840
 ahjo/resources/sql/queries/extended_properties_columns.sql,sha256=_jHbaseDCt_8WwWETdY0a0pm4v-_eN8qyNp3QW_RTbA,1266
 ahjo/resources/sql/queries/extended_properties_functions.sql,sha256=c4UHQFVwRqzTgVwyVfx2aZrEBraYUK_Erny4O14XIw4,621
 ahjo/resources/sql/queries/extended_properties_procedures.sql,sha256=gC8dB3EOsZDKfJPmOr00oY8kCwkBhk_VU76hIQ0raVk,569
 ahjo/resources/sql/queries/extended_properties_schemas.sql,sha256=HH7MpYBBEGMcrTZvSLMzCp-GTGplL13T1arQWXWSg4s,490
 ahjo/resources/sql/queries/extended_properties_tables.sql,sha256=Dgk2iAfboQYTg926ySpljPy-qdMnugmNo0myaBT1fKk,661
 ahjo/resources/sql/queries/extended_properties_views.sql,sha256=ORrdbe-Fst491S_QY_kFKIMHYFIWuFHNGLUvyIbc-7g,579
 ahjo/resources/sql/templates/schema.functionName.sql,sha256=kR-NdbwQni2nFXLCGSNedUTB6L5_ZeaZjpIowWzMKZw,710
 ahjo/resources/sql/templates/schema.procedureName.sql,sha256=5ZrjjgSaM60By_0pyE_30VhkoK1KXmCnRsYYIYwO7kQ,576
 ahjo/resources/sql/templates/schema.tableName.sql,sha256=uOmCrYjhd9D1N4r3ShseYFFuad_MiFDjtsxousuRGvY,391
 ahjo/resources/sql/templates/schema.viewName.sql,sha256=lizu8YKcF_ifewaJbt1ZbCYl23F52L-roBVSVimvxcE,497
 ahjo/scripts/__init__.py,sha256=ReZrA9U3WOuOny-hvBbB12833gjxpDAWomXQEGuPNyw,123
-ahjo/scripts/config.py,sha256=kqKnhONLB7AVCSkF58ibM7MmZRZpkEWZqy1QnEXDBUg,1631
-ahjo/scripts/init_project.py,sha256=_hDdSliz6uuoywOxtiOlibRhvX4vvGOWgT2biZs_cZg,1227
-ahjo/scripts/install_git_hook.py,sha256=a5eN2xL9rQrVT8LUt5MZvdF0FGv6XNQOrFb9PWF5OA0,918
-ahjo/scripts/master.py,sha256=WGk-ShzXkwmK_uFbEOayjwpXwTPmF-NHCQ39Yyae5hY,4798
-ahjo/scripts/master_actions.py,sha256=TnIF6yZGx_kX_70wayifQFbGuPLMfZi36ZtpFzwRirU,12975
+ahjo/scripts/alembic_api.py,sha256=YUhsKn2I7SwSz9EWLtE6UmBvEW4JYGYh4N-MvqnTIXw,616
+ahjo/scripts/config.py,sha256=Pw3xNaVHIzXypaWV8cg3j0NsVRWxu6mlS-gz_8p3gAk,1321
+ahjo/scripts/init_project.py,sha256=ljRovSV_ZOP1V3IRe7aDIfrb3U1p9Zh3gs30mPNLrhw,1133
+ahjo/scripts/install_git_hook.py,sha256=03lsIV-45VS0vcizpmd0giApRAtYGHz00EfAnx8pxPg,815
+ahjo/scripts/master.py,sha256=NkA_DNCZHdC58fCAiid4cYU1_qGiBnX9hBNN6Nrv6IM,5088
+ahjo/scripts/master_actions.py,sha256=osMfD8m6m81_4L86SpvugdR7Nx5LSfI0FhF5y5UMbKU,13595
 ahjo/scripts/multi_project_build.py,sha256=rvjB-CRAC9J6Ilt7OdxxPicVvU4BRgbB86kUr4qHjd4,850
-ahjo/scripts/scan_project.py,sha256=eRWCW8PMySMHckBh5HYm4pFnxVzZeumaxL75ejTp6to,2297
-ahjo/scripts/upgrade_project.py,sha256=KyGa84oZNtkmUU67mZRvzParrG4aPMUFFcSw3IMLVDc,1837
+ahjo/scripts/scan_project.py,sha256=1mwXaut4NyA0eTKmJi1KvCw0u0q2a3gc1Exu8uYQ-eA,2194
+ahjo/scripts/upgrade_project.py,sha256=WjXj-MlfX6_MPuK2ohi-_D1r44dBrjTKvTLvu2o22WI,2520
 ahjo/util/__init__.py,sha256=KNMCZbEGlXpS3UOyQgz7wC4fcbH8Y7JC_hRkq-lJBV0,177
 ahjo/util/jsonc.py,sha256=23Dy895zT3U_0z4nRbfmYgb-uKh-N5JM-LXAdB0f0rY,8632
-ahjo-3.7.0.dist-info/LICENSE,sha256=WtjCEwlcVzkh1ziO35P2qfVEkLjr87Flro7xlHz3CEY,11556
-ahjo-3.7.0.dist-info/METADATA,sha256=ylHVbdFHotuewUsNRRBtTFXi-9uaR6BDBpp35u3YOrw,36372
-ahjo-3.7.0.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-ahjo-3.7.0.dist-info/entry_points.txt,sha256=Oy3hFkHJgLYgcEMQ6ffKXviVr0crYkJbJi7qnvixveg,356
-ahjo-3.7.0.dist-info/top_level.txt,sha256=MIavzjbhY3Z3YD26SAvbduMKzU9N0wJ_wqi3NWCmIxk,5
-ahjo-3.7.0.dist-info/RECORD,,
+ahjo-3.8.0.dist-info/LICENSE,sha256=WtjCEwlcVzkh1ziO35P2qfVEkLjr87Flro7xlHz3CEY,11556
+ahjo-3.8.0.dist-info/METADATA,sha256=DKELr6YZ7JFeifQf2haLbDTVOAKpwDvAOabS_zRrUnE,37085
+ahjo-3.8.0.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+ahjo-3.8.0.dist-info/entry_points.txt,sha256=9bLyzrR4REfSpPSQyCybnGOqrIOK4Vhld5jii8BoCJc,400
+ahjo-3.8.0.dist-info/top_level.txt,sha256=MIavzjbhY3Z3YD26SAvbduMKzU9N0wJ_wqi3NWCmIxk,5
+ahjo-3.8.0.dist-info/RECORD,,
```

