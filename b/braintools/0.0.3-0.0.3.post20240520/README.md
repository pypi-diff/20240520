# Comparing `tmp/braintools-0.0.3-py2.py3-none-any.whl.zip` & `tmp/braintools-0.0.3.post20240520-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,40 +1,41 @@
-Zip file size: 79983 bytes, number of entries: 38
--rw-rw-rw-  2.0 fat      912 b- defN 24-Apr-13 06:57 braintools/__init__.py
--rw-rw-rw-  2.0 fat     1025 b- defN 24-Apr-06 08:01 braintools/functional/__init__.py
--rw-rw-rw-  2.0 fat    18207 b- defN 24-Apr-11 11:10 braintools/functional/_activations.py
--rw-rw-rw-  2.0 fat     2149 b- defN 24-Apr-13 06:57 braintools/functional/_normalization.py
--rw-rw-rw-  2.0 fat     2581 b- defN 24-Apr-11 11:10 braintools/functional/_spikes.py
--rw-rw-rw-  2.0 fat     1102 b- defN 24-Apr-06 07:27 braintools/init/__init__.py
--rw-rw-rw-  2.0 fat     1153 b- defN 24-Apr-06 07:27 braintools/init/_base.py
--rw-rw-rw-  2.0 fat     6427 b- defN 24-Apr-06 07:27 braintools/init/_generic.py
--rw-rw-rw-  2.0 fat    15361 b- defN 24-Apr-06 07:27 braintools/init/_random_inits.py
--rw-rw-rw-  2.0 fat     3071 b- defN 24-Apr-06 07:27 braintools/init/_regular_inits.py
--rw-rw-rw-  2.0 fat      963 b- defN 24-Apr-06 07:27 braintools/input/__init__.py
--rw-rw-rw-  2.0 fat    11180 b- defN 24-Apr-11 11:10 braintools/input/currents.py
--rw-rw-rw-  2.0 fat     4168 b- defN 24-Apr-11 11:10 braintools/input/currents_test.py
--rw-rw-rw-  2.0 fat     1687 b- defN 24-Apr-06 07:27 braintools/metric/__init__.py
+Zip file size: 80877 bytes, number of entries: 39
+-rw-rw-rw-  2.0 fat      907 b- defN 24-Apr-22 08:02 braintools/__init__.py
+-rw-rw-rw-  2.0 fat     1020 b- defN 24-Apr-22 08:02 braintools/functional/__init__.py
+-rw-rw-rw-  2.0 fat    18504 b- defN 24-Apr-22 08:02 braintools/functional/_activations.py
+-rw-rw-rw-  2.0 fat     2144 b- defN 24-Apr-22 08:02 braintools/functional/_normalization.py
+-rw-rw-rw-  2.0 fat     2576 b- defN 24-Apr-22 08:02 braintools/functional/_spikes.py
+-rw-rw-rw-  2.0 fat     1097 b- defN 24-Apr-22 08:02 braintools/init/__init__.py
+-rw-rw-rw-  2.0 fat     1148 b- defN 24-Apr-22 08:02 braintools/init/_base.py
+-rw-rw-rw-  2.0 fat     6422 b- defN 24-Apr-22 08:02 braintools/init/_generic.py
+-rw-rw-rw-  2.0 fat    15356 b- defN 24-Apr-22 08:02 braintools/init/_random_inits.py
+-rw-rw-rw-  2.0 fat     3066 b- defN 24-Apr-22 08:02 braintools/init/_regular_inits.py
+-rw-rw-rw-  2.0 fat      958 b- defN 24-Apr-22 08:02 braintools/input/__init__.py
+-rw-rw-rw-  2.0 fat    11175 b- defN 24-Apr-22 08:02 braintools/input/currents.py
+-rw-rw-rw-  2.0 fat     4163 b- defN 24-Apr-22 08:02 braintools/input/currents_test.py
+-rw-rw-rw-  2.0 fat     1682 b- defN 24-Apr-22 08:02 braintools/metric/__init__.py
 -rw-rw-rw-  2.0 fat    22249 b- defN 24-Apr-11 11:10 braintools/metric/_classification.py
 -rw-rw-rw-  2.0 fat    22447 b- defN 24-Apr-11 11:10 braintools/metric/_classification_test.py
--rw-rw-rw-  2.0 fat     9962 b- defN 24-Apr-06 07:27 braintools/metric/_correlation.py
--rw-rw-rw-  2.0 fat     3940 b- defN 24-Apr-06 07:27 braintools/metric/_correlation_test.py
--rw-rw-rw-  2.0 fat     2158 b- defN 24-Apr-06 07:27 braintools/metric/_fenchel_young.py
--rw-rw-rw-  2.0 fat     2530 b- defN 24-Apr-11 11:10 braintools/metric/_fenchel_young_test.py
--rw-rw-rw-  2.0 fat     2456 b- defN 24-Apr-06 07:27 braintools/metric/_firings.py
--rw-rw-rw-  2.0 fat     1359 b- defN 24-Apr-06 07:27 braintools/metric/_firings_test.py
--rw-rw-rw-  2.0 fat     4967 b- defN 24-Apr-11 11:10 braintools/metric/_lfp.py
--rw-rw-rw-  2.0 fat     6193 b- defN 24-Apr-06 07:27 braintools/metric/_ranking.py
--rw-rw-rw-  2.0 fat     8907 b- defN 24-Apr-11 11:10 braintools/metric/_ranking_test.py
--rw-rw-rw-  2.0 fat    16755 b- defN 24-Apr-11 11:10 braintools/metric/_regression.py
--rw-rw-rw-  2.0 fat     4945 b- defN 24-Apr-11 11:10 braintools/metric/_regression_test.py
--rw-rw-rw-  2.0 fat     1583 b- defN 24-Apr-06 07:27 braintools/metric/_smoothing.py
--rw-rw-rw-  2.0 fat     2012 b- defN 24-Apr-11 11:10 braintools/metric/_smoothing_test.py
--rw-rw-rw-  2.0 fat     1036 b- defN 24-Apr-06 08:01 braintools/metric/_util.py
--rw-rw-rw-  2.0 fat      924 b- defN 24-Apr-06 07:27 braintools/optim/__init__.py
--rw-rw-rw-  2.0 fat    15582 b- defN 24-Apr-06 07:27 braintools/optim/_lr_scheduler.py
--rw-rw-rw-  2.0 fat    45895 b- defN 24-Apr-06 07:27 braintools/optim/_sgd_optimizer.py
--rw-rw-rw-  2.0 fat    11554 b- defN 24-Apr-13 06:58 braintools-0.0.3.dist-info/LICENSE
--rw-rw-rw-  2.0 fat     4019 b- defN 24-Apr-13 06:58 braintools-0.0.3.dist-info/METADATA
--rw-rw-rw-  2.0 fat      110 b- defN 24-Apr-13 06:58 braintools-0.0.3.dist-info/WHEEL
--rw-rw-rw-  2.0 fat       11 b- defN 24-Apr-13 06:58 braintools-0.0.3.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     3344 b- defN 24-Apr-13 06:58 braintools-0.0.3.dist-info/RECORD
-38 files, 264924 bytes uncompressed, 74615 bytes compressed:  71.8%
+-rw-rw-rw-  2.0 fat     9958 b- defN 24-Apr-22 08:02 braintools/metric/_correlation.py
+-rw-rw-rw-  2.0 fat     3935 b- defN 24-Apr-22 08:02 braintools/metric/_correlation_test.py
+-rw-rw-rw-  2.0 fat     2125 b- defN 24-Apr-22 08:02 braintools/metric/_fenchel_young.py
+-rw-rw-rw-  2.0 fat     2526 b- defN 24-Apr-22 08:02 braintools/metric/_fenchel_young_test.py
+-rw-rw-rw-  2.0 fat     2451 b- defN 24-Apr-22 08:02 braintools/metric/_firings.py
+-rw-rw-rw-  2.0 fat     1354 b- defN 24-Apr-22 08:02 braintools/metric/_firings_test.py
+-rw-rw-rw-  2.0 fat     4962 b- defN 24-Apr-22 08:02 braintools/metric/_lfp.py
+-rw-rw-rw-  2.0 fat     6189 b- defN 24-Apr-22 08:02 braintools/metric/_ranking.py
+-rw-rw-rw-  2.0 fat     8903 b- defN 24-Apr-22 08:02 braintools/metric/_ranking_test.py
+-rw-rw-rw-  2.0 fat    16751 b- defN 24-Apr-22 08:02 braintools/metric/_regression.py
+-rw-rw-rw-  2.0 fat     4941 b- defN 24-Apr-22 08:02 braintools/metric/_regression_test.py
+-rw-rw-rw-  2.0 fat     1578 b- defN 24-Apr-22 08:02 braintools/metric/_smoothing.py
+-rw-rw-rw-  2.0 fat     2007 b- defN 24-Apr-22 08:02 braintools/metric/_smoothing_test.py
+-rw-rw-rw-  2.0 fat     1031 b- defN 24-Apr-22 08:02 braintools/metric/_util.py
+-rw-rw-rw-  2.0 fat      919 b- defN 24-Apr-22 08:02 braintools/optim/__init__.py
+-rw-rw-rw-  2.0 fat    15608 b- defN 24-Apr-22 08:02 braintools/optim/_lr_scheduler.py
+-rw-rw-rw-  2.0 fat     1199 b- defN 24-Apr-22 07:59 braintools/optim/_lr_scheduler_test.py
+-rw-rw-rw-  2.0 fat    45890 b- defN 24-Apr-22 08:02 braintools/optim/_sgd_optimizer.py
+-rw-rw-rw-  2.0 fat    11554 b- defN 24-May-20 09:39 braintools-0.0.3.post20240520.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat     4032 b- defN 24-May-20 09:39 braintools-0.0.3.post20240520.dist-info/METADATA
+-rw-rw-rw-  2.0 fat      110 b- defN 24-May-20 09:39 braintools-0.0.3.post20240520.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat       11 b- defN 24-May-20 09:39 braintools-0.0.3.post20240520.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat     3504 b- defN 24-May-20 09:39 braintools-0.0.3.post20240520.dist-info/RECORD
+39 files, 266452 bytes uncompressed, 75227 bytes compressed:  71.8%
```

## zipnote {}

```diff
@@ -90,26 +90,29 @@
 
 Filename: braintools/optim/__init__.py
 Comment: 
 
 Filename: braintools/optim/_lr_scheduler.py
 Comment: 
 
+Filename: braintools/optim/_lr_scheduler_test.py
+Comment: 
+
 Filename: braintools/optim/_sgd_optimizer.py
 Comment: 
 
-Filename: braintools-0.0.3.dist-info/LICENSE
+Filename: braintools-0.0.3.post20240520.dist-info/LICENSE
 Comment: 
 
-Filename: braintools-0.0.3.dist-info/METADATA
+Filename: braintools-0.0.3.post20240520.dist-info/METADATA
 Comment: 
 
-Filename: braintools-0.0.3.dist-info/WHEEL
+Filename: braintools-0.0.3.post20240520.dist-info/WHEEL
 Comment: 
 
-Filename: braintools-0.0.3.dist-info/top_level.txt
+Filename: braintools-0.0.3.post20240520.dist-info/top_level.txt
 Comment: 
 
-Filename: braintools-0.0.3.dist-info/RECORD
+Filename: braintools-0.0.3.post20240520.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## braintools/__init__.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/functional/__init__.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/functional/_activations.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
@@ -23,14 +23,15 @@
 import jax
 import jax.numpy as jnp
 from jax.scipy.special import logsumexp
 from jax.typing import ArrayLike
 import braincore as bc
 
 __all__ = [
+  "tanh",
   "relu",
   "squareplus",
   "softplus",
   "soft_sign",
   "sigmoid",
   "silu",
   "swish",
@@ -56,14 +57,30 @@
   'mish',
   'soft_shrink',
   'prelu',
   'tanh_shrink',
   'softmin',
 ]
 
+def tanh(x: ArrayLike) -> jax.Array:
+  r"""Hyperbolic tangent activation function.
+
+  Computes the element-wise function:
+
+  .. math::
+    \mathrm{tanh}(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}}
+
+  Args:
+    x : input array
+
+  Returns:
+    An array.
+  """
+  return jnp.tanh(x)
+
 
 def softmin(x, axis=-1):
   r"""
   Applies the Softmin function to an n-dimensional input Tensor
   rescaling them so that the elements of the n-dimensional output Tensor
   lie in the range `[0, 1]` and sum to 1.
```

## braintools/functional/_normalization.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/functional/_spikes.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/init/__init__.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/init/_base.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/init/_generic.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/init/_random_inits.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/init/_regular_inits.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/input/__init__.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/input/currents.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/input/currents_test.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/__init__.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/_correlation.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024 BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/_correlation_test.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/_fenchel_young.py

```diff
@@ -1,23 +1,22 @@
-# Copyright 2024 BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 # ==============================================================================
 
-"""Fenchel-Young losses."""
 
 from typing import Any, Protocol
 
 import jax.numpy as jnp
 
 __all__ = [
     "make_fenchel_young_loss",
@@ -29,36 +28,36 @@
   def __call__(self, scores, *args, **kwargs: Any):
     ...
 
 
 def make_fenchel_young_loss(
     max_fun: MaxFun
 ):
-  """Creates a Fenchel-Young loss from a max function.
+  """Creates a 2024 BDP Ecosystem from a max function.
 
   WARNING: The resulting loss accepts an arbitrary number of leading dimensions
   with the fy_loss operating over the last dimension. The jaxopt version of this
   function would instead flatten any vector in a single big 1D vector.
 
   Examples:
     Given a max function, e.g., the log sum exp, you can construct a
-    Fenchel-Young loss easily as follows:
+    2024 BDP Ecosystem easily as follows:
 
     >>> from jax.scipy.special import logsumexp
     >>> fy_loss = make_fy_loss(max_fun=logsumexp)
 
   Reference:
     Blondel et al. `Learning with Fenchel-Young Losses
     <https://arxiv.org/pdf/1901.02324.pdf>`_, 2020
 
   Args:
-    max_fun: the max function on which the Fenchel-Young loss is built.
+    max_fun: the max function on which the 2024 BDP Ecosystem is built.
 
   Returns:
-    A Fenchel-Young loss function with the same signature.
+    A 2024 BDP Ecosystem function with the same signature.
   """
 
   vdot_last_dim = jnp.vectorize(jnp.vdot, signature="(n),(n)->()")
   max_fun_last_dim = jnp.vectorize(max_fun, signature="(n)->()")
 
   def fenchel_young_loss(scores, targets, *args, **kwargs):
     max_value = max_fun_last_dim(scores, *args, **kwargs)
```

## braintools/metric/_fenchel_young_test.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024 BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/_firings.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/_firings_test.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/_lfp.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/_ranking.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024 BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/_ranking_test.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024 BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/_regression.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024 BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/_regression_test.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024 BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/_smoothing.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/_smoothing_test.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/metric/_util.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/optim/__init__.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## braintools/optim/_lr_scheduler.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
@@ -13,14 +13,15 @@
 # limitations under the License.
 # ==============================================================================
 
 # -*- coding: utf-8 -*-
 
 from typing import Sequence, Union
 
+import numpy as np
 import braincore as bc
 import jax
 import jax.numpy as jnp
 
 __all__ = [
   'LearningRateScheduler',
   'ConstantLR',
@@ -218,21 +219,21 @@
     super().__init__(lr=lr, last_epoch=last_epoch)
 
     assert len(milestones) > 0, 'milestones should be a non-empty sequence.'
     assert all([milestones[i] < milestones[i + 1] for i in range(len(milestones) - 1)]), (
       'milestones should be a sequence of increasing integers.'
     )
     assert 1. >= gamma >= 0, 'gamma should be in the range [0, 1].'
-    self.milestones = jnp.asarray((-1,) + tuple(milestones), dtype=bc.environ.ditype())
+    self.milestones = jnp.asarray((-1,) + tuple(milestones) + (np.iinfo(np.int32).max,), dtype=bc.environ.ditype())
     self.gamma = gamma
 
   def __call__(self, i=None):
     i = (self.last_epoch.value + 1) if i is None else i
-    conditions = (i > self.milestones[:-1]) & i < self.milestones[1:]
-    p = jnp.where(conditions, jnp.arange(0, len(self.milestones)))
+    conditions = jnp.logical_and((i >= self.milestones[:-1]), (i < self.milestones[1:]))
+    p = jnp.argmax(conditions)
     return self.lr * self.gamma ** p
 
   def extra_repr(self):
     return f', milestones={self.milestones}, gamma={self.gamma}'
 
 
 class CosineAnnealingLR(LearningRateScheduler):
```

## braintools/optim/_sgd_optimizer.py

```diff
@@ -1,8 +1,8 @@
-# Copyright 2024- BrainPy Ecosystem Limited. All Rights Reserved.
+# Copyright 2024 BDP Ecosystem Limited. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
```

## Comparing `braintools-0.0.3.dist-info/LICENSE` & `braintools-0.0.3.post20240520.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `braintools-0.0.3.dist-info/METADATA` & `braintools-0.0.3.post20240520.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: braintools
-Version: 0.0.3
+Version: 0.0.3.post20240520
 Summary: The Toolbox for Brain Dynamics Programming.
 Home-page: https://github.com/brainpy/braintools
 Author: BrainPy Team
 Author-email: BrainPy Team <chao.brain@qq.com>
 License: Apache-2.0 license
 Project-URL: homepage, http://github.com/brainpy/braintools
 Project-URL: repository, http://github.com/brainpy/braintools
```

### html2text {}

```diff
@@ -1,10 +1,10 @@
-Metadata-Version: 2.1 Name: braintools Version: 0.0.3 Summary: The Toolbox for
-Brain Dynamics Programming. Home-page: https://github.com/brainpy/braintools
-Author: BrainPy Team Author-email: BrainPy Team
+Metadata-Version: 2.1 Name: braintools Version: 0.0.3.post20240520 Summary: The
+Toolbox for Brain Dynamics Programming. Home-page: https://github.com/brainpy/
+braintools Author: BrainPy Team Author-email: BrainPy Team
 qq.com> License: Apache-2.0 license Project-URL: homepage, http://github.com/
 brainpy/braintools Project-URL: repository, http://github.com/brainpy/
 braintools Keywords: BrainPy,brain simulation,brain-inspired computing
 Classifier: Natural Language :: English Classifier: Operating System :: OS
 Independent Classifier: Development Status :: 4 - Beta Classifier: Intended
 Audience :: Developers Classifier: Intended Audience :: Science/Research
 Classifier: Programming Language :: Python :: 3 Classifier: Programming
```

## Comparing `braintools-0.0.3.dist-info/RECORD` & `braintools-0.0.3.post20240520.dist-info/RECORD`

 * *Files 14% similar despite different names*

```diff
@@ -1,38 +1,39 @@
-braintools/__init__.py,sha256=AQUeRHpFnPSS_nSNRu8Y8_sFgleR4-HgKW4B2g9ffnU,912
-braintools/functional/__init__.py,sha256=Y5DiZqdZJzJCAu821TNaiAyBoZ8RI6jGew0bVQfGX7I,1025
-braintools/functional/_activations.py,sha256=VF_JGa7frjamuf0B2GV_N-QGGsQFKxw0RCHjzboTdSE,18207
-braintools/functional/_normalization.py,sha256=rLO69zQ90JrnL3Vm-24sFRc7u5j31vntxB5Cuwsdg4Y,2149
-braintools/functional/_spikes.py,sha256=rNlABZIIZXvc6_tT8koPDZrECr_O6rGM8YKSytgU8E0,2581
-braintools/init/__init__.py,sha256=p0QKaKZQ29IsrY8R3-4t_teGlCgQKEJYYdBizpiKkkc,1102
-braintools/init/_base.py,sha256=OcetgiXdDHvzoaTzaKh_XAKEscX7e9iHZkP4oZBg2Do,1153
-braintools/init/_generic.py,sha256=j9VMOle_D44lT0IfUf6wqrJRi0ztq3JEcmqqViljE7w,6427
-braintools/init/_random_inits.py,sha256=6jCIdtZ-SkSbLaGPe722NhrZPDoSk7OHYeK-TauLpIQ,15361
-braintools/init/_regular_inits.py,sha256=bA5frDYeeDXtqnaUws1-JsCkt-PVKCn9HOT3SmQdl1E,3071
-braintools/input/__init__.py,sha256=Z3jEuruG5iLKSsqznq9GW-gaJq6tg9nKhSTx6c7Pep0,963
-braintools/input/currents.py,sha256=aTyM-c0GcaxLC_lEk0A6mV3MfaXtj4I5ecXDmOABqts,11180
-braintools/input/currents_test.py,sha256=MGHP9NUFNEaHElvbgfHfyJRcpPeFljm9aDH-gkCzjZI,4168
-braintools/metric/__init__.py,sha256=DBOMSrULRcmr15WFmM9f8TPBsx_ZCgDM1nfD9n3wPms,1687
+braintools/__init__.py,sha256=ZOQcAlFvr5MSZQaK87mNlOE1_PQKrQP4XSI8HWPV5oY,907
+braintools/functional/__init__.py,sha256=6aMwiOl2UGEd6b5SBpGaB0s2QG1iF8rRFoOfvScJ4Dg,1020
+braintools/functional/_activations.py,sha256=whrx4sFWKqEfTPrLP-RttOQUGgPdtb8yqs8PYUdolMk,18504
+braintools/functional/_normalization.py,sha256=yqn1lt6oG7j7EaISwiXQSPBnVq75YC5tCKbWBmYJ3pg,2144
+braintools/functional/_spikes.py,sha256=uAln_Q87pr1codLxeDck3PUA9jpk7S5LifNps1kdyrU,2576
+braintools/init/__init__.py,sha256=R1dHgub47o-WJM9QkFLc7x_Q7GsyaKKDtrRHTFPpC5g,1097
+braintools/init/_base.py,sha256=jRTmfoUsH_315vW9YMZzyIn2KDAAsv56SplBnvOyBW0,1148
+braintools/init/_generic.py,sha256=D_MmVnpnrNktRrOqjLCMPidMpU2WmE7fdr-pGJNkwqw,6422
+braintools/init/_random_inits.py,sha256=7Sh8cPtbiI9L_SzSxGU9NiATvVXCCLbDUEOnMMhcjNM,15356
+braintools/init/_regular_inits.py,sha256=yHXJqNTaMuQkONLBkZA6bnYxzc90fOLKgFF9wo1xKig,3066
+braintools/input/__init__.py,sha256=MVuepKt9g4DxhneyxuQe5LFltpGL0RuRGGLWub2NpAE,958
+braintools/input/currents.py,sha256=O15GJQtpJBnf3_jJbXa7tqM3K0yPD4CJwqCG0hl71Zk,11175
+braintools/input/currents_test.py,sha256=kD5tVwieOwwI-Ckyv7C34MgAC_B7SHb8ia4w52z6zbU,4163
+braintools/metric/__init__.py,sha256=p5EqWRuirShA0qrcdfvr5RIOk8k4B7hcyoB37RHpGcI,1682
 braintools/metric/_classification.py,sha256=D2NXd3lbaYdqDLC_RNzx4qONvkXr5XD5OZV4vQlGbNQ,22249
 braintools/metric/_classification_test.py,sha256=t5TBh4p0H5JyvhL2EqWoi4wVVUDeEYntt97vcZCE_-s,22447
-braintools/metric/_correlation.py,sha256=A6fwgqaw2CFpcbxYlR1qxrrZR1ECIRGyVCbrc8Si414,9962
-braintools/metric/_correlation_test.py,sha256=17J93_XyeZxuTDNvCM_nJdY6vNxYbTmWjVjJ_0bFS1I,3940
-braintools/metric/_fenchel_young.py,sha256=0vbmQ-WbKivt1i8EnFTkVKT4sVMVlEBQ-JoWRrPNR7U,2158
-braintools/metric/_fenchel_young_test.py,sha256=Z0cSmbb-Z2EzUnMtlaLeAyILw3HEeK1SMPx5YsefcDw,2530
-braintools/metric/_firings.py,sha256=6Wv4pSWI68XvvINCfqrh67Xr5tudyBos3husV5oQZsI,2456
-braintools/metric/_firings_test.py,sha256=0NKZGr5v5mYIrXTiDzsSOxduhGN2HUtlLo4R3aZqJ2E,1359
-braintools/metric/_lfp.py,sha256=2kJmc17SNfJSqMC97SjQqax3QIDJpDbun4e7WAIFKcs,4967
-braintools/metric/_ranking.py,sha256=2v3iVxxyR0f82abGPIi5-93vl--fDsKB4y0RlFzZsLM,6193
-braintools/metric/_ranking_test.py,sha256=z2q7Y1nXSYIWc2ZaqD-Ouu6NhEwsccExX43YvYo-6vQ,8907
-braintools/metric/_regression.py,sha256=80e89NXciy_b4cOYvdFf6IV9MGfTl8q9yIJtBuJRlL0,16755
-braintools/metric/_regression_test.py,sha256=CrVCvpQF4LB_ikiyzpjHC_CRBrQGFF_iIExnbcqCXSM,4945
-braintools/metric/_smoothing.py,sha256=GJ5HaOw-Ec6sledF_T289Ow7A6mQgNXMnSRw3188VME,1583
-braintools/metric/_smoothing_test.py,sha256=isVXdZs6nT8bnZzBabIdF2xh11LLq2rxbp0K8UZHAcc,2012
-braintools/metric/_util.py,sha256=l1oOKSWEIaWQSgoHpRF6hzpJhZ3Yf5Pq278M8uY7D2U,1036
-braintools/optim/__init__.py,sha256=ceb586IP74ya8vsWyQMCvf_xUX5Nbf3ECN2SIfXEADQ,924
-braintools/optim/_lr_scheduler.py,sha256=1ZB-5vkMBSXeIYPEInOi5RNDzt3FuGcKAZNklZ-vlGY,15582
-braintools/optim/_sgd_optimizer.py,sha256=ylz8QsP3nbG5TkgQgA2GYGiTppBrN1vfS7oTkoupkeg,45895
-braintools-0.0.3.dist-info/LICENSE,sha256=6fh5QkGp7UhVlXVDg46cZBy4gXG2927_iGk1KL0nGy4,11554
-braintools-0.0.3.dist-info/METADATA,sha256=cnJehafyubL-8XOFiCEuDf3bMe6xAbzuqOG_aOztxkM,4019
-braintools-0.0.3.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
-braintools-0.0.3.dist-info/top_level.txt,sha256=kpCUCOcIqo3D72vd6PIcAG-VeUzsgDFUneOQwywwmyc,11
-braintools-0.0.3.dist-info/RECORD,,
+braintools/metric/_correlation.py,sha256=9P4hbQlZ6Y2nkm-pk37LJX7wp6WCFz8CfVxbPeD44cU,9958
+braintools/metric/_correlation_test.py,sha256=GcqUczULwYHp9dabje2bK7WEoNkYcW3oiH5FGIa-Dz4,3935
+braintools/metric/_fenchel_young.py,sha256=pt-JBCBpi4VGv8vHeXWfwQd_yuW_2QaJIJKhwPZhJFo,2125
+braintools/metric/_fenchel_young_test.py,sha256=Ylv6vlbld4CmECK_WE1dM9NX_nfEGY530kcXr--iHtk,2526
+braintools/metric/_firings.py,sha256=W-SbQWxyQnhbZ7rKS_B0yVCnJml9X6xNfRmv7lt7i9o,2451
+braintools/metric/_firings_test.py,sha256=WuY3JfO6nAaPvdhBMXyfFiQEsu1FnVjFoTFYRLPNcdI,1354
+braintools/metric/_lfp.py,sha256=B8guz0RIorVl9CeP_9vUZvdcVN27vG3uUCsRQPvqYG0,4962
+braintools/metric/_ranking.py,sha256=zxMhgBqUdpLVbd0w88v06zgd2z1TLecS0JHpA0TWacs,6189
+braintools/metric/_ranking_test.py,sha256=haLZed_dzYamSDeKV9_WBPm1cYqpTIExdn6yivdVS1M,8903
+braintools/metric/_regression.py,sha256=noXQ_CuexoQjNDvQ1D-OH1_fhhTqzlj17oRDgWX0o0M,16751
+braintools/metric/_regression_test.py,sha256=uA-htZ7_dpCNEhW-x2IjP-GWmlNinHCry8MJXb4SLDo,4941
+braintools/metric/_smoothing.py,sha256=JqUPwWQpvhCIRXzp1sIMti5JxkvxAnLtbgcUDFS3rAA,1578
+braintools/metric/_smoothing_test.py,sha256=K4OSaY1qrUlofrfJI6lKDerymbmZaIKOwQ6AOzEHfKA,2007
+braintools/metric/_util.py,sha256=Q9DA4tjW39D2ff2IBWbooffVbpLX05gK3QoayevRwiw,1031
+braintools/optim/__init__.py,sha256=1xH5_peSWKuZ4tOU295r9EKAv0a-cBMABx6XV3faDJI,919
+braintools/optim/_lr_scheduler.py,sha256=5c_n9KRc2wB3l22QvPsuX-gPqJj_pSIOLzaIUTCR9x8,15608
+braintools/optim/_lr_scheduler_test.py,sha256=lVYIcNOzQaHrbl7FpZhQErGbC5Fmkb2vguECwDFWeLM,1199
+braintools/optim/_sgd_optimizer.py,sha256=bt5yD1-WQKxFImxPlIRYl4iwSxoiVhi8gi8dh5p9iTw,45890
+braintools-0.0.3.post20240520.dist-info/LICENSE,sha256=6fh5QkGp7UhVlXVDg46cZBy4gXG2927_iGk1KL0nGy4,11554
+braintools-0.0.3.post20240520.dist-info/METADATA,sha256=SLT3Rlm97v-dTXW-EUR0oaLHmAsrysdAUzZw5z2DDOs,4032
+braintools-0.0.3.post20240520.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
+braintools-0.0.3.post20240520.dist-info/top_level.txt,sha256=kpCUCOcIqo3D72vd6PIcAG-VeUzsgDFUneOQwywwmyc,11
+braintools-0.0.3.post20240520.dist-info/RECORD,,
```

