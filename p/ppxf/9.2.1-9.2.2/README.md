# Comparing `tmp/ppxf-9.2.1.tar.gz` & `tmp/ppxf-9.2.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "ppxf-9.2.1.tar", last modified: Thu Apr 18 17:17:44 2024, max compression
+gzip compressed data, was "ppxf-9.2.2.tar", last modified: Mon May 20 09:49:38 2024, max compression
```

## Comparing `ppxf-9.2.1.tar` & `ppxf-9.2.2.tar`

### file list

```diff
@@ -1,44 +1,44 @@
-drwxrwxrwx   0        0        0        0 2024-04-18 17:17:44.734028 ppxf-9.2.1/
--rw-rw-rw-   0        0        0   110290 2024-04-18 17:17:44.728937 ppxf-9.2.1/PKG-INFO
-drwxrwxrwx   0        0        0        0 2024-04-18 17:17:44.581169 ppxf-9.2.1/ppxf/
--rw-rw-rw-   0        0        0    36238 2024-04-18 17:14:44.000000 ppxf-9.2.1/ppxf/CHANGELOG.rst
--rw-rw-rw-   0        0        0      388 2024-01-05 17:54:47.000000 ppxf-9.2.1/ppxf/LICENSE.txt
--rw-rw-rw-   0        0        0     3058 2023-11-10 19:40:33.000000 ppxf-9.2.1/ppxf/README.rst
--rw-rw-rw-   0        0        0       22 2024-04-18 17:15:41.000000 ppxf-9.2.1/ppxf/__init__.py
--rw-rw-rw-   0        0        0    39781 2024-01-31 18:05:35.000000 ppxf-9.2.1/ppxf/capfit.py
-drwxrwxrwx   0        0        0        0 2024-04-18 17:17:44.688977 ppxf-9.2.1/ppxf/examples/
--rw-rw-rw-   0        0        0    34077 2022-06-10 10:29:46.000000 ppxf-9.2.1/ppxf/examples/FILTER.RES.info.txt
--rw-rw-rw-   0        0        0  2964767 2022-06-10 10:29:28.000000 ppxf-9.2.1/ppxf/examples/FILTER.RES.txt
--rw-rw-rw-   0        0        0       35 2020-11-26 15:46:13.000000 ppxf-9.2.1/ppxf/examples/__init__.py
--rw-rw-rw-   0        0        0    12485 2024-01-04 17:27:50.000000 ppxf-9.2.1/ppxf/examples/ppxf_example_gas_sdss_tied.py
--rw-rw-rw-   0        0        0    11175 2024-01-04 17:30:59.000000 ppxf-9.2.1/ppxf/examples/ppxf_example_kinematics_sauron.py
--rw-rw-rw-   0        0        0    10742 2024-01-04 17:32:46.000000 ppxf-9.2.1/ppxf/examples/ppxf_example_kinematics_sdss.py
--rw-rw-rw-   0        0        0     8742 2024-03-16 11:15:46.000000 ppxf-9.2.1/ppxf/examples/ppxf_example_montecarlo_simulation.py
--rw-rw-rw-   0        0        0    14106 2024-04-18 16:10:48.000000 ppxf-9.2.1/ppxf/examples/ppxf_example_population_gas_sdss.py
--rw-rw-rw-   0        0        0    10881 2024-02-08 17:59:57.000000 ppxf-9.2.1/ppxf/examples/ppxf_example_population_photometry.py
--rw-rw-rw-   0        0        0     6523 2024-01-04 17:53:58.000000 ppxf-9.2.1/ppxf/examples/ppxf_example_sky_and_symmetric_losvd.py
--rw-rw-rw-   0        0        0     7237 2024-01-04 17:56:15.000000 ppxf-9.2.1/ppxf/examples/ppxf_example_two_components.py
--rw-rw-rw-   0        0        0    12827 2024-04-18 17:16:08.000000 ppxf-9.2.1/ppxf/examples/ppxf_python_reference_output.txt
--rw-rw-rw-   0        0        0   135424 2024-04-18 17:07:55.000000 ppxf-9.2.1/ppxf/ppxf.py
--rw-rw-rw-   0        0        0    48415 2024-04-12 10:29:33.000000 ppxf-9.2.1/ppxf/ppxf_util.py
-drwxrwxrwx   0        0        0        0 2024-04-18 17:17:44.698767 ppxf-9.2.1/ppxf/spectra/
--rw-rw-rw-   0        0        0   172800 2011-10-17 22:16:00.000000 ppxf-9.2.1/ppxf/spectra/NGC3073_SDSS_DR8.fits
--rw-rw-rw-   0        0        0   172800 2011-10-17 14:22:36.000000 ppxf-9.2.1/ppxf/spectra/NGC3522_SDSS_DR8.fits
--rw-rw-rw-   0        0        0     5760 2004-12-28 23:44:02.000000 ppxf-9.2.1/ppxf/spectra/NGC4550_SAURON.fits
--rw-rw-rw-   0        0        0   604800 2015-10-12 18:45:25.000000 ppxf-9.2.1/ppxf/spectra/NGC4636_SDSS_DR12.fits
--rw-rw-rw-   0        0        0   155520 2021-03-19 16:06:44.000000 ppxf-9.2.1/ppxf/spectra/legac_M19_56670_v3.0.fits
-drwxrwxrwx   0        0        0        0 2024-04-18 17:17:44.728937 ppxf-9.2.1/ppxf/sps_models/
--rw-rw-rw-   0        0        0   462791 2023-09-23 18:39:50.000000 ppxf-9.2.1/ppxf/sps_models/Vazdekis2012_ssp_mass_Padova00_UN_baseFe_v10.0.txt
--rw-rw-rw-   0        0        0  1063839 2018-04-13 12:44:27.000000 ppxf-9.2.1/ppxf/sps_models/Vazdekis2012_ssp_phot_Padova00_UN_v10.0.txt
--rw-rw-rw-   0        0        0    47415 2018-04-13 12:44:36.000000 ppxf-9.2.1/ppxf/sps_models/Vazdekis2012_ssp_sdss_miuscat_UN1.30_v9.txt
--rw-rw-rw-   0        0        0    19722 2023-10-10 17:43:44.000000 ppxf-9.2.1/ppxf/sps_models/spectra_sun_vega.npz
--rw-rw-rw-   0        0        0    14734 2024-01-22 11:26:26.000000 ppxf-9.2.1/ppxf/sps_util.py
-drwxrwxrwx   0        0        0        0 2024-04-18 17:17:44.728937 ppxf-9.2.1/ppxf.egg-info/
--rw-rw-rw-   0        0        0   110290 2024-04-18 17:17:44.000000 ppxf-9.2.1/ppxf.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0     1231 2024-04-18 17:17:44.000000 ppxf-9.2.1/ppxf.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2024-04-18 17:17:44.000000 ppxf-9.2.1/ppxf.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       31 2024-04-18 17:17:44.000000 ppxf-9.2.1/ppxf.egg-info/requires.txt
--rw-rw-rw-   0        0        0        5 2024-04-18 17:17:44.000000 ppxf-9.2.1/ppxf.egg-info/top_level.txt
--rw-rw-rw-   0        0        0        2 2024-04-18 17:17:44.000000 ppxf-9.2.1/ppxf.egg-info/zip-safe
--rw-rw-rw-   0        0        0       42 2024-04-18 17:17:44.734028 ppxf-9.2.1/setup.cfg
--rw-rw-rw-   0        0        0     1697 2023-11-12 09:26:58.000000 ppxf-9.2.1/setup.py
+drwxrwxrwx   0        0        0        0 2024-05-20 09:49:38.796468 ppxf-9.2.2/
+-rw-rw-rw-   0        0        0   111221 2024-05-20 09:49:38.796468 ppxf-9.2.2/PKG-INFO
+drwxrwxrwx   0        0        0        0 2024-05-20 09:49:38.636538 ppxf-9.2.2/ppxf/
+-rw-rw-rw-   0        0        0    37125 2024-05-20 08:29:57.000000 ppxf-9.2.2/ppxf/CHANGELOG.rst
+-rw-rw-rw-   0        0        0      388 2024-01-05 17:54:47.000000 ppxf-9.2.2/ppxf/LICENSE.txt
+-rw-rw-rw-   0        0        0     3058 2023-11-10 19:40:33.000000 ppxf-9.2.2/ppxf/README.rst
+-rw-rw-rw-   0        0        0       22 2024-05-20 09:48:44.000000 ppxf-9.2.2/ppxf/__init__.py
+-rw-rw-rw-   0        0        0    39781 2024-01-31 18:05:35.000000 ppxf-9.2.2/ppxf/capfit.py
+drwxrwxrwx   0        0        0        0 2024-05-20 09:49:38.740870 ppxf-9.2.2/ppxf/examples/
+-rw-rw-rw-   0        0        0    34077 2022-06-10 10:29:46.000000 ppxf-9.2.2/ppxf/examples/FILTER.RES.info.txt
+-rw-rw-rw-   0        0        0  2964767 2022-06-10 10:29:28.000000 ppxf-9.2.2/ppxf/examples/FILTER.RES.txt
+-rw-rw-rw-   0        0        0       35 2020-11-26 15:46:13.000000 ppxf-9.2.2/ppxf/examples/__init__.py
+-rw-rw-rw-   0        0        0    12485 2024-05-16 09:47:55.000000 ppxf-9.2.2/ppxf/examples/ppxf_example_gas_sdss_tied.py
+-rw-rw-rw-   0        0        0    11188 2024-05-17 16:14:09.000000 ppxf-9.2.2/ppxf/examples/ppxf_example_kinematics_sauron.py
+-rw-rw-rw-   0        0        0    10633 2024-05-19 08:21:47.000000 ppxf-9.2.2/ppxf/examples/ppxf_example_kinematics_sdss.py
+-rw-rw-rw-   0        0        0     8742 2024-03-16 11:15:46.000000 ppxf-9.2.2/ppxf/examples/ppxf_example_montecarlo_simulation.py
+-rw-rw-rw-   0        0        0    14116 2024-05-20 09:22:15.000000 ppxf-9.2.2/ppxf/examples/ppxf_example_population_gas_sdss.py
+-rw-rw-rw-   0        0        0    10881 2024-02-08 17:59:57.000000 ppxf-9.2.2/ppxf/examples/ppxf_example_population_photometry.py
+-rw-rw-rw-   0        0        0     6523 2024-01-04 17:53:58.000000 ppxf-9.2.2/ppxf/examples/ppxf_example_sky_and_symmetric_losvd.py
+-rw-rw-rw-   0        0        0     7237 2024-01-04 17:56:15.000000 ppxf-9.2.2/ppxf/examples/ppxf_example_two_components.py
+-rw-rw-rw-   0        0        0    12824 2024-05-20 09:48:09.000000 ppxf-9.2.2/ppxf/examples/ppxf_python_reference_output.txt
+-rw-rw-rw-   0        0        0   135694 2024-05-20 09:34:00.000000 ppxf-9.2.2/ppxf/ppxf.py
+-rw-rw-rw-   0        0        0    49068 2024-05-17 10:16:50.000000 ppxf-9.2.2/ppxf/ppxf_util.py
+drwxrwxrwx   0        0        0        0 2024-05-20 09:49:38.756605 ppxf-9.2.2/ppxf/spectra/
+-rw-rw-rw-   0        0        0   172800 2011-10-17 22:16:00.000000 ppxf-9.2.2/ppxf/spectra/NGC3073_SDSS_DR8.fits
+-rw-rw-rw-   0        0        0   172800 2011-10-17 14:22:36.000000 ppxf-9.2.2/ppxf/spectra/NGC3522_SDSS_DR8.fits
+-rw-rw-rw-   0        0        0     5760 2004-12-28 23:44:02.000000 ppxf-9.2.2/ppxf/spectra/NGC4550_SAURON.fits
+-rw-rw-rw-   0        0        0   604800 2015-10-12 18:45:25.000000 ppxf-9.2.2/ppxf/spectra/NGC4636_SDSS_DR12.fits
+-rw-rw-rw-   0        0        0   155520 2021-03-19 16:06:44.000000 ppxf-9.2.2/ppxf/spectra/legac_M19_56670_v3.0.fits
+drwxrwxrwx   0        0        0        0 2024-05-20 09:49:38.791957 ppxf-9.2.2/ppxf/sps_models/
+-rw-rw-rw-   0        0        0   462791 2023-09-23 18:39:50.000000 ppxf-9.2.2/ppxf/sps_models/Vazdekis2012_ssp_mass_Padova00_UN_baseFe_v10.0.txt
+-rw-rw-rw-   0        0        0  1063839 2018-04-13 12:44:27.000000 ppxf-9.2.2/ppxf/sps_models/Vazdekis2012_ssp_phot_Padova00_UN_v10.0.txt
+-rw-rw-rw-   0        0        0    47415 2018-04-13 12:44:36.000000 ppxf-9.2.2/ppxf/sps_models/Vazdekis2012_ssp_sdss_miuscat_UN1.30_v9.txt
+-rw-rw-rw-   0        0        0    19722 2023-10-10 17:43:44.000000 ppxf-9.2.2/ppxf/sps_models/spectra_sun_vega.npz
+-rw-rw-rw-   0        0        0    14703 2024-05-01 09:53:45.000000 ppxf-9.2.2/ppxf/sps_util.py
+drwxrwxrwx   0        0        0        0 2024-05-20 09:49:38.791957 ppxf-9.2.2/ppxf.egg-info/
+-rw-rw-rw-   0        0        0   111221 2024-05-20 09:49:38.000000 ppxf-9.2.2/ppxf.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0     1231 2024-05-20 09:49:38.000000 ppxf-9.2.2/ppxf.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2024-05-20 09:49:38.000000 ppxf-9.2.2/ppxf.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       31 2024-05-20 09:49:38.000000 ppxf-9.2.2/ppxf.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        5 2024-05-20 09:49:38.000000 ppxf-9.2.2/ppxf.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0        2 2024-05-20 09:49:38.000000 ppxf-9.2.2/ppxf.egg-info/zip-safe
+-rw-rw-rw-   0        0        0       42 2024-05-20 09:49:38.796468 ppxf-9.2.2/setup.cfg
+-rw-rw-rw-   0        0        0     1697 2023-11-12 09:26:58.000000 ppxf-9.2.2/setup.py
```

### Comparing `ppxf-9.2.1/PKG-INFO` & `ppxf-9.2.2/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 00000000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00000010: 3a20 322e 310d 0a4e 616d 653a 2070 7078  : 2.1..Name: ppx
 00000020: 660d 0a56 6572 7369 6f6e 3a20 392e 322e  f..Version: 9.2.
-00000030: 310d 0a53 756d 6d61 7279 3a20 7050 5846  1..Summary: pPXF
+00000030: 320d 0a53 756d 6d61 7279 3a20 7050 5846  2..Summary: pPXF
 00000040: 3a20 4675 6c6c 2053 7065 6374 7275 6d20  : Full Spectrum 
 00000050: 616e 6420 5345 4420 4669 7474 696e 6720  and SED Fitting 
 00000060: 6f66 2047 616c 6163 7469 6320 616e 6420  of Galactic and 
 00000070: 5374 656c 6c61 7220 5370 6563 7472 610d  Stellar Spectra.
 00000080: 0a48 6f6d 652d 7061 6765 3a20 6874 7470  .Home-page: http
 00000090: 733a 2f2f 7075 726c 2e6f 7267 2f63 6170  s://purl.org/cap
 000000a0: 7065 6c6c 6172 692f 736f 6674 7761 7265  pellari/software
@@ -2906,3989 +2906,4047 @@
 0000b590: 0d0a 2020 2020 2a20 6060 7265 675f 6f72  ..    * ``reg_or
 0000b5a0: 643d 3260 603a 206d 696e 696d 697a 6573  d=2``: minimizes
 0000b5b0: 2074 6865 2069 6e74 6567 7261 6c20 6f76   the integral ov
 0000b5c0: 6572 2074 6865 2077 6569 6768 7473 206f  er the weights o
 0000b5d0: 6620 7468 6520 7371 7561 7265 640d 0a20  f the squared.. 
 0000b5e0: 2020 2020 2063 7572 7661 7475 7265 3a3a       curvature::
 0000b5f0: 0d0a 0d0a 2020 2020 2020 2020 4c61 706c  ....        Lapl
-0000b600: 6163 6961 6e5b 775d 2a2a 322e 0d0a 7265  acian[w]**2...re
-0000b610: 675f 7374 6570 3a20 6c69 7374 206f 6620  g_step: list of 
-0000b620: 6172 7261 7973 2c20 7368 6170 6520 286c  arrays, shape (l
-0000b630: 656e 2872 6567 5f64 696d 292c 290d 0a20  en(reg_dim),).. 
-0000b640: 2020 2044 6566 696e 6573 2074 6865 2073     Defines the s
-0000b650: 7465 7020 7369 7a65 7320 666f 7220 6e75  tep sizes for nu
-0000b660: 6d65 7269 6361 6c20 6573 7469 6d61 7469  merical estimati
-0000b670: 6f6e 206f 6620 6465 7269 7661 7469 7665  on of derivative
-0000b680: 7320 6475 7269 6e67 0d0a 2020 2020 7265  s during..    re
-0000b690: 6775 6c61 7269 7a61 7469 6f6e 2e20 4561  gularization. Ea
-0000b6a0: 6368 2061 7272 6179 2069 6e20 7468 6520  ch array in the 
-0000b6b0: 6c69 7374 2063 6f72 7265 7370 6f6e 6473  list corresponds
-0000b6c0: 2074 6f20 6120 6469 6d65 6e73 696f 6e20   to a dimension 
-0000b6d0: 696e 0d0a 2020 2020 6072 6567 5f64 696d  in..    `reg_dim
-0000b6e0: 602c 2073 7065 6369 6679 696e 6720 7468  `, specifying th
-0000b6f0: 6520 7374 6570 2073 697a 6520 666f 7220  e step size for 
-0000b700: 6561 6368 2069 6e74 6572 7661 6c20 7769  each interval wi
-0000b710: 7468 696e 2074 6861 740d 0a20 2020 2064  thin that..    d
-0000b720: 696d 656e 7369 6f6e 2e20 4279 2064 6566  imension. By def
-0000b730: 6175 6c74 2c20 6966 2060 7265 675f 7374  ault, if `reg_st
-0000b740: 6570 6020 6973 206e 6f74 2070 726f 7669  ep` is not provi
-0000b750: 6465 642c 2061 2073 7465 7020 7369 7a65  ded, a step size
-0000b760: 206f 660d 0a20 2020 206f 6e65 2069 7320   of..    one is 
-0000b770: 6173 7375 6d65 6420 666f 7220 616c 6c20  assumed for all 
-0000b780: 6469 6d65 6e73 696f 6e73 2c20 6571 7569  dimensions, equi
-0000b790: 7661 6c65 6e74 2074 6f20 0d0a 2020 2020  valent to ..    
-0000b7a0: 6072 6567 5f73 7465 7020 3d20 5b6e 702e  `reg_step = [np.
-0000b7b0: 6f6e 6573 2872 6420 2d20 3129 2066 6f72  ones(rd - 1) for
-0000b7c0: 2072 6420 696e 2072 6567 5f64 696d 5d60   rd in reg_dim]`
-0000b7d0: 2e20 546f 2063 7573 746f 6d69 7a65 2c20  . To customize, 
-0000b7e0: 7072 6f76 6964 650d 0a20 2020 2060 7265  provide..    `re
-0000b7f0: 675f 7374 6570 6020 6173 2061 206c 6973  g_step` as a lis
-0000b800: 7420 636f 6e74 6169 6e69 6e67 2061 7272  t containing arr
-0000b810: 6179 732c 2077 6865 7265 2065 6163 6820  ays, where each 
-0000b820: 6172 7261 7920 6861 7320 6120 6c65 6e67  array has a leng
-0000b830: 7468 0d0a 2020 2020 6f66 2060 7265 675f  th..    of `reg_
-0000b840: 6469 6d5b 6a5d 202d 2031 602c 2061 6c6c  dim[j] - 1`, all
-0000b850: 6f77 696e 6720 666f 7220 7661 7269 6162  owing for variab
-0000b860: 6c65 2073 7465 7020 7369 7a65 7320 6163  le step sizes ac
-0000b870: 726f 7373 2069 6e74 6572 7661 6c73 0d0a  ross intervals..
-0000b880: 2020 2020 616e 6420 6469 6d65 6e73 696f      and dimensio
-0000b890: 6e73 2e0d 0a0d 0a20 2020 204e 4f54 4520  ns.....    NOTE 
-0000b8a0: 313a 204d 756c 7469 706c 7969 6e67 2065  1: Multiplying e
-0000b8b0: 6163 6820 656c 656d 656e 7420 696e 2060  ach element in `
-0000b8c0: 7265 675f 7374 6570 6020 6279 2061 2063  reg_step` by a c
-0000b8d0: 6f6e 7374 616e 7420 6661 6374 6f72 2060  onstant factor `
-0000b8e0: 6b60 0d0a 2020 2020 6861 7320 7468 6520  k`..    has the 
-0000b8f0: 7361 6d65 2065 6666 6563 7420 6173 2064  same effect as d
-0000b900: 6976 6964 696e 6720 7468 6520 7265 6775  ividing the regu
-0000b910: 6c61 7269 7a61 7469 6f6e 2070 6172 616d  larization param
-0000b920: 6574 6572 2060 7265 6775 6c60 2062 790d  eter `regul` by.
-0000b930: 0a20 2020 2060 6b2a 2a72 6567 5f6f 7264  .    `k**reg_ord
-0000b940: 602e 0d0a 0d0a 2020 2020 4e4f 5445 2032  `.....    NOTE 2
-0000b950: 3a20 5468 6520 7374 616e 6461 7264 2061  : The standard a
-0000b960: 7070 726f 6163 6820 636f 6e73 6973 7473  pproach consists
-0000b970: 206f 6620 7361 6d70 6c69 6e67 2074 6865   of sampling the
-0000b980: 2053 5053 2074 656d 706c 6174 650d 0a20   SPS template.. 
-0000b990: 2020 2073 7065 6374 7261 206c 6f67 6172     spectra logar
-0000b9a0: 6974 686d 6963 616c 6c79 2069 6e20 6167  ithmically in ag
-0000b9b0: 6520 616e 6420 6164 6f70 7420 6120 636f  e and adopt a co
-0000b9c0: 6e73 7461 6e74 2075 6e69 7461 7279 2073  nstant unitary s
-0000b9d0: 7465 702c 0d0a 2020 2020 2a2a 7769 7468  tep,..    **with
-0000b9e0: 6f75 742a 2a20 7573 696e 6720 7468 6973  out** using this
-0000b9f0: 206b 6579 776f 7264 2e0d 0a72 6567 756c   keyword...regul
-0000ba00: 3a20 666c 6f61 742c 206f 7074 696f 6e61  : float, optiona
-0000ba10: 6c0d 0a20 2020 2049 6620 7468 6973 206b  l..    If this k
-0000ba20: 6579 776f 7264 2069 7320 6e6f 6e7a 6572  eyword is nonzer
-0000ba30: 6f2c 2074 6865 2070 726f 6772 616d 2061  o, the program a
-0000ba40: 7070 6c69 6573 2066 6972 7374 206f 7220  pplies first or 
-0000ba50: 7365 636f 6e64 2d6f 7264 6572 0d0a 2020  second-order..  
-0000ba60: 2020 6c69 6e65 6172 2072 6567 756c 6172    linear regular
-0000ba70: 697a 6174 696f 6e20 746f 2074 6865 2060  ization to the `
-0000ba80: 6077 6569 6768 7473 6060 2064 7572 696e  `weights`` durin
-0000ba90: 6720 7468 6520 6060 7050 5846 6060 2066  g the ``pPXF`` f
-0000baa0: 6974 2e0d 0a20 2020 2052 6567 756c 6172  it...    Regular
-0000bab0: 697a 6174 696f 6e20 6973 2064 6f6e 6520  ization is done 
-0000bac0: 696e 206f 6e65 2c20 7477 6f20 6f72 2074  in one, two or t
-0000bad0: 6872 6565 2064 696d 656e 7369 6f6e 7320  hree dimensions 
-0000bae0: 6465 7065 6e64 696e 6720 6f6e 0d0a 2020  depending on..  
-0000baf0: 2020 7768 6574 6865 7220 7468 6520 6172    whether the ar
-0000bb00: 7261 7920 6f66 2060 6074 656d 706c 6174  ray of ``templat
-0000bb10: 6573 6060 2068 6173 2074 776f 2c20 7468  es`` has two, th
-0000bb20: 7265 6520 6f72 2066 6f75 7220 6469 6d65  ree or four dime
-0000bb30: 6e73 696f 6e73 0d0a 2020 2020 7265 7370  nsions..    resp
-0000bb40: 6563 7469 7665 6c79 2e0d 0a20 2020 204c  ectively...    L
-0000bb50: 6172 6765 2060 6072 6567 756c 6060 2076  arge ``regul`` v
-0000bb60: 616c 7565 7320 636f 7272 6573 706f 6e64  alues correspond
-0000bb70: 2074 6f20 736d 6f6f 7468 6572 2060 6077   to smoother ``w
-0000bb80: 6569 6768 7473 6060 206f 7574 7075 742e  eights`` output.
-0000bb90: 2057 6865 6e0d 0a20 2020 2074 6869 7320   When..    this 
-0000bba0: 6b65 7977 6f72 6420 6973 206e 6f6e 7a65  keyword is nonze
-0000bbb0: 726f 2074 6865 2073 6f6c 7574 696f 6e20  ro the solution 
-0000bbc0: 7769 6c6c 2062 6520 6120 7472 6164 652d  will be a trade-
-0000bbd0: 6f66 6620 6265 7477 6565 6e20 7468 650d  off between the.
-0000bbe0: 0a20 2020 2073 6d6f 6f74 686e 6573 7320  .    smoothness 
-0000bbf0: 6f66 2060 6077 6569 6768 7473 6060 2061  of ``weights`` a
-0000bc00: 6e64 2067 6f6f 646e 6573 7320 6f66 2066  nd goodness of f
-0000bc10: 6974 2e0d 0a0d 0a20 2020 2053 6563 7469  it.....    Secti
-0000bc20: 6f6e 2033 2e35 206f 6620 6043 6170 7065  on 3.5 of `Cappe
-0000bc30: 6c6c 6172 6920 2832 3031 3729 605f 2064  llari (2017)`_ d
-0000bc40: 6573 6372 6962 6573 2072 6567 756c 6172  escribes regular
-0000bc50: 697a 6174 696f 6e2e 0d0a 0d0a 2020 2020  ization.....    
-0000bc60: 5768 656e 2066 6974 7469 6e67 206d 756c  When fitting mul
-0000bc70: 7469 706c 6520 6b69 6e65 6d61 7469 6320  tiple kinematic 
-0000bc80: 6060 636f 6d70 6f6e 656e 7460 6020 7468  ``component`` th
-0000bc90: 6520 7265 6775 6c61 7269 7a61 7469 6f6e  e regularization
-0000bca0: 2069 730d 0a20 2020 2061 7070 6c69 6564   is..    applied
-0000bcb0: 206f 6e6c 7920 746f 2074 6865 2066 6972   only to the fir
-0000bcc0: 7374 2060 6063 6f6d 706f 6e65 6e74 203d  st ``component =
-0000bcd0: 2030 6060 2c20 7768 696c 6520 6164 6469   0``, while addi
-0000bce0: 7469 6f6e 616c 0d0a 2020 2020 636f 6d70  tional..    comp
-0000bcf0: 6f6e 656e 7473 2061 7265 206e 6f74 2072  onents are not r
-0000bd00: 6567 756c 6172 697a 6564 2e20 5468 6973  egularized. This
-0000bd10: 2069 7320 7573 6566 756c 2077 6865 6e20   is useful when 
-0000bd20: 6669 7474 696e 6720 7374 656c 6c61 720d  fitting stellar.
-0000bd30: 0a20 2020 2070 6f70 756c 6174 696f 6e20  .    population 
-0000bd40: 746f 6765 7468 6572 2077 6974 6820 6761  together with ga
-0000bd50: 7320 656d 6973 7369 6f6e 206c 696e 6573  s emission lines
-0000bd60: 2e20 496e 2074 6861 7420 6361 7365 2c20  . In that case, 
-0000bd70: 7468 6520 5353 500d 0a20 2020 2073 7065  the SSP..    spe
-0000bd80: 6374 7261 6c20 7465 6d70 6c61 7465 7320  ctral templates 
-0000bd90: 6d75 7374 2062 6520 6769 7665 6e20 6669  must be given fi
-0000bda0: 7273 7420 616e 6420 7468 6520 6761 7320  rst and the gas 
-0000bdb0: 656d 6973 7369 6f6e 2074 656d 706c 6174  emission templat
-0000bdc0: 6573 0d0a 2020 2020 6172 6520 6769 7665  es..    are give
-0000bdd0: 6e20 6c61 7374 2e20 496e 2074 6869 7320  n last. In this 
-0000bde0: 7369 7475 6174 696f 6e2c 206f 6e65 2068  situation, one h
-0000bdf0: 6173 2074 6f20 7573 6520 7468 6520 6060  as to use the ``
-0000be00: 7265 675f 6469 6d60 600d 0a20 2020 206b  reg_dim``..    k
-0000be10: 6579 776f 7264 2028 6265 6c6f 7729 2c20  eyword (below), 
-0000be20: 746f 2067 6976 6520 6060 7050 5846 6060  to give ``pPXF``
-0000be30: 2074 6865 2064 696d 656e 7369 6f6e 7320   the dimensions 
-0000be40: 6f66 2074 6865 2070 6f70 756c 6174 696f  of the populatio
-0000be50: 6e0d 0a20 2020 2070 6172 616d 6574 6572  n..    parameter
-0000be60: 7320 2865 2e67 2e20 6060 6e5f 6167 6560  s (e.g. ``n_age`
-0000be70: 602c 2060 606e 5f6d 6574 616c 6060 2c20  `, ``n_metal``, 
-0000be80: 6060 6e5f 616c 7068 6160 6029 2e20 4120  ``n_alpha``). A 
-0000be90: 7573 6167 6520 6578 616d 706c 650d 0a20  usage example.. 
-0000bea0: 2020 2069 7320 6769 7665 6e20 696e 2074     is given in t
-0000beb0: 6865 2066 696c 6520 6060 7070 7866 5f65  he file ``ppxf_e
-0000bec0: 7861 6d70 6c65 5f70 6f70 756c 6174 696f  xample_populatio
-0000bed0: 6e5f 6761 735f 7364 7373 2e70 7960 602e  n_gas_sdss.py``.
-0000bee0: 0d0a 0d0a 2020 2020 5468 6520 6566 6665  ....    The effe
-0000bef0: 6374 206f 6620 7468 6520 7265 6775 6c61  ct of the regula
-0000bf00: 7269 7a61 7469 6f6e 2073 6368 656d 6520  rization scheme 
-0000bf10: 6973 2074 6865 2066 6f6c 6c6f 7769 6e67  is the following
-0000bf20: 3a0d 0a0d 0a20 2020 202a 2057 6974 6820  :....    * With 
-0000bf30: 6060 7265 675f 6f72 643d 3160 6020 6974  ``reg_ord=1`` it
-0000bf40: 2065 6e66 6f72 6365 7320 7468 6520 6e75   enforces the nu
-0000bf50: 6d65 7269 6361 6c20 6669 7273 7420 6465  merical first de
-0000bf60: 7269 7661 7469 7665 730d 0a20 2020 2020  rivatives..     
-0000bf70: 2062 6574 7765 656e 206e 6569 6768 626f   between neighbo
-0000bf80: 7572 696e 6720 7765 6967 6874 7320 2869  uring weights (i
-0000bf90: 6e20 7468 6520 312d 6469 6d20 6361 7365  n the 1-dim case
-0000bfa0: 2920 746f 2062 6520 6571 7561 6c20 746f  ) to be equal to
-0000bfb0: 0d0a 2020 2020 2020 6060 775b 6a5d 202d  ..      ``w[j] -
-0000bfc0: 2077 5b6a 2b31 5d20 3d20 3060 6020 7769   w[j+1] = 0`` wi
-0000bfd0: 7468 2061 6e20 6572 726f 7220 6060 4465  th an error ``De
-0000bfe0: 6c74 6120 3d20 312f 7265 6775 6c60 602e  lta = 1/regul``.
-0000bff0: 0d0a 0d0a 2020 2020 2a20 5769 7468 2060  ....    * With `
-0000c000: 6072 6567 5f6f 7264 3d32 6060 2069 7420  `reg_ord=2`` it 
-0000c010: 656e 666f 7263 6573 2074 6865 206e 756d  enforces the num
-0000c020: 6572 6963 616c 2073 6563 6f6e 6420 6465  erical second de
-0000c030: 7269 7661 7469 7665 730d 0a20 2020 2020  rivatives..     
-0000c040: 2062 6574 7765 656e 206e 6569 6768 626f   between neighbo
-0000c050: 7572 696e 6720 7765 6967 6874 7320 2869  uring weights (i
-0000c060: 6e20 7468 6520 312d 6469 6d20 6361 7365  n the 1-dim case
-0000c070: 2920 746f 2062 6520 6571 7561 6c20 746f  ) to be equal to
-0000c080: 0d0a 2020 2020 2020 6060 775b 6a2d 315d  ..      ``w[j-1]
-0000c090: 202d 2032 2a77 5b6a 5d20 2b20 775b 6a2b   - 2*w[j] + w[j+
-0000c0a0: 315d 203d 2030 6060 2077 6974 6820 616e  1] = 0`` with an
-0000c0b0: 2065 7272 6f72 2060 6044 656c 7461 203d   error ``Delta =
-0000c0c0: 2031 2f72 6567 756c 6060 2e0d 0a0d 0a20   1/regul``..... 
-0000c0d0: 2020 2049 7420 6d61 7920 6265 2068 656c     It may be hel
-0000c0e0: 7066 756c 2074 6f20 6465 6669 6e65 2060  pful to define `
-0000c0f0: 6072 6567 756c 203d 2031 2f44 656c 7461  `regul = 1/Delta
-0000c100: 6060 2061 6e64 2074 6869 6e6b 206f 6620  `` and think of 
-0000c110: 6060 4465 6c74 6160 600d 0a20 2020 2061  ``Delta``..    a
-0000c120: 7320 7468 6520 7265 6775 6c61 7269 7a61  s the regulariza
-0000c130: 7469 6f6e 2065 7272 6f72 2e0d 0a0d 0a20  tion error..... 
-0000c140: 2020 2049 4d50 4f52 5441 4e54 3a20 6060     IMPORTANT: ``
-0000c150: 4465 6c74 6160 6020 6e65 6564 7320 746f  Delta`` needs to
-0000c160: 2062 6520 736d 616c 6c65 7220 6275 7420   be smaller but 
-0000c170: 6f66 2074 6865 2073 616d 6520 6f72 6465  of the same orde
-0000c180: 7220 6f66 0d0a 2020 2020 6d61 676e 6974  r of..    magnit
-0000c190: 7564 6520 6f66 2074 6865 2074 7970 6963  ude of the typic
-0000c1a0: 616c 2060 6077 6569 6768 7473 6060 2074  al ``weights`` t
-0000c1b0: 6f20 706c 6179 2061 6e20 6566 6665 6374  o play an effect
-0000c1c0: 206f 6e20 7468 650d 0a20 2020 2072 6567   on the..    reg
-0000c1d0: 756c 6172 697a 6174 696f 6e2e 204f 6e65  ularization. One
-0000c1e0: 2071 7569 636b 2077 6179 2074 6f20 6163   quick way to ac
-0000c1f0: 6869 6576 6520 7468 6973 2069 733a 0d0a  hieve this is:..
-0000c200: 0d0a 2020 2020 312e 2044 6976 6964 6520  ..    1. Divide 
-0000c210: 7468 6520 6675 6c6c 2060 6074 656d 706c  the full ``templ
-0000c220: 6174 6573 6060 2061 7272 6179 2062 7920  ates`` array by 
-0000c230: 6120 7363 616c 6172 2069 6e20 7375 6368  a scalar in such
-0000c240: 2061 2077 6179 2074 6861 740d 0a20 2020   a way that..   
-0000c250: 2020 2020 7468 6520 7479 7069 6361 6c20      the typical 
-0000c260: 7465 6d70 6c61 7465 2068 6173 2061 206d  template has a m
-0000c270: 6564 6961 6e20 6f66 206f 6e65 3a3a 0d0a  edian of one::..
-0000c280: 0d0a 2020 2020 2020 2020 2020 2020 7465  ..            te
-0000c290: 6d70 6c61 7465 7320 2f3d 206e 702e 6d65  mplates /= np.me
-0000c2a0: 6469 616e 2874 656d 706c 6174 6573 290d  dian(templates).
-0000c2b0: 0a0d 0a20 2020 2032 2e20 446f 2074 6865  ...    2. Do the
-0000c2c0: 2073 616d 6520 666f 7220 7468 6520 696e   same for the in
-0000c2d0: 7075 7420 6761 6c61 7879 2073 7065 6374  put galaxy spect
-0000c2e0: 7275 6d3a 3a0d 0a0d 0a20 2020 2020 2020  rum::....       
-0000c2f0: 2020 2020 2067 616c 6178 7920 2f3d 206e       galaxy /= n
-0000c300: 702e 6d65 6469 616e 2867 616c 6178 7929  p.median(galaxy)
-0000c310: 0d0a 0d0a 2020 2020 332e 2049 6e20 7468  ....    3. In th
-0000c320: 6973 2073 6974 7561 7469 6f6e 2c20 6120  is situation, a 
-0000c330: 7365 6e73 6962 6c65 2067 7565 7373 2066  sensible guess f
-0000c340: 6f72 2060 6044 656c 7461 6060 2077 696c  or ``Delta`` wil
-0000c350: 6c20 6265 2061 2066 6577 0d0a 2020 2020  l be a few..    
-0000c360: 2020 2070 6572 6365 6e74 2028 652e 672e     percent (e.g.
-0000c370: 2060 6044 656c 7461 3d30 2e30 3120 2d2d   ``Delta=0.01 --
-0000c380: 3e20 7265 6775 6c3d 3130 3060 6029 2e0d  > regul=100``)..
-0000c390: 0a0d 0a20 2020 2041 6c74 6572 6e61 7469  ...    Alternati
-0000c3a0: 7665 6c79 2c20 666f 7220 6120 6d6f 7265  vely, for a more
-0000c3b0: 2072 6967 6f72 6f75 7320 6465 6669 6e69   rigorous defini
-0000c3c0: 7469 6f6e 206f 6620 7468 6520 7061 7261  tion of the para
-0000c3d0: 6d65 7465 720d 0a20 2020 2060 6072 6567  meter..    ``reg
-0000c3e0: 756c 6060 3a0d 0a0d 0a20 2020 2041 2e20  ul``:....    A. 
-0000c3f0: 5065 7266 6f72 6d20 616e 2075 6e72 6567  Perform an unreg
-0000c400: 756c 6172 697a 6564 2066 6974 2028 6060  ularized fit (``
-0000c410: 7265 6775 6c3d 3060 6029 2061 6e64 2074  regul=0``) and t
-0000c420: 6865 6e20 7265 7363 616c 6520 7468 650d  hen rescale the.
-0000c430: 0a20 2020 2020 2020 696e 7075 7420 6060  .       input ``
-0000c440: 6e6f 6973 6560 6020 7370 6563 7472 756d  noise`` spectrum
-0000c450: 2073 6f20 7468 6174 3a3a 0d0a 0d0a 2020   so that::....  
-0000c460: 2020 2020 2020 2020 2020 4368 695e 322f            Chi^2/
-0000c470: 444f 4620 3d20 4368 695e 322f 676f 6f64  DOF = Chi^2/good
-0000c480: 5069 7865 6c73 2e73 697a 6520 3d20 312e  Pixels.size = 1.
-0000c490: 0d0a 0d0a 2020 2020 2020 2054 6869 7320  ....       This 
-0000c4a0: 6973 2061 6368 6965 7665 6420 6279 2072  is achieved by r
-0000c4b0: 6573 6361 6c69 6e67 2074 6865 2069 6e70  escaling the inp
-0000c4c0: 7574 2060 606e 6f69 7365 6060 2073 7065  ut ``noise`` spe
-0000c4d0: 6374 7275 6d20 6173 3a3a 0d0a 0d0a 2020  ctrum as::....  
-0000c4e0: 2020 2020 2020 2020 2020 6e6f 6973 6520            noise 
-0000c4f0: 3d20 6e6f 6973 652a 6e70 2e73 7172 7428  = noise*np.sqrt(
-0000c500: 4368 692a 2a32 2f44 4f46 2920 3d20 6e6f  Chi**2/DOF) = no
-0000c510: 6973 652a 6e70 2e73 7172 7428 7070 2e63  ise*np.sqrt(pp.c
-0000c520: 6869 3229 3b0d 0a0d 0a20 2020 2042 2e20  hi2);....    B. 
-0000c530: 496e 6372 6561 7365 2060 6072 6567 756c  Increase ``regul
-0000c540: 6060 2061 6e64 2069 7465 7261 7469 7665  `` and iterative
-0000c550: 6c79 2072 6564 6f20 7468 6520 6060 7050  ly redo the ``pP
-0000c560: 5846 6060 2066 6974 2075 6e74 696c 2074  XF`` fit until t
-0000c570: 6865 0d0a 2020 2020 2020 2060 6043 6869  he..       ``Chi
-0000c580: 5e32 6060 2069 6e63 7265 6173 6573 2066  ^2`` increases f
-0000c590: 726f 6d20 7468 6520 756e 7265 6775 6c61  rom the unregula
-0000c5a0: 7269 7a65 6420 7661 6c75 650d 0a20 2020  rized value..   
-0000c5b0: 2020 2020 6060 4368 695e 3220 3d20 676f      ``Chi^2 = go
-0000c5c0: 6f64 5069 7865 6c73 2e73 697a 6560 6020  odPixels.size`` 
-0000c5d0: 6279 0d0a 2020 2020 2020 2060 6044 656c  by..       ``Del
-0000c5e0: 7461 4368 695e 3220 3d20 6e70 2e73 7172  taChi^2 = np.sqr
-0000c5f0: 7428 322a 676f 6f64 5069 7865 6c73 2e73  t(2*goodPixels.s
-0000c600: 697a 6529 6060 2e0d 0a0d 0a20 2020 2054  ize)``.....    T
-0000c610: 6865 2064 6572 6976 6564 2072 6567 756c  he derived regul
-0000c620: 6172 697a 6174 696f 6e20 636f 7272 6573  arization corres
-0000c630: 706f 6e64 7320 746f 2074 6865 206d 6178  ponds to the max
-0000c640: 696d 756d 206f 6e65 2073 7469 6c6c 0d0a  imum one still..
-0000c650: 2020 2020 636f 6e73 6973 7465 6e74 2077      consistent w
-0000c660: 6974 6820 7468 6520 6f62 7365 7276 6174  ith the observat
-0000c670: 696f 6e73 2061 6e64 2074 6865 2064 6572  ions and the der
-0000c680: 6976 6564 2073 7461 7220 666f 726d 6174  ived star format
-0000c690: 696f 6e20 6869 7374 6f72 790d 0a20 2020  ion history..   
-0000c6a0: 2077 696c 6c20 6265 2074 6865 2073 6d6f   will be the smo
-0000c6b0: 6f74 6865 7374 2028 6d69 6e69 6d75 6d20  othest (minimum 
-0000c6c0: 6375 7276 6174 7572 6520 6f72 206d 696e  curvature or min
-0000c6d0: 696d 756d 2076 6172 6961 7469 6f6e 2920  imum variation) 
-0000c6e0: 7468 6174 2069 730d 0a20 2020 2073 7469  that is..    sti
-0000c6f0: 6c6c 2063 6f6e 7369 7374 656e 7420 7769  ll consistent wi
-0000c700: 7468 2074 6865 206f 6273 6572 7661 7469  th the observati
-0000c710: 6f6e 732e 0d0a 7369 676d 615f 6469 6666  ons...sigma_diff
-0000c720: 3a20 666c 6f61 742c 206f 7074 696f 6e61  : float, optiona
-0000c730: 6c0d 0a20 2020 2051 7561 6472 6174 6963  l..    Quadratic
-0000c740: 2064 6966 6665 7265 6e63 6520 696e 206b   difference in k
-0000c750: 6d2f 7320 6465 6669 6e65 6420 6173 3a3a  m/s defined as::
-0000c760: 0d0a 0d0a 2020 2020 2020 2020 7369 676d  ....        sigm
-0000c770: 615f 6469 6666 2a2a 3220 3d20 7369 676d  a_diff**2 = sigm
-0000c780: 615f 696e 7374 2a2a 3220 2d20 7369 676d  a_inst**2 - sigm
-0000c790: 615f 7465 6d70 2a2a 320d 0a0d 0a20 2020  a_temp**2....   
-0000c7a0: 2062 6574 7765 656e 2074 6865 2069 6e73   between the ins
-0000c7b0: 7472 756d 656e 7461 6c20 6469 7370 6572  trumental disper
-0000c7c0: 7369 6f6e 206f 6620 7468 6520 6761 6c61  sion of the gala
-0000c7d0: 7879 2073 7065 6374 7275 6d20 616e 6420  xy spectrum and 
-0000c7e0: 7468 650d 0a20 2020 2069 6e73 7472 756d  the..    instrum
-0000c7f0: 656e 7461 6c20 6469 7370 6572 7369 6f6e  ental dispersion
-0000c800: 206f 6620 7468 6520 7465 6d70 6c61 7465   of the template
-0000c810: 2073 7065 6374 7261 2e0d 0a0d 0a20 2020   spectra.....   
-0000c820: 2054 6869 7320 6b65 7977 6f72 6420 6973   This keyword is
-0000c830: 2075 7365 6675 6c20 7768 656e 2074 6865   useful when the
-0000c840: 2074 656d 706c 6174 6573 2068 6176 6520   templates have 
-0000c850: 6869 6768 6572 2072 6573 6f6c 7574 696f  higher resolutio
-0000c860: 6e20 7468 616e 0d0a 2020 2020 7468 6520  n than..    the 
-0000c870: 6761 6c61 7879 2061 6e64 2074 6865 7920  galaxy and they 
-0000c880: 7765 7265 206e 6f74 2063 6f6e 766f 6c76  were not convolv
-0000c890: 6564 2074 6f20 6d61 7463 6820 7468 6520  ed to match the 
-0000c8a0: 696e 7374 7275 6d65 6e74 616c 0d0a 2020  instrumental..  
-0000c8b0: 2020 6469 7370 6572 7369 6f6e 206f 6620    dispersion of 
-0000c8c0: 7468 6520 6761 6c61 7879 2073 7065 6374  the galaxy spect
-0000c8d0: 7275 6d2e 2049 6e20 7468 6973 2073 6974  rum. In this sit
-0000c8e0: 7561 7469 6f6e 2c20 7468 6520 636f 6e76  uation, the conv
-0000c8f0: 6f6c 7574 696f 6e0d 0a20 2020 2069 7320  olution..    is 
-0000c900: 646f 6e65 2062 7920 6060 7050 5846 6060  done by ``pPXF``
-0000c910: 2077 6974 6820 696e 6372 6561 7365 6420   with increased 
-0000c920: 6163 6375 7261 6379 2c20 7573 696e 6720  accuracy, using 
-0000c930: 616e 2061 6e61 6c79 7469 6320 466f 7572  an analytic Four
-0000c940: 6965 720d 0a20 2020 2054 7261 6e73 666f  ier..    Transfo
-0000c950: 726d 2e0d 0a73 6b79 3a0d 0a20 2020 2076  rm...sky:..    v
-0000c960: 6563 746f 7220 636f 6e74 6169 6e69 6e67  ector containing
-0000c970: 2074 6865 2073 7065 6374 7275 6d20 6f66   the spectrum of
-0000c980: 2074 6865 2073 6b79 2074 6f20 6265 2069   the sky to be i
-0000c990: 6e63 6c75 6465 6420 696e 2074 6865 2066  ncluded in the f
-0000c9a0: 6974 2c20 6f72 0d0a 2020 2020 6172 7261  it, or..    arra
-0000c9b0: 7920 6f66 2064 696d 656e 7369 6f6e 7320  y of dimensions 
-0000c9c0: 6060 736b 795b 6e5f 7069 7865 6c73 2c20  ``sky[n_pixels, 
-0000c9d0: 6e53 6b79 5d60 6020 636f 6e74 6169 6e69  nSky]`` containi
-0000c9e0: 6e67 2064 6966 6665 7265 6e74 2073 6b79  ng different sky
-0000c9f0: 0d0a 2020 2020 7370 6563 7472 6120 746f  ..    spectra to
-0000ca00: 2061 6464 2074 6f20 7468 6520 6d6f 6465   add to the mode
-0000ca10: 6c20 6f66 2074 6865 206f 6273 6572 7665  l of the observe
-0000ca20: 6420 6060 6761 6c61 7879 6060 2073 7065  d ``galaxy`` spe
-0000ca30: 6374 7275 6d2e 2054 6865 0d0a 2020 2020  ctrum. The..    
-0000ca40: 6060 736b 7960 6020 6861 7320 746f 2062  ``sky`` has to b
-0000ca50: 6520 6c6f 672d 7265 6269 6e6e 6564 2061  e log-rebinned a
-0000ca60: 7320 7468 6520 6060 6761 6c61 7879 6060  s the ``galaxy``
-0000ca70: 2073 7065 6374 7275 6d20 616e 6420 6e65   spectrum and ne
-0000ca80: 6564 7320 746f 0d0a 2020 2020 6861 7665  eds to..    have
-0000ca90: 2074 6865 2073 616d 6520 6e75 6d62 6572   the same number
-0000caa0: 206f 6620 7069 7865 6c73 2e0d 0a0d 0a20   of pixels..... 
-0000cab0: 2020 2054 6865 2073 6b79 2069 7320 6765     The sky is ge
-0000cac0: 6e65 7261 6c6c 7920 7375 6274 7261 6374  nerally subtract
-0000cad0: 6564 2066 726f 6d20 7468 6520 6461 7461  ed from the data
-0000cae0: 2062 6566 6f72 6520 7468 6520 6060 7050   before the ``pP
-0000caf0: 5846 6060 2066 6974 2e0d 0a20 2020 2048  XF`` fit...    H
-0000cb00: 6f77 6576 6572 2c20 666f 7220 6f62 7365  owever, for obse
-0000cb10: 7276 6174 696f 6e73 2076 6572 7920 6865  rvations very he
-0000cb20: 6176 696c 7920 646f 6d69 6e61 7465 6420  avily dominated 
-0000cb30: 6279 2074 6865 2073 6b79 2073 7065 6374  by the sky spect
-0000cb40: 7275 6d2c 0d0a 2020 2020 7768 6572 6520  rum,..    where 
-0000cb50: 6120 7665 7279 2061 6363 7572 6174 6520  a very accurate 
-0000cb60: 736b 7920 7375 6274 7261 6374 696f 6e20  sky subtraction 
-0000cb70: 6973 2063 7269 7469 6361 6c2c 2069 7420  is critical, it 
-0000cb80: 6d61 7920 6265 2075 7365 6675 6c0d 0a20  may be useful.. 
-0000cb90: 2020 202a 6e6f 742a 2074 6f20 7375 6274     *not* to subt
-0000cba0: 7261 6374 2074 6865 2073 6b79 2066 726f  ract the sky fro
-0000cbb0: 6d20 7468 6520 7370 6563 7472 756d 2c20  m the spectrum, 
-0000cbc0: 6275 7420 746f 2069 6e63 6c75 6465 2069  but to include i
-0000cbd0: 7420 696e 2074 6865 0d0a 2020 2020 6669  t in the..    fi
-0000cbe0: 7420 7573 696e 6720 7468 6973 206b 6579  t using this key
-0000cbf0: 776f 7264 2e0d 0a74 656d 706c 6174 6573  word...templates
-0000cc00: 5f72 6666 743a 0d0a 2020 2020 5768 656e  _rfft:..    When
-0000cc10: 2063 616c 6c69 6e67 2060 6070 5058 4660   calling ``pPXF`
-0000cc20: 6020 6d61 6e79 2074 696d 6573 2077 6974  ` many times wit
-0000cc30: 6820 616e 2069 6465 6e74 6963 616c 2073  h an identical s
-0000cc40: 6574 206f 6620 7465 6d70 6c61 7465 732c  et of templates,
-0000cc50: 0d0a 2020 2020 6f6e 6520 6361 6e20 7573  ..    one can us
-0000cc60: 6520 7468 6973 206b 6579 776f 7264 2074  e this keyword t
-0000cc70: 6f20 7061 7373 2074 6865 2072 6561 6c20  o pass the real 
-0000cc80: 4646 5420 6f66 2074 6865 2074 656d 706c  FFT of the templ
-0000cc90: 6174 6573 2c0d 0a20 2020 2063 6f6d 7075  ates,..    compu
-0000cca0: 7465 6420 696e 2061 2070 7265 7669 6f75  ted in a previou
-0000ccb0: 7320 6060 7050 5846 6060 2063 616c 6c2c  s ``pPXF`` call,
-0000ccc0: 2073 746f 7265 6420 696e 2074 6865 0d0a   stored in the..
-0000ccd0: 2020 2020 6060 7070 2e74 656d 706c 6174      ``pp.templat
-0000cce0: 6573 5f72 6666 7460 6020 6174 7472 6962  es_rfft`` attrib
-0000ccf0: 7574 652e 2054 6869 7320 6b65 7977 6f72  ute. This keywor
-0000cd00: 6420 6d61 696e 6c79 2065 7869 7374 7320  d mainly exists 
-0000cd10: 746f 2073 686f 770d 0a20 2020 2074 6861  to show..    tha
-0000cd20: 7420 7468 6572 6520 6973 206e 6f20 6e65  t there is no ne
-0000cd30: 6564 2066 6f72 2069 742e 2e2e 0d0a 0d0a  ed for it.......
-0000cd40: 2020 2020 494d 504f 5254 414e 543a 2055      IMPORTANT: U
-0000cd50: 7365 2074 6869 7320 6b65 7977 6f72 6420  se this keyword 
-0000cd60: 6f6e 6c79 2069 6620 796f 7520 756e 6465  only if you unde
-0000cd70: 7273 7461 6e64 2077 6861 7420 796f 7520  rstand what you 
-0000cd80: 6172 6520 646f 696e 6721 0d0a 7469 6564  are doing!..tied
-0000cd90: 3a0d 0a20 2020 2041 206c 6973 7420 6f66  :..    A list of
-0000cda0: 2073 7472 696e 6720 6578 7072 6573 7369   string expressi
-0000cdb0: 6f6e 732e 2045 6163 6820 6578 7072 6573  ons. Each expres
-0000cdc0: 7369 6f6e 2022 7469 6573 2220 7468 6520  sion "ties" the 
-0000cdd0: 7061 7261 6d65 7465 7220 746f 0d0a 2020  parameter to..  
-0000cde0: 2020 6f74 6865 7220 6672 6565 206f 7220    other free or 
-0000cdf0: 6669 7865 6420 7061 7261 6d65 7465 7273  fixed parameters
-0000ce00: 2e20 2041 6e79 2065 7870 7265 7373 696f  .  Any expressio
-0000ce10: 6e20 696e 766f 6c76 696e 6720 636f 6e73  n involving cons
-0000ce20: 7461 6e74 7320 616e 640d 0a20 2020 2074  tants and..    t
-0000ce30: 6865 2070 6172 616d 6574 6572 2061 7272  he parameter arr
-0000ce40: 6179 2060 6070 5b6a 5d60 6020 6172 6520  ay ``p[j]`` are 
-0000ce50: 7065 726d 6974 7465 642e 2053 696e 6365  permitted. Since
-0000ce60: 2074 6865 7920 6172 6520 746f 7461 6c6c   they are totall
-0000ce70: 790d 0a20 2020 2063 6f6e 7374 7261 696e  y..    constrain
-0000ce80: 6564 2c20 7469 6564 2070 6172 616d 6574  ed, tied paramet
-0000ce90: 6572 7320 6172 6520 636f 6e73 6964 6572  ers are consider
-0000cea0: 6564 2074 6f20 6265 2066 6978 6564 3b20  ed to be fixed; 
-0000ceb0: 6e6f 2065 7272 6f72 7320 6172 650d 0a20  no errors are.. 
-0000cec0: 2020 2063 6f6d 7075 7465 6420 666f 7220     computed for 
-0000ced0: 7468 656d 2e0d 0a0d 0a20 2020 2054 6869  them.....    Thi
-0000cee0: 7320 6973 2061 6e20 6172 7261 792c 206f  s is an array, o
-0000cef0: 7220 6c69 7374 206f 6620 6172 7261 7973  r list of arrays
-0000cf00: 2c20 7769 7468 2074 6865 2073 616d 6520  , with the same 
-0000cf10: 6469 6d65 6e73 696f 6e73 2061 730d 0a20  dimensions as.. 
-0000cf20: 2020 2060 6073 7461 7274 6060 2e20 496e     ``start``. In
-0000cf30: 2070 7261 6374 6963 652c 2066 6f72 2065   practice, for e
-0000cf40: 7665 7279 2065 6c65 6d65 6e74 206f 6620  very element of 
-0000cf50: 6060 7374 6172 7460 6020 6f6e 6520 6e65  ``start`` one ne
-0000cf60: 6564 7320 746f 0d0a 2020 2020 7370 6563  eds to..    spec
-0000cf70: 6966 7920 6569 7468 6572 2061 6e20 656d  ify either an em
-0000cf80: 7074 7920 7374 7269 6e67 2060 6027 2760  pty string ``''`
-0000cf90: 6020 696d 706c 7969 6e67 2074 6861 7420  ` implying that 
-0000cfa0: 7468 6520 7061 7261 6d65 7465 7220 6973  the parameter is
-0000cfb0: 0d0a 2020 2020 6672 6565 2c20 6f72 2061  ..    free, or a
-0000cfc0: 2073 7472 696e 6720 6578 7072 6573 7369   string expressi
-0000cfd0: 6f6e 2069 6e76 6f6c 7669 6e67 2073 6f6d  on involving som
-0000cfe0: 6520 6f66 2074 6865 2076 6172 6961 626c  e of the variabl
-0000cff0: 6573 2060 6070 5b6a 5d60 602c 0d0a 2020  es ``p[j]``,..  
-0000d000: 2020 7768 6572 6520 6060 6a60 6020 7265    where ``j`` re
-0000d010: 7072 6573 656e 7473 2074 6865 2069 6e64  presents the ind
-0000d020: 6578 206f 6620 7468 6520 666c 6174 7465  ex of the flatte
-0000d030: 6e65 6420 6c69 7374 206f 6620 6b69 6e65  ned list of kine
-0000d040: 6d61 7469 630d 0a20 2020 2070 6172 616d  matic..    param
-0000d050: 6574 6572 732e 0d0a 0d0a 2020 2020 4558  eters.....    EX
-0000d060: 414d 504c 453a 2057 6520 7761 6e74 2074  AMPLE: We want t
-0000d070: 6f20 6669 7420 7468 7265 6520 6b69 6e65  o fit three kine
-0000d080: 6d61 7469 6320 636f 6d70 6f6e 656e 7473  matic components
-0000d090: 2c20 7769 7468 2034 206d 6f6d 656e 7473  , with 4 moments
-0000d0a0: 2066 6f72 0d0a 2020 2020 7468 6520 6669   for..    the fi
-0000d0b0: 7273 7420 636f 6d70 6f6e 656e 7420 616e  rst component an
-0000d0c0: 6420 3220 6d6f 6d65 6e74 7320 666f 7220  d 2 moments for 
-0000d0d0: 7468 6520 7365 636f 6e64 2061 6e64 2074  the second and t
-0000d0e0: 6869 7264 2028 652e 672e 2073 7461 7273  hird (e.g. stars
-0000d0f0: 0d0a 2020 2020 616e 6420 7477 6f20 6761  ..    and two ga
-0000d100: 7320 636f 6d70 6f6e 656e 7473 292e 2049  s components). I
-0000d110: 6e20 7468 6973 2063 6173 653a 3a0d 0a0d  n this case::...
-0000d120: 0a20 2020 2020 2020 206d 6f6d 656e 7473  .        moments
-0000d130: 203d 205b 342c 2032 2c20 325d 0d0a 2020   = [4, 2, 2]..  
-0000d140: 2020 2020 2020 7374 6172 7420 3d20 5b5b        start = [[
-0000d150: 5631 2c20 7369 676d 6131 2c20 302c 2030  V1, sigma1, 0, 0
-0000d160: 5d2c 205b 5632 2c20 7369 676d 6132 5d2c  ], [V2, sigma2],
-0000d170: 205b 5633 2c20 7369 676d 6133 5d5d 0d0a   [V3, sigma3]]..
-0000d180: 0d0a 2020 2020 7468 656e 2077 6520 6361  ..    then we ca
-0000d190: 6e20 666f 7263 6520 7468 6520 6571 7561  n force the equa
-0000d1a0: 6c69 7479 2063 6f6e 7374 7261 696e 7420  lity constraint 
-0000d1b0: 6060 5632 203d 2056 3360 6020 6173 2066  ``V2 = V3`` as f
-0000d1c0: 6f6c 6c6f 7773 3a3a 0d0a 0d0a 2020 2020  ollows::....    
-0000d1d0: 2020 2020 7469 6564 203d 205b 5b27 272c      tied = [['',
-0000d1e0: 2027 272c 2027 272c 2027 275d 2c20 5b27   '', '', ''], ['
-0000d1f0: 272c 2027 275d 2c20 5b27 705b 345d 272c  ', ''], ['p[4]',
-0000d200: 2027 275d 5d20 2023 2070 5b36 5d20 3d20   '']]  # p[6] = 
-0000d210: 705b 345d 0d0a 0d0a 2020 2020 6f72 2077  p[4]....    or w
-0000d220: 6520 6361 6e20 666f 7263 6520 7468 6520  e can force the 
-0000d230: 6571 7561 6c69 7479 2063 6f6e 7374 7261  equality constra
-0000d240: 696e 7420 6060 7369 676d 6132 203d 2073  int ``sigma2 = s
-0000d250: 6967 6d61 3360 6020 6173 0d0a 2020 2020  igma3`` as..    
-0000d260: 666f 6c6c 6f77 733a 3a0d 0a0d 0a20 2020  follows::....   
-0000d270: 2020 2020 2074 6965 6420 3d20 5b5b 2727       tied = [[''
-0000d280: 2c20 2727 2c20 2727 2c20 2727 5d2c 205b  , '', '', ''], [
-0000d290: 2727 2c20 2727 5d2c 205b 2727 2c20 2770  '', ''], ['', 'p
-0000d2a0: 5b35 5d27 5d5d 2020 2320 705b 375d 203d  [5]']]  # p[7] =
-0000d2b0: 2070 5b35 5d0d 0a0d 0a20 2020 204f 6e65   p[5]....    One
-0000d2c0: 2063 616e 2061 6c73 6f20 7573 6520 6d6f   can also use mo
-0000d2d0: 7265 2067 656e 6572 616c 2066 6f72 6d75  re general formu
-0000d2e0: 6c61 732e 2046 6f72 2065 7861 6d70 6c65  las. For example
-0000d2f0: 206f 6e65 2063 6f75 6c64 2063 6f6e 7374   one could const
-0000d300: 7261 696e 0d0a 2020 2020 6060 5633 203d  rain..    ``V3 =
-0000d310: 2028 5631 202b 2056 3229 2f32 6060 2061   (V1 + V2)/2`` a
-0000d320: 7320 7765 6c6c 2061 7320 6060 7369 676d  s well as ``sigm
-0000d330: 6131 203d 2073 6967 6d61 3260 6020 6173  a1 = sigma2`` as
-0000d340: 2066 6f6c 6c6f 7773 3a3a 0d0a 0d0a 2020   follows::....  
-0000d350: 2020 2020 2020 2320 705b 355d 203d 2070        # p[5] = p
-0000d360: 5b31 5d0d 0a20 2020 2020 2020 2023 2070  [1]..        # p
-0000d370: 5b36 5d20 3d20 2870 5b30 5d20 2b20 705b  [6] = (p[0] + p[
-0000d380: 345d 292f 320d 0a20 2020 2020 2020 2074  4])/2..        t
-0000d390: 6965 6420 3d20 5b5b 2727 2c20 2727 2c20  ied = [['', '', 
-0000d3a0: 2727 2c20 2727 5d2c 205b 2727 2c20 2770  '', ''], ['', 'p
-0000d3b0: 5b31 5d27 5d2c 205b 2728 705b 305d 202b  [1]'], ['(p[0] +
-0000d3c0: 2070 5b34 5d29 2f32 272c 2027 275d 5d0d   p[4])/2', '']].
-0000d3d0: 0a0d 0a20 2020 204e 4f54 453a 204f 6e65  ...    NOTE: One
-0000d3e0: 2063 6f75 6c64 2069 6e20 7072 696e 6369   could in princi
-0000d3f0: 706c 6520 7573 6520 7468 6520 6060 7469  ple use the ``ti
-0000d400: 6564 6060 206b 6579 776f 7264 2074 6f20  ed`` keyword to 
-0000d410: 636f 6d70 6c65 7465 6c79 2074 6965 0d0a  completely tie..
-0000d420: 2020 2020 7468 6520 4c4f 5356 4420 6f66      the LOSVD of
-0000d430: 2074 776f 206b 696e 656d 6174 6963 2063   two kinematic c
-0000d440: 6f6d 706f 6e65 6e74 732e 2048 6f77 6576  omponents. Howev
-0000d450: 6572 2c20 7468 6973 2073 616d 6520 6566  er, this same ef
-0000d460: 6665 6374 2069 730d 0a20 2020 206d 6f72  fect is..    mor
-0000d470: 6520 6566 6669 6369 656e 7420 6163 6869  e efficient achi
-0000d480: 6576 6564 2062 7920 6173 7369 676e 696e  eved by assignin
-0000d490: 6720 7468 656d 2074 6f20 7468 6520 7361  g them to the sa
-0000d4a0: 6d65 206b 696e 656d 6174 6963 0d0a 2020  me kinematic..  
-0000d4b0: 2020 636f 6d70 6f6e 656e 7420 7573 696e    component usin
-0000d4c0: 6720 7468 6520 6060 636f 6d70 6f6e 656e  g the ``componen
-0000d4d0: 7460 6020 6b65 7977 6f72 642e 0d0a 7472  t`` keyword...tr
-0000d4e0: 6967 3a0d 0a20 2020 2053 6574 2060 6074  ig:..    Set ``t
-0000d4f0: 7269 673d 5472 7565 6060 2074 6f20 7573  rig=True`` to us
-0000d500: 6520 7472 6967 6f6e 6f6d 6574 7269 6320  e trigonometric 
-0000d510: 7365 7269 6573 2061 7320 616e 2061 6c74  series as an alt
-0000d520: 6572 6e61 7469 7665 2074 6f0d 0a20 2020  ernative to..   
-0000d530: 204c 6567 656e 6472 6520 706f 6c79 6e6f   Legendre polyno
-0000d540: 6d69 616c 732c 2066 6f72 2062 6f74 6820  mials, for both 
-0000d550: 7468 6520 6164 6469 7469 7665 2061 6e64  the additive and
-0000d560: 206d 756c 7469 706c 6963 6174 6976 650d   multiplicative.
-0000d570: 0a20 2020 2070 6f6c 796e 6f6d 6961 6c73  .    polynomials
-0000d580: 2e20 5768 656e 2060 6074 7269 673d 5472  . When ``trig=Tr
-0000d590: 7565 6060 2074 6865 2066 6974 7465 6420  ue`` the fitted 
-0000d5a0: 7365 7269 6573 2062 656c 6f77 2068 6173  series below has
-0000d5b0: 0d0a 2020 2020 6060 4e20 3d20 6465 6772  ..    ``N = degr
-0000d5c0: 6565 2f32 6060 206f 7220 6060 4e20 3d20  ee/2`` or ``N = 
-0000d5d0: 6d64 6567 7265 652f 3260 603a 3a0d 0a0d  mdegree/2``::...
-0000d5e0: 0a20 2020 2020 2020 2070 6f6c 7920 3d20  .        poly = 
-0000d5f0: 415f 3020 2b20 7375 6d5f 7b6e 3d31 7d5e  A_0 + sum_{n=1}^
-0000d600: 7b4e 7d20 5b41 5f6e 2a63 6f73 286e 2a74  {N} [A_n*cos(n*t
-0000d610: 6829 202b 2042 5f6e 2a73 696e 286e 2a74  h) + B_n*sin(n*t
-0000d620: 6829 5d0d 0a0d 0a20 2020 2049 4d50 4f52  h)]....    IMPOR
-0000d630: 5441 4e54 3a20 5468 6520 7472 6967 6f6e  TANT: The trigon
-0000d640: 6f6d 6574 7269 6320 7365 7269 6573 2068  ometric series h
-0000d650: 6173 2070 6572 696f 6469 6320 626f 756e  as periodic boun
-0000d660: 6461 7279 2063 6f6e 6469 7469 6f6e 732e  dary conditions.
-0000d670: 0d0a 2020 2020 5468 6973 2069 7320 736f  ..    This is so
-0000d680: 6d65 7469 6d65 7320 6120 6465 7369 7261  metimes a desira
-0000d690: 626c 6520 7072 6f70 6572 7479 2c20 6275  ble property, bu
-0000d6a0: 7420 7468 6973 2065 7870 616e 7369 6f6e  t this expansion
-0000d6b0: 2069 7320 6e6f 7420 6173 0d0a 2020 2020   is not as..    
-0000d6c0: 666c 6578 6962 6c65 2061 7320 7468 6520  flexible as the 
-0000d6d0: 4c65 6765 6e64 7265 2070 6f6c 796e 6f6d  Legendre polynom
-0000d6e0: 6961 6c73 2e0d 0a76 656c 7363 616c 655f  ials...velscale_
-0000d6f0: 7261 7469 6f3a 2069 6e74 2c20 6f70 7469  ratio: int, opti
-0000d700: 6f6e 616c 0d0a 2020 2020 496e 7465 6765  onal..    Intege
-0000d710: 722e 2047 6976 6573 2074 6865 2069 6e74  r. Gives the int
-0000d720: 6567 6572 2060 6072 6174 696f 203e 3d20  eger ``ratio >= 
-0000d730: 3160 6020 6265 7477 6565 6e20 7468 6520  1`` between the 
-0000d740: 6060 7665 6c73 6361 6c65 6060 206f 660d  ``velscale`` of.
-0000d750: 0a20 2020 2074 6865 2060 6067 616c 6178  .    the ``galax
-0000d760: 7960 6020 616e 6420 7468 6520 6060 7465  y`` and the ``te
-0000d770: 6d70 6c61 7465 7360 602e 2057 6865 6e20  mplates``. When 
-0000d780: 7468 6973 206b 6579 776f 7264 2069 7320  this keyword is 
-0000d790: 7573 6564 2c20 7468 650d 0a20 2020 2074  used, the..    t
-0000d7a0: 656d 706c 6174 6573 2061 7265 2063 6f6e  emplates are con
-0000d7b0: 766f 6c76 6564 2062 7920 7468 6520 4c4f  volved by the LO
-0000d7c0: 5356 4420 6174 2074 6865 6972 206e 6174  SVD at their nat
-0000d7d0: 6976 6520 7265 736f 6c75 7469 6f6e 2c20  ive resolution, 
-0000d7e0: 616e 640d 0a20 2020 206f 6e6c 7920 7375  and..    only su
-0000d7f0: 6273 6571 7565 6e74 6c79 2061 7265 2069  bsequently are i
-0000d800: 6e74 6567 7261 7465 6420 6f76 6572 2074  ntegrated over t
-0000d810: 6865 2070 6978 656c 7320 616e 6420 6669  he pixels and fi
-0000d820: 7474 6564 2074 6f0d 0a20 2020 2060 6067  tted to..    ``g
-0000d830: 616c 6178 7960 602e 2054 6869 7320 6b65  alaxy``. This ke
-0000d840: 7977 6f72 6420 6973 2067 656e 6572 616c  yword is general
-0000d850: 6c79 2075 6e6e 6563 6573 7361 7279 2061  ly unnecessary a
-0000d860: 6e64 206d 6f73 746c 7920 7573 6566 756c  nd mostly useful
-0000d870: 2066 6f72 0d0a 2020 2020 7465 7374 696e   for..    testin
-0000d880: 672e 0d0a 0d0a 2020 2020 4e6f 7465 2074  g.....    Note t
-0000d890: 6861 7420 696e 2072 6561 6c69 7374 6963  hat in realistic
-0000d8a0: 2073 6974 7561 7469 6f6e 7320 7468 6520   situations the 
-0000d8b0: 756e 6365 7274 6169 6e74 7920 696e 2074  uncertainty in t
-0000d8c0: 6865 206b 6e6f 776c 6564 6765 2061 6e64  he knowledge and
-0000d8d0: 0d0a 2020 2020 7661 7269 6174 696f 6e73  ..    variations
-0000d8e0: 206f 6620 7468 6520 696e 7472 696e 7369   of the intrinsi
-0000d8f0: 6320 6c69 6e65 2d73 7072 6561 6420 6675  c line-spread fu
-0000d900: 6e63 7469 6f6e 2062 6563 6f6d 6573 2074  nction becomes t
-0000d910: 6865 206c 696d 6974 696e 670d 0a20 2020  he limiting..   
-0000d920: 2066 6163 746f 7220 696e 2072 6563 6f76   factor in recov
-0000d930: 6572 696e 6720 7468 6520 4c4f 5356 4420  ering the LOSVD 
-0000d940: 7765 6c6c 2062 656c 6f77 2060 6076 656c  well below ``vel
-0000d950: 7363 616c 6560 602e 0d0a 7673 7973 743a  scale``...vsyst:
-0000d960: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
-0000d970: 0d0a 2020 2020 5265 6665 7265 6e63 6520  ..    Reference 
-0000d980: 7665 6c6f 6369 7479 2069 6e20 6060 6b6d  velocity in ``km
-0000d990: 2f73 6060 2028 6465 6661 756c 7420 3029  /s`` (default 0)
-0000d9a0: 2e20 5468 6520 696e 7075 7420 696e 6974  . The input init
-0000d9b0: 6961 6c20 6775 6573 7320 616e 640d 0a20  ial guess and.. 
-0000d9c0: 2020 2074 6865 206f 7574 7075 7420 7665     the output ve
-0000d9d0: 6c6f 6369 7469 6573 2061 7265 206d 6561  locities are mea
-0000d9e0: 7375 7265 6420 7769 7468 2072 6573 7065  sured with respe
-0000d9f0: 6374 2074 6f20 7468 6973 2076 656c 6f63  ct to this veloc
-0000da00: 6974 792e 2054 6869 730d 0a20 2020 206b  ity. This..    k
-0000da10: 6579 776f 7264 2063 616e 2062 6520 7573  eyword can be us
-0000da20: 6564 2074 6f20 6163 636f 756e 7420 666f  ed to account fo
-0000da30: 7220 7468 6520 6469 6666 6572 656e 6365  r the difference
-0000da40: 2069 6e20 7468 6520 7374 6172 7469 6e67   in the starting
-0000da50: 0d0a 2020 2020 7761 7665 6c65 6e67 7468  ..    wavelength
-0000da60: 206f 6620 7468 6520 7465 6d70 6c61 7465   of the template
-0000da70: 7320 616e 6420 7468 6520 6761 6c61 7879  s and the galaxy
-0000da80: 2073 7065 6374 7275 6d20 6173 2066 6f6c   spectrum as fol
-0000da90: 6c6f 7773 3a3a 0d0a 0d0a 2020 2020 2020  lows::....      
-0000daa0: 2020 7673 7973 7420 3d20 632a 6e70 2e6c    vsyst = c*np.l
-0000dab0: 6f67 2877 6176 655f 7465 6d70 5b30 5d2f  og(wave_temp[0]/
-0000dac0: 7761 7665 5f67 616c 5b30 5d29 0d0a 0d0a  wave_gal[0])....
-0000dad0: 2020 2020 4173 2061 6c74 6572 6e61 7469      As alternati
-0000dae0: 7665 2074 6f20 7573 696e 6720 7468 6973  ve to using this
-0000daf0: 206b 6579 776f 7264 2c20 6f6e 6520 6361   keyword, one ca
-0000db00: 6e20 7061 7373 2074 6865 2077 6176 656c  n pass the wavel
-0000db10: 656e 6774 6873 0d0a 2020 2020 6060 6c61  engths..    ``la
-0000db20: 6d60 6020 616e 6420 6060 6c61 6d5f 7465  m`` and ``lam_te
-0000db30: 6d70 6060 206f 6620 626f 7468 2074 6865  mp`` of both the
-0000db40: 2060 6067 616c 6178 7960 6020 616e 6420   ``galaxy`` and 
-0000db50: 6060 7465 6d70 6c61 7465 7360 600d 0a20  ``templates``.. 
-0000db60: 2020 2073 7065 6374 7261 2e20 496e 2074     spectra. In t
-0000db70: 6861 7420 6361 7365 2020 6060 7673 7973  hat case  ``vsys
-0000db80: 7460 6020 6973 2063 6f6d 7075 7465 6420  t`` is computed 
-0000db90: 6175 746f 6d61 7469 6361 6c6c 7920 616e  automatically an
-0000dba0: 6420 7368 6f75 6c64 0d0a 2020 2020 6e6f  d should..    no
-0000dbb0: 7420 6265 2067 6976 656e 2e0d 0a0d 0a20  t be given..... 
-0000dbc0: 2020 2054 6865 2076 616c 7565 2061 7373     The value ass
-0000dbd0: 6967 6e65 6420 746f 2074 6869 7320 6b65  igned to this ke
-0000dbe0: 7977 6f72 6420 6973 202a 6372 7563 6961  yword is *crucia
-0000dbf0: 6c2a 2066 6f72 2074 6865 2074 776f 2d73  l* for the two-s
-0000dc00: 6964 6564 0d0a 2020 2020 6669 7474 696e  ided..    fittin
-0000dc10: 672e 2049 6e20 7468 6973 2063 6173 6520  g. In this case 
-0000dc20: 6060 7673 7973 7460 6020 6361 6e20 6265  ``vsyst`` can be
-0000dc30: 2064 6574 6572 6d69 6e65 6420 6672 6f6d   determined from
-0000dc40: 2061 2070 7265 7669 6f75 730d 0a20 2020   a previous..   
-0000dc50: 206e 6f72 6d61 6c20 6f6e 652d 7369 6465   normal one-side
-0000dc60: 6420 6669 7420 746f 2074 6865 2067 616c  d fit to the gal
-0000dc70: 6178 7920 7665 6c6f 6369 7479 2070 726f  axy velocity pro
-0000dc80: 6669 6c65 2e20 4166 7465 7220 7468 6174  file. After that
-0000dc90: 2069 6e69 7469 616c 0d0a 2020 2020 6669   initial..    fi
-0000dca0: 742c 2060 6076 7379 7374 6060 2063 616e  t, ``vsyst`` can
-0000dcb0: 2062 6520 6465 6669 6e65 6420 6173 2074   be defined as t
-0000dcc0: 6865 206d 6561 7375 7265 6420 7665 6c6f  he measured velo
-0000dcd0: 6369 7479 2061 7420 7468 6520 6761 6c61  city at the gala
-0000dce0: 7879 0d0a 2020 2020 6365 6e74 6572 2e20  xy..    center. 
-0000dcf0: 4d6f 7265 2061 6363 7572 6174 656c 7920  More accurately 
-0000dd00: 6060 7673 7973 7460 6020 6973 2074 6865  ``vsyst`` is the
-0000dd10: 2076 616c 7565 2077 6869 6368 2068 6173   value which has
-0000dd20: 2074 6f20 6265 0d0a 2020 2020 7375 6274   to be..    subt
-0000dd30: 7261 6374 6564 2074 6f20 6f62 7461 696e  racted to obtain
-0000dd40: 2061 206e 6561 726c 7920 616e 7469 2d73   a nearly anti-s
-0000dd50: 796d 6d65 7472 6963 2076 656c 6f63 6974  ymmetric velocit
-0000dd60: 7920 7072 6f66 696c 6520 6174 2074 6865  y profile at the
-0000dd70: 0d0a 2020 2020 7477 6f20 6f70 706f 7369  ..    two opposi
-0000dd80: 7465 2073 6964 6573 206f 6620 7468 6520  te sides of the 
-0000dd90: 6761 6c61 7879 206e 7563 6c65 7573 2e0d  galaxy nucleus..
-0000dda0: 0a0d 0a20 2020 2049 4d50 4f52 5441 4e54  ...    IMPORTANT
-0000ddb0: 3a20 7468 6973 2076 616c 7565 2069 7320  : this value is 
-0000ddc0: 6765 6e65 7261 6c6c 7920 2a64 6966 6665  generally *diffe
-0000ddd0: 7265 6e74 2a20 6672 6f6d 2074 6865 2073  rent* from the s
-0000dde0: 7973 7465 6d69 630d 0a20 2020 2076 656c  ystemic..    vel
-0000ddf0: 6f63 6974 7920 6f6e 6520 6361 6e20 6765  ocity one can ge
-0000de00: 7420 6672 6f6d 2074 6865 206c 6974 6572  t from the liter
-0000de10: 6174 7572 652e 2044 6f20 6e6f 7420 7472  ature. Do not tr
-0000de20: 7920 746f 2075 7365 2074 6861 7421 0d0a  y to use that!..
-0000de30: 0d0a 4f75 7470 7574 2050 6172 616d 6574  ..Output Paramet
-0000de40: 6572 730d 0a2d 2d2d 2d2d 2d2d 2d2d 2d2d  ers..-----------
-0000de50: 2d2d 2d2d 2d2d 0d0a 0d0a 5374 6f72 6564  ------....Stored
-0000de60: 2061 7320 6174 7472 6962 7574 6573 206f   as attributes o
-0000de70: 6620 7468 6520 6060 7050 5846 6060 2063  f the ``pPXF`` c
-0000de80: 6c61 7373 3a0d 0a0d 0a2e 6170 6f6c 793a  lass:.....apoly:
-0000de90: 0d0a 2020 2020 5665 6374 6f72 2077 6974  ..    Vector wit
-0000dea0: 6820 7468 6520 6265 7374 2066 6974 7469  h the best fitti
-0000deb0: 6e67 2061 6464 6974 6976 6520 706f 6c79  ng additive poly
-0000dec0: 6e6f 6d69 616c 2e0d 0a2e 6265 7374 6669  nomial....bestfi
-0000ded0: 743a 0d0a 2020 2020 5665 6374 6f72 2077  t:..    Vector w
-0000dee0: 6974 6820 7468 6520 6265 7374 2066 6974  ith the best fit
-0000def0: 7469 6e67 206d 6f64 656c 2066 6f72 2074  ting model for t
-0000df00: 6865 2067 616c 6178 7920 7370 6563 7472  he galaxy spectr
-0000df10: 756d 2e0d 0a20 2020 2054 6869 7320 6973  um...    This is
-0000df20: 2061 206c 696e 6561 7220 636f 6d62 696e   a linear combin
-0000df30: 6174 696f 6e20 6f66 2074 6865 2074 656d  ation of the tem
-0000df40: 706c 6174 6573 2c20 636f 6e76 6f6c 7665  plates, convolve
-0000df50: 6420 7769 7468 2074 6865 2062 6573 740d  d with the best.
-0000df60: 0a20 2020 2066 6974 7469 6e67 204c 4f53  .    fitting LOS
-0000df70: 5644 2c20 6d75 6c74 6970 6c69 6564 2062  VD, multiplied b
-0000df80: 7920 7468 6520 6d75 6c74 6970 6c69 6361  y the multiplica
-0000df90: 7469 7665 2070 6f6c 796e 6f6d 6961 6c73  tive polynomials
-0000dfa0: 2061 6e64 0d0a 2020 2020 7769 7468 2073   and..    with s
-0000dfb0: 7562 7365 7175 656e 746c 7920 6164 6465  ubsequently adde
-0000dfc0: 6420 706f 6c79 6e6f 6d69 616c 2063 6f6e  d polynomial con
-0000dfd0: 7469 6e75 756d 2074 6572 6d73 206f 7220  tinuum terms or 
-0000dfe0: 736b 7920 636f 6d70 6f6e 656e 7473 2e0d  sky components..
-0000dff0: 0a2e 6368 6932 3a0d 0a20 2020 2054 6865  ..chi2:..    The
-0000e000: 2072 6564 7563 6564 2060 6063 6869 5e32   reduced ``chi^2
-0000e010: 6060 2028 6e61 6d65 6c79 2060 6063 6869  `` (namely ``chi
-0000e020: 5e32 2f44 4f46 6060 2920 6f66 2074 6865  ^2/DOF``) of the
-0000e030: 2066 6974 2c20 7768 6572 650d 0a20 2020   fit, where..   
-0000e040: 2060 6044 4f46 203d 2070 702e 646f 6660   ``DOF = pp.dof`
-0000e050: 6020 2028 6170 7072 6f78 696d 6174 656c  `  (approximatel
-0000e060: 7920 6060 444f 4620 7e20 7070 2e67 6f6f  y ``DOF ~ pp.goo
-0000e070: 6470 6978 656c 732e 7369 7a65 6060 292e  dpixels.size``).
-0000e080: 0d0a 0d0a 2020 2020 494d 504f 5254 414e  ....    IMPORTAN
-0000e090: 543a 2069 6620 6060 4368 695e 322f 444f  T: if ``Chi^2/DO
-0000e0a0: 4660 6020 6973 206e 6f74 207e 3120 6974  F`` is not ~1 it
-0000e0b0: 206d 6561 6e73 2074 6861 7420 7468 6520   means that the 
-0000e0c0: 6572 726f 7273 2061 7265 206e 6f74 0d0a  errors are not..
-0000e0d0: 2020 2020 7072 6f70 6572 6c79 2065 7374      properly est
-0000e0e0: 696d 6174 6564 2c20 6f72 2074 6861 7420  imated, or that 
-0000e0f0: 7468 6520 7465 6d70 6c61 7465 2069 7320  the template is 
-0000e100: 6261 6420 616e 6420 6974 2069 7320 2a6e  bad and it is *n
-0000e110: 6f74 2a20 7361 6665 2074 6f0d 0a20 2020  ot* safe to..   
-0000e120: 2073 6574 2074 6865 2060 6063 6c65 616e   set the ``clean
-0000e130: 6060 206b 6579 776f 7264 2e0d 0a2e 6475  `` keyword....du
-0000e140: 7374 3a0d 0a20 2020 204c 6973 7420 6f66  st:..    List of
-0000e150: 2064 6963 7469 6f6e 6172 6965 732c 206f   dictionaries, o
-0000e160: 6e65 2066 6f72 2065 6163 6820 6669 7474  ne for each fitt
-0000e170: 6564 206a 2d74 6820 6475 7374 2063 6f6d  ed j-th dust com
-0000e180: 706f 6e65 6e74 2e20 466f 720d 0a20 2020  ponent. For..   
-0000e190: 2065 6163 6820 6469 6374 696f 6e61 7279   each dictionary
-0000e1a0: 2c20 6060 6475 7374 5f6a 5b22 736f 6c22  , ``dust_j["sol"
-0000e1b0: 5d60 6020 636f 6e74 6169 6e73 2074 6865  ]`` contains the
-0000e1c0: 2062 6573 742d 6669 7474 696e 670d 0a20   best-fitting.. 
-0000e1d0: 2020 2070 6172 616d 6574 6572 206f 6620     parameter of 
-0000e1e0: 7468 6520 6174 7465 6e75 6174 696f 6e20  the attenuation 
-0000e1f0: 6375 7276 6520 6f66 2074 6861 7420 6475  curve of that du
-0000e200: 7374 2063 6f6d 706f 6e65 6e74 2e20 5468  st component. Th
-0000e210: 6520 6f74 6865 720d 0a20 2020 2066 6965  e other..    fie
-0000e220: 6c64 206f 6620 7468 6520 6469 6374 696f  ld of the dictio
-0000e230: 6e61 7279 2061 7265 2063 6f70 6965 6420  nary are copied 
-0000e240: 6672 6f6d 2074 6865 2069 6e70 7574 2074  from the input t
-0000e250: 6f20 7468 6520 6b65 7977 6f72 640d 0a20  o the keyword.. 
-0000e260: 2020 2060 6064 7573 7460 602e 0d0a 2e65     ``dust``....e
-0000e270: 7272 6f72 3a0d 0a20 2020 2054 6869 7320  rror:..    This 
-0000e280: 7661 7269 6162 6c65 2063 6f6e 7461 696e  variable contain
-0000e290: 7320 6120 7665 6374 6f72 206f 6620 2a66  s a vector of *f
-0000e2a0: 6f72 6d61 6c2a 2075 6e63 6572 7461 696e  ormal* uncertain
-0000e2b0: 7479 2028 6060 312a 7369 676d 6160 6029  ty (``1*sigma``)
-0000e2c0: 0d0a 2020 2020 666f 7220 7468 6520 6669  ..    for the fi
-0000e2d0: 7474 6564 2070 6172 616d 6574 6572 7320  tted parameters 
-0000e2e0: 696e 2074 6865 206f 7574 7075 7420 7665  in the output ve
-0000e2f0: 6374 6f72 2060 6073 6f6c 6060 2e0d 0a20  ctor ``sol``... 
-0000e300: 2020 2054 6865 7920 6172 6520 636f 6d70     They are comp
-0000e310: 7574 6564 2066 726f 6d20 7468 6520 6573  uted from the es
-0000e320: 7469 6d61 7465 6420 636f 7661 7269 616e  timated covarian
-0000e330: 6365 206d 6174 7269 7820 6f66 2074 6865  ce matrix of the
-0000e340: 2073 7461 6e64 6172 640d 0a20 2020 2065   standard..    e
-0000e350: 7272 6f72 7320 696e 2074 6865 2066 6974  rrors in the fit
-0000e360: 7465 6420 7061 7261 6d65 7465 7273 2061  ted parameters a
-0000e370: 7373 756d 696e 6720 6974 2069 7320 6469  ssuming it is di
-0000e380: 6167 6f6e 616c 2061 7420 7468 6520 6d69  agonal at the mi
-0000e390: 6e69 6d75 6d2e 0d0a 2020 2020 5468 6973  nimum...    This
-0000e3a0: 206f 7074 696f 6e20 6361 6e20 6265 2075   option can be u
-0000e3b0: 7365 6420 7768 656e 2073 7065 6564 2069  sed when speed i
-0000e3c0: 7320 6573 7365 6e74 6961 6c2c 2074 6f20  s essential, to 
-0000e3d0: 6f62 7461 696e 2061 6e20 6f72 6465 7220  obtain an order 
-0000e3e0: 6f66 0d0a 2020 2020 6d61 676e 6974 7564  of..    magnitud
-0000e3f0: 6520 6573 7469 6d61 7465 206f 6620 7468  e estimate of th
-0000e400: 6520 756e 6365 7274 6169 6e74 6965 732c  e uncertainties,
-0000e410: 2062 7574 2077 6520 2a73 7472 6f6e 676c   but we *strongl
-0000e420: 792a 2072 6563 6f6d 6d65 6e64 2074 6f0d  y* recommend to.
-0000e430: 0a20 2020 2072 756e 2062 6f6f 7473 7472  .    run bootstr
-0000e440: 6170 7069 6e67 2073 696d 756c 6174 696f  apping simulatio
-0000e450: 6e73 2074 6f20 6f62 7461 696e 206d 6f72  ns to obtain mor
-0000e460: 6520 7265 6c69 6162 6c65 2065 7272 6f72  e reliable error
-0000e470: 732e 2049 6e20 6661 6374 2c0d 0a20 2020  s. In fact,..   
-0000e480: 2074 6865 7365 2065 7272 6f72 7320 6361   these errors ca
-0000e490: 6e20 6265 2073 6576 6572 656c 7920 756e  n be severely un
-0000e4a0: 6465 7265 7374 696d 6174 6564 2069 6e20  derestimated in 
-0000e4b0: 7468 6520 7265 6769 6f6e 2077 6865 7265  the region where
-0000e4c0: 2074 6865 0d0a 2020 2020 7065 6e61 6c74   the..    penalt
-0000e4d0: 7920 6566 6665 6374 2069 7320 6d6f 7374  y effect is most
-0000e4e0: 2069 6d70 6f72 7461 6e74 2028 6060 7369   important (``si
-0000e4f0: 676d 6120 3c20 322a 7665 6c73 6361 6c65  gma < 2*velscale
-0000e500: 6060 292e 0d0a 0d0a 2020 2020 5468 6573  ``).....    Thes
-0000e510: 6520 6572 726f 7273 2061 7265 206d 6561  e errors are mea
-0000e520: 6e69 6e67 6c65 7373 2075 6e6c 6573 7320  ningless unless 
-0000e530: 6060 4368 695e 322f 444f 4620 7e20 3160  ``Chi^2/DOF ~ 1`
-0000e540: 602e 2048 6f77 6576 6572 2069 6620 6f6e  `. However if on
-0000e550: 650d 0a20 2020 202a 6173 7375 6d65 732a  e..    *assumes*
-0000e560: 2074 6861 7420 7468 6520 6669 7420 6973   that the fit is
-0000e570: 2067 6f6f 642c 2061 2063 6f72 7265 6374   good, a correct
-0000e580: 6564 2065 7374 696d 6174 6520 6f66 2074  ed estimate of t
-0000e590: 6865 2065 7272 6f72 7320 6973 3a3a 0d0a  he errors is::..
-0000e5a0: 0d0a 2020 2020 2020 2020 6572 726f 725f  ..        error_
-0000e5b0: 636f 7272 203d 2065 7272 6f72 2a73 7172  corr = error*sqr
-0000e5c0: 7428 6368 695e 322f 444f 4629 203d 2070  t(chi^2/DOF) = p
-0000e5d0: 702e 6572 726f 722a 7371 7274 2870 702e  p.error*sqrt(pp.
-0000e5e0: 6368 6932 292e 0d0a 0d0a 2020 2020 494d  chi2).....    IM
-0000e5f0: 504f 5254 414e 543a 2077 6865 6e20 7275  PORTANT: when ru
-0000e600: 6e6e 696e 6720 4d6f 6e74 6520 4361 726c  nning Monte Carl
-0000e610: 6f20 7369 6d75 6c61 7469 6f6e 7320 746f  o simulations to
-0000e620: 2064 6574 6572 6d69 6e65 2074 6865 2065   determine the e
-0000e630: 7272 6f72 2c0d 0a20 2020 2074 6865 2070  rror,..    the p
-0000e640: 656e 616c 7479 2028 6060 6269 6173 6060  enalty (``bias``
-0000e650: 2920 7368 6f75 6c64 2062 6520 7365 7420  ) should be set 
-0000e660: 746f 207a 6572 6f2c 206f 7220 6265 7474  to zero, or bett
-0000e670: 6572 2074 6f20 6120 7665 7279 2073 6d61  er to a very sma
-0000e680: 6c6c 0d0a 2020 2020 7661 6c75 652e 2053  ll..    value. S
-0000e690: 6565 2053 6563 7469 6f6e 2033 2e34 206f  ee Section 3.4 o
-0000e6a0: 6620 6043 6170 7065 6c6c 6172 6920 2620  f `Cappellari & 
-0000e6b0: 456d 7365 6c6c 656d 2028 3230 3034 2960  Emsellem (2004)`
-0000e6c0: 5f20 666f 7220 616e 0d0a 2020 2020 6578  _ for an..    ex
-0000e6d0: 706c 616e 6174 696f 6e2e 0d0a 2e67 6173  planation....gas
-0000e6e0: 5f62 6573 7466 6974 3a0d 0a20 2020 2049  _bestfit:..    I
-0000e6f0: 6620 6060 6761 735f 636f 6d70 6f6e 656e  f ``gas_componen
-0000e700: 7420 6973 206e 6f74 204e 6f6e 6560 602c  t is not None``,
-0000e710: 2074 6869 7320 6174 7472 6962 7574 6520   this attribute 
-0000e720: 7265 7475 726e 7320 7468 650d 0a20 2020  returns the..   
-0000e730: 2062 6573 742d 6669 7474 696e 6720 6761   best-fitting ga
-0000e740: 7320 656d 6973 7369 6f6e 2d6c 696e 6573  s emission-lines
-0000e750: 2073 7065 6374 7275 6d20 616c 6f6e 652e   spectrum alone.
-0000e760: 0d0a 2020 2020 5468 6520 6265 7374 2d66  ..    The best-f
-0000e770: 6974 7469 6e67 2073 7465 6c6c 6172 2073  itting stellar s
-0000e780: 7065 6374 7275 6d20 616c 6f6e 6520 6361  pectrum alone ca
-0000e790: 6e20 6265 2063 6f6d 7075 7465 6420 6173  n be computed as
-0000e7a0: 0d0a 2020 2020 6060 7374 6172 735f 6265  ..    ``stars_be
-0000e7b0: 7374 6669 7420 3d20 7070 2e62 6573 7466  stfit = pp.bestf
-0000e7c0: 6974 202d 2070 702e 6761 735f 6265 7374  it - pp.gas_best
-0000e7d0: 6669 7460 600d 0a2e 6761 735f 6265 7374  fit``...gas_best
-0000e7e0: 6669 745f 7465 6d70 6c61 7465 733a 0d0a  fit_templates:..
-0000e7f0: 2020 2020 4966 2060 6067 6173 5f63 6f6d      If ``gas_com
-0000e800: 706f 6e65 6e74 2069 7320 6e6f 7420 4e6f  ponent is not No
-0000e810: 6e65 6060 2c20 7468 6973 2061 7474 7269  ne``, this attri
-0000e820: 6275 7465 2072 6574 7572 6e73 2074 6865  bute returns the
-0000e830: 2069 6e64 6976 6964 7561 6c0d 0a20 2020   individual..   
-0000e840: 2062 6573 742d 6669 7474 696e 6720 6761   best-fitting ga
-0000e850: 7320 656d 6973 7369 6f6e 2d6c 696e 6573  s emission-lines
-0000e860: 2074 656d 706c 6174 6573 2061 7320 636f   templates as co
-0000e870: 6c75 6d6e 7320 6f66 2061 6e20 6172 7261  lumns of an arra
-0000e880: 792e 0d0a 2020 2020 4e6f 7465 2074 6861  y...    Note tha
-0000e890: 7420 6060 7070 2e67 6173 5f62 6573 7466  t ``pp.gas_bestf
-0000e8a0: 6974 203d 2070 702e 6761 735f 6265 7374  it = pp.gas_best
-0000e8b0: 6669 745f 7465 6d70 6c61 7465 732e 7375  fit_templates.su
-0000e8c0: 6d28 3129 6060 0d0a 2e67 6173 5f66 6c75  m(1)``...gas_flu
-0000e8d0: 783a 0d0a 2020 2020 5665 6374 6f72 2077  x:..    Vector w
-0000e8e0: 6974 6820 7468 6520 696e 7465 6772 6174  ith the integrat
-0000e8f0: 6564 2066 6c75 7820 2869 6e20 636f 756e  ed flux (in coun
-0000e900: 7473 2920 6f66 2061 6c6c 206c 696e 6573  ts) of all lines
-0000e910: 2073 6574 2061 730d 0a20 2020 2060 6054   set as..    ``T
-0000e920: 7275 6560 6020 696e 2074 6865 2069 6e70  rue`` in the inp
-0000e930: 7574 2060 6067 6173 5f63 6f6d 706f 6e65  ut ``gas_compone
-0000e940: 6e74 6060 206b 6579 776f 7264 2e20 5468  nt`` keyword. Th
-0000e950: 6973 2069 7320 7468 6520 666c 7578 206f  is is the flux o
-0000e960: 660d 0a20 2020 2069 6e64 6976 6964 7561  f..    individua
-0000e970: 6c20 6761 7320 7465 6d70 6c61 7465 732c  l gas templates,
-0000e980: 2077 6869 6368 206d 6179 2069 6e63 6c75   which may inclu
-0000e990: 6465 206d 756c 7469 706c 6520 6c69 6e65  de multiple line
-0000e9a0: 732e 0d0a 2020 2020 5468 6973 2069 6d70  s...    This imp
-0000e9b0: 6c69 6573 2074 6861 742c 2069 6620 6120  lies that, if a 
-0000e9c0: 6761 7320 7465 6d70 6c61 7465 2064 6573  gas template des
-0000e9d0: 6372 6962 6573 2061 2064 6f75 626c 6574  cribes a doublet
-0000e9e0: 2c20 7468 6520 666c 7578 2069 730d 0a20  , the flux is.. 
-0000e9f0: 2020 2074 6861 7420 6f66 2062 6f74 6820     that of both 
-0000ea00: 6c69 6e65 732e 2049 6620 7468 6520 4261  lines. If the Ba
-0000ea10: 6c6d 6572 2073 6572 6965 7320 6973 2069  lmer series is i
-0000ea20: 6e70 7574 2061 7320 6120 7369 6e67 6c65  nput as a single
-0000ea30: 2074 656d 706c 6174 652c 0d0a 2020 2020   template,..    
-0000ea40: 7468 6973 2069 7320 7468 6520 666c 7578  this is the flux
-0000ea50: 206f 6620 7468 6520 656e 7469 7265 2073   of the entire s
-0000ea60: 6572 6965 732e 0d0a 0d0a 2020 2020 5468  eries.....    Th
-0000ea70: 6520 7265 7475 726e 6564 2066 6c75 7865  e returned fluxe
-0000ea80: 7320 6172 6520 6e6f 7420 636f 7272 6563  s are not correc
-0000ea90: 7465 6420 696e 2061 6e79 2077 6179 2061  ted in any way a
-0000eaa0: 6e64 2069 6e20 7061 7274 6963 756c 6172  nd in particular
-0000eab0: 2c20 6e6f 0d0a 2020 2020 7265 6464 656e  , no..    redden
-0000eac0: 696e 6720 636f 7272 6563 7469 6f6e 2069  ing correction i
-0000ead0: 7320 6170 706c 6965 642e 2049 6e20 6f74  s applied. In ot
-0000eae0: 6865 7220 776f 7264 732c 2074 6865 2072  her words, the r
-0000eaf0: 6574 7572 6e65 640d 0a20 2020 2060 602e  eturned..    ``.
-0000eb00: 6761 735f 666c 7578 6060 2073 686f 756c  gas_flux`` shoul
-0000eb10: 6420 6265 2075 6e63 6861 6e67 6564 2c20  d be unchanged, 
-0000eb20: 7769 7468 696e 2074 6865 2065 7272 6f72  within the error
-0000eb30: 732c 2072 6567 6172 646c 6573 7320 6f66  s, regardless of
-0000eb40: 0d0a 2020 2020 7768 6574 6865 7220 7265  ..    whether re
-0000eb50: 6464 656e 696e 6720 6f72 206d 756c 7469  ddening or multi
-0000eb60: 706c 6963 6174 6976 6520 706f 6c79 6e6f  plicative polyno
-0000eb70: 6d69 616c 7320 7765 7265 2066 6974 7465  mials were fitte
-0000eb80: 6420 6279 2060 6070 5058 4660 600d 0a20  d by ``pPXF``.. 
-0000eb90: 2020 206f 7220 6e6f 742e 0d0a 0d0a 2020     or not.....  
-0000eba0: 2020 494d 504f 5254 414e 543a 2060 6070    IMPORTANT: ``p
-0000ebb0: 5058 4660 6020 6d61 6b65 7320 6e6f 2061  PXF`` makes no a
-0000ebc0: 7373 756d 7074 696f 6e73 2061 626f 7574  ssumptions about
-0000ebd0: 2074 6865 2069 6e70 7574 2066 6c75 7820   the input flux 
-0000ebe0: 756e 6974 733a 0d0a 2020 2020 5468 6520  units:..    The 
-0000ebf0: 7265 7475 726e 6564 2060 602e 6761 735f  returned ``.gas_
-0000ec00: 666c 7578 6060 2068 6173 2074 6865 2073  flux`` has the s
-0000ec10: 616d 6520 756e 6974 7320 616e 6420 7661  ame units and va
-0000ec20: 6c75 6573 206f 6e65 2077 6f75 6c64 0d0a  lues one would..
-0000ec30: 2020 2020 6d65 6173 7572 6520 2877 6974      measure (wit
-0000ec40: 6820 6c6f 7765 7220 6163 6375 7261 6379  h lower accuracy
-0000ec50: 2920 6279 2073 756d 6d69 6e67 2074 6865  ) by summing the
-0000ec60: 2070 6978 656c 7320 7661 6c75 6573 2c20   pixels values, 
-0000ec70: 7769 7468 696e 2074 6865 0d0a 2020 2020  within the..    
-0000ec80: 6769 7665 6e20 6761 7320 6c69 6e65 732c  given gas lines,
-0000ec90: 206f 6e20 7468 6520 636f 6e74 696e 7575   on the continuu
-0000eca0: 6d2d 7375 6274 7261 6374 6564 2069 6e70  m-subtracted inp
-0000ecb0: 7574 2067 616c 6178 7920 7370 6563 7472  ut galaxy spectr
-0000ecc0: 756d 2e0d 0a20 2020 2054 6869 7320 696d  um...    This im
-0000ecd0: 706c 6965 7320 7468 6174 2c20 6966 2074  plies that, if t
-0000ece0: 6865 2073 7065 6374 7275 6d20 6973 2069  he spectrum is i
-0000ecf0: 6e20 756e 6974 7320 6f66 2060 6065 7267  n units of ``erg
-0000ed00: 2f28 7320 636d 5e32 2041 2960 602c 0d0a  /(s cm^2 A)``,..
-0000ed10: 2020 2020 7468 6520 6060 2e67 6173 5f66      the ``.gas_f
-0000ed20: 6c75 7860 6020 7265 7475 726e 6564 2062  lux`` returned b
-0000ed30: 7920 6060 7050 5846 6060 2073 686f 756c  y ``pPXF`` shoul
-0000ed40: 6420 6265 206d 756c 7469 706c 6965 6420  d be multiplied 
-0000ed50: 6279 2074 6865 0d0a 2020 2020 7069 7865  by the..    pixe
-0000ed60: 6c20 7369 7a65 2069 6e20 416e 6773 7472  l size in Angstr
-0000ed70: 6f6d 2061 7420 7468 6520 6c69 6e65 2077  om at the line w
-0000ed80: 6176 656c 656e 6774 6820 746f 206f 6274  avelength to obt
-0000ed90: 6169 6e20 7468 6520 696e 7465 6772 6174  ain the integrat
-0000eda0: 6564 0d0a 2020 2020 6c69 6e65 2066 6c75  ed..    line flu
-0000edb0: 7820 696e 2075 6e69 7473 206f 6620 6060  x in units of ``
-0000edc0: 6572 672f 2873 2063 6d5e 3229 6060 2e0d  erg/(s cm^2)``..
-0000edd0: 0a0d 0a20 2020 204e 4f54 453a 2049 6620  ...    NOTE: If 
-0000ede0: 7468 6572 6520 6973 206e 6f20 6761 7320  there is no gas 
-0000edf0: 7265 6464 656e 696e 6720 616e 6420 6561  reddening and ea
-0000ee00: 6368 2069 6e70 7574 2067 6173 2074 656d  ch input gas tem
-0000ee10: 706c 6174 6520 7761 730d 0a20 2020 206e  plate was..    n
-0000ee20: 6f72 6d61 6c69 7a65 6420 746f 2060 6073  ormalized to ``s
-0000ee30: 756d 203d 2031 6060 2c20 7468 656e 0d0a  um = 1``, then..
-0000ee40: 2020 2020 6060 7070 2e67 6173 5f66 6c75      ``pp.gas_flu
-0000ee50: 7820 3d20 7070 2e77 6569 6768 7473 5b70  x = pp.weights[p
-0000ee60: 702e 6761 735f 636f 6d70 6f6e 656e 745d  p.gas_component]
-0000ee70: 6060 2e0d 0a0d 0a20 2020 2057 6865 6e20  ``.....    When 
-0000ee80: 6120 6761 7320 7465 6d70 6c61 7465 2069  a gas template i
-0000ee90: 7320 6964 656e 7469 6361 6c6c 7920 7a65  s identically ze
-0000eea0: 726f 2077 6974 6869 6e20 7468 6520 6669  ro within the fi
-0000eeb0: 7474 6564 2072 6567 696f 6e2c 2074 6865  tted region, the
-0000eec0: 6e0d 0a20 2020 2060 6070 702e 6761 735f  n..    ``pp.gas_
-0000eed0: 666c 7578 203d 2070 702e 6761 735f 666c  flux = pp.gas_fl
-0000eee0: 7578 5f65 7272 6f72 203d 206e 702e 6e61  ux_error = np.na
-0000eef0: 6e60 602e 2054 6865 2063 6f72 7265 7370  n``. The corresp
-0000ef00: 6f6e 6469 6e67 0d0a 2020 2020 636f 6d70  onding..    comp
-0000ef10: 6f6e 656e 7473 206f 6620 6060 7070 2e67  onents of ``pp.g
-0000ef20: 6173 5f7a 6572 6f5f 7465 6d70 6c61 7465  as_zero_template
-0000ef30: 6060 2061 7265 2073 6574 2074 6f20 6060  `` are set to ``
-0000ef40: 5472 7565 6060 2e20 5468 6573 650d 0a20  True``. These.. 
-0000ef50: 2020 2060 606e 702e 6e61 6e60 6020 7661     ``np.nan`` va
-0000ef60: 6c75 6573 2061 7265 2073 6574 2061 7420  lues are set at 
-0000ef70: 7468 6520 656e 6420 6f66 2074 6865 2063  the end of the c
-0000ef80: 616c 6375 6c61 7469 6f6e 2074 6f20 666c  alculation to fl
-0000ef90: 6167 2074 6865 0d0a 2020 2020 756e 6465  ag the..    unde
-0000efa0: 6669 6e65 6420 7661 6c75 6573 2e20 5468  fined values. Th
-0000efb0: 6573 6520 666c 6167 7320 6765 6e65 7261  ese flags genera
-0000efc0: 6c6c 7920 696e 6469 6361 7465 2074 6861  lly indicate tha
-0000efd0: 7420 736f 6d65 206f 6620 7468 6520 6761  t some of the ga
-0000efe0: 730d 0a20 2020 2074 656d 706c 6174 6573  s..    templates
-0000eff0: 2070 6173 7365 6420 746f 2060 6070 5058   passed to ``pPX
-0000f000: 4660 6020 636f 6e73 6973 7420 6f66 2067  F`` consist of g
-0000f010: 6173 2065 6d69 7373 696f 6e20 6c69 6e65  as emission line
-0000f020: 7320 7468 6174 2066 616c 6c0d 0a20 2020  s that fall..   
-0000f030: 206f 7574 7369 6465 2074 6865 2066 6974   outside the fit
-0000f040: 7465 6420 7761 7665 6c65 6e67 7468 2072  ted wavelength r
-0000f050: 616e 6765 206f 7220 7769 7468 696e 2061  ange or within a
-0000f060: 206d 6173 6b65 6420 7370 6563 7472 616c   masked spectral
-0000f070: 2072 6567 696f 6e2e 0d0a 2020 2020 5468   region...    Th
-0000f080: 6573 6520 6060 6e70 2e6e 616e 6060 2064  ese ``np.nan`` d
-0000f090: 6f20 2a6e 6f74 2a20 696e 6469 6361 7465  o *not* indicate
-0000f0a0: 206e 756d 6572 6963 616c 2069 7373 7565   numerical issue
-0000f0b0: 7320 7769 7468 2074 6865 2061 6374 7561  s with the actua
-0000f0c0: 6c0d 0a20 2020 2060 6070 5058 4660 6020  l..    ``pPXF`` 
-0000f0d0: 6361 6c63 756c 6174 696f 6e20 616e 6420  calculation and 
-0000f0e0: 7468 6520 7265 7374 206f 6620 7468 6520  the rest of the 
-0000f0f0: 6060 7050 5846 6060 206f 7574 7075 7420  ``pPXF`` output 
-0000f100: 6973 2072 656c 6961 626c 652e 0d0a 2e67  is reliable....g
-0000f110: 6173 5f66 6c75 785f 6572 726f 723a 0d0a  as_flux_error:..
-0000f120: 2020 2020 2a46 6f72 6d61 6c2a 2075 6e63      *Formal* unc
-0000f130: 6572 7461 696e 7479 2028 6060 312a 7369  ertainty (``1*si
-0000f140: 676d 6160 6029 2066 6f72 2074 6865 2071  gma``) for the q
-0000f150: 7561 6e74 6974 7920 6060 7070 2e67 6173  uantity ``pp.gas
-0000f160: 5f66 6c75 7860 602c 2069 6e0d 0a20 2020  _flux``, in..   
-0000f170: 2074 6865 2073 616d 6520 756e 6974 7320   the same units 
-0000f180: 6173 2074 6865 2067 6173 2066 6c75 7865  as the gas fluxe
-0000f190: 732e 0d0a 0d0a 2020 2020 5468 6973 2065  s.....    This e
-0000f1a0: 7272 6f72 2069 7320 6170 7072 6f78 696d  rror is approxim
-0000f1b0: 6174 6520 6173 2069 7420 6967 6e6f 7265  ate as it ignore
-0000f1c0: 7320 7468 6520 636f 7661 7269 616e 6365  s the covariance
-0000f1d0: 2062 6574 7765 656e 2074 6865 2067 6173   between the gas
-0000f1e0: 0d0a 2020 2020 666c 7578 2061 6e64 2061  ..    flux and a
-0000f1f0: 6e79 206e 6f6e 2d6c 696e 6561 7220 7061  ny non-linear pa
-0000f200: 7261 6d65 7465 722e 2042 6f6f 7473 7472  rameter. Bootstr
-0000f210: 6170 7069 6e67 2063 616e 2062 6520 7573  apping can be us
-0000f220: 6564 2066 6f72 206d 6f72 650d 0a20 2020  ed for more..   
-0000f230: 2061 6363 7572 6174 6520 6572 726f 7273   accurate errors
-0000f240: 2e0d 0a0d 0a20 2020 2054 6865 7365 2065  .....    These e
-0000f250: 7272 6f72 7320 6172 6520 6d65 616e 696e  rrors are meanin
-0000f260: 676c 6573 7320 756e 6c65 7373 2060 6043  gless unless ``C
-0000f270: 6869 5e32 2f44 4f46 207e 2031 6060 2e20  hi^2/DOF ~ 1``. 
-0000f280: 486f 7765 7665 7220 6966 206f 6e65 0d0a  However if one..
-0000f290: 2020 2020 2a61 7373 756d 6573 2a20 7468      *assumes* th
-0000f2a0: 6174 2074 6865 2066 6974 2069 7320 676f  at the fit is go
-0000f2b0: 6f64 2c20 6120 636f 7272 6563 7465 6420  od, a corrected 
-0000f2c0: 6573 7469 6d61 7465 206f 6620 7468 6520  estimate of the 
-0000f2d0: 6572 726f 7273 2069 733a 3a0d 0a0d 0a20  errors is::.... 
-0000f2e0: 2020 2020 2020 2067 6173 5f66 6c75 785f         gas_flux_
-0000f2f0: 6572 726f 725f 636f 7272 203d 2067 6173  error_corr = gas
-0000f300: 5f66 6c75 785f 6572 726f 722a 7371 7274  _flux_error*sqrt
-0000f310: 2863 6869 5e32 2f44 4f46 290d 0a20 2020  (chi^2/DOF)..   
-0000f320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f330: 2020 2020 2020 2020 203d 2070 702e 6761           = pp.ga
-0000f340: 735f 666c 7578 5f65 7272 6f72 2a73 7172  s_flux_error*sqr
-0000f350: 7428 7070 2e63 6869 3229 2e0d 0a0d 0a2e  t(pp.chi2)......
-0000f360: 6761 735f 6d70 6f6c 793a 0d0a 2020 2020  gas_mpoly:..    
-0000f370: 7665 6374 6f72 2077 6974 6820 7468 6520  vector with the 
-0000f380: 6265 7374 2d66 6974 7469 6e67 2067 6173  best-fitting gas
-0000f390: 2072 6564 6465 6e69 6e67 2063 7572 7665   reddening curve
-0000f3a0: 2e0d 0a2e 6761 735f 7265 6464 656e 696e  ....gas_reddenin
-0000f3b0: 673a 0d0a 2020 2020 4265 7374 2066 6974  g:..    Best fit
-0000f3c0: 7469 6e67 2060 6041 5f56 6060 2076 616c  ting ``A_V`` val
-0000f3d0: 7565 2069 6620 7468 6520 6060 6761 735f  ue if the ``gas_
-0000f3e0: 7265 6464 656e 696e 6760 6020 6b65 7977  reddening`` keyw
-0000f3f0: 6f72 6420 6973 2073 6574 2e0d 0a20 2020  ord is set...   
-0000f400: 2054 6869 7320 6973 2065 7370 6563 6961   This is especia
-0000f410: 6c6c 7920 7573 6566 756c 2077 6865 6e20  lly useful when 
-0000f420: 7468 6520 4261 6c6d 6572 2073 6572 6965  the Balmer serie
-0000f430: 7320 6973 2069 6e70 7574 2061 7320 6120  s is input as a 
-0000f440: 7369 6e67 6c65 0d0a 2020 2020 7465 6d70  single..    temp
-0000f450: 6c61 7465 2077 6974 6820 616e 2061 7373  late with an ass
-0000f460: 756d 6564 2074 6865 6f72 6574 6963 616c  umed theoretical
-0000f470: 6c79 2070 7265 6469 6374 6564 2064 6563  ly predicted dec
-0000f480: 7265 6d65 6e74 2065 2e67 2e20 7573 696e  rement e.g. usin
-0000f490: 670d 0a20 2020 2060 6065 6d69 7373 696f  g..    ``emissio
-0000f4a0: 6e5f 6c69 6e65 7328 2e2e 2e2c 2074 6965  n_lines(..., tie
-0000f4b0: 5f62 616c 6d65 723d 5472 7565 2960 6020  _balmer=True)`` 
-0000f4c0: 696e 2060 6070 7078 662e 7070 7866 5f75  in ``ppxf.ppxf_u
-0000f4d0: 7469 6c60 6020 746f 0d0a 2020 2020 636f  til`` to..    co
-0000f4e0: 6d70 7574 6520 7468 6520 6761 7320 7465  mpute the gas te
-0000f4f0: 6d70 6c61 7465 732e 0d0a 2e67 6173 5f7a  mplates....gas_z
-0000f500: 6572 6f5f 7465 6d70 6c61 7465 3a0d 0a20  ero_template:.. 
-0000f510: 2020 2076 6563 746f 7220 6f66 2073 697a     vector of siz
-0000f520: 6520 6060 6761 735f 636f 6d70 6f6e 656e  e ``gas_componen
-0000f530: 742e 7375 6d28 2960 6020 7365 7420 746f  t.sum()`` set to
-0000f540: 2060 6054 7275 6560 6020 7768 6572 650d   ``True`` where.
-0000f550: 0a20 2020 2074 6865 2067 6173 2074 656d  .    the gas tem
-0000f560: 706c 6174 6520 7761 7320 6964 656e 7469  plate was identi
-0000f570: 6361 6c6c 7920 7a65 726f 2077 6974 6869  cally zero withi
-0000f580: 6e20 7468 6520 6669 7474 6564 2072 6567  n the fitted reg
-0000f590: 696f 6e2e 0d0a 2020 2020 466f 7220 7468  ion...    For th
-0000f5a0: 6f73 6520 6761 7320 636f 6d70 6f6e 656e  ose gas componen
-0000f5b0: 7473 2060 6070 702e 6761 735f 666c 7578  ts ``pp.gas_flux
-0000f5c0: 203d 2070 702e 6761 735f 666c 7578 5f65   = pp.gas_flux_e
-0000f5d0: 7272 6f72 203d 206e 702e 6e61 6e60 602e  rror = np.nan``.
-0000f5e0: 0d0a 2020 2020 5468 6573 6520 666c 6167  ..    These flag
-0000f5f0: 7320 6765 6e65 7261 6c6c 7920 696e 6469  s generally indi
-0000f600: 6361 7465 2074 6861 7420 736f 6d65 206f  cate that some o
-0000f610: 6620 7468 6520 6761 7320 7465 6d70 6c61  f the gas templa
-0000f620: 7465 7320 7061 7373 6564 2074 6f0d 0a20  tes passed to.. 
-0000f630: 2020 2060 6070 5058 4660 6020 636f 6e73     ``pPXF`` cons
-0000f640: 6973 7420 6f66 2067 6173 2065 6d69 7373  ist of gas emiss
-0000f650: 696f 6e20 6c69 6e65 7320 7468 6174 2066  ion lines that f
-0000f660: 616c 6c20 6f75 7473 6964 6520 7468 6520  all outside the 
-0000f670: 6669 7474 6564 0d0a 2020 2020 7761 7665  fitted..    wave
-0000f680: 6c65 6e67 7468 2072 616e 6765 206f 7220  length range or 
-0000f690: 7769 7468 696e 2061 206d 6173 6b65 6420  within a masked 
-0000f6a0: 7370 6563 7472 616c 2072 6567 696f 6e2e  spectral region.
-0000f6b0: 0d0a 2e67 6f6f 6470 6978 656c 733a 0d0a  ...goodpixels:..
-0000f6c0: 2020 2020 496e 7465 6765 7220 7665 6374      Integer vect
-0000f6d0: 6f72 2063 6f6e 7461 696e 696e 6720 7468  or containing th
-0000f6e0: 6520 696e 6469 6365 7320 6f66 2074 6865  e indices of the
-0000f6f0: 2067 6f6f 6420 7069 7865 6c73 2069 6e20   good pixels in 
-0000f700: 7468 6520 6669 742e 0d0a 2020 2020 5468  the fit...    Th
-0000f710: 6973 2076 6563 746f 7220 6973 2061 2063  is vector is a c
-0000f720: 6f70 7920 6f66 2074 6865 2069 6e70 7574  opy of the input
-0000f730: 2060 6067 6f6f 6470 6978 656c 7360 6020   ``goodpixels`` 
-0000f740: 6966 2060 6063 6c65 616e 203d 2046 616c  if ``clean = Fal
-0000f750: 7365 6060 0d0a 2020 2020 6f74 6865 7277  se``..    otherw
-0000f760: 6973 6520 6974 2077 696c 6c20 6265 2075  ise it will be u
-0000f770: 7064 6174 6564 2062 7920 7265 6d6f 7669  pdated by removi
-0000f780: 6e67 2074 6865 2064 6574 6563 7465 6420  ng the detected 
-0000f790: 6f75 746c 6965 7273 2e0d 0a2e 6d61 7472  outliers....matr
-0000f7a0: 6978 3a0d 0a20 2020 2050 7265 6469 6374  ix:..    Predict
-0000f7b0: 696f 6e20 6060 6d61 7472 6978 5b6e 5f70  ion ``matrix[n_p
-0000f7c0: 6978 656c 732c 2064 6567 7265 6520 2b20  ixels, degree + 
-0000f7d0: 6e5f 7465 6d70 6c61 7465 7320 2b20 6e5f  n_templates + n_
-0000f7e0: 736b 795d 6060 206f 6620 7468 650d 0a20  sky]`` of the.. 
-0000f7f0: 2020 206c 696e 6561 7220 7379 7374 656d     linear system
-0000f800: 2e0d 0a0d 0a20 2020 2060 6070 702e 6d61  .....    ``pp.ma
-0000f810: 7472 6978 5b6e 5f70 6978 656c 732c 203a  trix[n_pixels, :
-0000f820: 2064 6567 7265 655d 6060 2063 6f6e 7461   degree]`` conta
-0000f830: 696e 7320 7468 6520 6164 6469 7469 7665  ins the additive
-0000f840: 2070 6f6c 796e 6f6d 6961 6c73 2069 660d   polynomials if.
-0000f850: 0a20 2020 2060 6064 6567 7265 6520 3e3d  .    ``degree >=
-0000f860: 2030 6060 2e0d 0a0d 0a20 2020 2060 6070   0``.....    ``p
-0000f870: 702e 6d61 7472 6978 5b6e 5f70 6978 656c  p.matrix[n_pixel
-0000f880: 732c 2064 6567 7265 6520 3a20 6465 6772  s, degree : degr
-0000f890: 6565 202b 206e 5f74 656d 706c 6174 6573  ee + n_templates
-0000f8a0: 5d60 6020 636f 6e74 6169 6e73 2074 6865  ]`` contains the
-0000f8b0: 0d0a 2020 2020 7374 656c 6c61 722f 6761  ..    stellar/ga
-0000f8c0: 7320 7465 6d70 6c61 7465 7320 636f 6e76  s templates conv
-0000f8d0: 6f6c 7665 6420 6279 2074 6865 204c 4f53  olved by the LOS
-0000f8e0: 5644 2c20 616e 6420 6d75 6c74 6970 6c69  VD, and multipli
-0000f8f0: 6564 2062 7920 7468 650d 0a20 2020 206d  ed by the..    m
-0000f900: 756c 7469 706c 6963 6174 6976 6520 706f  ultiplicative po
-0000f910: 6c79 6e6f 6d69 616c 7320 6966 2060 606d  lynomials if ``m
-0000f920: 6465 6772 6565 203e 2030 6060 2e0d 0a2e  degree > 0``....
-0000f930: 6d70 6f6c 793a 0d0a 2020 2020 4265 7374  mpoly:..    Best
-0000f940: 2066 6974 7469 6e67 206d 756c 7469 706c   fitting multipl
-0000f950: 6963 6174 6976 6520 706f 6c79 6e6f 6d69  icative polynomi
-0000f960: 616c 2028 6f72 2072 6564 6465 6e69 6e67  al (or reddening
-0000f970: 2063 7572 7665 2077 6865 6e0d 0a20 2020   curve when..   
-0000f980: 2060 6072 6564 6465 6e69 6e67 6060 2069   ``reddening`` i
-0000f990: 7320 7365 7429 2e0d 0a2e 6d70 6f6c 7977  s set)....mpolyw
-0000f9a0: 6569 6768 7473 3a0d 0a20 2020 2054 6869  eights:..    Thi
-0000f9b0: 7320 6973 206c 6172 6765 6c79 2073 7570  s is largely sup
-0000f9c0: 6572 7365 6465 6420 6279 2074 6865 2060  erseded by the `
-0000f9d0: 602e 6d70 6f6c 7960 6020 6174 7472 6962  `.mpoly`` attrib
-0000f9e0: 7574 6520 6162 6f76 652e 0d0a 0d0a 2020  ute above.....  
-0000f9f0: 2020 5768 656e 2060 606d 6465 6772 6565    When ``mdegree
-0000fa00: 203e 2030 6060 2074 6869 7320 636f 6e74   > 0`` this cont
-0000fa10: 6169 6e73 2069 6e20 6f75 7470 7574 2074  ains in output t
-0000fa20: 6865 2063 6f65 6666 6963 6965 6e74 7320  he coefficients 
-0000fa30: 6f66 2074 6865 0d0a 2020 2020 6d75 6c74  of the..    mult
-0000fa40: 6970 6c69 6361 7469 7665 204c 6567 656e  iplicative Legen
-0000fa50: 6472 6520 706f 6c79 6e6f 6d69 616c 7320  dre polynomials 
-0000fa60: 6f66 206f 7264 6572 2060 6031 2c20 322c  of order ``1, 2,
-0000fa70: 2e2e 2e20 6d64 6567 7265 6560 602e 0d0a  ... mdegree``...
-0000fa80: 2020 2020 5468 6520 706f 6c79 6e6f 6d69      The polynomi
-0000fa90: 616c 2063 616e 2062 6520 6578 706c 6963  al can be explic
-0000faa0: 6974 6c79 2065 7661 6c75 6174 6564 2061  itly evaluated a
-0000fab0: 733a 3a0d 0a0d 0a20 2020 2020 2020 2066  s::....        f
-0000fac0: 726f 6d20 6e75 6d70 792e 706f 6c79 6e6f  rom numpy.polyno
-0000fad0: 6d69 616c 2069 6d70 6f72 7420 6c65 6765  mial import lege
-0000fae0: 6e64 7265 0d0a 2020 2020 2020 2020 7820  ndre..        x 
-0000faf0: 3d20 6e70 2e6c 696e 7370 6163 6528 2d31  = np.linspace(-1
-0000fb00: 2c20 312c 206c 656e 2867 616c 6178 7929  , 1, len(galaxy)
-0000fb10: 290d 0a20 2020 2020 2020 206d 706f 6c79  )..        mpoly
-0000fb20: 203d 206c 6567 656e 6472 652e 6c65 6776   = legendre.legv
-0000fb30: 616c 2878 2c20 6e70 2e61 7070 656e 6428  al(x, np.append(
-0000fb40: 312c 2070 702e 6d70 6f6c 7977 6569 6768  1, pp.mpolyweigh
-0000fb50: 7473 2929 0d0a 0d0a 2020 2020 5768 656e  ts))....    When
-0000fb60: 2060 6074 7269 6720 3d20 5472 7565 6060   ``trig = True``
-0000fb70: 2074 6865 2070 6f6c 796e 6f6d 6961 6c20   the polynomial 
-0000fb80: 6973 2065 7661 6c75 6174 6564 2061 733a  is evaluated as:
-0000fb90: 3a0d 0a0d 0a20 2020 2020 2020 206d 706f  :....        mpo
-0000fba0: 6c79 203d 2070 702e 7472 6967 7661 6c28  ly = pp.trigval(
-0000fbb0: 782c 206e 702e 6170 7065 6e64 2831 2c20  x, np.append(1, 
-0000fbc0: 7070 2e6d 706f 6c79 7765 6967 6874 7329  pp.mpolyweights)
-0000fbd0: 290d 0a0d 0a2e 7068 6f74 5f62 6573 7466  ).....phot_bestf
-0000fbe0: 6974 3a20 6172 7261 795f 6c69 6b65 2077  it: array_like w
-0000fbf0: 6974 6820 7368 6170 6520 286e 5f70 686f  ith shape (n_pho
-0000fc00: 7429 0d0a 2020 2020 5768 656e 2060 6070  t)..    When ``p
-0000fc10: 686f 7460 6020 6973 2067 6976 656e 2c20  hot`` is given, 
-0000fc20: 7468 656e 2074 6869 7320 6174 7472 6962  then this attrib
-0000fc30: 7574 6520 636f 6e74 6169 6e73 2074 6865  ute contains the
-0000fc40: 2062 6573 7420 6669 7474 696e 670d 0a20   best fitting.. 
-0000fc50: 2020 2066 6c75 7865 7320 696e 2074 6865     fluxes in the
-0000fc60: 2070 686f 746f 6d65 7472 6963 2062 616e   photometric ban
-0000fc70: 6473 2067 6976 656e 2061 7320 696e 7075  ds given as inpu
-0000fc80: 7420 696e 2060 6070 686f 745f 6761 6c61  t in ``phot_gala
-0000fc90: 7879 6060 2e0d 0a2e 706c 6f74 3a20 6675  xy``....plot: fu
-0000fca0: 6e63 7469 6f6e 0d0a 2020 2020 4361 6c6c  nction..    Call
-0000fcb0: 2074 6865 206d 6574 686f 6420 6675 6e63   the method func
-0000fcc0: 7469 6f6e 2060 6070 702e 706c 6f74 2829  tion ``pp.plot()
-0000fcd0: 6060 2061 6674 6572 2074 6865 2063 616c  `` after the cal
-0000fce0: 6c20 746f 0d0a 2020 2020 6060 7070 203d  l to..    ``pp =
-0000fcf0: 2070 7078 6628 2e2e 2e29 6060 2074 6f20   ppxf(...)`` to 
-0000fd00: 7072 6f64 7563 6520 6120 706c 6f74 206f  produce a plot o
-0000fd10: 6620 7468 6520 6265 7374 2066 6974 2e20  f the best fit. 
-0000fd20: 5468 6973 2069 7320 616e 0d0a 2020 2020  This is an..    
-0000fd30: 616c 7465 726e 6174 6976 6520 746f 2063  alternative to c
-0000fd40: 616c 6c69 6e67 2060 6070 7020 3d20 7070  alling ``pp = pp
-0000fd50: 7866 282e 2e2e 2c20 706c 6f74 3d54 7275  xf(..., plot=Tru
-0000fd60: 6529 6060 2e0d 0a0d 0a20 2020 2055 7365  e)``.....    Use
-0000fd70: 2074 6865 2063 6f6d 6d61 6e64 2060 6070   the command ``p
-0000fd80: 702e 706c 6f74 2867 6173 5f63 6c69 703d  p.plot(gas_clip=
-0000fd90: 5472 7565 2960 6020 746f 2073 6361 6c65  True)`` to scale
-0000fda0: 2074 6865 2070 6c6f 7420 6261 7365 6420   the plot based 
-0000fdb0: 6f6e 0d0a 2020 2020 7468 6520 7374 656c  on..    the stel
-0000fdc0: 6c61 7220 636f 6e74 696e 7575 6d20 616c  lar continuum al
-0000fdd0: 6f6e 652c 2077 6869 6c65 2061 6c6c 6f77  one, while allow
-0000fde0: 696e 6720 666f 7220 7468 6520 6761 7320  ing for the gas 
-0000fdf0: 656d 6973 7369 6f6e 206c 696e 6573 0d0a  emission lines..
-0000fe00: 2020 2020 746f 2067 6f20 6f75 7473 6964      to go outsid
-0000fe10: 6520 7468 6520 706c 6f74 7469 6e67 2072  e the plotting r
-0000fe20: 6567 696f 6e2e 2054 6869 7320 6973 2075  egion. This is u
-0000fe30: 7365 6675 6c20 746f 2069 6e73 7065 6374  seful to inspect
-0000fe40: 2074 6865 2066 6974 0d0a 2020 2020 746f   the fit..    to
-0000fe50: 2074 6865 2073 7465 6c6c 6172 2063 6f6e   the stellar con
-0000fe60: 7469 6e75 756d 2c20 696e 2074 6865 2070  tinuum, in the p
-0000fe70: 7265 7365 6e63 6520 6f66 2073 7472 6f6e  resence of stron
-0000fe80: 6720 6761 7320 656d 6973 7369 6f6e 206c  g gas emission l
-0000fe90: 696e 6573 2e0d 0a20 2020 2054 6869 7320  ines...    This 
-0000fea0: 6861 7320 6566 6665 6374 206f 6e6c 7920  has effect only 
-0000feb0: 6966 2060 6067 6173 5f63 6f6d 706f 6e65  if ``gas_compone
-0000fec0: 6e74 2069 7320 6e6f 7420 4e6f 6e65 6060  nt is not None``
-0000fed0: 2e0d 0a0d 0a20 2020 2055 7365 2074 6865  .....    Use the
-0000fee0: 2063 6f6d 6d61 6e64 2060 6070 702e 706c   command ``pp.pl
-0000fef0: 6f74 282e 2e2e 2c20 7370 6563 3d54 7275  ot(..., spec=Tru
-0000ff00: 6529 6060 2074 6f20 696e 636c 7564 6520  e)`` to include 
-0000ff10: 7468 6520 6761 6c61 7879 0d0a 2020 2020  the galaxy..    
-0000ff20: 7370 6563 7472 756d 2069 6e20 7468 6520  spectrum in the 
-0000ff30: 706c 6f74 2061 6e64 2060 6070 702e 706c  plot and ``pp.pl
-0000ff40: 6f74 282e 2e2e 2c20 7068 6f74 3d54 7275  ot(..., phot=Tru
-0000ff50: 6529 6060 2074 6f20 696e 636c 7564 6520  e)`` to include 
-0000ff60: 7468 650d 0a20 2020 2070 686f 746f 6d65  the..    photome
-0000ff70: 7472 6963 206d 6561 7375 7265 6d65 6e74  tric measurement
-0000ff80: 732e 2046 6f72 2065 7861 6d70 6c65 2c20  s. For example, 
-0000ff90: 7768 656e 2066 6974 7469 6e67 2073 7065  when fitting spe
-0000ffa0: 6374 7261 2061 6e64 0d0a 2020 2020 7068  ctra and..    ph
-0000ffb0: 6f74 6f6d 6574 7279 2074 6f67 6574 6865  otometry togethe
-0000ffc0: 722c 206f 6e65 2063 616e 2075 7365 2060  r, one can use `
-0000ffd0: 6070 702e 706c 6f74 2870 686f 743d 5472  `pp.plot(phot=Tr
-0000ffe0: 7565 2c20 7370 6563 3d46 616c 7365 2960  ue, spec=False)`
-0000fff0: 600d 0a20 2020 2074 6f20 706c 6f74 2074  `..    to plot t
-00010000: 6865 2070 686f 746f 6d65 7472 7920 616c  he photometry al
-00010010: 6f6e 6520 616e 6420 6060 7070 2e70 6c6f  one and ``pp.plo
-00010020: 7428 7068 6f74 3d46 616c 7365 2c20 7370  t(phot=False, sp
-00010030: 6563 3d54 7275 6529 6060 0d0a 2020 2020  ec=True)``..    
-00010040: 746f 2070 6c6f 7420 7468 6520 7370 6563  to plot the spec
-00010050: 7472 756d 2061 6c6f 6e65 2e20 4279 2064  trum alone. By d
-00010060: 6566 6175 6c74 2062 6f74 6820 7468 6520  efault both the 
-00010070: 7370 6563 7472 756d 2061 6e64 2070 686f  spectrum and pho
-00010080: 746f 6d65 7472 790d 0a20 2020 2061 7265  tometry..    are
-00010090: 2069 6e63 6c75 6465 6420 696e 2061 2073   included in a s
-000100a0: 696e 676c 6520 706c 6f74 2e0d 0a2e 706f  ingle plot....po
-000100b0: 6c79 7765 6967 6874 733a 0d0a 2020 2020  lyweights:..    
-000100c0: 5468 6973 2069 7320 6c61 7267 656c 7920  This is largely 
-000100d0: 7375 7065 7273 6564 6564 2062 7920 7468  superseded by th
-000100e0: 6520 6060 2e61 706f 6c79 6060 2061 7474  e ``.apoly`` att
-000100f0: 7269 6275 7465 2061 626f 7665 2e0d 0a0d  ribute above....
-00010100: 0a20 2020 2057 6865 6e20 6060 6465 6772  .    When ``degr
-00010110: 6565 203e 3d20 3060 6020 636f 6e74 6169  ee >= 0`` contai
-00010120: 6e73 2074 6865 2077 6569 6768 7473 206f  ns the weights o
-00010130: 6620 7468 6520 6164 6469 7469 7665 204c  f the additive L
-00010140: 6567 656e 6472 650d 0a20 2020 2070 6f6c  egendre..    pol
-00010150: 796e 6f6d 6961 6c73 206f 6620 6f72 6465  ynomials of orde
-00010160: 7220 6060 302c 2031 2c2e 2e2e 2064 6567  r ``0, 1,... deg
-00010170: 7265 6560 602e 2054 6865 2062 6573 742d  ree``. The best-
-00010180: 6669 7474 696e 6720 6164 6469 7469 7665  fitting additive
-00010190: 0d0a 2020 2020 706f 6c79 6e6f 6d69 616c  ..    polynomial
-000101a0: 2063 616e 2062 6520 6578 706c 6963 6974   can be explicit
-000101b0: 6c79 2065 7661 6c75 6174 6564 2061 733a  ly evaluated as:
-000101c0: 3a0d 0a0d 0a20 2020 2020 2020 2066 726f  :....        fro
-000101d0: 6d20 6e75 6d70 792e 706f 6c79 6e6f 6d69  m numpy.polynomi
-000101e0: 616c 2069 6d70 6f72 7420 6c65 6765 6e64  al import legend
-000101f0: 7265 0d0a 2020 2020 2020 2020 7820 3d20  re..        x = 
-00010200: 6e70 2e6c 696e 7370 6163 6528 2d31 2c20  np.linspace(-1, 
-00010210: 312c 206c 656e 2867 616c 6178 7929 290d  1, len(galaxy)).
-00010220: 0a20 2020 2020 2020 2061 706f 6c79 203d  .        apoly =
-00010230: 206c 6567 656e 6472 652e 6c65 6776 616c   legendre.legval
-00010240: 2878 2c20 7070 2e70 6f6c 7977 6569 6768  (x, pp.polyweigh
-00010250: 7473 290d 0a0d 0a20 2020 2057 6865 6e20  ts)....    When 
-00010260: 6060 7472 6967 3d54 7275 6560 6020 7468  ``trig=True`` th
-00010270: 6520 706f 6c79 6e6f 6d69 616c 2069 7320  e polynomial is 
-00010280: 6576 616c 7561 7465 6420 6173 3a3a 0d0a  evaluated as::..
-00010290: 0d0a 2020 2020 2020 2020 6170 6f6c 7920  ..        apoly 
-000102a0: 3d20 7070 2e74 7269 6776 616c 2878 2c20  = pp.trigval(x, 
-000102b0: 7070 2e70 6f6c 7977 6569 6768 7473 290d  pp.polyweights).
-000102c0: 0a0d 0a20 2020 2057 6865 6e20 646f 696e  ...    When doin
-000102d0: 6720 6120 7477 6f2d 7369 6465 6420 6669  g a two-sided fi
-000102e0: 7474 696e 6720 2873 6565 2068 656c 7020  tting (see help 
-000102f0: 666f 7220 6060 6761 6c61 7879 6060 2070  for ``galaxy`` p
-00010300: 6172 616d 6574 6572 292c 2074 6865 0d0a  arameter), the..
-00010310: 2020 2020 6164 6469 7469 7665 2070 6f6c      additive pol
-00010320: 796e 6f6d 6961 6c73 2061 7265 2061 6c6c  ynomials are all
-00010330: 6f77 6564 2074 6f20 6265 2064 6966 6665  owed to be diffe
-00010340: 7265 6e74 2066 6f72 2074 6865 206c 6566  rent for the lef
-00010350: 7420 616e 6420 7269 6768 740d 0a20 2020  t and right..   
-00010360: 2073 7065 6374 7275 6d2e 2049 6e20 7468   spectrum. In th
-00010370: 6174 2063 6173 652c 2074 6865 206f 7574  at case, the out
-00010380: 7075 7420 7765 6967 6874 7320 6f66 2074  put weights of t
-00010390: 6865 2061 6464 6974 6976 6520 706f 6c79  he additive poly
-000103a0: 6e6f 6d69 616c 730d 0a20 2020 2061 6c74  nomials..    alt
-000103b0: 6572 6e61 7465 2062 6574 7765 656e 2074  ernate between t
-000103c0: 6865 2066 6972 7374 2028 6c65 6674 2920  he first (left) 
-000103d0: 7370 6563 7472 756d 2061 6e64 2074 6865  spectrum and the
-000103e0: 2073 6563 6f6e 6420 2872 6967 6874 290d   second (right).
-000103f0: 0a20 2020 2073 7065 6374 7275 6d2e 0d0a  .    spectrum...
-00010400: 2e72 6564 6465 6e69 6e67 3a0d 0a20 2020  .reddening:..   
-00010410: 2042 6573 7420 6669 7474 696e 6720 6060   Best fitting ``
-00010420: 415f 5660 6020 7661 6c75 6520 6966 2074  A_V`` value if t
-00010430: 6865 2060 6072 6564 6465 6e69 6e67 6060  he ``reddening``
-00010440: 206b 6579 776f 7264 2069 7320 7365 742e   keyword is set.
-00010450: 0d0a 2e73 6f6c 3a0d 0a20 2020 2056 6563  ...sol:..    Vec
-00010460: 746f 7220 636f 6e74 6169 6e69 6e67 2069  tor containing i
-00010470: 6e20 6f75 7470 7574 2074 6865 2070 6172  n output the par
-00010480: 616d 6574 6572 7320 6f66 2074 6865 206b  ameters of the k
-00010490: 696e 656d 6174 6963 732e 0d0a 0d0a 2020  inematics.....  
-000104a0: 2020 2a20 4966 2060 606d 6f6d 656e 7473    * If ``moments
-000104b0: 3d32 6060 2074 6869 7320 636f 6e74 6169  =2`` this contai
-000104c0: 6e73 2060 605b 5665 6c2c 2053 6967 6d61  ns ``[Vel, Sigma
-000104d0: 5d60 600d 0a20 2020 202a 2049 6620 6060  ]``..    * If ``
-000104e0: 6d6f 6d65 6e74 733d 3460 6020 7468 6973  moments=4`` this
-000104f0: 2063 6f6e 7461 696e 7320 6060 5b56 656c   contains ``[Vel
-00010500: 2c20 5369 676d 612c 2068 332c 2068 345d  , Sigma, h3, h4]
-00010510: 6060 0d0a 2020 2020 2a20 4966 2060 606d  ``..    * If ``m
-00010520: 6f6d 656e 7473 3d4e 6060 2074 6869 7320  oments=N`` this 
-00010530: 636f 6e74 6169 6e73 2060 605b 5665 6c2c  contains ``[Vel,
-00010540: 2053 6967 6d61 2c20 6833 2c2e 2e2e 2068   Sigma, h3,... h
-00010550: 4e5d 6060 0d0a 0d0a 2020 2020 5768 656e  N]``....    When
-00010560: 2066 6974 7469 6e67 206d 756c 7469 706c   fitting multipl
-00010570: 6520 6b69 6e65 6d61 7469 6320 6060 636f  e kinematic ``co
-00010580: 6d70 6f6e 656e 7460 602c 2060 6070 702e  mponent``, ``pp.
-00010590: 736f 6c60 6020 636f 6e74 6169 6e73 2061  sol`` contains a
-000105a0: 0d0a 2020 2020 6c69 7374 2077 6974 6820  ..    list with 
-000105b0: 7468 6520 736f 6c75 7469 6f6e 2066 6f72  the solution for
-000105c0: 2061 6c6c 2064 6966 6665 7265 6e74 2063   all different c
-000105d0: 6f6d 706f 6e65 6e74 732c 206f 6e65 2061  omponents, one a
-000105e0: 6674 6572 2074 6865 0d0a 2020 2020 6f74  fter the..    ot
-000105f0: 6865 722c 2073 6f72 7465 6420 6279 2060  her, sorted by `
-00010600: 6063 6f6d 706f 6e65 6e74 6060 3a20 6060  `component``: ``
-00010610: 7070 2e73 6f6c 203d 205b 736f 6c31 2c20  pp.sol = [sol1, 
-00010620: 736f 6c32 2c2e 2e2e 5d60 602e 0d0a 0d0a  sol2,...]``.....
-00010630: 2020 2020 6060 5665 6c60 6020 6973 2074      ``Vel`` is t
-00010640: 6865 2076 656c 6f63 6974 792c 2060 6053  he velocity, ``S
-00010650: 6967 6d61 6060 2069 7320 7468 6520 7665  igma`` is the ve
-00010660: 6c6f 6369 7479 2064 6973 7065 7273 696f  locity dispersio
-00010670: 6e2c 0d0a 2020 2020 6060 6833 202d 2068  n,..    ``h3 - h
-00010680: 3660 6020 6172 6520 7468 6520 4761 7573  6`` are the Gaus
-00010690: 732d 4865 726d 6974 6520 636f 6566 6669  s-Hermite coeffi
-000106a0: 6369 656e 7473 2e20 5468 6520 6d6f 6465  cients. The mode
-000106b0: 6c20 7061 7261 6d65 7465 7273 0d0a 2020  l parameters..  
-000106c0: 2020 6172 6520 6669 7474 6564 2073 696d    are fitted sim
-000106d0: 756c 7461 6e65 6f75 736c 792e 0d0a 0d0a  ultaneously.....
-000106e0: 2020 2020 494d 504f 5254 414e 543a 2054      IMPORTANT: T
-000106f0: 6865 2070 7265 6369 7365 2072 656c 6174  he precise relat
-00010700: 696f 6e20 6265 7477 6565 6e20 7468 6520  ion between the 
-00010710: 6f75 7470 7574 2060 6070 5058 4660 6020  output ``pPXF`` 
-00010720: 7665 6c6f 6369 7479 0d0a 2020 2020 616e  velocity..    an
-00010730: 6420 7265 6473 6869 6674 2069 7320 6060  d redshift is ``
-00010740: 5665 6c20 3d20 632a 6e70 2e6c 6f67 2831  Vel = c*np.log(1
-00010750: 202b 207a 2960 602e 2053 6565 2053 6563   + z)``. See Sec
-00010760: 7469 6f6e 2032 2e33 206f 660d 0a20 2020  tion 2.3 of..   
-00010770: 2060 4361 7070 656c 6c61 7269 2028 3230   `Cappellari (20
-00010780: 3137 2960 5f20 666f 7220 6120 6465 7461  17)`_ for a deta
-00010790: 696c 6564 2065 7870 6c61 6e61 7469 6f6e  iled explanation
-000107a0: 2e0d 0a0d 0a20 2020 2054 6865 7365 2061  .....    These a
-000107b0: 7265 2074 6865 2064 6566 6175 6c74 2073  re the default s
-000107c0: 6166 6574 7920 6c69 6d69 7473 206f 6e20  afety limits on 
-000107d0: 7468 6520 6669 7474 696e 6720 7061 7261  the fitting para
-000107e0: 6d65 7465 7273 0d0a 2020 2020 2874 6865  meters..    (the
-000107f0: 7920 6361 6e20 6265 2063 6861 6e67 6564  y can be changed
-00010800: 2075 7369 6e67 2074 6865 2060 6062 6f75   using the ``bou
-00010810: 6e64 7360 6020 6b65 7977 6f72 6429 3a0d  nds`` keyword):.
-00010820: 0a0d 0a20 2020 202a 2060 6056 656c 6060  ...    * ``Vel``
-00010830: 2069 7320 636f 6e73 7472 6169 6e65 6420   is constrained 
-00010840: 746f 2062 6520 6060 2b2f 2d32 3030 3060  to be ``+/-2000`
-00010850: 6020 6b6d 2f73 2066 726f 6d20 7468 6520  ` km/s from the 
-00010860: 696e 7075 7420 6775 6573 730d 0a20 2020  input guess..   
-00010870: 202a 2060 6076 656c 7363 616c 652f 3130   * ``velscale/10
-00010880: 3020 3c20 5369 676d 6120 3c20 3130 3030  0 < Sigma < 1000
-00010890: 6060 206b 6d2f 730d 0a20 2020 202a 2060  `` km/s..    * `
-000108a0: 602d 302e 3320 3c20 5b68 332c 2068 342c  `-0.3 < [h3, h4,
-000108b0: 202e 2e2e 5d20 3c20 302e 3360 6020 2028   ...] < 0.3``  (
-000108c0: 6578 7472 656d 6520 7661 6c75 6520 666f  extreme value fo
-000108d0: 7220 7265 616c 2067 616c 6178 6965 7329  r real galaxies)
-000108e0: 0d0a 0d0a 2020 2020 496e 2074 6865 2063  ....    In the c
-000108f0: 6173 6520 6f66 2074 776f 2d73 6964 6564  ase of two-sided
-00010900: 204c 4f53 5644 2066 6974 7469 6e67 2074   LOSVD fitting t
-00010910: 6865 206f 7574 7075 7420 7661 6c75 6573  he output values
-00010920: 2072 6566 6572 2074 6f20 7468 650d 0a20   refer to the.. 
-00010930: 2020 2066 6972 7374 2069 6e70 7574 2067     first input g
-00010940: 616c 6178 7920 7370 6563 7472 756d 2c20  alaxy spectrum, 
-00010950: 7768 696c 6520 7468 6520 7365 636f 6e64  while the second
-00010960: 2073 7065 6374 7275 6d20 7769 6c6c 2068   spectrum will h
-00010970: 6176 6520 6279 0d0a 2020 2020 636f 6e73  ave by..    cons
-00010980: 7472 7563 7469 6f6e 206b 696e 656d 6174  truction kinemat
-00010990: 6963 7320 7061 7261 6d65 7465 7273 2060  ics parameters `
-000109a0: 605b 2d56 656c 2c20 5369 676d 612c 202d  `[-Vel, Sigma, -
-000109b0: 6833 2c20 6834 2c20 2d68 352c 2068 365d  h3, h4, -h5, h6]
-000109c0: 6060 2e0d 0a20 2020 2049 6620 6060 7673  ``...    If ``vs
-000109d0: 7973 7460 6020 6973 206e 6f6e 7a65 726f  yst`` is nonzero
-000109e0: 2028 6173 2072 6571 7569 7265 6420 666f   (as required fo
-000109f0: 7220 7477 6f2d 7369 6465 6420 6669 7474  r two-sided fitt
-00010a00: 696e 6729 2c20 7468 656e 2074 6865 0d0a  ing), then the..
-00010a10: 2020 2020 6f75 7470 7574 2076 656c 6f63      output veloc
-00010a20: 6974 7920 6973 206d 6561 7375 7265 6420  ity is measured 
-00010a30: 7769 7468 2072 6573 7065 6374 2074 6f20  with respect to 
-00010a40: 6060 7673 7973 7460 602e 0d0a 2e73 7461  ``vsyst``....sta
-00010a50: 7475 733a 0d0a 2020 2020 436f 6e74 6169  tus:..    Contai
-00010a60: 6e73 2074 6865 206f 7574 7075 7420 7374  ns the output st
-00010a70: 6174 7573 206f 6620 7468 6520 6f70 7469  atus of the opti
-00010a80: 6d69 7a61 7469 6f6e 2e20 506f 7369 7469  mization. Positi
-00010a90: 7665 2076 616c 7565 730d 0a20 2020 2067  ve values..    g
-00010aa0: 656e 6572 616c 6c79 2072 6570 7265 7365  enerally represe
-00010ab0: 6e74 2073 7563 6365 7373 2028 7468 6520  nt success (the 
-00010ac0: 6d65 616e 696e 6720 6f66 2060 6073 7461  meaning of ``sta
-00010ad0: 7475 7360 6020 6973 2064 6566 696e 6564  tus`` is defined
-00010ae0: 2061 7320 696e 0d0a 2020 2020 6073 6369   as in..    `sci
-00010af0: 7079 2e6f 7074 696d 697a 652e 6c65 6173  py.optimize.leas
-00010b00: 745f 7371 7561 7265 7360 5f29 2e0d 0a2e  t_squares`_)....
-00010b10: 7765 6967 6874 733a 0d0a 2020 2020 5265  weights:..    Re
-00010b20: 6365 6976 6573 2074 6865 2076 616c 7565  ceives the value
-00010b30: 206f 6620 7468 6520 7765 6967 6874 7320   of the weights 
-00010b40: 6279 2077 6869 6368 2065 6163 6820 7465  by which each te
-00010b50: 6d70 6c61 7465 2077 6173 0d0a 2020 2020  mplate was..    
-00010b60: 6d75 6c74 6970 6c69 6564 2074 6f20 6265  multiplied to be
-00010b70: 7374 2066 6974 2074 6865 2067 616c 6178  st fit the galax
-00010b80: 7920 7370 6563 7472 756d 2e20 5468 6520  y spectrum. The 
-00010b90: 6f70 7469 6d61 6c20 7465 6d70 6c61 7465  optimal template
-00010ba0: 2063 616e 2062 650d 0a20 2020 2063 6f6d   can be..    com
-00010bb0: 7075 7465 6420 7769 7468 2061 6e20 6172  puted with an ar
-00010bc0: 7261 792d 7665 6374 6f72 206d 756c 7469  ray-vector multi
-00010bd0: 706c 6963 6174 696f 6e3a 3a0d 0a0d 0a20  plication::.... 
-00010be0: 2020 2020 2020 2062 6573 7465 6d70 203d         bestemp =
-00010bf0: 2074 656d 706c 6174 6573 2040 2077 6569   templates @ wei
-00010c00: 6768 7473 0d0a 0d0a 2020 2020 5468 6573  ghts....    Thes
-00010c10: 6520 6060 2e77 6569 6768 7473 6060 2064  e ``.weights`` d
-00010c20: 6f20 6e6f 7420 696e 636c 7564 6520 7468  o not include th
-00010c30: 6520 7765 6967 6874 7320 6f66 2074 6865  e weights of the
-00010c40: 2061 6464 6974 6976 650d 0a20 2020 2070   additive..    p
-00010c50: 6f6c 796e 6f6d 6961 6c73 2077 6869 6368  olynomials which
-00010c60: 2061 7265 2073 6570 6172 6174 656c 7920   are separately 
-00010c70: 7374 6f72 6564 2069 6e20 6060 7070 2e70  stored in ``pp.p
-00010c80: 6f6c 7977 6569 6768 7473 6060 2e0d 0a0d  olyweights``....
-00010c90: 0a20 2020 2057 6865 6e20 7468 6520 6060  .    When the ``
-00010ca0: 736b 7960 6020 6b65 7977 6f72 6420 6973  sky`` keyword is
-00010cb0: 2075 7365 6420 6060 7765 6967 6874 735b   used ``weights[
-00010cc0: 3a6e 5f74 656d 706c 6174 6573 5d60 6020  :n_templates]`` 
-00010cd0: 636f 6e74 6169 6e73 2074 6865 0d0a 2020  contains the..  
-00010ce0: 2020 7765 6967 6874 7320 666f 7220 7468    weights for th
-00010cf0: 6520 7465 6d70 6c61 7465 732c 2077 6869  e templates, whi
-00010d00: 6c65 2060 6077 6569 6768 7473 5b6e 5f74  le ``weights[n_t
-00010d10: 656d 706c 6174 6573 3a5d 6060 2067 6976  emplates:]`` giv
-00010d20: 6573 2074 6865 0d0a 2020 2020 6f6e 6573  es the..    ones
-00010d30: 2066 6f72 2074 6865 2073 6b79 2e20 496e   for the sky. In
-00010d40: 2074 6861 7420 6361 7365 2074 6865 2062   that case the b
-00010d50: 6573 742d 6669 7474 696e 6720 6761 6c61  est-fitting gala
-00010d60: 7879 2074 656d 706c 6174 6520 616e 6420  xy template and 
-00010d70: 736b 790d 0a20 2020 2061 7265 2067 6976  sky..    are giv
-00010d80: 656e 2062 793a 3a0d 0a0d 0a20 2020 2020  en by::....     
-00010d90: 2020 2062 6573 7465 6d70 203d 2074 656d     bestemp = tem
-00010da0: 706c 6174 6573 2040 2077 6569 6768 7473  plates @ weights
-00010db0: 5b3a 6e5f 7465 6d70 6c61 7465 735d 0d0a  [:n_templates]..
-00010dc0: 2020 2020 2020 2020 6265 7374 736b 7920          bestsky 
-00010dd0: 3d20 736b 7920 4020 7765 6967 6874 735b  = sky @ weights[
-00010de0: 6e5f 7465 6d70 6c61 7465 733a 5d0d 0a0d  n_templates:]...
-00010df0: 0a20 2020 2057 6865 6e20 646f 696e 6720  .    When doing 
-00010e00: 6120 7477 6f2d 7369 6465 6420 6669 7474  a two-sided fitt
-00010e10: 696e 6720 2873 6565 2068 656c 7020 666f  ing (see help fo
-00010e20: 7220 6060 6761 6c61 7879 6060 2070 6172  r ``galaxy`` par
-00010e30: 616d 6574 6572 290d 0a20 2020 202a 746f  ameter)..    *to
-00010e40: 6765 7468 6572 2a20 7769 7468 2074 6865  gether* with the
-00010e50: 2060 6073 6b79 6060 206b 6579 776f 7264   ``sky`` keyword
-00010e60: 2c20 7468 6520 736b 7920 7765 6967 6874  , the sky weight
-00010e70: 7320 6172 6520 616c 6c6f 7765 6420 746f  s are allowed to
-00010e80: 2062 650d 0a20 2020 2064 6966 6665 7265   be..    differe
-00010e90: 6e74 2066 6f72 2074 6865 206c 6566 7420  nt for the left 
-00010ea0: 616e 6420 7269 6768 7420 7370 6563 7472  and right spectr
-00010eb0: 756d 2e20 496e 2074 6861 7420 6361 7365  um. In that case
-00010ec0: 2074 6865 206f 7574 7075 7420 736b 790d   the output sky.
-00010ed0: 0a20 2020 2077 6569 6768 7473 2061 6c74  .    weights alt
-00010ee0: 6572 6e61 7465 2062 6574 7765 656e 2074  ernate between t
-00010ef0: 6865 2066 6972 7374 2028 6c65 6674 2920  he first (left) 
-00010f00: 7370 6563 7472 756d 2061 6e64 2074 6865  spectrum and the
-00010f10: 2073 6563 6f6e 640d 0a20 2020 2028 7269   second..    (ri
-00010f20: 6768 7429 2073 7065 6374 7275 6d2e 0d0a  ght) spectrum...
-00010f30: 0d0a 486f 7720 746f 2053 6574 2074 6865  ..How to Set the
-00010f40: 204b 696e 656d 6174 6963 2050 656e 616c   Kinematic Penal
-00010f50: 7479 204b 6579 776f 7264 0d0a 2d2d 2d2d  ty Keyword..----
-00010f60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b600: 6163 6961 6e5b 775d 2a2a 322e 0d0a 0d0a  acian[w]**2.....
+0000b610: 7265 675f 7374 6570 3a20 6c69 7374 206f  reg_step: list o
+0000b620: 6620 6172 7261 7973 2c20 7368 6170 6520  f arrays, shape 
+0000b630: 286c 656e 2872 6567 5f64 696d 292c 290d  (len(reg_dim),).
+0000b640: 0a20 2020 2044 6566 696e 6573 2074 6865  .    Defines the
+0000b650: 2073 7465 7020 7369 7a65 7320 666f 7220   step sizes for 
+0000b660: 6e75 6d65 7269 6361 6c20 6573 7469 6d61  numerical estima
+0000b670: 7469 6f6e 206f 6620 6465 7269 7661 7469  tion of derivati
+0000b680: 7665 7320 6475 7269 6e67 0d0a 2020 2020  ves during..    
+0000b690: 7265 6775 6c61 7269 7a61 7469 6f6e 2e20  regularization. 
+0000b6a0: 4561 6368 2061 7272 6179 2069 6e20 7468  Each array in th
+0000b6b0: 6520 6c69 7374 2063 6f72 7265 7370 6f6e  e list correspon
+0000b6c0: 6473 2074 6f20 6120 6469 6d65 6e73 696f  ds to a dimensio
+0000b6d0: 6e20 696e 0d0a 2020 2020 6060 7265 675f  n in..    ``reg_
+0000b6e0: 6469 6d60 602c 2073 7065 6369 6679 696e  dim``, specifyin
+0000b6f0: 6720 7468 6520 7374 6570 2073 697a 6520  g the step size 
+0000b700: 666f 7220 6561 6368 2069 6e74 6572 7661  for each interva
+0000b710: 6c20 7769 7468 696e 2074 6861 740d 0a20  l within that.. 
+0000b720: 2020 2064 696d 656e 7369 6f6e 2e20 4279     dimension. By
+0000b730: 2064 6566 6175 6c74 2c20 6966 2060 6072   default, if ``r
+0000b740: 6567 5f73 7465 7060 6020 6973 206e 6f74  eg_step`` is not
+0000b750: 2070 726f 7669 6465 642c 2061 2073 7465   provided, a ste
+0000b760: 7020 7369 7a65 206f 660d 0a20 2020 206f  p size of..    o
+0000b770: 6e65 2069 7320 6173 7375 6d65 6420 666f  ne is assumed fo
+0000b780: 7220 616c 6c20 6469 6d65 6e73 696f 6e73  r all dimensions
+0000b790: 2c20 6571 7569 7661 6c65 6e74 2074 6f20  , equivalent to 
+0000b7a0: 0d0a 2020 2020 6060 7265 675f 7374 6570  ..    ``reg_step
+0000b7b0: 203d 205b 6e70 2e6f 6e65 7328 7264 202d   = [np.ones(rd -
+0000b7c0: 2031 2920 666f 7220 7264 2069 6e20 7265   1) for rd in re
+0000b7d0: 675f 6469 6d5d 6060 2e20 546f 2063 7573  g_dim]``. To cus
+0000b7e0: 746f 6d69 7a65 2c0d 0a20 2020 2070 726f  tomize,..    pro
+0000b7f0: 7669 6465 2060 6072 6567 5f73 7465 7060  vide ``reg_step`
+0000b800: 6020 6173 2061 206c 6973 7420 636f 6e74  ` as a list cont
+0000b810: 6169 6e69 6e67 2061 7272 6179 732c 2077  aining arrays, w
+0000b820: 6865 7265 2065 6163 6820 6172 7261 7920  here each array 
+0000b830: 6861 730d 0a20 2020 2061 206c 656e 6774  has..    a lengt
+0000b840: 6820 6f66 2060 6072 6567 5f64 696d 5b6a  h of ``reg_dim[j
+0000b850: 5d20 2d20 3160 602c 2061 6c6c 6f77 696e  ] - 1``, allowin
+0000b860: 6720 666f 7220 7661 7269 6162 6c65 2073  g for variable s
+0000b870: 7465 7020 7369 7a65 7320 6163 726f 7373  tep sizes across
+0000b880: 0d0a 2020 2020 696e 7465 7276 616c 7320  ..    intervals 
+0000b890: 616e 6420 6469 6d65 6e73 696f 6e73 2e0d  and dimensions..
+0000b8a0: 0a0d 0a20 2020 204e 4f54 4520 313a 204d  ...    NOTE 1: M
+0000b8b0: 756c 7469 706c 7969 6e67 2065 6163 6820  ultiplying each 
+0000b8c0: 656c 656d 656e 7420 696e 2060 6072 6567  element in ``reg
+0000b8d0: 5f73 7465 7060 6020 6279 2061 2063 6f6e  _step`` by a con
+0000b8e0: 7374 616e 7420 6661 6374 6f72 0d0a 2020  stant factor..  
+0000b8f0: 2020 6060 6b60 6020 6861 7320 7468 6520    ``k`` has the 
+0000b900: 7361 6d65 2065 6666 6563 7420 6173 2064  same effect as d
+0000b910: 6976 6964 696e 6720 7468 6520 7265 6775  ividing the regu
+0000b920: 6c61 7269 7a61 7469 6f6e 2070 6172 616d  larization param
+0000b930: 6574 6572 0d0a 2020 2020 6060 7265 6775  eter..    ``regu
+0000b940: 6c60 6020 6279 2060 606b 2a2a 7265 675f  l`` by ``k**reg_
+0000b950: 6f72 6460 602e 0d0a 0d0a 2020 2020 4e4f  ord``.....    NO
+0000b960: 5445 2032 3a20 5468 6520 7374 616e 6461  TE 2: The standa
+0000b970: 7264 2061 7070 726f 6163 6820 636f 6e73  rd approach cons
+0000b980: 6973 7473 206f 6620 7361 6d70 6c69 6e67  ists of sampling
+0000b990: 2074 6865 2053 5053 2074 656d 706c 6174   the SPS templat
+0000b9a0: 650d 0a20 2020 2073 7065 6374 7261 206c  e..    spectra l
+0000b9b0: 6f67 6172 6974 686d 6963 616c 6c79 2069  ogarithmically i
+0000b9c0: 6e20 6167 6520 616e 6420 6164 6f70 7420  n age and adopt 
+0000b9d0: 6120 636f 6e73 7461 6e74 2075 6e69 7461  a constant unita
+0000b9e0: 7279 2073 7465 702c 0d0a 2020 2020 2a2a  ry step,..    **
+0000b9f0: 7769 7468 6f75 742a 2a20 7573 696e 6720  without** using 
+0000ba00: 7468 6973 206b 6579 776f 7264 2e0d 0a72  this keyword...r
+0000ba10: 6567 756c 3a20 666c 6f61 742c 206f 7074  egul: float, opt
+0000ba20: 696f 6e61 6c0d 0a20 2020 2049 6620 7468  ional..    If th
+0000ba30: 6973 206b 6579 776f 7264 2069 7320 6e6f  is keyword is no
+0000ba40: 6e7a 6572 6f2c 2074 6865 2070 726f 6772  nzero, the progr
+0000ba50: 616d 2061 7070 6c69 6573 2066 6972 7374  am applies first
+0000ba60: 206f 7220 7365 636f 6e64 2d6f 7264 6572   or second-order
+0000ba70: 0d0a 2020 2020 6c69 6e65 6172 2072 6567  ..    linear reg
+0000ba80: 756c 6172 697a 6174 696f 6e20 746f 2074  ularization to t
+0000ba90: 6865 2060 6077 6569 6768 7473 6060 2064  he ``weights`` d
+0000baa0: 7572 696e 6720 7468 6520 6060 7050 5846  uring the ``pPXF
+0000bab0: 6060 2066 6974 2e0d 0a20 2020 2052 6567  `` fit...    Reg
+0000bac0: 756c 6172 697a 6174 696f 6e20 6973 2064  ularization is d
+0000bad0: 6f6e 6520 696e 206f 6e65 2c20 7477 6f20  one in one, two 
+0000bae0: 6f72 2074 6872 6565 2064 696d 656e 7369  or three dimensi
+0000baf0: 6f6e 7320 6465 7065 6e64 696e 6720 6f6e  ons depending on
+0000bb00: 0d0a 2020 2020 7768 6574 6865 7220 7468  ..    whether th
+0000bb10: 6520 6172 7261 7920 6f66 2060 6074 656d  e array of ``tem
+0000bb20: 706c 6174 6573 6060 2068 6173 2074 776f  plates`` has two
+0000bb30: 2c20 7468 7265 6520 6f72 2066 6f75 7220  , three or four 
+0000bb40: 6469 6d65 6e73 696f 6e73 0d0a 2020 2020  dimensions..    
+0000bb50: 7265 7370 6563 7469 7665 6c79 2e0d 0a20  respectively... 
+0000bb60: 2020 204c 6172 6765 2060 6072 6567 756c     Large ``regul
+0000bb70: 6060 2076 616c 7565 7320 636f 7272 6573  `` values corres
+0000bb80: 706f 6e64 2074 6f20 736d 6f6f 7468 6572  pond to smoother
+0000bb90: 2060 6077 6569 6768 7473 6060 206f 7574   ``weights`` out
+0000bba0: 7075 742e 2057 6865 6e0d 0a20 2020 2074  put. When..    t
+0000bbb0: 6869 7320 6b65 7977 6f72 6420 6973 206e  his keyword is n
+0000bbc0: 6f6e 7a65 726f 2074 6865 2073 6f6c 7574  onzero the solut
+0000bbd0: 696f 6e20 7769 6c6c 2062 6520 6120 7472  ion will be a tr
+0000bbe0: 6164 652d 6f66 6620 6265 7477 6565 6e20  ade-off between 
+0000bbf0: 7468 650d 0a20 2020 2073 6d6f 6f74 686e  the..    smoothn
+0000bc00: 6573 7320 6f66 2060 6077 6569 6768 7473  ess of ``weights
+0000bc10: 6060 2061 6e64 2067 6f6f 646e 6573 7320  `` and goodness 
+0000bc20: 6f66 2066 6974 2e0d 0a0d 0a20 2020 2053  of fit.....    S
+0000bc30: 6563 7469 6f6e 2033 2e35 206f 6620 6043  ection 3.5 of `C
+0000bc40: 6170 7065 6c6c 6172 6920 2832 3031 3729  appellari (2017)
+0000bc50: 605f 2064 6573 6372 6962 6573 2072 6567  `_ describes reg
+0000bc60: 756c 6172 697a 6174 696f 6e2e 0d0a 0d0a  ularization.....
+0000bc70: 2020 2020 5768 656e 2066 6974 7469 6e67      When fitting
+0000bc80: 206d 756c 7469 706c 6520 6b69 6e65 6d61   multiple kinema
+0000bc90: 7469 6320 6060 636f 6d70 6f6e 656e 7460  tic ``component`
+0000bca0: 6020 7468 6520 7265 6775 6c61 7269 7a61  ` the regulariza
+0000bcb0: 7469 6f6e 2069 730d 0a20 2020 2061 7070  tion is..    app
+0000bcc0: 6c69 6564 206f 6e6c 7920 746f 2074 6865  lied only to the
+0000bcd0: 2066 6972 7374 2060 6063 6f6d 706f 6e65   first ``compone
+0000bce0: 6e74 203d 2030 6060 2c20 7768 696c 6520  nt = 0``, while 
+0000bcf0: 6164 6469 7469 6f6e 616c 0d0a 2020 2020  additional..    
+0000bd00: 636f 6d70 6f6e 656e 7473 2061 7265 206e  components are n
+0000bd10: 6f74 2072 6567 756c 6172 697a 6564 2e20  ot regularized. 
+0000bd20: 5468 6973 2069 7320 7573 6566 756c 2077  This is useful w
+0000bd30: 6865 6e20 6669 7474 696e 6720 7374 656c  hen fitting stel
+0000bd40: 6c61 720d 0a20 2020 2070 6f70 756c 6174  lar..    populat
+0000bd50: 696f 6e20 746f 6765 7468 6572 2077 6974  ion together wit
+0000bd60: 6820 6761 7320 656d 6973 7369 6f6e 206c  h gas emission l
+0000bd70: 696e 6573 2e20 496e 2074 6861 7420 6361  ines. In that ca
+0000bd80: 7365 2c20 7468 6520 5353 500d 0a20 2020  se, the SSP..   
+0000bd90: 2073 7065 6374 7261 6c20 7465 6d70 6c61   spectral templa
+0000bda0: 7465 7320 6d75 7374 2062 6520 6769 7665  tes must be give
+0000bdb0: 6e20 6669 7273 7420 616e 6420 7468 6520  n first and the 
+0000bdc0: 6761 7320 656d 6973 7369 6f6e 2074 656d  gas emission tem
+0000bdd0: 706c 6174 6573 0d0a 2020 2020 6172 6520  plates..    are 
+0000bde0: 6769 7665 6e20 6c61 7374 2e20 496e 2074  given last. In t
+0000bdf0: 6869 7320 7369 7475 6174 696f 6e2c 206f  his situation, o
+0000be00: 6e65 2068 6173 2074 6f20 7573 6520 7468  ne has to use th
+0000be10: 6520 6060 7265 675f 6469 6d60 600d 0a20  e ``reg_dim``.. 
+0000be20: 2020 206b 6579 776f 7264 2028 6265 6c6f     keyword (belo
+0000be30: 7729 2c20 746f 2067 6976 6520 6060 7050  w), to give ``pP
+0000be40: 5846 6060 2074 6865 2064 696d 656e 7369  XF`` the dimensi
+0000be50: 6f6e 7320 6f66 2074 6865 2070 6f70 756c  ons of the popul
+0000be60: 6174 696f 6e0d 0a20 2020 2070 6172 616d  ation..    param
+0000be70: 6574 6572 7320 2865 2e67 2e20 6060 6e5f  eters (e.g. ``n_
+0000be80: 6167 6560 602c 2060 606e 5f6d 6574 616c  age``, ``n_metal
+0000be90: 6060 2c20 6060 6e5f 616c 7068 6160 6029  ``, ``n_alpha``)
+0000bea0: 2e20 4120 7573 6167 6520 6578 616d 706c  . A usage exampl
+0000beb0: 650d 0a20 2020 2069 7320 6769 7665 6e20  e..    is given 
+0000bec0: 696e 2074 6865 2066 696c 6520 6060 7070  in the file ``pp
+0000bed0: 7866 5f65 7861 6d70 6c65 5f70 6f70 756c  xf_example_popul
+0000bee0: 6174 696f 6e5f 6761 735f 7364 7373 2e70  ation_gas_sdss.p
+0000bef0: 7960 602e 0d0a 0d0a 2020 2020 5468 6520  y``.....    The 
+0000bf00: 6566 6665 6374 206f 6620 7468 6520 7265  effect of the re
+0000bf10: 6775 6c61 7269 7a61 7469 6f6e 2073 6368  gularization sch
+0000bf20: 656d 6520 6973 2074 6865 2066 6f6c 6c6f  eme is the follo
+0000bf30: 7769 6e67 3a0d 0a0d 0a20 2020 202a 2057  wing:....    * W
+0000bf40: 6974 6820 6060 7265 675f 6f72 643d 3160  ith ``reg_ord=1`
+0000bf50: 6020 6974 2065 6e66 6f72 6365 7320 7468  ` it enforces th
+0000bf60: 6520 6e75 6d65 7269 6361 6c20 6669 7273  e numerical firs
+0000bf70: 7420 6465 7269 7661 7469 7665 730d 0a20  t derivatives.. 
+0000bf80: 2020 2020 2062 6574 7765 656e 206e 6569       between nei
+0000bf90: 6768 626f 7572 696e 6720 7765 6967 6874  ghbouring weight
+0000bfa0: 7320 2869 6e20 7468 6520 312d 6469 6d20  s (in the 1-dim 
+0000bfb0: 6361 7365 2920 746f 2062 6520 6571 7561  case) to be equa
+0000bfc0: 6c20 746f 0d0a 2020 2020 2020 6060 775b  l to..      ``w[
+0000bfd0: 6a5d 202d 2077 5b6a 2b31 5d20 3d20 3060  j] - w[j+1] = 0`
+0000bfe0: 6020 7769 7468 2061 6e20 6572 726f 7220  ` with an error 
+0000bff0: 6060 4465 6c74 6120 3d20 312f 7265 6775  ``Delta = 1/regu
+0000c000: 6c60 602e 0d0a 0d0a 2020 2020 2a20 5769  l``.....    * Wi
+0000c010: 7468 2060 6072 6567 5f6f 7264 3d32 6060  th ``reg_ord=2``
+0000c020: 2069 7420 656e 666f 7263 6573 2074 6865   it enforces the
+0000c030: 206e 756d 6572 6963 616c 2073 6563 6f6e   numerical secon
+0000c040: 6420 6465 7269 7661 7469 7665 730d 0a20  d derivatives.. 
+0000c050: 2020 2020 2062 6574 7765 656e 206e 6569       between nei
+0000c060: 6768 626f 7572 696e 6720 7765 6967 6874  ghbouring weight
+0000c070: 7320 2869 6e20 7468 6520 312d 6469 6d20  s (in the 1-dim 
+0000c080: 6361 7365 2920 746f 2062 6520 6571 7561  case) to be equa
+0000c090: 6c20 746f 0d0a 2020 2020 2020 6060 775b  l to..      ``w[
+0000c0a0: 6a2d 315d 202d 2032 2a77 5b6a 5d20 2b20  j-1] - 2*w[j] + 
+0000c0b0: 775b 6a2b 315d 203d 2030 6060 2077 6974  w[j+1] = 0`` wit
+0000c0c0: 6820 616e 2065 7272 6f72 2060 6044 656c  h an error ``Del
+0000c0d0: 7461 203d 2031 2f72 6567 756c 6060 2e0d  ta = 1/regul``..
+0000c0e0: 0a0d 0a20 2020 2049 7420 6d61 7920 6265  ...    It may be
+0000c0f0: 2068 656c 7066 756c 2074 6f20 6465 6669   helpful to defi
+0000c100: 6e65 2060 6072 6567 756c 203d 2031 2f44  ne ``regul = 1/D
+0000c110: 656c 7461 6060 2061 6e64 2074 6869 6e6b  elta`` and think
+0000c120: 206f 6620 6060 4465 6c74 6160 600d 0a20   of ``Delta``.. 
+0000c130: 2020 2061 7320 7468 6520 7265 6775 6c61     as the regula
+0000c140: 7269 7a61 7469 6f6e 2065 7272 6f72 2e0d  rization error..
+0000c150: 0a0d 0a20 2020 2049 4d50 4f52 5441 4e54  ...    IMPORTANT
+0000c160: 3a20 6060 4465 6c74 6160 6020 6e65 6564  : ``Delta`` need
+0000c170: 7320 746f 2062 6520 736d 616c 6c65 7220  s to be smaller 
+0000c180: 6275 7420 6f66 2074 6865 2073 616d 6520  but of the same 
+0000c190: 6f72 6465 7220 6f66 0d0a 2020 2020 6d61  order of..    ma
+0000c1a0: 676e 6974 7564 6520 6f66 2074 6865 2074  gnitude of the t
+0000c1b0: 7970 6963 616c 2060 6077 6569 6768 7473  ypical ``weights
+0000c1c0: 6060 2074 6f20 706c 6179 2061 6e20 6566  `` to play an ef
+0000c1d0: 6665 6374 206f 6e20 7468 650d 0a20 2020  fect on the..   
+0000c1e0: 2072 6567 756c 6172 697a 6174 696f 6e2e   regularization.
+0000c1f0: 204f 6e65 2071 7569 636b 2077 6179 2074   One quick way t
+0000c200: 6f20 6163 6869 6576 6520 7468 6973 2069  o achieve this i
+0000c210: 733a 0d0a 0d0a 2020 2020 312e 2044 6976  s:....    1. Div
+0000c220: 6964 6520 7468 6520 6675 6c6c 2060 6074  ide the full ``t
+0000c230: 656d 706c 6174 6573 6060 2061 7272 6179  emplates`` array
+0000c240: 2062 7920 6120 7363 616c 6172 2069 6e20   by a scalar in 
+0000c250: 7375 6368 2061 2077 6179 2074 6861 740d  such a way that.
+0000c260: 0a20 2020 2020 2020 7468 6520 7479 7069  .       the typi
+0000c270: 6361 6c20 7465 6d70 6c61 7465 2068 6173  cal template has
+0000c280: 2061 206d 6564 6961 6e20 6f66 206f 6e65   a median of one
+0000c290: 3a3a 0d0a 0d0a 2020 2020 2020 2020 2020  ::....          
+0000c2a0: 2020 7465 6d70 6c61 7465 7320 2f3d 206e    templates /= n
+0000c2b0: 702e 6d65 6469 616e 2874 656d 706c 6174  p.median(templat
+0000c2c0: 6573 290d 0a0d 0a20 2020 2032 2e20 446f  es)....    2. Do
+0000c2d0: 2074 6865 2073 616d 6520 666f 7220 7468   the same for th
+0000c2e0: 6520 696e 7075 7420 6761 6c61 7879 2073  e input galaxy s
+0000c2f0: 7065 6374 7275 6d3a 3a0d 0a0d 0a20 2020  pectrum::....   
+0000c300: 2020 2020 2020 2020 2067 616c 6178 7920           galaxy 
+0000c310: 2f3d 206e 702e 6d65 6469 616e 2867 616c  /= np.median(gal
+0000c320: 6178 7929 0d0a 0d0a 2020 2020 332e 2049  axy)....    3. I
+0000c330: 6e20 7468 6973 2073 6974 7561 7469 6f6e  n this situation
+0000c340: 2c20 6120 7365 6e73 6962 6c65 2067 7565  , a sensible gue
+0000c350: 7373 2066 6f72 2060 6044 656c 7461 6060  ss for ``Delta``
+0000c360: 2077 696c 6c20 6265 2061 2066 6577 0d0a   will be a few..
+0000c370: 2020 2020 2020 2070 6572 6365 6e74 2028         percent (
+0000c380: 652e 672e 2060 6044 656c 7461 3d30 2e30  e.g. ``Delta=0.0
+0000c390: 3120 2d2d 3e20 7265 6775 6c3d 3130 3060  1 --> regul=100`
+0000c3a0: 6029 2e0d 0a0d 0a20 2020 2041 6c74 6572  `).....    Alter
+0000c3b0: 6e61 7469 7665 6c79 2c20 666f 7220 6120  natively, for a 
+0000c3c0: 6d6f 7265 2072 6967 6f72 6f75 7320 6465  more rigorous de
+0000c3d0: 6669 6e69 7469 6f6e 206f 6620 7468 6520  finition of the 
+0000c3e0: 7061 7261 6d65 7465 720d 0a20 2020 2060  parameter..    `
+0000c3f0: 6072 6567 756c 6060 3a0d 0a0d 0a20 2020  `regul``:....   
+0000c400: 2041 2e20 5065 7266 6f72 6d20 616e 2075   A. Perform an u
+0000c410: 6e72 6567 756c 6172 697a 6564 2066 6974  nregularized fit
+0000c420: 2028 6060 7265 6775 6c3d 3060 6029 2061   (``regul=0``) a
+0000c430: 6e64 2074 6865 6e20 7265 7363 616c 6520  nd then rescale 
+0000c440: 7468 650d 0a20 2020 2020 2020 696e 7075  the..       inpu
+0000c450: 7420 6060 6e6f 6973 6560 6020 7370 6563  t ``noise`` spec
+0000c460: 7472 756d 2073 6f20 7468 6174 3a3a 0d0a  trum so that::..
+0000c470: 0d0a 2020 2020 2020 2020 2020 2020 4368  ..            Ch
+0000c480: 695e 322f 444f 4620 3d20 4368 695e 322f  i^2/DOF = Chi^2/
+0000c490: 676f 6f64 5069 7865 6c73 2e73 697a 6520  goodPixels.size 
+0000c4a0: 3d20 312e 0d0a 0d0a 2020 2020 2020 2054  = 1.....       T
+0000c4b0: 6869 7320 6973 2061 6368 6965 7665 6420  his is achieved 
+0000c4c0: 6279 2072 6573 6361 6c69 6e67 2074 6865  by rescaling the
+0000c4d0: 2069 6e70 7574 2060 606e 6f69 7365 6060   input ``noise``
+0000c4e0: 2073 7065 6374 7275 6d20 6173 3a3a 0d0a   spectrum as::..
+0000c4f0: 0d0a 2020 2020 2020 2020 2020 2020 6e6f  ..            no
+0000c500: 6973 6520 3d20 6e6f 6973 652a 6e70 2e73  ise = noise*np.s
+0000c510: 7172 7428 4368 692a 2a32 2f44 4f46 2920  qrt(Chi**2/DOF) 
+0000c520: 3d20 6e6f 6973 652a 6e70 2e73 7172 7428  = noise*np.sqrt(
+0000c530: 7070 2e63 6869 3229 3b0d 0a0d 0a20 2020  pp.chi2);....   
+0000c540: 2042 2e20 496e 6372 6561 7365 2060 6072   B. Increase ``r
+0000c550: 6567 756c 6060 2061 6e64 2069 7465 7261  egul`` and itera
+0000c560: 7469 7665 6c79 2072 6564 6f20 7468 6520  tively redo the 
+0000c570: 6060 7050 5846 6060 2066 6974 2075 6e74  ``pPXF`` fit unt
+0000c580: 696c 2074 6865 0d0a 2020 2020 2020 2060  il the..       `
+0000c590: 6043 6869 5e32 6060 2069 6e63 7265 6173  `Chi^2`` increas
+0000c5a0: 6573 2066 726f 6d20 7468 6520 756e 7265  es from the unre
+0000c5b0: 6775 6c61 7269 7a65 6420 7661 6c75 650d  gularized value.
+0000c5c0: 0a20 2020 2020 2020 6060 4368 695e 3220  .       ``Chi^2 
+0000c5d0: 3d20 676f 6f64 5069 7865 6c73 2e73 697a  = goodPixels.siz
+0000c5e0: 6560 6020 6279 0d0a 2020 2020 2020 2060  e`` by..       `
+0000c5f0: 6044 656c 7461 4368 695e 3220 3d20 6e70  `DeltaChi^2 = np
+0000c600: 2e73 7172 7428 322a 676f 6f64 5069 7865  .sqrt(2*goodPixe
+0000c610: 6c73 2e73 697a 6529 6060 2e0d 0a0d 0a20  ls.size)``..... 
+0000c620: 2020 2054 6865 2064 6572 6976 6564 2072     The derived r
+0000c630: 6567 756c 6172 697a 6174 696f 6e20 636f  egularization co
+0000c640: 7272 6573 706f 6e64 7320 746f 2074 6865  rresponds to the
+0000c650: 206d 6178 696d 756d 206f 6e65 2073 7469   maximum one sti
+0000c660: 6c6c 0d0a 2020 2020 636f 6e73 6973 7465  ll..    consiste
+0000c670: 6e74 2077 6974 6820 7468 6520 6f62 7365  nt with the obse
+0000c680: 7276 6174 696f 6e73 2061 6e64 2074 6865  rvations and the
+0000c690: 2064 6572 6976 6564 2073 7461 7220 666f   derived star fo
+0000c6a0: 726d 6174 696f 6e20 6869 7374 6f72 790d  rmation history.
+0000c6b0: 0a20 2020 2077 696c 6c20 6265 2074 6865  .    will be the
+0000c6c0: 2073 6d6f 6f74 6865 7374 2028 6d69 6e69   smoothest (mini
+0000c6d0: 6d75 6d20 6375 7276 6174 7572 6520 6f72  mum curvature or
+0000c6e0: 206d 696e 696d 756d 2076 6172 6961 7469   minimum variati
+0000c6f0: 6f6e 2920 7468 6174 2069 730d 0a20 2020  on) that is..   
+0000c700: 2073 7469 6c6c 2063 6f6e 7369 7374 656e   still consisten
+0000c710: 7420 7769 7468 2074 6865 206f 6273 6572  t with the obser
+0000c720: 7661 7469 6f6e 732e 0d0a 7369 676d 615f  vations...sigma_
+0000c730: 6469 6666 3a20 666c 6f61 742c 206f 7074  diff: float, opt
+0000c740: 696f 6e61 6c0d 0a20 2020 2051 7561 6472  ional..    Quadr
+0000c750: 6174 6963 2064 6966 6665 7265 6e63 6520  atic difference 
+0000c760: 696e 206b 6d2f 7320 6465 6669 6e65 6420  in km/s defined 
+0000c770: 6173 3a3a 0d0a 0d0a 2020 2020 2020 2020  as::....        
+0000c780: 7369 676d 615f 6469 6666 2a2a 3220 3d20  sigma_diff**2 = 
+0000c790: 7369 676d 615f 696e 7374 2a2a 3220 2d20  sigma_inst**2 - 
+0000c7a0: 7369 676d 615f 7465 6d70 2a2a 320d 0a0d  sigma_temp**2...
+0000c7b0: 0a20 2020 2062 6574 7765 656e 2074 6865  .    between the
+0000c7c0: 2069 6e73 7472 756d 656e 7461 6c20 6469   instrumental di
+0000c7d0: 7370 6572 7369 6f6e 206f 6620 7468 6520  spersion of the 
+0000c7e0: 6761 6c61 7879 2073 7065 6374 7275 6d20  galaxy spectrum 
+0000c7f0: 616e 6420 7468 650d 0a20 2020 2069 6e73  and the..    ins
+0000c800: 7472 756d 656e 7461 6c20 6469 7370 6572  trumental disper
+0000c810: 7369 6f6e 206f 6620 7468 6520 7465 6d70  sion of the temp
+0000c820: 6c61 7465 2073 7065 6374 7261 2e0d 0a0d  late spectra....
+0000c830: 0a20 2020 2054 6869 7320 6b65 7977 6f72  .    This keywor
+0000c840: 6420 6973 2075 7365 6675 6c20 7768 656e  d is useful when
+0000c850: 2074 6865 2074 656d 706c 6174 6573 2068   the templates h
+0000c860: 6176 6520 6869 6768 6572 2072 6573 6f6c  ave higher resol
+0000c870: 7574 696f 6e20 7468 616e 0d0a 2020 2020  ution than..    
+0000c880: 7468 6520 6761 6c61 7879 2061 6e64 2074  the galaxy and t
+0000c890: 6865 7920 7765 7265 206e 6f74 2063 6f6e  hey were not con
+0000c8a0: 766f 6c76 6564 2074 6f20 6d61 7463 6820  volved to match 
+0000c8b0: 7468 6520 696e 7374 7275 6d65 6e74 616c  the instrumental
+0000c8c0: 0d0a 2020 2020 6469 7370 6572 7369 6f6e  ..    dispersion
+0000c8d0: 206f 6620 7468 6520 6761 6c61 7879 2073   of the galaxy s
+0000c8e0: 7065 6374 7275 6d2e 2049 6e20 7468 6973  pectrum. In this
+0000c8f0: 2073 6974 7561 7469 6f6e 2c20 7468 6520   situation, the 
+0000c900: 636f 6e76 6f6c 7574 696f 6e0d 0a20 2020  convolution..   
+0000c910: 2069 7320 646f 6e65 2062 7920 6060 7050   is done by ``pP
+0000c920: 5846 6060 2077 6974 6820 696e 6372 6561  XF`` with increa
+0000c930: 7365 6420 6163 6375 7261 6379 2c20 7573  sed accuracy, us
+0000c940: 696e 6720 616e 2061 6e61 6c79 7469 6320  ing an analytic 
+0000c950: 466f 7572 6965 720d 0a20 2020 2054 7261  Fourier..    Tra
+0000c960: 6e73 666f 726d 2e0d 0a73 6b79 3a0d 0a20  nsform...sky:.. 
+0000c970: 2020 2076 6563 746f 7220 636f 6e74 6169     vector contai
+0000c980: 6e69 6e67 2074 6865 2073 7065 6374 7275  ning the spectru
+0000c990: 6d20 6f66 2074 6865 2073 6b79 2074 6f20  m of the sky to 
+0000c9a0: 6265 2069 6e63 6c75 6465 6420 696e 2074  be included in t
+0000c9b0: 6865 2066 6974 2c20 6f72 0d0a 2020 2020  he fit, or..    
+0000c9c0: 6172 7261 7920 6f66 2064 696d 656e 7369  array of dimensi
+0000c9d0: 6f6e 7320 6060 736b 795b 6e5f 7069 7865  ons ``sky[n_pixe
+0000c9e0: 6c73 2c20 6e53 6b79 5d60 6020 636f 6e74  ls, nSky]`` cont
+0000c9f0: 6169 6e69 6e67 2064 6966 6665 7265 6e74  aining different
+0000ca00: 2073 6b79 0d0a 2020 2020 7370 6563 7472   sky..    spectr
+0000ca10: 6120 746f 2061 6464 2074 6f20 7468 6520  a to add to the 
+0000ca20: 6d6f 6465 6c20 6f66 2074 6865 206f 6273  model of the obs
+0000ca30: 6572 7665 6420 6060 6761 6c61 7879 6060  erved ``galaxy``
+0000ca40: 2073 7065 6374 7275 6d2e 2054 6865 0d0a   spectrum. The..
+0000ca50: 2020 2020 6060 736b 7960 6020 6861 7320      ``sky`` has 
+0000ca60: 746f 2062 6520 6c6f 672d 7265 6269 6e6e  to be log-rebinn
+0000ca70: 6564 2061 7320 7468 6520 6060 6761 6c61  ed as the ``gala
+0000ca80: 7879 6060 2073 7065 6374 7275 6d20 616e  xy`` spectrum an
+0000ca90: 6420 6e65 6564 7320 746f 0d0a 2020 2020  d needs to..    
+0000caa0: 6861 7665 2074 6865 2073 616d 6520 6e75  have the same nu
+0000cab0: 6d62 6572 206f 6620 7069 7865 6c73 2e0d  mber of pixels..
+0000cac0: 0a0d 0a20 2020 2054 6865 2073 6b79 2069  ...    The sky i
+0000cad0: 7320 6765 6e65 7261 6c6c 7920 7375 6274  s generally subt
+0000cae0: 7261 6374 6564 2066 726f 6d20 7468 6520  racted from the 
+0000caf0: 6461 7461 2062 6566 6f72 6520 7468 6520  data before the 
+0000cb00: 6060 7050 5846 6060 2066 6974 2e0d 0a20  ``pPXF`` fit... 
+0000cb10: 2020 2048 6f77 6576 6572 2c20 666f 7220     However, for 
+0000cb20: 6f62 7365 7276 6174 696f 6e73 2076 6572  observations ver
+0000cb30: 7920 6865 6176 696c 7920 646f 6d69 6e61  y heavily domina
+0000cb40: 7465 6420 6279 2074 6865 2073 6b79 2073  ted by the sky s
+0000cb50: 7065 6374 7275 6d2c 0d0a 2020 2020 7768  pectrum,..    wh
+0000cb60: 6572 6520 6120 7665 7279 2061 6363 7572  ere a very accur
+0000cb70: 6174 6520 736b 7920 7375 6274 7261 6374  ate sky subtract
+0000cb80: 696f 6e20 6973 2063 7269 7469 6361 6c2c  ion is critical,
+0000cb90: 2069 7420 6d61 7920 6265 2075 7365 6675   it may be usefu
+0000cba0: 6c0d 0a20 2020 202a 6e6f 742a 2074 6f20  l..    *not* to 
+0000cbb0: 7375 6274 7261 6374 2074 6865 2073 6b79  subtract the sky
+0000cbc0: 2066 726f 6d20 7468 6520 7370 6563 7472   from the spectr
+0000cbd0: 756d 2c20 6275 7420 746f 2069 6e63 6c75  um, but to inclu
+0000cbe0: 6465 2069 7420 696e 2074 6865 0d0a 2020  de it in the..  
+0000cbf0: 2020 6669 7420 7573 696e 6720 7468 6973    fit using this
+0000cc00: 206b 6579 776f 7264 2e0d 0a74 656d 706c   keyword...templ
+0000cc10: 6174 6573 5f72 6666 743a 0d0a 2020 2020  ates_rfft:..    
+0000cc20: 5768 656e 2063 616c 6c69 6e67 2060 6070  When calling ``p
+0000cc30: 5058 4660 6020 6d61 6e79 2074 696d 6573  PXF`` many times
+0000cc40: 2077 6974 6820 616e 2069 6465 6e74 6963   with an identic
+0000cc50: 616c 2073 6574 206f 6620 7465 6d70 6c61  al set of templa
+0000cc60: 7465 732c 0d0a 2020 2020 6f6e 6520 6361  tes,..    one ca
+0000cc70: 6e20 7573 6520 7468 6973 206b 6579 776f  n use this keywo
+0000cc80: 7264 2074 6f20 7061 7373 2074 6865 2072  rd to pass the r
+0000cc90: 6561 6c20 4646 5420 6f66 2074 6865 2074  eal FFT of the t
+0000cca0: 656d 706c 6174 6573 2c0d 0a20 2020 2063  emplates,..    c
+0000ccb0: 6f6d 7075 7465 6420 696e 2061 2070 7265  omputed in a pre
+0000ccc0: 7669 6f75 7320 6060 7050 5846 6060 2063  vious ``pPXF`` c
+0000ccd0: 616c 6c2c 2073 746f 7265 6420 696e 2074  all, stored in t
+0000cce0: 6865 0d0a 2020 2020 6060 7070 2e74 656d  he..    ``pp.tem
+0000ccf0: 706c 6174 6573 5f72 6666 7460 6020 6174  plates_rfft`` at
+0000cd00: 7472 6962 7574 652e 2054 6869 7320 6b65  tribute. This ke
+0000cd10: 7977 6f72 6420 6d61 696e 6c79 2065 7869  yword mainly exi
+0000cd20: 7374 7320 746f 2073 686f 770d 0a20 2020  sts to show..   
+0000cd30: 2074 6861 7420 7468 6572 6520 6973 206e   that there is n
+0000cd40: 6f20 6e65 6564 2066 6f72 2069 742e 2e2e  o need for it...
+0000cd50: 0d0a 0d0a 2020 2020 494d 504f 5254 414e  ....    IMPORTAN
+0000cd60: 543a 2055 7365 2074 6869 7320 6b65 7977  T: Use this keyw
+0000cd70: 6f72 6420 6f6e 6c79 2069 6620 796f 7520  ord only if you 
+0000cd80: 756e 6465 7273 7461 6e64 2077 6861 7420  understand what 
+0000cd90: 796f 7520 6172 6520 646f 696e 6721 0d0a  you are doing!..
+0000cda0: 7469 6564 3a0d 0a20 2020 2041 206c 6973  tied:..    A lis
+0000cdb0: 7420 6f66 2073 7472 696e 6720 6578 7072  t of string expr
+0000cdc0: 6573 7369 6f6e 732e 2045 6163 6820 6578  essions. Each ex
+0000cdd0: 7072 6573 7369 6f6e 2022 7469 6573 2220  pression "ties" 
+0000cde0: 7468 6520 7061 7261 6d65 7465 7220 746f  the parameter to
+0000cdf0: 0d0a 2020 2020 6f74 6865 7220 6672 6565  ..    other free
+0000ce00: 206f 7220 6669 7865 6420 7061 7261 6d65   or fixed parame
+0000ce10: 7465 7273 2e20 2041 6e79 2065 7870 7265  ters.  Any expre
+0000ce20: 7373 696f 6e20 696e 766f 6c76 696e 6720  ssion involving 
+0000ce30: 636f 6e73 7461 6e74 7320 616e 640d 0a20  constants and.. 
+0000ce40: 2020 2074 6865 2070 6172 616d 6574 6572     the parameter
+0000ce50: 2061 7272 6179 2060 6070 5b6a 5d60 6020   array ``p[j]`` 
+0000ce60: 6172 6520 7065 726d 6974 7465 642e 2053  are permitted. S
+0000ce70: 696e 6365 2074 6865 7920 6172 6520 746f  ince they are to
+0000ce80: 7461 6c6c 790d 0a20 2020 2063 6f6e 7374  tally..    const
+0000ce90: 7261 696e 6564 2c20 7469 6564 2070 6172  rained, tied par
+0000cea0: 616d 6574 6572 7320 6172 6520 636f 6e73  ameters are cons
+0000ceb0: 6964 6572 6564 2074 6f20 6265 2066 6978  idered to be fix
+0000cec0: 6564 3b20 6e6f 2065 7272 6f72 7320 6172  ed; no errors ar
+0000ced0: 650d 0a20 2020 2063 6f6d 7075 7465 6420  e..    computed 
+0000cee0: 666f 7220 7468 656d 2e0d 0a0d 0a20 2020  for them.....   
+0000cef0: 2054 6869 7320 6973 2061 6e20 6172 7261   This is an arra
+0000cf00: 792c 206f 7220 6c69 7374 206f 6620 6172  y, or list of ar
+0000cf10: 7261 7973 2c20 7769 7468 2074 6865 2073  rays, with the s
+0000cf20: 616d 6520 6469 6d65 6e73 696f 6e73 2061  ame dimensions a
+0000cf30: 730d 0a20 2020 2060 6073 7461 7274 6060  s..    ``start``
+0000cf40: 2e20 496e 2070 7261 6374 6963 652c 2066  . In practice, f
+0000cf50: 6f72 2065 7665 7279 2065 6c65 6d65 6e74  or every element
+0000cf60: 206f 6620 6060 7374 6172 7460 6020 6f6e   of ``start`` on
+0000cf70: 6520 6e65 6564 7320 746f 0d0a 2020 2020  e needs to..    
+0000cf80: 7370 6563 6966 7920 6569 7468 6572 2061  specify either a
+0000cf90: 6e20 656d 7074 7920 7374 7269 6e67 2060  n empty string `
+0000cfa0: 6027 2760 6020 696d 706c 7969 6e67 2074  `''`` implying t
+0000cfb0: 6861 7420 7468 6520 7061 7261 6d65 7465  hat the paramete
+0000cfc0: 7220 6973 0d0a 2020 2020 6672 6565 2c20  r is..    free, 
+0000cfd0: 6f72 2061 2073 7472 696e 6720 6578 7072  or a string expr
+0000cfe0: 6573 7369 6f6e 2069 6e76 6f6c 7669 6e67  ession involving
+0000cff0: 2073 6f6d 6520 6f66 2074 6865 2076 6172   some of the var
+0000d000: 6961 626c 6573 2060 6070 5b6a 5d60 602c  iables ``p[j]``,
+0000d010: 0d0a 2020 2020 7768 6572 6520 6060 6a60  ..    where ``j`
+0000d020: 6020 7265 7072 6573 656e 7473 2074 6865  ` represents the
+0000d030: 2069 6e64 6578 206f 6620 7468 6520 666c   index of the fl
+0000d040: 6174 7465 6e65 6420 6c69 7374 206f 6620  attened list of 
+0000d050: 6b69 6e65 6d61 7469 630d 0a20 2020 2070  kinematic..    p
+0000d060: 6172 616d 6574 6572 732e 0d0a 0d0a 2020  arameters.....  
+0000d070: 2020 4558 414d 504c 453a 2057 6520 7761    EXAMPLE: We wa
+0000d080: 6e74 2074 6f20 6669 7420 7468 7265 6520  nt to fit three 
+0000d090: 6b69 6e65 6d61 7469 6320 636f 6d70 6f6e  kinematic compon
+0000d0a0: 656e 7473 2c20 7769 7468 2034 206d 6f6d  ents, with 4 mom
+0000d0b0: 656e 7473 2066 6f72 0d0a 2020 2020 7468  ents for..    th
+0000d0c0: 6520 6669 7273 7420 636f 6d70 6f6e 656e  e first componen
+0000d0d0: 7420 616e 6420 3220 6d6f 6d65 6e74 7320  t and 2 moments 
+0000d0e0: 666f 7220 7468 6520 7365 636f 6e64 2061  for the second a
+0000d0f0: 6e64 2074 6869 7264 2028 652e 672e 2073  nd third (e.g. s
+0000d100: 7461 7273 0d0a 2020 2020 616e 6420 7477  tars..    and tw
+0000d110: 6f20 6761 7320 636f 6d70 6f6e 656e 7473  o gas components
+0000d120: 292e 2049 6e20 7468 6973 2063 6173 653a  ). In this case:
+0000d130: 3a0d 0a0d 0a20 2020 2020 2020 206d 6f6d  :....        mom
+0000d140: 656e 7473 203d 205b 342c 2032 2c20 325d  ents = [4, 2, 2]
+0000d150: 0d0a 2020 2020 2020 2020 7374 6172 7420  ..        start 
+0000d160: 3d20 5b5b 5631 2c20 7369 676d 6131 2c20  = [[V1, sigma1, 
+0000d170: 302c 2030 5d2c 205b 5632 2c20 7369 676d  0, 0], [V2, sigm
+0000d180: 6132 5d2c 205b 5633 2c20 7369 676d 6133  a2], [V3, sigma3
+0000d190: 5d5d 0d0a 0d0a 2020 2020 7468 656e 2077  ]]....    then w
+0000d1a0: 6520 6361 6e20 666f 7263 6520 7468 6520  e can force the 
+0000d1b0: 6571 7561 6c69 7479 2063 6f6e 7374 7261  equality constra
+0000d1c0: 696e 7420 6060 5632 203d 2056 3360 6020  int ``V2 = V3`` 
+0000d1d0: 6173 2066 6f6c 6c6f 7773 3a3a 0d0a 0d0a  as follows::....
+0000d1e0: 2020 2020 2020 2020 7469 6564 203d 205b          tied = [
+0000d1f0: 5b27 272c 2027 272c 2027 272c 2027 275d  ['', '', '', '']
+0000d200: 2c20 5b27 272c 2027 275d 2c20 5b27 705b  , ['', ''], ['p[
+0000d210: 345d 272c 2027 275d 5d20 2023 2070 5b36  4]', '']]  # p[6
+0000d220: 5d20 3d20 705b 345d 0d0a 0d0a 2020 2020  ] = p[4]....    
+0000d230: 6f72 2077 6520 6361 6e20 666f 7263 6520  or we can force 
+0000d240: 7468 6520 6571 7561 6c69 7479 2063 6f6e  the equality con
+0000d250: 7374 7261 696e 7420 6060 7369 676d 6132  straint ``sigma2
+0000d260: 203d 2073 6967 6d61 3360 6020 6173 0d0a   = sigma3`` as..
+0000d270: 2020 2020 666f 6c6c 6f77 733a 3a0d 0a0d      follows::...
+0000d280: 0a20 2020 2020 2020 2074 6965 6420 3d20  .        tied = 
+0000d290: 5b5b 2727 2c20 2727 2c20 2727 2c20 2727  [['', '', '', ''
+0000d2a0: 5d2c 205b 2727 2c20 2727 5d2c 205b 2727  ], ['', ''], [''
+0000d2b0: 2c20 2770 5b35 5d27 5d5d 2020 2320 705b  , 'p[5]']]  # p[
+0000d2c0: 375d 203d 2070 5b35 5d0d 0a0d 0a20 2020  7] = p[5]....   
+0000d2d0: 204f 6e65 2063 616e 2061 6c73 6f20 7573   One can also us
+0000d2e0: 6520 6d6f 7265 2067 656e 6572 616c 2066  e more general f
+0000d2f0: 6f72 6d75 6c61 732e 2046 6f72 2065 7861  ormulas. For exa
+0000d300: 6d70 6c65 206f 6e65 2063 6f75 6c64 2063  mple one could c
+0000d310: 6f6e 7374 7261 696e 0d0a 2020 2020 6060  onstrain..    ``
+0000d320: 5633 203d 2028 5631 202b 2056 3229 2f32  V3 = (V1 + V2)/2
+0000d330: 6060 2061 7320 7765 6c6c 2061 7320 6060  `` as well as ``
+0000d340: 7369 676d 6131 203d 2073 6967 6d61 3260  sigma1 = sigma2`
+0000d350: 6020 6173 2066 6f6c 6c6f 7773 3a3a 0d0a  ` as follows::..
+0000d360: 0d0a 2020 2020 2020 2020 2320 705b 355d  ..        # p[5]
+0000d370: 203d 2070 5b31 5d0d 0a20 2020 2020 2020   = p[1]..       
+0000d380: 2023 2070 5b36 5d20 3d20 2870 5b30 5d20   # p[6] = (p[0] 
+0000d390: 2b20 705b 345d 292f 320d 0a20 2020 2020  + p[4])/2..     
+0000d3a0: 2020 2074 6965 6420 3d20 5b5b 2727 2c20     tied = [['', 
+0000d3b0: 2727 2c20 2727 2c20 2727 5d2c 205b 2727  '', '', ''], [''
+0000d3c0: 2c20 2770 5b31 5d27 5d2c 205b 2728 705b  , 'p[1]'], ['(p[
+0000d3d0: 305d 202b 2070 5b34 5d29 2f32 272c 2027  0] + p[4])/2', '
+0000d3e0: 275d 5d0d 0a0d 0a20 2020 204e 4f54 453a  ']]....    NOTE:
+0000d3f0: 204f 6e65 2063 6f75 6c64 2069 6e20 7072   One could in pr
+0000d400: 696e 6369 706c 6520 7573 6520 7468 6520  inciple use the 
+0000d410: 6060 7469 6564 6060 206b 6579 776f 7264  ``tied`` keyword
+0000d420: 2074 6f20 636f 6d70 6c65 7465 6c79 2074   to completely t
+0000d430: 6965 0d0a 2020 2020 7468 6520 4c4f 5356  ie..    the LOSV
+0000d440: 4420 6f66 2074 776f 206b 696e 656d 6174  D of two kinemat
+0000d450: 6963 2063 6f6d 706f 6e65 6e74 732e 2048  ic components. H
+0000d460: 6f77 6576 6572 2c20 7468 6973 2073 616d  owever, this sam
+0000d470: 6520 6566 6665 6374 2069 730d 0a20 2020  e effect is..   
+0000d480: 206d 6f72 6520 6566 6669 6369 656e 7420   more efficient 
+0000d490: 6163 6869 6576 6564 2062 7920 6173 7369  achieved by assi
+0000d4a0: 676e 696e 6720 7468 656d 2074 6f20 7468  gning them to th
+0000d4b0: 6520 7361 6d65 206b 696e 656d 6174 6963  e same kinematic
+0000d4c0: 0d0a 2020 2020 636f 6d70 6f6e 656e 7420  ..    component 
+0000d4d0: 7573 696e 6720 7468 6520 6060 636f 6d70  using the ``comp
+0000d4e0: 6f6e 656e 7460 6020 6b65 7977 6f72 642e  onent`` keyword.
+0000d4f0: 0d0a 7472 6967 3a0d 0a20 2020 2053 6574  ..trig:..    Set
+0000d500: 2060 6074 7269 673d 5472 7565 6060 2074   ``trig=True`` t
+0000d510: 6f20 7573 6520 7472 6967 6f6e 6f6d 6574  o use trigonomet
+0000d520: 7269 6320 7365 7269 6573 2061 7320 616e  ric series as an
+0000d530: 2061 6c74 6572 6e61 7469 7665 2074 6f0d   alternative to.
+0000d540: 0a20 2020 204c 6567 656e 6472 6520 706f  .    Legendre po
+0000d550: 6c79 6e6f 6d69 616c 732c 2066 6f72 2062  lynomials, for b
+0000d560: 6f74 6820 7468 6520 6164 6469 7469 7665  oth the additive
+0000d570: 2061 6e64 206d 756c 7469 706c 6963 6174   and multiplicat
+0000d580: 6976 650d 0a20 2020 2070 6f6c 796e 6f6d  ive..    polynom
+0000d590: 6961 6c73 2e20 5768 656e 2060 6074 7269  ials. When ``tri
+0000d5a0: 673d 5472 7565 6060 2074 6865 2066 6974  g=True`` the fit
+0000d5b0: 7465 6420 7365 7269 6573 2062 656c 6f77  ted series below
+0000d5c0: 2068 6173 0d0a 2020 2020 6060 4e20 3d20   has..    ``N = 
+0000d5d0: 6465 6772 6565 2f32 6060 206f 7220 6060  degree/2`` or ``
+0000d5e0: 4e20 3d20 6d64 6567 7265 652f 3260 603a  N = mdegree/2``:
+0000d5f0: 3a0d 0a0d 0a20 2020 2020 2020 2070 6f6c  :....        pol
+0000d600: 7920 3d20 415f 3020 2b20 7375 6d5f 7b6e  y = A_0 + sum_{n
+0000d610: 3d31 7d5e 7b4e 7d20 5b41 5f6e 2a63 6f73  =1}^{N} [A_n*cos
+0000d620: 286e 2a74 6829 202b 2042 5f6e 2a73 696e  (n*th) + B_n*sin
+0000d630: 286e 2a74 6829 5d0d 0a0d 0a20 2020 2049  (n*th)]....    I
+0000d640: 4d50 4f52 5441 4e54 3a20 5468 6520 7472  MPORTANT: The tr
+0000d650: 6967 6f6e 6f6d 6574 7269 6320 7365 7269  igonometric seri
+0000d660: 6573 2068 6173 2070 6572 696f 6469 6320  es has periodic 
+0000d670: 626f 756e 6461 7279 2063 6f6e 6469 7469  boundary conditi
+0000d680: 6f6e 732e 0d0a 2020 2020 5468 6973 2069  ons...    This i
+0000d690: 7320 736f 6d65 7469 6d65 7320 6120 6465  s sometimes a de
+0000d6a0: 7369 7261 626c 6520 7072 6f70 6572 7479  sirable property
+0000d6b0: 2c20 6275 7420 7468 6973 2065 7870 616e  , but this expan
+0000d6c0: 7369 6f6e 2069 7320 6e6f 7420 6173 0d0a  sion is not as..
+0000d6d0: 2020 2020 666c 6578 6962 6c65 2061 7320      flexible as 
+0000d6e0: 7468 6520 4c65 6765 6e64 7265 2070 6f6c  the Legendre pol
+0000d6f0: 796e 6f6d 6961 6c73 2e0d 0a76 656c 7363  ynomials...velsc
+0000d700: 616c 655f 7261 7469 6f3a 2069 6e74 2c20  ale_ratio: int, 
+0000d710: 6f70 7469 6f6e 616c 0d0a 2020 2020 496e  optional..    In
+0000d720: 7465 6765 722e 2047 6976 6573 2074 6865  teger. Gives the
+0000d730: 2069 6e74 6567 6572 2060 6072 6174 696f   integer ``ratio
+0000d740: 203e 3d20 3160 6020 6265 7477 6565 6e20   >= 1`` between 
+0000d750: 7468 6520 6060 7665 6c73 6361 6c65 6060  the ``velscale``
+0000d760: 206f 660d 0a20 2020 2074 6865 2060 6067   of..    the ``g
+0000d770: 616c 6178 7960 6020 616e 6420 7468 6520  alaxy`` and the 
+0000d780: 6060 7465 6d70 6c61 7465 7360 602e 2057  ``templates``. W
+0000d790: 6865 6e20 7468 6973 206b 6579 776f 7264  hen this keyword
+0000d7a0: 2069 7320 7573 6564 2c20 7468 650d 0a20   is used, the.. 
+0000d7b0: 2020 2074 656d 706c 6174 6573 2061 7265     templates are
+0000d7c0: 2063 6f6e 766f 6c76 6564 2062 7920 7468   convolved by th
+0000d7d0: 6520 4c4f 5356 4420 6174 2074 6865 6972  e LOSVD at their
+0000d7e0: 206e 6174 6976 6520 7265 736f 6c75 7469   native resoluti
+0000d7f0: 6f6e 2c20 616e 640d 0a20 2020 206f 6e6c  on, and..    onl
+0000d800: 7920 7375 6273 6571 7565 6e74 6c79 2061  y subsequently a
+0000d810: 7265 2069 6e74 6567 7261 7465 6420 6f76  re integrated ov
+0000d820: 6572 2074 6865 2070 6978 656c 7320 616e  er the pixels an
+0000d830: 6420 6669 7474 6564 2074 6f0d 0a20 2020  d fitted to..   
+0000d840: 2060 6067 616c 6178 7960 602e 2054 6869   ``galaxy``. Thi
+0000d850: 7320 6b65 7977 6f72 6420 6973 2067 656e  s keyword is gen
+0000d860: 6572 616c 6c79 2075 6e6e 6563 6573 7361  erally unnecessa
+0000d870: 7279 2061 6e64 206d 6f73 746c 7920 7573  ry and mostly us
+0000d880: 6566 756c 2066 6f72 0d0a 2020 2020 7465  eful for..    te
+0000d890: 7374 696e 672e 0d0a 0d0a 2020 2020 4e6f  sting.....    No
+0000d8a0: 7465 2074 6861 7420 696e 2072 6561 6c69  te that in reali
+0000d8b0: 7374 6963 2073 6974 7561 7469 6f6e 7320  stic situations 
+0000d8c0: 7468 6520 756e 6365 7274 6169 6e74 7920  the uncertainty 
+0000d8d0: 696e 2074 6865 206b 6e6f 776c 6564 6765  in the knowledge
+0000d8e0: 2061 6e64 0d0a 2020 2020 7661 7269 6174   and..    variat
+0000d8f0: 696f 6e73 206f 6620 7468 6520 696e 7472  ions of the intr
+0000d900: 696e 7369 6320 6c69 6e65 2d73 7072 6561  insic line-sprea
+0000d910: 6420 6675 6e63 7469 6f6e 2062 6563 6f6d  d function becom
+0000d920: 6573 2074 6865 206c 696d 6974 696e 670d  es the limiting.
+0000d930: 0a20 2020 2066 6163 746f 7220 696e 2072  .    factor in r
+0000d940: 6563 6f76 6572 696e 6720 7468 6520 4c4f  ecovering the LO
+0000d950: 5356 4420 7765 6c6c 2062 656c 6f77 2060  SVD well below `
+0000d960: 6076 656c 7363 616c 6560 602e 0d0a 7673  `velscale``...vs
+0000d970: 7973 743a 2066 6c6f 6174 2c20 6f70 7469  yst: float, opti
+0000d980: 6f6e 616c 0d0a 2020 2020 5265 6665 7265  onal..    Refere
+0000d990: 6e63 6520 7665 6c6f 6369 7479 2069 6e20  nce velocity in 
+0000d9a0: 6060 6b6d 2f73 6060 2028 6465 6661 756c  ``km/s`` (defaul
+0000d9b0: 7420 3029 2e20 5468 6520 696e 7075 7420  t 0). The input 
+0000d9c0: 696e 6974 6961 6c20 6775 6573 7320 616e  initial guess an
+0000d9d0: 640d 0a20 2020 2074 6865 206f 7574 7075  d..    the outpu
+0000d9e0: 7420 7665 6c6f 6369 7469 6573 2061 7265  t velocities are
+0000d9f0: 206d 6561 7375 7265 6420 7769 7468 2072   measured with r
+0000da00: 6573 7065 6374 2074 6f20 7468 6973 2076  espect to this v
+0000da10: 656c 6f63 6974 792e 2054 6869 730d 0a20  elocity. This.. 
+0000da20: 2020 206b 6579 776f 7264 2063 616e 2062     keyword can b
+0000da30: 6520 7573 6564 2074 6f20 6163 636f 756e  e used to accoun
+0000da40: 7420 666f 7220 7468 6520 6469 6666 6572  t for the differ
+0000da50: 656e 6365 2069 6e20 7468 6520 7374 6172  ence in the star
+0000da60: 7469 6e67 0d0a 2020 2020 7761 7665 6c65  ting..    wavele
+0000da70: 6e67 7468 206f 6620 7468 6520 7465 6d70  ngth of the temp
+0000da80: 6c61 7465 7320 616e 6420 7468 6520 6761  lates and the ga
+0000da90: 6c61 7879 2073 7065 6374 7275 6d20 6173  laxy spectrum as
+0000daa0: 2066 6f6c 6c6f 7773 3a3a 0d0a 0d0a 2020   follows::....  
+0000dab0: 2020 2020 2020 7673 7973 7420 3d20 632a        vsyst = c*
+0000dac0: 6e70 2e6c 6f67 2877 6176 655f 7465 6d70  np.log(wave_temp
+0000dad0: 5b30 5d2f 7761 7665 5f67 616c 5b30 5d29  [0]/wave_gal[0])
+0000dae0: 0d0a 0d0a 2020 2020 4173 2061 6c74 6572  ....    As alter
+0000daf0: 6e61 7469 7665 2074 6f20 7573 696e 6720  native to using 
+0000db00: 7468 6973 206b 6579 776f 7264 2c20 6f6e  this keyword, on
+0000db10: 6520 6361 6e20 7061 7373 2074 6865 2077  e can pass the w
+0000db20: 6176 656c 656e 6774 6873 0d0a 2020 2020  avelengths..    
+0000db30: 6060 6c61 6d60 6020 616e 6420 6060 6c61  ``lam`` and ``la
+0000db40: 6d5f 7465 6d70 6060 206f 6620 626f 7468  m_temp`` of both
+0000db50: 2074 6865 2060 6067 616c 6178 7960 6020   the ``galaxy`` 
+0000db60: 616e 6420 6060 7465 6d70 6c61 7465 7360  and ``templates`
+0000db70: 600d 0a20 2020 2073 7065 6374 7261 2e20  `..    spectra. 
+0000db80: 496e 2074 6861 7420 6361 7365 2020 6060  In that case  ``
+0000db90: 7673 7973 7460 6020 6973 2063 6f6d 7075  vsyst`` is compu
+0000dba0: 7465 6420 6175 746f 6d61 7469 6361 6c6c  ted automaticall
+0000dbb0: 7920 616e 6420 7368 6f75 6c64 0d0a 2020  y and should..  
+0000dbc0: 2020 6e6f 7420 6265 2067 6976 656e 2e0d    not be given..
+0000dbd0: 0a0d 0a20 2020 2054 6865 2076 616c 7565  ...    The value
+0000dbe0: 2061 7373 6967 6e65 6420 746f 2074 6869   assigned to thi
+0000dbf0: 7320 6b65 7977 6f72 6420 6973 202a 6372  s keyword is *cr
+0000dc00: 7563 6961 6c2a 2066 6f72 2074 6865 2074  ucial* for the t
+0000dc10: 776f 2d73 6964 6564 0d0a 2020 2020 6669  wo-sided..    fi
+0000dc20: 7474 696e 672e 2049 6e20 7468 6973 2063  tting. In this c
+0000dc30: 6173 6520 6060 7673 7973 7460 6020 6361  ase ``vsyst`` ca
+0000dc40: 6e20 6265 2064 6574 6572 6d69 6e65 6420  n be determined 
+0000dc50: 6672 6f6d 2061 2070 7265 7669 6f75 730d  from a previous.
+0000dc60: 0a20 2020 206e 6f72 6d61 6c20 6f6e 652d  .    normal one-
+0000dc70: 7369 6465 6420 6669 7420 746f 2074 6865  sided fit to the
+0000dc80: 2067 616c 6178 7920 7665 6c6f 6369 7479   galaxy velocity
+0000dc90: 2070 726f 6669 6c65 2e20 4166 7465 7220   profile. After 
+0000dca0: 7468 6174 2069 6e69 7469 616c 0d0a 2020  that initial..  
+0000dcb0: 2020 6669 742c 2060 6076 7379 7374 6060    fit, ``vsyst``
+0000dcc0: 2063 616e 2062 6520 6465 6669 6e65 6420   can be defined 
+0000dcd0: 6173 2074 6865 206d 6561 7375 7265 6420  as the measured 
+0000dce0: 7665 6c6f 6369 7479 2061 7420 7468 6520  velocity at the 
+0000dcf0: 6761 6c61 7879 0d0a 2020 2020 6365 6e74  galaxy..    cent
+0000dd00: 6572 2e20 4d6f 7265 2061 6363 7572 6174  er. More accurat
+0000dd10: 656c 7920 6060 7673 7973 7460 6020 6973  ely ``vsyst`` is
+0000dd20: 2074 6865 2076 616c 7565 2077 6869 6368   the value which
+0000dd30: 2068 6173 2074 6f20 6265 0d0a 2020 2020   has to be..    
+0000dd40: 7375 6274 7261 6374 6564 2074 6f20 6f62  subtracted to ob
+0000dd50: 7461 696e 2061 206e 6561 726c 7920 616e  tain a nearly an
+0000dd60: 7469 2d73 796d 6d65 7472 6963 2076 656c  ti-symmetric vel
+0000dd70: 6f63 6974 7920 7072 6f66 696c 6520 6174  ocity profile at
+0000dd80: 2074 6865 0d0a 2020 2020 7477 6f20 6f70   the..    two op
+0000dd90: 706f 7369 7465 2073 6964 6573 206f 6620  posite sides of 
+0000dda0: 7468 6520 6761 6c61 7879 206e 7563 6c65  the galaxy nucle
+0000ddb0: 7573 2e0d 0a0d 0a20 2020 2049 4d50 4f52  us.....    IMPOR
+0000ddc0: 5441 4e54 3a20 7468 6973 2076 616c 7565  TANT: this value
+0000ddd0: 2069 7320 6765 6e65 7261 6c6c 7920 2a64   is generally *d
+0000dde0: 6966 6665 7265 6e74 2a20 6672 6f6d 2074  ifferent* from t
+0000ddf0: 6865 2073 7973 7465 6d69 630d 0a20 2020  he systemic..   
+0000de00: 2076 656c 6f63 6974 7920 6f6e 6520 6361   velocity one ca
+0000de10: 6e20 6765 7420 6672 6f6d 2074 6865 206c  n get from the l
+0000de20: 6974 6572 6174 7572 652e 2044 6f20 6e6f  iterature. Do no
+0000de30: 7420 7472 7920 746f 2075 7365 2074 6861  t try to use tha
+0000de40: 7421 0d0a 0d0a 4f75 7470 7574 2050 6172  t!....Output Par
+0000de50: 616d 6574 6572 730d 0a2d 2d2d 2d2d 2d2d  ameters..-------
+0000de60: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a 5374  ----------....St
+0000de70: 6f72 6564 2061 7320 6174 7472 6962 7574  ored as attribut
+0000de80: 6573 206f 6620 7468 6520 6060 7050 5846  es of the ``pPXF
+0000de90: 6060 2063 6c61 7373 3a0d 0a0d 0a2e 6170  `` class:.....ap
+0000dea0: 6f6c 793a 0d0a 2020 2020 5665 6374 6f72  oly:..    Vector
+0000deb0: 2077 6974 6820 7468 6520 6265 7374 2066   with the best f
+0000dec0: 6974 7469 6e67 2061 6464 6974 6976 6520  itting additive 
+0000ded0: 706f 6c79 6e6f 6d69 616c 2e0d 0a2e 6265  polynomial....be
+0000dee0: 7374 6669 743a 0d0a 2020 2020 5665 6374  stfit:..    Vect
+0000def0: 6f72 2077 6974 6820 7468 6520 6265 7374  or with the best
+0000df00: 2066 6974 7469 6e67 206d 6f64 656c 2066   fitting model f
+0000df10: 6f72 2074 6865 2067 616c 6178 7920 7370  or the galaxy sp
+0000df20: 6563 7472 756d 2e0d 0a20 2020 2054 6869  ectrum...    Thi
+0000df30: 7320 6973 2061 206c 696e 6561 7220 636f  s is a linear co
+0000df40: 6d62 696e 6174 696f 6e20 6f66 2074 6865  mbination of the
+0000df50: 2074 656d 706c 6174 6573 2c20 636f 6e76   templates, conv
+0000df60: 6f6c 7665 6420 7769 7468 2074 6865 2062  olved with the b
+0000df70: 6573 740d 0a20 2020 2066 6974 7469 6e67  est..    fitting
+0000df80: 204c 4f53 5644 2c20 6d75 6c74 6970 6c69   LOSVD, multipli
+0000df90: 6564 2062 7920 7468 6520 6d75 6c74 6970  ed by the multip
+0000dfa0: 6c69 6361 7469 7665 2070 6f6c 796e 6f6d  licative polynom
+0000dfb0: 6961 6c73 2061 6e64 0d0a 2020 2020 7769  ials and..    wi
+0000dfc0: 7468 2073 7562 7365 7175 656e 746c 7920  th subsequently 
+0000dfd0: 6164 6465 6420 706f 6c79 6e6f 6d69 616c  added polynomial
+0000dfe0: 2063 6f6e 7469 6e75 756d 2074 6572 6d73   continuum terms
+0000dff0: 206f 7220 736b 7920 636f 6d70 6f6e 656e   or sky componen
+0000e000: 7473 2e0d 0a2e 6368 6932 3a0d 0a20 2020  ts....chi2:..   
+0000e010: 2054 6865 2072 6564 7563 6564 2060 6063   The reduced ``c
+0000e020: 6869 5e32 6060 2028 6e61 6d65 6c79 2060  hi^2`` (namely `
+0000e030: 6063 6869 5e32 2f44 4f46 6060 2920 6f66  `chi^2/DOF``) of
+0000e040: 2074 6865 2066 6974 2c20 7768 6572 650d   the fit, where.
+0000e050: 0a20 2020 2060 6044 4f46 203d 2070 702e  .    ``DOF = pp.
+0000e060: 646f 6660 6020 2028 6170 7072 6f78 696d  dof``  (approxim
+0000e070: 6174 656c 7920 6060 444f 4620 7e20 7070  ately ``DOF ~ pp
+0000e080: 2e67 6f6f 6470 6978 656c 732e 7369 7a65  .goodpixels.size
+0000e090: 6060 292e 0d0a 0d0a 2020 2020 494d 504f  ``).....    IMPO
+0000e0a0: 5254 414e 543a 2069 6620 6060 4368 695e  RTANT: if ``Chi^
+0000e0b0: 322f 444f 4660 6020 6973 206e 6f74 207e  2/DOF`` is not ~
+0000e0c0: 3120 6974 206d 6561 6e73 2074 6861 7420  1 it means that 
+0000e0d0: 7468 6520 6572 726f 7273 2061 7265 206e  the errors are n
+0000e0e0: 6f74 0d0a 2020 2020 7072 6f70 6572 6c79  ot..    properly
+0000e0f0: 2065 7374 696d 6174 6564 2c20 6f72 2074   estimated, or t
+0000e100: 6861 7420 7468 6520 7465 6d70 6c61 7465  hat the template
+0000e110: 2069 7320 6261 6420 616e 6420 6974 2069   is bad and it i
+0000e120: 7320 2a6e 6f74 2a20 7361 6665 2074 6f0d  s *not* safe to.
+0000e130: 0a20 2020 2073 6574 2074 6865 2060 6063  .    set the ``c
+0000e140: 6c65 616e 6060 206b 6579 776f 7264 2e0d  lean`` keyword..
+0000e150: 0a2e 6475 7374 3a0d 0a20 2020 204c 6973  ..dust:..    Lis
+0000e160: 7420 6f66 2064 6963 7469 6f6e 6172 6965  t of dictionarie
+0000e170: 732c 206f 6e65 2066 6f72 2065 6163 6820  s, one for each 
+0000e180: 6669 7474 6564 206a 2d74 6820 6475 7374  fitted j-th dust
+0000e190: 2063 6f6d 706f 6e65 6e74 2e20 466f 720d   component. For.
+0000e1a0: 0a20 2020 2065 6163 6820 6469 6374 696f  .    each dictio
+0000e1b0: 6e61 7279 2c20 6060 6475 7374 5f6a 5b22  nary, ``dust_j["
+0000e1c0: 736f 6c22 5d60 6020 636f 6e74 6169 6e73  sol"]`` contains
+0000e1d0: 2074 6865 2062 6573 742d 6669 7474 696e   the best-fittin
+0000e1e0: 670d 0a20 2020 2070 6172 616d 6574 6572  g..    parameter
+0000e1f0: 206f 6620 7468 6520 6174 7465 6e75 6174   of the attenuat
+0000e200: 696f 6e20 6375 7276 6520 6f66 2074 6861  ion curve of tha
+0000e210: 7420 6475 7374 2063 6f6d 706f 6e65 6e74  t dust component
+0000e220: 2e20 5468 6520 6f74 6865 720d 0a20 2020  . The other..   
+0000e230: 2066 6965 6c64 206f 6620 7468 6520 6469   field of the di
+0000e240: 6374 696f 6e61 7279 2061 7265 2063 6f70  ctionary are cop
+0000e250: 6965 6420 6672 6f6d 2074 6865 2069 6e70  ied from the inp
+0000e260: 7574 2074 6f20 7468 6520 6b65 7977 6f72  ut to the keywor
+0000e270: 640d 0a20 2020 2060 6064 7573 7460 602e  d..    ``dust``.
+0000e280: 0d0a 2e65 7272 6f72 3a0d 0a20 2020 2054  ...error:..    T
+0000e290: 6869 7320 7661 7269 6162 6c65 2063 6f6e  his variable con
+0000e2a0: 7461 696e 7320 6120 7665 6374 6f72 206f  tains a vector o
+0000e2b0: 6620 2a66 6f72 6d61 6c2a 2075 6e63 6572  f *formal* uncer
+0000e2c0: 7461 696e 7479 2028 6060 312a 7369 676d  tainty (``1*sigm
+0000e2d0: 6160 6029 0d0a 2020 2020 666f 7220 7468  a``)..    for th
+0000e2e0: 6520 6669 7474 6564 2070 6172 616d 6574  e fitted paramet
+0000e2f0: 6572 7320 696e 2074 6865 206f 7574 7075  ers in the outpu
+0000e300: 7420 7665 6374 6f72 2060 6073 6f6c 6060  t vector ``sol``
+0000e310: 2e0d 0a20 2020 2054 6865 7920 6172 6520  ...    They are 
+0000e320: 636f 6d70 7574 6564 2066 726f 6d20 7468  computed from th
+0000e330: 6520 6573 7469 6d61 7465 6420 636f 7661  e estimated cova
+0000e340: 7269 616e 6365 206d 6174 7269 7820 6f66  riance matrix of
+0000e350: 2074 6865 2073 7461 6e64 6172 640d 0a20   the standard.. 
+0000e360: 2020 2065 7272 6f72 7320 696e 2074 6865     errors in the
+0000e370: 2066 6974 7465 6420 7061 7261 6d65 7465   fitted paramete
+0000e380: 7273 2061 7373 756d 696e 6720 6974 2069  rs assuming it i
+0000e390: 7320 6469 6167 6f6e 616c 2061 7420 7468  s diagonal at th
+0000e3a0: 6520 6d69 6e69 6d75 6d2e 0d0a 2020 2020  e minimum...    
+0000e3b0: 5468 6973 206f 7074 696f 6e20 6361 6e20  This option can 
+0000e3c0: 6265 2075 7365 6420 7768 656e 2073 7065  be used when spe
+0000e3d0: 6564 2069 7320 6573 7365 6e74 6961 6c2c  ed is essential,
+0000e3e0: 2074 6f20 6f62 7461 696e 2061 6e20 6f72   to obtain an or
+0000e3f0: 6465 7220 6f66 0d0a 2020 2020 6d61 676e  der of..    magn
+0000e400: 6974 7564 6520 6573 7469 6d61 7465 206f  itude estimate o
+0000e410: 6620 7468 6520 756e 6365 7274 6169 6e74  f the uncertaint
+0000e420: 6965 732c 2062 7574 2077 6520 2a73 7472  ies, but we *str
+0000e430: 6f6e 676c 792a 2072 6563 6f6d 6d65 6e64  ongly* recommend
+0000e440: 2074 6f0d 0a20 2020 2072 756e 2062 6f6f   to..    run boo
+0000e450: 7473 7472 6170 7069 6e67 2073 696d 756c  tstrapping simul
+0000e460: 6174 696f 6e73 2074 6f20 6f62 7461 696e  ations to obtain
+0000e470: 206d 6f72 6520 7265 6c69 6162 6c65 2065   more reliable e
+0000e480: 7272 6f72 732e 2049 6e20 6661 6374 2c0d  rrors. In fact,.
+0000e490: 0a20 2020 2074 6865 7365 2065 7272 6f72  .    these error
+0000e4a0: 7320 6361 6e20 6265 2073 6576 6572 656c  s can be severel
+0000e4b0: 7920 756e 6465 7265 7374 696d 6174 6564  y underestimated
+0000e4c0: 2069 6e20 7468 6520 7265 6769 6f6e 2077   in the region w
+0000e4d0: 6865 7265 2074 6865 0d0a 2020 2020 7065  here the..    pe
+0000e4e0: 6e61 6c74 7920 6566 6665 6374 2069 7320  nalty effect is 
+0000e4f0: 6d6f 7374 2069 6d70 6f72 7461 6e74 2028  most important (
+0000e500: 6060 7369 676d 6120 3c20 322a 7665 6c73  ``sigma < 2*vels
+0000e510: 6361 6c65 6060 292e 0d0a 0d0a 2020 2020  cale``).....    
+0000e520: 5468 6573 6520 6572 726f 7273 2061 7265  These errors are
+0000e530: 206d 6561 6e69 6e67 6c65 7373 2075 6e6c   meaningless unl
+0000e540: 6573 7320 6060 4368 695e 322f 444f 4620  ess ``Chi^2/DOF 
+0000e550: 7e20 3160 602e 2048 6f77 6576 6572 2069  ~ 1``. However i
+0000e560: 6620 6f6e 650d 0a20 2020 202a 6173 7375  f one..    *assu
+0000e570: 6d65 732a 2074 6861 7420 7468 6520 6669  mes* that the fi
+0000e580: 7420 6973 2067 6f6f 642c 2061 2063 6f72  t is good, a cor
+0000e590: 7265 6374 6564 2065 7374 696d 6174 6520  rected estimate 
+0000e5a0: 6f66 2074 6865 2065 7272 6f72 7320 6973  of the errors is
+0000e5b0: 3a3a 0d0a 0d0a 2020 2020 2020 2020 6572  ::....        er
+0000e5c0: 726f 725f 636f 7272 203d 2065 7272 6f72  ror_corr = error
+0000e5d0: 2a73 7172 7428 6368 695e 322f 444f 4629  *sqrt(chi^2/DOF)
+0000e5e0: 203d 2070 702e 6572 726f 722a 7371 7274   = pp.error*sqrt
+0000e5f0: 2870 702e 6368 6932 292e 0d0a 0d0a 2020  (pp.chi2).....  
+0000e600: 2020 494d 504f 5254 414e 543a 2077 6865    IMPORTANT: whe
+0000e610: 6e20 7275 6e6e 696e 6720 4d6f 6e74 6520  n running Monte 
+0000e620: 4361 726c 6f20 7369 6d75 6c61 7469 6f6e  Carlo simulation
+0000e630: 7320 746f 2064 6574 6572 6d69 6e65 2074  s to determine t
+0000e640: 6865 2065 7272 6f72 2c0d 0a20 2020 2074  he error,..    t
+0000e650: 6865 2070 656e 616c 7479 2028 6060 6269  he penalty (``bi
+0000e660: 6173 6060 2920 7368 6f75 6c64 2062 6520  as``) should be 
+0000e670: 7365 7420 746f 207a 6572 6f2c 206f 7220  set to zero, or 
+0000e680: 6265 7474 6572 2074 6f20 6120 7665 7279  better to a very
+0000e690: 2073 6d61 6c6c 0d0a 2020 2020 7661 6c75   small..    valu
+0000e6a0: 652e 2053 6565 2053 6563 7469 6f6e 2033  e. See Section 3
+0000e6b0: 2e34 206f 6620 6043 6170 7065 6c6c 6172  .4 of `Cappellar
+0000e6c0: 6920 2620 456d 7365 6c6c 656d 2028 3230  i & Emsellem (20
+0000e6d0: 3034 2960 5f20 666f 7220 616e 0d0a 2020  04)`_ for an..  
+0000e6e0: 2020 6578 706c 616e 6174 696f 6e2e 0d0a    explanation...
+0000e6f0: 2e67 6173 5f62 6573 7466 6974 3a0d 0a20  .gas_bestfit:.. 
+0000e700: 2020 2049 6620 6060 6761 735f 636f 6d70     If ``gas_comp
+0000e710: 6f6e 656e 7420 6973 206e 6f74 204e 6f6e  onent is not Non
+0000e720: 6560 602c 2074 6869 7320 6174 7472 6962  e``, this attrib
+0000e730: 7574 6520 7265 7475 726e 7320 7468 650d  ute returns the.
+0000e740: 0a20 2020 2062 6573 742d 6669 7474 696e  .    best-fittin
+0000e750: 6720 6761 7320 656d 6973 7369 6f6e 2d6c  g gas emission-l
+0000e760: 696e 6573 2073 7065 6374 7275 6d20 616c  ines spectrum al
+0000e770: 6f6e 652e 0d0a 2020 2020 5468 6520 6265  one...    The be
+0000e780: 7374 2d66 6974 7469 6e67 2073 7465 6c6c  st-fitting stell
+0000e790: 6172 2073 7065 6374 7275 6d20 616c 6f6e  ar spectrum alon
+0000e7a0: 6520 6361 6e20 6265 2063 6f6d 7075 7465  e can be compute
+0000e7b0: 6420 6173 0d0a 2020 2020 6060 7374 6172  d as..    ``star
+0000e7c0: 735f 6265 7374 6669 7420 3d20 7070 2e62  s_bestfit = pp.b
+0000e7d0: 6573 7466 6974 202d 2070 702e 6761 735f  estfit - pp.gas_
+0000e7e0: 6265 7374 6669 7460 600d 0a2e 6761 735f  bestfit``...gas_
+0000e7f0: 6265 7374 6669 745f 7465 6d70 6c61 7465  bestfit_template
+0000e800: 733a 0d0a 2020 2020 4966 2060 6067 6173  s:..    If ``gas
+0000e810: 5f63 6f6d 706f 6e65 6e74 2069 7320 6e6f  _component is no
+0000e820: 7420 4e6f 6e65 6060 2c20 7468 6973 2061  t None``, this a
+0000e830: 7474 7269 6275 7465 2072 6574 7572 6e73  ttribute returns
+0000e840: 2074 6865 2069 6e64 6976 6964 7561 6c0d   the individual.
+0000e850: 0a20 2020 2062 6573 742d 6669 7474 696e  .    best-fittin
+0000e860: 6720 6761 7320 656d 6973 7369 6f6e 2d6c  g gas emission-l
+0000e870: 696e 6573 2074 656d 706c 6174 6573 2061  ines templates a
+0000e880: 7320 636f 6c75 6d6e 7320 6f66 2061 6e20  s columns of an 
+0000e890: 6172 7261 792e 0d0a 2020 2020 4e6f 7465  array...    Note
+0000e8a0: 2074 6861 7420 6060 7070 2e67 6173 5f62   that ``pp.gas_b
+0000e8b0: 6573 7466 6974 203d 2070 702e 6761 735f  estfit = pp.gas_
+0000e8c0: 6265 7374 6669 745f 7465 6d70 6c61 7465  bestfit_template
+0000e8d0: 732e 7375 6d28 3129 6060 0d0a 2e67 6173  s.sum(1)``...gas
+0000e8e0: 5f66 6c75 783a 0d0a 2020 2020 5665 6374  _flux:..    Vect
+0000e8f0: 6f72 2077 6974 6820 7468 6520 696e 7465  or with the inte
+0000e900: 6772 6174 6564 2066 6c75 7820 2869 6e20  grated flux (in 
+0000e910: 636f 756e 7473 2920 6f66 2061 6c6c 206c  counts) of all l
+0000e920: 696e 6573 2073 6574 2061 730d 0a20 2020  ines set as..   
+0000e930: 2060 6054 7275 6560 6020 696e 2074 6865   ``True`` in the
+0000e940: 2069 6e70 7574 2060 6067 6173 5f63 6f6d   input ``gas_com
+0000e950: 706f 6e65 6e74 6060 206b 6579 776f 7264  ponent`` keyword
+0000e960: 2e20 5468 6973 2069 7320 7468 6520 666c  . This is the fl
+0000e970: 7578 206f 660d 0a20 2020 2069 6e64 6976  ux of..    indiv
+0000e980: 6964 7561 6c20 6761 7320 7465 6d70 6c61  idual gas templa
+0000e990: 7465 732c 2077 6869 6368 206d 6179 2069  tes, which may i
+0000e9a0: 6e63 6c75 6465 206d 756c 7469 706c 6520  nclude multiple 
+0000e9b0: 6c69 6e65 732e 0d0a 2020 2020 5468 6973  lines...    This
+0000e9c0: 2069 6d70 6c69 6573 2074 6861 742c 2069   implies that, i
+0000e9d0: 6620 6120 6761 7320 7465 6d70 6c61 7465  f a gas template
+0000e9e0: 2064 6573 6372 6962 6573 2061 2064 6f75   describes a dou
+0000e9f0: 626c 6574 2c20 7468 6520 666c 7578 2069  blet, the flux i
+0000ea00: 730d 0a20 2020 2074 6861 7420 6f66 2062  s..    that of b
+0000ea10: 6f74 6820 6c69 6e65 732e 2049 6620 7468  oth lines. If th
+0000ea20: 6520 4261 6c6d 6572 2073 6572 6965 7320  e Balmer series 
+0000ea30: 6973 2069 6e70 7574 2061 7320 6120 7369  is input as a si
+0000ea40: 6e67 6c65 2074 656d 706c 6174 652c 0d0a  ngle template,..
+0000ea50: 2020 2020 7468 6973 2069 7320 7468 6520      this is the 
+0000ea60: 666c 7578 206f 6620 7468 6520 656e 7469  flux of the enti
+0000ea70: 7265 2073 6572 6965 732e 0d0a 0d0a 2020  re series.....  
+0000ea80: 2020 5468 6520 7265 7475 726e 6564 2066    The returned f
+0000ea90: 6c75 7865 7320 6172 6520 6e6f 7420 636f  luxes are not co
+0000eaa0: 7272 6563 7465 6420 696e 2061 6e79 2077  rrected in any w
+0000eab0: 6179 2061 6e64 2069 6e20 7061 7274 6963  ay and in partic
+0000eac0: 756c 6172 2c20 6e6f 0d0a 2020 2020 7265  ular, no..    re
+0000ead0: 6464 656e 696e 6720 636f 7272 6563 7469  ddening correcti
+0000eae0: 6f6e 2069 7320 6170 706c 6965 642e 2049  on is applied. I
+0000eaf0: 6e20 6f74 6865 7220 776f 7264 732c 2074  n other words, t
+0000eb00: 6865 2072 6574 7572 6e65 640d 0a20 2020  he returned..   
+0000eb10: 2060 602e 6761 735f 666c 7578 6060 2073   ``.gas_flux`` s
+0000eb20: 686f 756c 6420 6265 2075 6e63 6861 6e67  hould be unchang
+0000eb30: 6564 2c20 7769 7468 696e 2074 6865 2065  ed, within the e
+0000eb40: 7272 6f72 732c 2072 6567 6172 646c 6573  rrors, regardles
+0000eb50: 7320 6f66 0d0a 2020 2020 7768 6574 6865  s of..    whethe
+0000eb60: 7220 7265 6464 656e 696e 6720 6f72 206d  r reddening or m
+0000eb70: 756c 7469 706c 6963 6174 6976 6520 706f  ultiplicative po
+0000eb80: 6c79 6e6f 6d69 616c 7320 7765 7265 2066  lynomials were f
+0000eb90: 6974 7465 6420 6279 2060 6070 5058 4660  itted by ``pPXF`
+0000eba0: 600d 0a20 2020 206f 7220 6e6f 742e 0d0a  `..    or not...
+0000ebb0: 0d0a 2020 2020 494d 504f 5254 414e 543a  ..    IMPORTANT:
+0000ebc0: 2060 6070 5058 4660 6020 6d61 6b65 7320   ``pPXF`` makes 
+0000ebd0: 6e6f 2061 7373 756d 7074 696f 6e73 2061  no assumptions a
+0000ebe0: 626f 7574 2074 6865 2069 6e70 7574 2066  bout the input f
+0000ebf0: 6c75 7820 756e 6974 733a 0d0a 2020 2020  lux units:..    
+0000ec00: 5468 6520 7265 7475 726e 6564 2060 602e  The returned ``.
+0000ec10: 6761 735f 666c 7578 6060 2068 6173 2074  gas_flux`` has t
+0000ec20: 6865 2073 616d 6520 756e 6974 7320 616e  he same units an
+0000ec30: 6420 7661 6c75 6573 206f 6e65 2077 6f75  d values one wou
+0000ec40: 6c64 0d0a 2020 2020 6d65 6173 7572 6520  ld..    measure 
+0000ec50: 2877 6974 6820 6c6f 7765 7220 6163 6375  (with lower accu
+0000ec60: 7261 6379 2920 6279 2073 756d 6d69 6e67  racy) by summing
+0000ec70: 2074 6865 2070 6978 656c 7320 7661 6c75   the pixels valu
+0000ec80: 6573 2c20 7769 7468 696e 2074 6865 0d0a  es, within the..
+0000ec90: 2020 2020 6769 7665 6e20 6761 7320 6c69      given gas li
+0000eca0: 6e65 732c 206f 6e20 7468 6520 636f 6e74  nes, on the cont
+0000ecb0: 696e 7575 6d2d 7375 6274 7261 6374 6564  inuum-subtracted
+0000ecc0: 2069 6e70 7574 2067 616c 6178 7920 7370   input galaxy sp
+0000ecd0: 6563 7472 756d 2e0d 0a20 2020 2054 6869  ectrum...    Thi
+0000ece0: 7320 696d 706c 6965 7320 7468 6174 2c20  s implies that, 
+0000ecf0: 6966 2074 6865 2073 7065 6374 7275 6d20  if the spectrum 
+0000ed00: 6973 2069 6e20 756e 6974 7320 6f66 2060  is in units of `
+0000ed10: 6065 7267 2f28 7320 636d 5e32 2041 2960  `erg/(s cm^2 A)`
+0000ed20: 602c 0d0a 2020 2020 7468 6520 6060 2e67  `,..    the ``.g
+0000ed30: 6173 5f66 6c75 7860 6020 7265 7475 726e  as_flux`` return
+0000ed40: 6564 2062 7920 6060 7050 5846 6060 2073  ed by ``pPXF`` s
+0000ed50: 686f 756c 6420 6265 206d 756c 7469 706c  hould be multipl
+0000ed60: 6965 6420 6279 2074 6865 0d0a 2020 2020  ied by the..    
+0000ed70: 7069 7865 6c20 7369 7a65 2069 6e20 416e  pixel size in An
+0000ed80: 6773 7472 6f6d 2061 7420 7468 6520 6c69  gstrom at the li
+0000ed90: 6e65 2077 6176 656c 656e 6774 6820 746f  ne wavelength to
+0000eda0: 206f 6274 6169 6e20 7468 6520 696e 7465   obtain the inte
+0000edb0: 6772 6174 6564 0d0a 2020 2020 6c69 6e65  grated..    line
+0000edc0: 2066 6c75 7820 696e 2075 6e69 7473 206f   flux in units o
+0000edd0: 6620 6060 6572 672f 2873 2063 6d5e 3229  f ``erg/(s cm^2)
+0000ede0: 6060 2e0d 0a0d 0a20 2020 204e 4f54 453a  ``.....    NOTE:
+0000edf0: 2049 6620 7468 6572 6520 6973 206e 6f20   If there is no 
+0000ee00: 6761 7320 7265 6464 656e 696e 6720 616e  gas reddening an
+0000ee10: 6420 6561 6368 2069 6e70 7574 2067 6173  d each input gas
+0000ee20: 2074 656d 706c 6174 6520 7761 730d 0a20   template was.. 
+0000ee30: 2020 206e 6f72 6d61 6c69 7a65 6420 746f     normalized to
+0000ee40: 2060 6073 756d 203d 2031 6060 2c20 7468   ``sum = 1``, th
+0000ee50: 656e 0d0a 2020 2020 6060 7070 2e67 6173  en..    ``pp.gas
+0000ee60: 5f66 6c75 7820 3d20 7070 2e77 6569 6768  _flux = pp.weigh
+0000ee70: 7473 5b70 702e 6761 735f 636f 6d70 6f6e  ts[pp.gas_compon
+0000ee80: 656e 745d 6060 2e0d 0a0d 0a20 2020 2057  ent]``.....    W
+0000ee90: 6865 6e20 6120 6761 7320 7465 6d70 6c61  hen a gas templa
+0000eea0: 7465 2069 7320 6964 656e 7469 6361 6c6c  te is identicall
+0000eeb0: 7920 7a65 726f 2077 6974 6869 6e20 7468  y zero within th
+0000eec0: 6520 6669 7474 6564 2072 6567 696f 6e2c  e fitted region,
+0000eed0: 2074 6865 6e0d 0a20 2020 2060 6070 702e   then..    ``pp.
+0000eee0: 6761 735f 666c 7578 203d 2070 702e 6761  gas_flux = pp.ga
+0000eef0: 735f 666c 7578 5f65 7272 6f72 203d 206e  s_flux_error = n
+0000ef00: 702e 6e61 6e60 602e 2054 6865 2063 6f72  p.nan``. The cor
+0000ef10: 7265 7370 6f6e 6469 6e67 0d0a 2020 2020  responding..    
+0000ef20: 636f 6d70 6f6e 656e 7473 206f 6620 6060  components of ``
+0000ef30: 7070 2e67 6173 5f7a 6572 6f5f 7465 6d70  pp.gas_zero_temp
+0000ef40: 6c61 7465 6060 2061 7265 2073 6574 2074  late`` are set t
+0000ef50: 6f20 6060 5472 7565 6060 2e20 5468 6573  o ``True``. Thes
+0000ef60: 650d 0a20 2020 2060 606e 702e 6e61 6e60  e..    ``np.nan`
+0000ef70: 6020 7661 6c75 6573 2061 7265 2073 6574  ` values are set
+0000ef80: 2061 7420 7468 6520 656e 6420 6f66 2074   at the end of t
+0000ef90: 6865 2063 616c 6375 6c61 7469 6f6e 2074  he calculation t
+0000efa0: 6f20 666c 6167 2074 6865 0d0a 2020 2020  o flag the..    
+0000efb0: 756e 6465 6669 6e65 6420 7661 6c75 6573  undefined values
+0000efc0: 2e20 5468 6573 6520 666c 6167 7320 6765  . These flags ge
+0000efd0: 6e65 7261 6c6c 7920 696e 6469 6361 7465  nerally indicate
+0000efe0: 2074 6861 7420 736f 6d65 206f 6620 7468   that some of th
+0000eff0: 6520 6761 730d 0a20 2020 2074 656d 706c  e gas..    templ
+0000f000: 6174 6573 2070 6173 7365 6420 746f 2060  ates passed to `
+0000f010: 6070 5058 4660 6020 636f 6e73 6973 7420  `pPXF`` consist 
+0000f020: 6f66 2067 6173 2065 6d69 7373 696f 6e20  of gas emission 
+0000f030: 6c69 6e65 7320 7468 6174 2066 616c 6c0d  lines that fall.
+0000f040: 0a20 2020 206f 7574 7369 6465 2074 6865  .    outside the
+0000f050: 2066 6974 7465 6420 7761 7665 6c65 6e67   fitted waveleng
+0000f060: 7468 2072 616e 6765 206f 7220 7769 7468  th range or with
+0000f070: 696e 2061 206d 6173 6b65 6420 7370 6563  in a masked spec
+0000f080: 7472 616c 2072 6567 696f 6e2e 0d0a 2020  tral region...  
+0000f090: 2020 5468 6573 6520 6060 6e70 2e6e 616e    These ``np.nan
+0000f0a0: 6060 2064 6f20 2a6e 6f74 2a20 696e 6469  `` do *not* indi
+0000f0b0: 6361 7465 206e 756d 6572 6963 616c 2069  cate numerical i
+0000f0c0: 7373 7565 7320 7769 7468 2074 6865 2061  ssues with the a
+0000f0d0: 6374 7561 6c0d 0a20 2020 2060 6070 5058  ctual..    ``pPX
+0000f0e0: 4660 6020 6361 6c63 756c 6174 696f 6e20  F`` calculation 
+0000f0f0: 616e 6420 7468 6520 7265 7374 206f 6620  and the rest of 
+0000f100: 7468 6520 6060 7050 5846 6060 206f 7574  the ``pPXF`` out
+0000f110: 7075 7420 6973 2072 656c 6961 626c 652e  put is reliable.
+0000f120: 0d0a 2e67 6173 5f66 6c75 785f 6572 726f  ...gas_flux_erro
+0000f130: 723a 0d0a 2020 2020 2a46 6f72 6d61 6c2a  r:..    *Formal*
+0000f140: 2075 6e63 6572 7461 696e 7479 2028 6060   uncertainty (``
+0000f150: 312a 7369 676d 6160 6029 2066 6f72 2074  1*sigma``) for t
+0000f160: 6865 2071 7561 6e74 6974 7920 6060 7070  he quantity ``pp
+0000f170: 2e67 6173 5f66 6c75 7860 602c 2069 6e0d  .gas_flux``, in.
+0000f180: 0a20 2020 2074 6865 2073 616d 6520 756e  .    the same un
+0000f190: 6974 7320 6173 2074 6865 2067 6173 2066  its as the gas f
+0000f1a0: 6c75 7865 732e 0d0a 0d0a 2020 2020 5468  luxes.....    Th
+0000f1b0: 6973 2065 7272 6f72 2069 7320 6170 7072  is error is appr
+0000f1c0: 6f78 696d 6174 6520 6173 2069 7420 6967  oximate as it ig
+0000f1d0: 6e6f 7265 7320 7468 6520 636f 7661 7269  nores the covari
+0000f1e0: 616e 6365 2062 6574 7765 656e 2074 6865  ance between the
+0000f1f0: 2067 6173 0d0a 2020 2020 666c 7578 2061   gas..    flux a
+0000f200: 6e64 2061 6e79 206e 6f6e 2d6c 696e 6561  nd any non-linea
+0000f210: 7220 7061 7261 6d65 7465 722e 2042 6f6f  r parameter. Boo
+0000f220: 7473 7472 6170 7069 6e67 2063 616e 2062  tstrapping can b
+0000f230: 6520 7573 6564 2066 6f72 206d 6f72 650d  e used for more.
+0000f240: 0a20 2020 2061 6363 7572 6174 6520 6572  .    accurate er
+0000f250: 726f 7273 2e0d 0a0d 0a20 2020 2054 6865  rors.....    The
+0000f260: 7365 2065 7272 6f72 7320 6172 6520 6d65  se errors are me
+0000f270: 616e 696e 676c 6573 7320 756e 6c65 7373  aningless unless
+0000f280: 2060 6043 6869 5e32 2f44 4f46 207e 2031   ``Chi^2/DOF ~ 1
+0000f290: 6060 2e20 486f 7765 7665 7220 6966 206f  ``. However if o
+0000f2a0: 6e65 0d0a 2020 2020 2a61 7373 756d 6573  ne..    *assumes
+0000f2b0: 2a20 7468 6174 2074 6865 2066 6974 2069  * that the fit i
+0000f2c0: 7320 676f 6f64 2c20 6120 636f 7272 6563  s good, a correc
+0000f2d0: 7465 6420 6573 7469 6d61 7465 206f 6620  ted estimate of 
+0000f2e0: 7468 6520 6572 726f 7273 2069 733a 3a0d  the errors is::.
+0000f2f0: 0a0d 0a20 2020 2020 2020 2067 6173 5f66  ...        gas_f
+0000f300: 6c75 785f 6572 726f 725f 636f 7272 203d  lux_error_corr =
+0000f310: 2067 6173 5f66 6c75 785f 6572 726f 722a   gas_flux_error*
+0000f320: 7371 7274 2863 6869 5e32 2f44 4f46 290d  sqrt(chi^2/DOF).
+0000f330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f340: 2020 2020 2020 2020 2020 2020 203d 2070               = p
+0000f350: 702e 6761 735f 666c 7578 5f65 7272 6f72  p.gas_flux_error
+0000f360: 2a73 7172 7428 7070 2e63 6869 3229 2e0d  *sqrt(pp.chi2)..
+0000f370: 0a0d 0a2e 6761 735f 6d70 6f6c 793a 0d0a  ....gas_mpoly:..
+0000f380: 2020 2020 7665 6374 6f72 2077 6974 6820      vector with 
+0000f390: 7468 6520 6265 7374 2d66 6974 7469 6e67  the best-fitting
+0000f3a0: 2067 6173 2072 6564 6465 6e69 6e67 2063   gas reddening c
+0000f3b0: 7572 7665 2e0d 0a2e 6761 735f 7265 6464  urve....gas_redd
+0000f3c0: 656e 696e 673a 0d0a 2020 2020 4265 7374  ening:..    Best
+0000f3d0: 2066 6974 7469 6e67 2060 6041 5f56 6060   fitting ``A_V``
+0000f3e0: 2076 616c 7565 2069 6620 7468 6520 6060   value if the ``
+0000f3f0: 6761 735f 7265 6464 656e 696e 6760 6020  gas_reddening`` 
+0000f400: 6b65 7977 6f72 6420 6973 2073 6574 2e0d  keyword is set..
+0000f410: 0a20 2020 2054 6869 7320 6973 2065 7370  .    This is esp
+0000f420: 6563 6961 6c6c 7920 7573 6566 756c 2077  ecially useful w
+0000f430: 6865 6e20 7468 6520 4261 6c6d 6572 2073  hen the Balmer s
+0000f440: 6572 6965 7320 6973 2069 6e70 7574 2061  eries is input a
+0000f450: 7320 6120 7369 6e67 6c65 0d0a 2020 2020  s a single..    
+0000f460: 7465 6d70 6c61 7465 2077 6974 6820 616e  template with an
+0000f470: 2061 7373 756d 6564 2074 6865 6f72 6574   assumed theoret
+0000f480: 6963 616c 6c79 2070 7265 6469 6374 6564  ically predicted
+0000f490: 2064 6563 7265 6d65 6e74 2065 2e67 2e20   decrement e.g. 
+0000f4a0: 7573 696e 670d 0a20 2020 2060 6065 6d69  using..    ``emi
+0000f4b0: 7373 696f 6e5f 6c69 6e65 7328 2e2e 2e2c  ssion_lines(...,
+0000f4c0: 2074 6965 5f62 616c 6d65 723d 5472 7565   tie_balmer=True
+0000f4d0: 2960 6020 696e 2060 6070 7078 662e 7070  )`` in ``ppxf.pp
+0000f4e0: 7866 5f75 7469 6c60 6020 746f 0d0a 2020  xf_util`` to..  
+0000f4f0: 2020 636f 6d70 7574 6520 7468 6520 6761    compute the ga
+0000f500: 7320 7465 6d70 6c61 7465 732e 0d0a 2e67  s templates....g
+0000f510: 6173 5f7a 6572 6f5f 7465 6d70 6c61 7465  as_zero_template
+0000f520: 3a0d 0a20 2020 2076 6563 746f 7220 6f66  :..    vector of
+0000f530: 2073 697a 6520 6060 6761 735f 636f 6d70   size ``gas_comp
+0000f540: 6f6e 656e 742e 7375 6d28 2960 6020 7365  onent.sum()`` se
+0000f550: 7420 746f 2060 6054 7275 6560 6020 7768  t to ``True`` wh
+0000f560: 6572 650d 0a20 2020 2074 6865 2067 6173  ere..    the gas
+0000f570: 2074 656d 706c 6174 6520 7761 7320 6964   template was id
+0000f580: 656e 7469 6361 6c6c 7920 7a65 726f 2077  entically zero w
+0000f590: 6974 6869 6e20 7468 6520 6669 7474 6564  ithin the fitted
+0000f5a0: 2072 6567 696f 6e2e 0d0a 2020 2020 466f   region...    Fo
+0000f5b0: 7220 7468 6f73 6520 6761 7320 636f 6d70  r those gas comp
+0000f5c0: 6f6e 656e 7473 2060 6070 702e 6761 735f  onents ``pp.gas_
+0000f5d0: 666c 7578 203d 2070 702e 6761 735f 666c  flux = pp.gas_fl
+0000f5e0: 7578 5f65 7272 6f72 203d 206e 702e 6e61  ux_error = np.na
+0000f5f0: 6e60 602e 0d0a 2020 2020 5468 6573 6520  n``...    These 
+0000f600: 666c 6167 7320 6765 6e65 7261 6c6c 7920  flags generally 
+0000f610: 696e 6469 6361 7465 2074 6861 7420 736f  indicate that so
+0000f620: 6d65 206f 6620 7468 6520 6761 7320 7465  me of the gas te
+0000f630: 6d70 6c61 7465 7320 7061 7373 6564 2074  mplates passed t
+0000f640: 6f0d 0a20 2020 2060 6070 5058 4660 6020  o..    ``pPXF`` 
+0000f650: 636f 6e73 6973 7420 6f66 2067 6173 2065  consist of gas e
+0000f660: 6d69 7373 696f 6e20 6c69 6e65 7320 7468  mission lines th
+0000f670: 6174 2066 616c 6c20 6f75 7473 6964 6520  at fall outside 
+0000f680: 7468 6520 6669 7474 6564 0d0a 2020 2020  the fitted..    
+0000f690: 7761 7665 6c65 6e67 7468 2072 616e 6765  wavelength range
+0000f6a0: 206f 7220 7769 7468 696e 2061 206d 6173   or within a mas
+0000f6b0: 6b65 6420 7370 6563 7472 616c 2072 6567  ked spectral reg
+0000f6c0: 696f 6e2e 0d0a 2e67 6f6f 6470 6978 656c  ion....goodpixel
+0000f6d0: 733a 0d0a 2020 2020 496e 7465 6765 7220  s:..    Integer 
+0000f6e0: 7665 6374 6f72 2063 6f6e 7461 696e 696e  vector containin
+0000f6f0: 6720 7468 6520 696e 6469 6365 7320 6f66  g the indices of
+0000f700: 2074 6865 2067 6f6f 6420 7069 7865 6c73   the good pixels
+0000f710: 2069 6e20 7468 6520 6669 742e 0d0a 2020   in the fit...  
+0000f720: 2020 5468 6973 2076 6563 746f 7220 6973    This vector is
+0000f730: 2061 2063 6f70 7920 6f66 2074 6865 2069   a copy of the i
+0000f740: 6e70 7574 2060 6067 6f6f 6470 6978 656c  nput ``goodpixel
+0000f750: 7360 6020 6966 2060 6063 6c65 616e 203d  s`` if ``clean =
+0000f760: 2046 616c 7365 6060 0d0a 2020 2020 6f74   False``..    ot
+0000f770: 6865 7277 6973 6520 6974 2077 696c 6c20  herwise it will 
+0000f780: 6265 2075 7064 6174 6564 2062 7920 7265  be updated by re
+0000f790: 6d6f 7669 6e67 2074 6865 2064 6574 6563  moving the detec
+0000f7a0: 7465 6420 6f75 746c 6965 7273 2e0d 0a2e  ted outliers....
+0000f7b0: 6d61 7472 6978 3a0d 0a20 2020 2050 7265  matrix:..    Pre
+0000f7c0: 6469 6374 696f 6e20 6060 6d61 7472 6978  diction ``matrix
+0000f7d0: 5b6e 5f70 6978 656c 732c 2064 6567 7265  [n_pixels, degre
+0000f7e0: 6520 2b20 6e5f 7465 6d70 6c61 7465 7320  e + n_templates 
+0000f7f0: 2b20 6e5f 736b 795d 6060 206f 6620 7468  + n_sky]`` of th
+0000f800: 650d 0a20 2020 206c 696e 6561 7220 7379  e..    linear sy
+0000f810: 7374 656d 2e0d 0a0d 0a20 2020 2060 6070  stem.....    ``p
+0000f820: 702e 6d61 7472 6978 5b6e 5f70 6978 656c  p.matrix[n_pixel
+0000f830: 732c 203a 2064 6567 7265 655d 6060 2063  s, : degree]`` c
+0000f840: 6f6e 7461 696e 7320 7468 6520 6164 6469  ontains the addi
+0000f850: 7469 7665 2070 6f6c 796e 6f6d 6961 6c73  tive polynomials
+0000f860: 2069 660d 0a20 2020 2060 6064 6567 7265   if..    ``degre
+0000f870: 6520 3e3d 2030 6060 2e0d 0a0d 0a20 2020  e >= 0``.....   
+0000f880: 2060 6070 702e 6d61 7472 6978 5b6e 5f70   ``pp.matrix[n_p
+0000f890: 6978 656c 732c 2064 6567 7265 6520 3a20  ixels, degree : 
+0000f8a0: 6465 6772 6565 202b 206e 5f74 656d 706c  degree + n_templ
+0000f8b0: 6174 6573 5d60 6020 636f 6e74 6169 6e73  ates]`` contains
+0000f8c0: 2074 6865 0d0a 2020 2020 7374 656c 6c61   the..    stella
+0000f8d0: 722f 6761 7320 7465 6d70 6c61 7465 7320  r/gas templates 
+0000f8e0: 636f 6e76 6f6c 7665 6420 6279 2074 6865  convolved by the
+0000f8f0: 204c 4f53 5644 2c20 616e 6420 6d75 6c74   LOSVD, and mult
+0000f900: 6970 6c69 6564 2062 7920 7468 650d 0a20  iplied by the.. 
+0000f910: 2020 206d 756c 7469 706c 6963 6174 6976     multiplicativ
+0000f920: 6520 706f 6c79 6e6f 6d69 616c 7320 6966  e polynomials if
+0000f930: 2060 606d 6465 6772 6565 203e 2030 6060   ``mdegree > 0``
+0000f940: 2e0d 0a2e 6d70 6f6c 793a 0d0a 2020 2020  ....mpoly:..    
+0000f950: 4265 7374 2066 6974 7469 6e67 206d 756c  Best fitting mul
+0000f960: 7469 706c 6963 6174 6976 6520 706f 6c79  tiplicative poly
+0000f970: 6e6f 6d69 616c 2028 6f72 2072 6564 6465  nomial (or redde
+0000f980: 6e69 6e67 2063 7572 7665 2077 6865 6e0d  ning curve when.
+0000f990: 0a20 2020 2060 6072 6564 6465 6e69 6e67  .    ``reddening
+0000f9a0: 6060 2069 7320 7365 7429 2e0d 0a2e 6d70  `` is set)....mp
+0000f9b0: 6f6c 7977 6569 6768 7473 3a0d 0a20 2020  olyweights:..   
+0000f9c0: 2054 6869 7320 6973 206c 6172 6765 6c79   This is largely
+0000f9d0: 2073 7570 6572 7365 6465 6420 6279 2074   superseded by t
+0000f9e0: 6865 2060 602e 6d70 6f6c 7960 6020 6174  he ``.mpoly`` at
+0000f9f0: 7472 6962 7574 6520 6162 6f76 652e 0d0a  tribute above...
+0000fa00: 0d0a 2020 2020 5768 656e 2060 606d 6465  ..    When ``mde
+0000fa10: 6772 6565 203e 2030 6060 2074 6869 7320  gree > 0`` this 
+0000fa20: 636f 6e74 6169 6e73 2069 6e20 6f75 7470  contains in outp
+0000fa30: 7574 2074 6865 2063 6f65 6666 6963 6965  ut the coefficie
+0000fa40: 6e74 7320 6f66 2074 6865 0d0a 2020 2020  nts of the..    
+0000fa50: 6d75 6c74 6970 6c69 6361 7469 7665 204c  multiplicative L
+0000fa60: 6567 656e 6472 6520 706f 6c79 6e6f 6d69  egendre polynomi
+0000fa70: 616c 7320 6f66 206f 7264 6572 2060 6031  als of order ``1
+0000fa80: 2c20 322c 2e2e 2e20 6d64 6567 7265 6560  , 2,... mdegree`
+0000fa90: 602e 0d0a 2020 2020 5468 6520 706f 6c79  `...    The poly
+0000faa0: 6e6f 6d69 616c 2063 616e 2062 6520 6578  nomial can be ex
+0000fab0: 706c 6963 6974 6c79 2065 7661 6c75 6174  plicitly evaluat
+0000fac0: 6564 2061 733a 3a0d 0a0d 0a20 2020 2020  ed as::....     
+0000fad0: 2020 2066 726f 6d20 6e75 6d70 792e 706f     from numpy.po
+0000fae0: 6c79 6e6f 6d69 616c 2069 6d70 6f72 7420  lynomial import 
+0000faf0: 6c65 6765 6e64 7265 0d0a 2020 2020 2020  legendre..      
+0000fb00: 2020 7820 3d20 6e70 2e6c 696e 7370 6163    x = np.linspac
+0000fb10: 6528 2d31 2c20 312c 206c 656e 2867 616c  e(-1, 1, len(gal
+0000fb20: 6178 7929 290d 0a20 2020 2020 2020 206d  axy))..        m
+0000fb30: 706f 6c79 203d 206c 6567 656e 6472 652e  poly = legendre.
+0000fb40: 6c65 6776 616c 2878 2c20 6e70 2e61 7070  legval(x, np.app
+0000fb50: 656e 6428 312c 2070 702e 6d70 6f6c 7977  end(1, pp.mpolyw
+0000fb60: 6569 6768 7473 2929 0d0a 0d0a 2020 2020  eights))....    
+0000fb70: 5768 656e 2060 6074 7269 6720 3d20 5472  When ``trig = Tr
+0000fb80: 7565 6060 2074 6865 2070 6f6c 796e 6f6d  ue`` the polynom
+0000fb90: 6961 6c20 6973 2065 7661 6c75 6174 6564  ial is evaluated
+0000fba0: 2061 733a 3a0d 0a0d 0a20 2020 2020 2020   as::....       
+0000fbb0: 206d 706f 6c79 203d 2070 702e 7472 6967   mpoly = pp.trig
+0000fbc0: 7661 6c28 782c 206e 702e 6170 7065 6e64  val(x, np.append
+0000fbd0: 2831 2c20 7070 2e6d 706f 6c79 7765 6967  (1, pp.mpolyweig
+0000fbe0: 6874 7329 290d 0a0d 0a2e 7068 6f74 5f62  hts)).....phot_b
+0000fbf0: 6573 7466 6974 3a20 6172 7261 795f 6c69  estfit: array_li
+0000fc00: 6b65 2077 6974 6820 7368 6170 6520 286e  ke with shape (n
+0000fc10: 5f70 686f 7429 0d0a 2020 2020 5768 656e  _phot)..    When
+0000fc20: 2060 6070 686f 7460 6020 6973 2067 6976   ``phot`` is giv
+0000fc30: 656e 2c20 7468 656e 2074 6869 7320 6174  en, then this at
+0000fc40: 7472 6962 7574 6520 636f 6e74 6169 6e73  tribute contains
+0000fc50: 2074 6865 2062 6573 7420 6669 7474 696e   the best fittin
+0000fc60: 670d 0a20 2020 2066 6c75 7865 7320 696e  g..    fluxes in
+0000fc70: 2074 6865 2070 686f 746f 6d65 7472 6963   the photometric
+0000fc80: 2062 616e 6473 2067 6976 656e 2061 7320   bands given as 
+0000fc90: 696e 7075 7420 696e 2060 6070 686f 745f  input in ``phot_
+0000fca0: 6761 6c61 7879 6060 2e0d 0a2e 706c 6f74  galaxy``....plot
+0000fcb0: 3a20 6675 6e63 7469 6f6e 0d0a 2020 2020  : function..    
+0000fcc0: 4361 6c6c 2074 6865 206d 6574 686f 6420  Call the method 
+0000fcd0: 6675 6e63 7469 6f6e 2060 6070 702e 706c  function ``pp.pl
+0000fce0: 6f74 2829 6060 2061 6674 6572 2074 6865  ot()`` after the
+0000fcf0: 2063 616c 6c20 746f 0d0a 2020 2020 6060   call to..    ``
+0000fd00: 7070 203d 2070 7078 6628 2e2e 2e29 6060  pp = ppxf(...)``
+0000fd10: 2074 6f20 7072 6f64 7563 6520 6120 706c   to produce a pl
+0000fd20: 6f74 206f 6620 7468 6520 6265 7374 2066  ot of the best f
+0000fd30: 6974 2e20 5468 6973 2069 7320 616e 0d0a  it. This is an..
+0000fd40: 2020 2020 616c 7465 726e 6174 6976 6520      alternative 
+0000fd50: 746f 2063 616c 6c69 6e67 2060 6070 7020  to calling ``pp 
+0000fd60: 3d20 7070 7866 282e 2e2e 2c20 706c 6f74  = ppxf(..., plot
+0000fd70: 3d54 7275 6529 6060 2e0d 0a0d 0a20 2020  =True)``.....   
+0000fd80: 2055 7365 2074 6865 2063 6f6d 6d61 6e64   Use the command
+0000fd90: 2060 6070 702e 706c 6f74 2867 6173 5f63   ``pp.plot(gas_c
+0000fda0: 6c69 703d 5472 7565 2960 6020 746f 2073  lip=True)`` to s
+0000fdb0: 6361 6c65 2074 6865 2070 6c6f 7420 6261  cale the plot ba
+0000fdc0: 7365 6420 6f6e 0d0a 2020 2020 7468 6520  sed on..    the 
+0000fdd0: 7374 656c 6c61 7220 636f 6e74 696e 7575  stellar continuu
+0000fde0: 6d20 616c 6f6e 652c 2077 6869 6c65 2061  m alone, while a
+0000fdf0: 6c6c 6f77 696e 6720 666f 7220 7468 6520  llowing for the 
+0000fe00: 6761 7320 656d 6973 7369 6f6e 206c 696e  gas emission lin
+0000fe10: 6573 0d0a 2020 2020 746f 2067 6f20 6f75  es..    to go ou
+0000fe20: 7473 6964 6520 7468 6520 706c 6f74 7469  tside the plotti
+0000fe30: 6e67 2072 6567 696f 6e2e 2054 6869 7320  ng region. This 
+0000fe40: 6973 2075 7365 6675 6c20 746f 2069 6e73  is useful to ins
+0000fe50: 7065 6374 2074 6865 2066 6974 0d0a 2020  pect the fit..  
+0000fe60: 2020 746f 2074 6865 2073 7465 6c6c 6172    to the stellar
+0000fe70: 2063 6f6e 7469 6e75 756d 2c20 696e 2074   continuum, in t
+0000fe80: 6865 2070 7265 7365 6e63 6520 6f66 2073  he presence of s
+0000fe90: 7472 6f6e 6720 6761 7320 656d 6973 7369  trong gas emissi
+0000fea0: 6f6e 206c 696e 6573 2e0d 0a20 2020 2054  on lines...    T
+0000feb0: 6869 7320 6861 7320 6566 6665 6374 206f  his has effect o
+0000fec0: 6e6c 7920 6966 2060 6067 6173 5f63 6f6d  nly if ``gas_com
+0000fed0: 706f 6e65 6e74 2069 7320 6e6f 7420 4e6f  ponent is not No
+0000fee0: 6e65 6060 2e0d 0a0d 0a20 2020 2055 7365  ne``.....    Use
+0000fef0: 2074 6865 2063 6f6d 6d61 6e64 2060 6070   the command ``p
+0000ff00: 702e 706c 6f74 282e 2e2e 2c20 7370 6563  p.plot(..., spec
+0000ff10: 3d54 7275 6529 6060 2074 6f20 696e 636c  =True)`` to incl
+0000ff20: 7564 6520 7468 6520 6761 6c61 7879 0d0a  ude the galaxy..
+0000ff30: 2020 2020 7370 6563 7472 756d 2069 6e20      spectrum in 
+0000ff40: 7468 6520 706c 6f74 2061 6e64 2060 6070  the plot and ``p
+0000ff50: 702e 706c 6f74 282e 2e2e 2c20 7068 6f74  p.plot(..., phot
+0000ff60: 3d54 7275 6529 6060 2074 6f20 696e 636c  =True)`` to incl
+0000ff70: 7564 6520 7468 650d 0a20 2020 2070 686f  ude the..    pho
+0000ff80: 746f 6d65 7472 6963 206d 6561 7375 7265  tometric measure
+0000ff90: 6d65 6e74 732e 2046 6f72 2065 7861 6d70  ments. For examp
+0000ffa0: 6c65 2c20 7768 656e 2066 6974 7469 6e67  le, when fitting
+0000ffb0: 2073 7065 6374 7261 2061 6e64 0d0a 2020   spectra and..  
+0000ffc0: 2020 7068 6f74 6f6d 6574 7279 2074 6f67    photometry tog
+0000ffd0: 6574 6865 722c 206f 6e65 2063 616e 2075  ether, one can u
+0000ffe0: 7365 2060 6070 702e 706c 6f74 2870 686f  se ``pp.plot(pho
+0000fff0: 743d 5472 7565 2c20 7370 6563 3d46 616c  t=True, spec=Fal
+00010000: 7365 2960 600d 0a20 2020 2074 6f20 706c  se)``..    to pl
+00010010: 6f74 2074 6865 2070 686f 746f 6d65 7472  ot the photometr
+00010020: 7920 616c 6f6e 6520 616e 6420 6060 7070  y alone and ``pp
+00010030: 2e70 6c6f 7428 7068 6f74 3d46 616c 7365  .plot(phot=False
+00010040: 2c20 7370 6563 3d54 7275 6529 6060 0d0a  , spec=True)``..
+00010050: 2020 2020 746f 2070 6c6f 7420 7468 6520      to plot the 
+00010060: 7370 6563 7472 756d 2061 6c6f 6e65 2e20  spectrum alone. 
+00010070: 4279 2064 6566 6175 6c74 2062 6f74 6820  By default both 
+00010080: 7468 6520 7370 6563 7472 756d 2061 6e64  the spectrum and
+00010090: 2070 686f 746f 6d65 7472 790d 0a20 2020   photometry..   
+000100a0: 2061 7265 2069 6e63 6c75 6465 6420 696e   are included in
+000100b0: 2061 2073 696e 676c 6520 706c 6f74 2e0d   a single plot..
+000100c0: 0a2e 706f 6c79 7765 6967 6874 733a 0d0a  ..polyweights:..
+000100d0: 2020 2020 5468 6973 2069 7320 6c61 7267      This is larg
+000100e0: 656c 7920 7375 7065 7273 6564 6564 2062  ely superseded b
+000100f0: 7920 7468 6520 6060 2e61 706f 6c79 6060  y the ``.apoly``
+00010100: 2061 7474 7269 6275 7465 2061 626f 7665   attribute above
+00010110: 2e0d 0a0d 0a20 2020 2057 6865 6e20 6060  .....    When ``
+00010120: 6465 6772 6565 203e 3d20 3060 6020 636f  degree >= 0`` co
+00010130: 6e74 6169 6e73 2074 6865 2077 6569 6768  ntains the weigh
+00010140: 7473 206f 6620 7468 6520 6164 6469 7469  ts of the additi
+00010150: 7665 204c 6567 656e 6472 650d 0a20 2020  ve Legendre..   
+00010160: 2070 6f6c 796e 6f6d 6961 6c73 206f 6620   polynomials of 
+00010170: 6f72 6465 7220 6060 302c 2031 2c2e 2e2e  order ``0, 1,...
+00010180: 2064 6567 7265 6560 602e 2054 6865 2062   degree``. The b
+00010190: 6573 742d 6669 7474 696e 6720 6164 6469  est-fitting addi
+000101a0: 7469 7665 0d0a 2020 2020 706f 6c79 6e6f  tive..    polyno
+000101b0: 6d69 616c 2063 616e 2062 6520 6578 706c  mial can be expl
+000101c0: 6963 6974 6c79 2065 7661 6c75 6174 6564  icitly evaluated
+000101d0: 2061 733a 3a0d 0a0d 0a20 2020 2020 2020   as::....       
+000101e0: 2066 726f 6d20 6e75 6d70 792e 706f 6c79   from numpy.poly
+000101f0: 6e6f 6d69 616c 2069 6d70 6f72 7420 6c65  nomial import le
+00010200: 6765 6e64 7265 0d0a 2020 2020 2020 2020  gendre..        
+00010210: 7820 3d20 6e70 2e6c 696e 7370 6163 6528  x = np.linspace(
+00010220: 2d31 2c20 312c 206c 656e 2867 616c 6178  -1, 1, len(galax
+00010230: 7929 290d 0a20 2020 2020 2020 2061 706f  y))..        apo
+00010240: 6c79 203d 206c 6567 656e 6472 652e 6c65  ly = legendre.le
+00010250: 6776 616c 2878 2c20 7070 2e70 6f6c 7977  gval(x, pp.polyw
+00010260: 6569 6768 7473 290d 0a0d 0a20 2020 2057  eights)....    W
+00010270: 6865 6e20 6060 7472 6967 3d54 7275 6560  hen ``trig=True`
+00010280: 6020 7468 6520 706f 6c79 6e6f 6d69 616c  ` the polynomial
+00010290: 2069 7320 6576 616c 7561 7465 6420 6173   is evaluated as
+000102a0: 3a3a 0d0a 0d0a 2020 2020 2020 2020 6170  ::....        ap
+000102b0: 6f6c 7920 3d20 7070 2e74 7269 6776 616c  oly = pp.trigval
+000102c0: 2878 2c20 7070 2e70 6f6c 7977 6569 6768  (x, pp.polyweigh
+000102d0: 7473 290d 0a0d 0a20 2020 2057 6865 6e20  ts)....    When 
+000102e0: 646f 696e 6720 6120 7477 6f2d 7369 6465  doing a two-side
+000102f0: 6420 6669 7474 696e 6720 2873 6565 2068  d fitting (see h
+00010300: 656c 7020 666f 7220 6060 6761 6c61 7879  elp for ``galaxy
+00010310: 6060 2070 6172 616d 6574 6572 292c 2074  `` parameter), t
+00010320: 6865 0d0a 2020 2020 6164 6469 7469 7665  he..    additive
+00010330: 2070 6f6c 796e 6f6d 6961 6c73 2061 7265   polynomials are
+00010340: 2061 6c6c 6f77 6564 2074 6f20 6265 2064   allowed to be d
+00010350: 6966 6665 7265 6e74 2066 6f72 2074 6865  ifferent for the
+00010360: 206c 6566 7420 616e 6420 7269 6768 740d   left and right.
+00010370: 0a20 2020 2073 7065 6374 7275 6d2e 2049  .    spectrum. I
+00010380: 6e20 7468 6174 2063 6173 652c 2074 6865  n that case, the
+00010390: 206f 7574 7075 7420 7765 6967 6874 7320   output weights 
+000103a0: 6f66 2074 6865 2061 6464 6974 6976 6520  of the additive 
+000103b0: 706f 6c79 6e6f 6d69 616c 730d 0a20 2020  polynomials..   
+000103c0: 2061 6c74 6572 6e61 7465 2062 6574 7765   alternate betwe
+000103d0: 656e 2074 6865 2066 6972 7374 2028 6c65  en the first (le
+000103e0: 6674 2920 7370 6563 7472 756d 2061 6e64  ft) spectrum and
+000103f0: 2074 6865 2073 6563 6f6e 6420 2872 6967   the second (rig
+00010400: 6874 290d 0a20 2020 2073 7065 6374 7275  ht)..    spectru
+00010410: 6d2e 0d0a 2e72 6564 6465 6e69 6e67 3a0d  m....reddening:.
+00010420: 0a20 2020 2042 6573 7420 6669 7474 696e  .    Best fittin
+00010430: 6720 6060 415f 5660 6020 7661 6c75 6520  g ``A_V`` value 
+00010440: 6966 2074 6865 2060 6072 6564 6465 6e69  if the ``reddeni
+00010450: 6e67 6060 206b 6579 776f 7264 2069 7320  ng`` keyword is 
+00010460: 7365 742e 0d0a 2e73 6f6c 3a0d 0a20 2020  set....sol:..   
+00010470: 2056 6563 746f 7220 636f 6e74 6169 6e69   Vector containi
+00010480: 6e67 2069 6e20 6f75 7470 7574 2074 6865  ng in output the
+00010490: 2070 6172 616d 6574 6572 7320 6f66 2074   parameters of t
+000104a0: 6865 206b 696e 656d 6174 6963 732e 0d0a  he kinematics...
+000104b0: 0d0a 2020 2020 2a20 4966 2060 606d 6f6d  ..    * If ``mom
+000104c0: 656e 7473 3d32 6060 2074 6869 7320 636f  ents=2`` this co
+000104d0: 6e74 6169 6e73 2060 605b 5665 6c2c 2053  ntains ``[Vel, S
+000104e0: 6967 6d61 5d60 600d 0a20 2020 202a 2049  igma]``..    * I
+000104f0: 6620 6060 6d6f 6d65 6e74 733d 3460 6020  f ``moments=4`` 
+00010500: 7468 6973 2063 6f6e 7461 696e 7320 6060  this contains ``
+00010510: 5b56 656c 2c20 5369 676d 612c 2068 332c  [Vel, Sigma, h3,
+00010520: 2068 345d 6060 0d0a 2020 2020 2a20 4966   h4]``..    * If
+00010530: 2060 606d 6f6d 656e 7473 3d4e 6060 2074   ``moments=N`` t
+00010540: 6869 7320 636f 6e74 6169 6e73 2060 605b  his contains ``[
+00010550: 5665 6c2c 2053 6967 6d61 2c20 6833 2c2e  Vel, Sigma, h3,.
+00010560: 2e2e 2068 4e5d 6060 0d0a 0d0a 2020 2020  .. hN]``....    
+00010570: 5768 656e 2066 6974 7469 6e67 206d 756c  When fitting mul
+00010580: 7469 706c 6520 6b69 6e65 6d61 7469 6320  tiple kinematic 
+00010590: 6060 636f 6d70 6f6e 656e 7460 602c 2060  ``component``, `
+000105a0: 6070 702e 736f 6c60 6020 636f 6e74 6169  `pp.sol`` contai
+000105b0: 6e73 2061 0d0a 2020 2020 6c69 7374 2077  ns a..    list w
+000105c0: 6974 6820 7468 6520 736f 6c75 7469 6f6e  ith the solution
+000105d0: 2066 6f72 2061 6c6c 2064 6966 6665 7265   for all differe
+000105e0: 6e74 2063 6f6d 706f 6e65 6e74 732c 206f  nt components, o
+000105f0: 6e65 2061 6674 6572 2074 6865 0d0a 2020  ne after the..  
+00010600: 2020 6f74 6865 722c 2073 6f72 7465 6420    other, sorted 
+00010610: 6279 2060 6063 6f6d 706f 6e65 6e74 6060  by ``component``
+00010620: 3a20 6060 7070 2e73 6f6c 203d 205b 736f  : ``pp.sol = [so
+00010630: 6c31 2c20 736f 6c32 2c2e 2e2e 5d60 602e  l1, sol2,...]``.
+00010640: 0d0a 0d0a 2020 2020 6060 5665 6c60 6020  ....    ``Vel`` 
+00010650: 6973 2074 6865 2076 656c 6f63 6974 792c  is the velocity,
+00010660: 2060 6053 6967 6d61 6060 2069 7320 7468   ``Sigma`` is th
+00010670: 6520 7665 6c6f 6369 7479 2064 6973 7065  e velocity dispe
+00010680: 7273 696f 6e2c 0d0a 2020 2020 6060 6833  rsion,..    ``h3
+00010690: 202d 2068 3660 6020 6172 6520 7468 6520   - h6`` are the 
+000106a0: 4761 7573 732d 4865 726d 6974 6520 636f  Gauss-Hermite co
+000106b0: 6566 6669 6369 656e 7473 2e20 5468 6520  efficients. The 
+000106c0: 6d6f 6465 6c20 7061 7261 6d65 7465 7273  model parameters
+000106d0: 0d0a 2020 2020 6172 6520 6669 7474 6564  ..    are fitted
+000106e0: 2073 696d 756c 7461 6e65 6f75 736c 792e   simultaneously.
+000106f0: 0d0a 0d0a 2020 2020 494d 504f 5254 414e  ....    IMPORTAN
+00010700: 543a 2054 6865 2070 7265 6369 7365 2072  T: The precise r
+00010710: 656c 6174 696f 6e20 6265 7477 6565 6e20  elation between 
+00010720: 7468 6520 6f75 7470 7574 2060 6070 5058  the output ``pPX
+00010730: 4660 6020 7665 6c6f 6369 7479 0d0a 2020  F`` velocity..  
+00010740: 2020 616e 6420 7265 6473 6869 6674 2069    and redshift i
+00010750: 7320 6060 5665 6c20 3d20 632a 6e70 2e6c  s ``Vel = c*np.l
+00010760: 6f67 2831 202b 207a 2960 602e 2053 6565  og(1 + z)``. See
+00010770: 2053 6563 7469 6f6e 2032 2e33 206f 660d   Section 2.3 of.
+00010780: 0a20 2020 2060 4361 7070 656c 6c61 7269  .    `Cappellari
+00010790: 2028 3230 3137 2960 5f20 666f 7220 6120   (2017)`_ for a 
+000107a0: 6465 7461 696c 6564 2065 7870 6c61 6e61  detailed explana
+000107b0: 7469 6f6e 2e0d 0a0d 0a20 2020 2054 6865  tion.....    The
+000107c0: 7365 2061 7265 2074 6865 2064 6566 6175  se are the defau
+000107d0: 6c74 2073 6166 6574 7920 6c69 6d69 7473  lt safety limits
+000107e0: 206f 6e20 7468 6520 6669 7474 696e 6720   on the fitting 
+000107f0: 7061 7261 6d65 7465 7273 0d0a 2020 2020  parameters..    
+00010800: 2874 6865 7920 6361 6e20 6265 2063 6861  (they can be cha
+00010810: 6e67 6564 2075 7369 6e67 2074 6865 2060  nged using the `
+00010820: 6062 6f75 6e64 7360 6020 6b65 7977 6f72  `bounds`` keywor
+00010830: 6429 3a0d 0a0d 0a20 2020 202a 2060 6056  d):....    * ``V
+00010840: 656c 6060 2069 7320 636f 6e73 7472 6169  el`` is constrai
+00010850: 6e65 6420 746f 2062 6520 6060 2b2f 2d32  ned to be ``+/-2
+00010860: 3030 3060 6020 6b6d 2f73 2066 726f 6d20  000`` km/s from 
+00010870: 7468 6520 696e 7075 7420 6775 6573 730d  the input guess.
+00010880: 0a20 2020 202a 2060 6076 656c 7363 616c  .    * ``velscal
+00010890: 652f 3130 3020 3c20 5369 676d 6120 3c20  e/100 < Sigma < 
+000108a0: 3130 3030 6060 206b 6d2f 730d 0a20 2020  1000`` km/s..   
+000108b0: 202a 2060 602d 302e 3320 3c20 5b68 332c   * ``-0.3 < [h3,
+000108c0: 2068 342c 202e 2e2e 5d20 3c20 302e 3360   h4, ...] < 0.3`
+000108d0: 6020 2028 6578 7472 656d 6520 7661 6c75  `  (extreme valu
+000108e0: 6520 666f 7220 7265 616c 2067 616c 6178  e for real galax
+000108f0: 6965 7329 0d0a 0d0a 2020 2020 496e 2074  ies)....    In t
+00010900: 6865 2063 6173 6520 6f66 2074 776f 2d73  he case of two-s
+00010910: 6964 6564 204c 4f53 5644 2066 6974 7469  ided LOSVD fitti
+00010920: 6e67 2074 6865 206f 7574 7075 7420 7661  ng the output va
+00010930: 6c75 6573 2072 6566 6572 2074 6f20 7468  lues refer to th
+00010940: 650d 0a20 2020 2066 6972 7374 2069 6e70  e..    first inp
+00010950: 7574 2067 616c 6178 7920 7370 6563 7472  ut galaxy spectr
+00010960: 756d 2c20 7768 696c 6520 7468 6520 7365  um, while the se
+00010970: 636f 6e64 2073 7065 6374 7275 6d20 7769  cond spectrum wi
+00010980: 6c6c 2068 6176 6520 6279 0d0a 2020 2020  ll have by..    
+00010990: 636f 6e73 7472 7563 7469 6f6e 206b 696e  construction kin
+000109a0: 656d 6174 6963 7320 7061 7261 6d65 7465  ematics paramete
+000109b0: 7273 2060 605b 2d56 656c 2c20 5369 676d  rs ``[-Vel, Sigm
+000109c0: 612c 202d 6833 2c20 6834 2c20 2d68 352c  a, -h3, h4, -h5,
+000109d0: 2068 365d 6060 2e0d 0a20 2020 2049 6620   h6]``...    If 
+000109e0: 6060 7673 7973 7460 6020 6973 206e 6f6e  ``vsyst`` is non
+000109f0: 7a65 726f 2028 6173 2072 6571 7569 7265  zero (as require
+00010a00: 6420 666f 7220 7477 6f2d 7369 6465 6420  d for two-sided 
+00010a10: 6669 7474 696e 6729 2c20 7468 656e 2074  fitting), then t
+00010a20: 6865 0d0a 2020 2020 6f75 7470 7574 2076  he..    output v
+00010a30: 656c 6f63 6974 7920 6973 206d 6561 7375  elocity is measu
+00010a40: 7265 6420 7769 7468 2072 6573 7065 6374  red with respect
+00010a50: 2074 6f20 6060 7673 7973 7460 602e 0d0a   to ``vsyst``...
+00010a60: 2e73 7461 7475 733a 0d0a 2020 2020 436f  .status:..    Co
+00010a70: 6e74 6169 6e73 2074 6865 206f 7574 7075  ntains the outpu
+00010a80: 7420 7374 6174 7573 206f 6620 7468 6520  t status of the 
+00010a90: 6f70 7469 6d69 7a61 7469 6f6e 2e20 506f  optimization. Po
+00010aa0: 7369 7469 7665 2076 616c 7565 730d 0a20  sitive values.. 
+00010ab0: 2020 2067 656e 6572 616c 6c79 2072 6570     generally rep
+00010ac0: 7265 7365 6e74 2073 7563 6365 7373 2028  resent success (
+00010ad0: 7468 6520 6d65 616e 696e 6720 6f66 2060  the meaning of `
+00010ae0: 6073 7461 7475 7360 6020 6973 2064 6566  `status`` is def
+00010af0: 696e 6564 2061 7320 696e 0d0a 2020 2020  ined as in..    
+00010b00: 6073 6369 7079 2e6f 7074 696d 697a 652e  `scipy.optimize.
+00010b10: 6c65 6173 745f 7371 7561 7265 7360 5f29  least_squares`_)
+00010b20: 2e0d 0a2e 7765 6967 6874 733a 0d0a 2020  ....weights:..  
+00010b30: 2020 5265 6365 6976 6573 2074 6865 2076    Receives the v
+00010b40: 616c 7565 206f 6620 7468 6520 7765 6967  alue of the weig
+00010b50: 6874 7320 6279 2077 6869 6368 2065 6163  hts by which eac
+00010b60: 6820 7465 6d70 6c61 7465 2077 6173 0d0a  h template was..
+00010b70: 2020 2020 6d75 6c74 6970 6c69 6564 2074      multiplied t
+00010b80: 6f20 6265 7374 2066 6974 2074 6865 2067  o best fit the g
+00010b90: 616c 6178 7920 7370 6563 7472 756d 2e20  alaxy spectrum. 
+00010ba0: 5468 6520 6f70 7469 6d61 6c20 7465 6d70  The optimal temp
+00010bb0: 6c61 7465 2063 616e 2062 650d 0a20 2020  late can be..   
+00010bc0: 2063 6f6d 7075 7465 6420 7769 7468 2061   computed with a
+00010bd0: 6e20 6172 7261 792d 7665 6374 6f72 206d  n array-vector m
+00010be0: 756c 7469 706c 6963 6174 696f 6e3a 3a0d  ultiplication::.
+00010bf0: 0a0d 0a20 2020 2020 2020 2062 6573 7465  ...        beste
+00010c00: 6d70 203d 2074 656d 706c 6174 6573 2040  mp = templates @
+00010c10: 2077 6569 6768 7473 0d0a 0d0a 2020 2020   weights....    
+00010c20: 5468 6573 6520 6060 2e77 6569 6768 7473  These ``.weights
+00010c30: 6060 2064 6f20 6e6f 7420 696e 636c 7564  `` do not includ
+00010c40: 6520 7468 6520 7765 6967 6874 7320 6f66  e the weights of
+00010c50: 2074 6865 2061 6464 6974 6976 650d 0a20   the additive.. 
+00010c60: 2020 2070 6f6c 796e 6f6d 6961 6c73 2077     polynomials w
+00010c70: 6869 6368 2061 7265 2073 6570 6172 6174  hich are separat
+00010c80: 656c 7920 7374 6f72 6564 2069 6e20 6060  ely stored in ``
+00010c90: 7070 2e70 6f6c 7977 6569 6768 7473 6060  pp.polyweights``
+00010ca0: 2e0d 0a0d 0a20 2020 2057 6865 6e20 7468  .....    When th
+00010cb0: 6520 6060 736b 7960 6020 6b65 7977 6f72  e ``sky`` keywor
+00010cc0: 6420 6973 2075 7365 6420 6060 7765 6967  d is used ``weig
+00010cd0: 6874 735b 3a6e 5f74 656d 706c 6174 6573  hts[:n_templates
+00010ce0: 5d60 6020 636f 6e74 6169 6e73 2074 6865  ]`` contains the
+00010cf0: 0d0a 2020 2020 7765 6967 6874 7320 666f  ..    weights fo
+00010d00: 7220 7468 6520 7465 6d70 6c61 7465 732c  r the templates,
+00010d10: 2077 6869 6c65 2060 6077 6569 6768 7473   while ``weights
+00010d20: 5b6e 5f74 656d 706c 6174 6573 3a5d 6060  [n_templates:]``
+00010d30: 2067 6976 6573 2074 6865 0d0a 2020 2020   gives the..    
+00010d40: 6f6e 6573 2066 6f72 2074 6865 2073 6b79  ones for the sky
+00010d50: 2e20 496e 2074 6861 7420 6361 7365 2074  . In that case t
+00010d60: 6865 2062 6573 742d 6669 7474 696e 6720  he best-fitting 
+00010d70: 6761 6c61 7879 2074 656d 706c 6174 6520  galaxy template 
+00010d80: 616e 6420 736b 790d 0a20 2020 2061 7265  and sky..    are
+00010d90: 2067 6976 656e 2062 793a 3a0d 0a0d 0a20   given by::.... 
+00010da0: 2020 2020 2020 2062 6573 7465 6d70 203d         bestemp =
+00010db0: 2074 656d 706c 6174 6573 2040 2077 6569   templates @ wei
+00010dc0: 6768 7473 5b3a 6e5f 7465 6d70 6c61 7465  ghts[:n_template
+00010dd0: 735d 0d0a 2020 2020 2020 2020 6265 7374  s]..        best
+00010de0: 736b 7920 3d20 736b 7920 4020 7765 6967  sky = sky @ weig
+00010df0: 6874 735b 6e5f 7465 6d70 6c61 7465 733a  hts[n_templates:
+00010e00: 5d0d 0a0d 0a20 2020 2057 6865 6e20 646f  ]....    When do
+00010e10: 696e 6720 6120 7477 6f2d 7369 6465 6420  ing a two-sided 
+00010e20: 6669 7474 696e 6720 2873 6565 2068 656c  fitting (see hel
+00010e30: 7020 666f 7220 6060 6761 6c61 7879 6060  p for ``galaxy``
+00010e40: 2070 6172 616d 6574 6572 290d 0a20 2020   parameter)..   
+00010e50: 202a 746f 6765 7468 6572 2a20 7769 7468   *together* with
+00010e60: 2074 6865 2060 6073 6b79 6060 206b 6579   the ``sky`` key
+00010e70: 776f 7264 2c20 7468 6520 736b 7920 7765  word, the sky we
+00010e80: 6967 6874 7320 6172 6520 616c 6c6f 7765  ights are allowe
+00010e90: 6420 746f 2062 650d 0a20 2020 2064 6966  d to be..    dif
+00010ea0: 6665 7265 6e74 2066 6f72 2074 6865 206c  ferent for the l
+00010eb0: 6566 7420 616e 6420 7269 6768 7420 7370  eft and right sp
+00010ec0: 6563 7472 756d 2e20 496e 2074 6861 7420  ectrum. In that 
+00010ed0: 6361 7365 2074 6865 206f 7574 7075 7420  case the output 
+00010ee0: 736b 790d 0a20 2020 2077 6569 6768 7473  sky..    weights
+00010ef0: 2061 6c74 6572 6e61 7465 2062 6574 7765   alternate betwe
+00010f00: 656e 2074 6865 2066 6972 7374 2028 6c65  en the first (le
+00010f10: 6674 2920 7370 6563 7472 756d 2061 6e64  ft) spectrum and
+00010f20: 2074 6865 2073 6563 6f6e 640d 0a20 2020   the second..   
+00010f30: 2028 7269 6768 7429 2073 7065 6374 7275   (right) spectru
+00010f40: 6d2e 0d0a 0d0a 486f 7720 746f 2053 6574  m.....How to Set
+00010f50: 2074 6865 204b 696e 656d 6174 6963 2050   the Kinematic P
+00010f60: 656e 616c 7479 204b 6579 776f 7264 0d0a  enalty Keyword..
 00010f70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00010f80: 2d2d 2d2d 0d0a 0d0a 5468 6520 6060 6269  ----....The ``bi
-00010f90: 6173 6060 206b 6579 776f 7264 2069 7320  as`` keyword is 
-00010fa0: 6f6e 6c79 2075 7365 6420 6966 2060 606d  only used if ``m
-00010fb0: 6f6d 656e 7473 203e 2032 6060 2c20 6f74  oments > 2``, ot
-00010fc0: 6865 7277 6973 6520 6974 2069 7320 6967  herwise it is ig
-00010fd0: 6e6f 7265 642e 0d0a 0d0a 5468 6520 6060  nored.....The ``
-00010fe0: 7050 5846 6060 2072 6f75 7469 6e65 2063  pPXF`` routine c
-00010ff0: 616e 2067 6976 6520 7365 6e73 6962 6c65  an give sensible
-00011000: 2071 7569 636b 2072 6573 756c 7473 2077   quick results w
-00011010: 6974 6820 7468 6520 6465 6661 756c 740d  ith the default.
-00011020: 0a60 6062 6961 7360 6020 7061 7261 6d65  .``bias`` parame
-00011030: 7465 722c 2068 6f77 6576 6572 2c20 6c69  ter, however, li
-00011040: 6b65 2069 6e20 616e 7920 7065 6e61 6c69  ke in any penali
-00011050: 7a65 642f 6669 6c74 6572 6564 2f72 6567  zed/filtered/reg
-00011060: 756c 6172 697a 6564 0d0a 6d65 7468 6f64  ularized..method
-00011070: 2c20 7468 6520 6f70 7469 6d61 6c20 616d  , the optimal am
-00011080: 6f75 6e74 206f 6620 7065 6e61 6c69 7a61  ount of penaliza
-00011090: 7469 6f6e 2067 656e 6572 616c 6c79 2064  tion generally d
-000110a0: 6570 656e 6473 206f 6e20 7468 6520 7072  epends on the pr
-000110b0: 6f62 6c65 6d0d 0a75 6e64 6572 2073 7475  oblem..under stu
-000110c0: 6479 2e0d 0a0d 0a54 6865 2067 656e 6572  dy.....The gener
-000110d0: 616c 2072 756c 6520 6865 7265 2069 7320  al rule here is 
-000110e0: 7468 6174 2074 6865 2070 656e 616c 7479  that the penalty
-000110f0: 2073 686f 756c 6420 6c65 6176 6520 7468   should leave th
-00011100: 6520 6c69 6e65 2d6f 662d 7369 6768 740d  e line-of-sight.
-00011110: 0a76 656c 6f63 6974 792d 6469 7374 7269  .velocity-distri
-00011120: 6275 7469 6f6e 2028 4c4f 5356 4429 2076  bution (LOSVD) v
-00011130: 6972 7475 616c 6c79 2075 6e61 6666 6563  irtually unaffec
-00011140: 7465 642c 2077 6865 6e20 6974 2069 7320  ted, when it is 
-00011150: 7765 6c6c 2073 616d 706c 6564 0d0a 616e  well sampled..an
-00011160: 6420 7468 6520 7369 676e 616c 2d74 6f2d  d the signal-to-
-00011170: 6e6f 6973 6520 7261 7469 6f20 2860 6053  noise ratio (``S
-00011180: 2f4e 6060 2920 6973 2073 7566 6669 6369  /N``) is suffici
-00011190: 656e 746c 7920 6869 6768 2e0d 0a0d 0a45  ently high.....E
-000111a0: 5841 4d50 4c45 3a20 4966 2079 6f75 2065  XAMPLE: If you e
-000111b0: 7870 6563 7420 6120 4c4f 5356 4420 7769  xpect a LOSVD wi
-000111c0: 7468 2075 7020 746f 2061 2068 6967 6820  th up to a high 
-000111d0: 6060 6834 207e 2030 2e32 6060 2061 6e64  ``h4 ~ 0.2`` and
-000111e0: 2079 6f75 720d 0a61 646f 7074 6564 2070   your..adopted p
-000111f0: 656e 616c 7479 2028 6060 6269 6173 6060  enalty (``bias``
-00011200: 2920 6269 6173 6573 2074 6865 2073 6f6c  ) biases the sol
-00011210: 7574 696f 6e20 746f 7761 7264 7320 6120  ution towards a 
-00011220: 6d75 6368 206c 6f77 6572 0d0a 6060 6834  much lower..``h4
-00011230: 207e 2030 2e31 6060 2c20 6576 656e 2077   ~ 0.1``, even w
-00011240: 6865 6e20 7468 6520 6d65 6173 7572 6564  hen the measured
-00011250: 2060 6073 6967 6d61 203e 2033 2a76 656c   ``sigma > 3*vel
-00011260: 7363 616c 6560 6020 616e 6420 7468 6520  scale`` and the 
-00011270: 532f 4e20 6973 0d0a 6869 6768 2c20 7468  S/N is..high, th
-00011280: 656e 2079 6f75 2061 7265 202a 6d69 7375  en you are *misu
-00011290: 7369 6e67 2a20 7468 6520 6060 7050 5846  sing* the ``pPXF
-000112a0: 6060 206d 6574 686f 6421 0d0a 0d0a 5448  `` method!....TH
-000112b0: 4520 5245 4349 5045 3a20 5468 6520 666f  E RECIPE: The fo
-000112c0: 6c6c 6f77 696e 6720 6973 2061 2073 696d  llowing is a sim
-000112d0: 706c 6520 7072 6163 7469 6361 6c20 7265  ple practical re
-000112e0: 6369 7065 2066 6f72 2061 2073 656e 7369  cipe for a sensi
-000112f0: 626c 650d 0a64 6574 6572 6d69 6e61 7469  ble..determinati
-00011300: 6f6e 206f 6620 7468 6520 7065 6e61 6c74  on of the penalt
-00011310: 7920 696e 2060 6070 5058 4660 603a 0d0a  y in ``pPXF``:..
-00011320: 0d0a 312e 2043 686f 6f73 6520 6120 6d69  ..1. Choose a mi
-00011330: 6e69 6d75 6d20 6060 2853 2f4e 295f 6d69  nimum ``(S/N)_mi
-00011340: 6e60 6020 6c65 7665 6c20 666f 7220 796f  n`` level for yo
-00011350: 7572 206b 696e 656d 6174 6963 7320 6578  ur kinematics ex
-00011360: 7472 6163 7469 6f6e 2061 6e64 0d0a 2020  traction and..  
-00011370: 2073 7061 7469 616c 6c79 2062 696e 2079   spatially bin y
-00011380: 6f75 7220 6461 7461 2073 6f20 7468 6174  our data so that
-00011390: 2074 6865 7265 2061 7265 206e 6f20 7370   there are no sp
-000113a0: 6563 7472 6120 6265 6c6f 7720 6060 2853  ectra below ``(S
-000113b0: 2f4e 295f 6d69 6e60 603b 0d0a 322e 2050  /N)_min``;..2. P
-000113c0: 6572 666f 726d 2061 2066 6974 206f 6620  erform a fit of 
-000113d0: 796f 7572 206b 696e 656d 6174 6963 7320  your kinematics 
-000113e0: 2a77 6974 686f 7574 2a20 7065 6e61 6c74  *without* penalt
-000113f0: 7920 286b 6579 776f 7264 2060 6062 6961  y (keyword ``bia
-00011400: 733d 3060 6029 2e0d 0a20 2020 5468 6520  s=0``)...   The 
-00011410: 736f 6c75 7469 6f6e 2077 696c 6c20 6265  solution will be
-00011420: 206e 6f69 7379 2061 6e64 206d 6179 2062   noisy and may b
-00011430: 6520 6166 6665 6374 6564 2062 7920 7370  e affected by sp
-00011440: 7572 696f 7573 2073 6f6c 7574 696f 6e73  urious solutions
-00011450: 2c0d 0a20 2020 686f 7765 7665 722c 2074  ,..   however, t
-00011460: 6869 7320 7374 6570 2077 696c 6c20 616c  his step will al
-00011470: 6c6f 7720 796f 7520 746f 2063 6865 636b  low you to check
-00011480: 2074 6865 2065 7870 6563 7465 6420 6176   the expected av
-00011490: 6572 6167 6520 7261 6e67 6573 0d0a 2020  erage ranges..  
-000114a0: 2069 6e20 7468 6520 4761 7573 732d 4865   in the Gauss-He
-000114b0: 726d 6974 6520 7061 7261 6d65 7465 7273  rmite parameters
-000114c0: 2060 605b 6833 2c20 6834 5d60 6020 666f   ``[h3, h4]`` fo
-000114d0: 7220 7468 6520 6761 6c61 7879 2075 6e64  r the galaxy und
-000114e0: 6572 2073 7475 6479 3b0d 0a33 2e20 5065  er study;..3. Pe
-000114f0: 7266 6f72 6d20 6120 4d6f 6e74 6520 4361  rform a Monte Ca
-00011500: 726c 6f20 7369 6d75 6c61 7469 6f6e 206f  rlo simulation o
-00011510: 6620 796f 7572 2073 7065 6374 7261 2c20  f your spectra, 
-00011520: 666f 6c6c 6f77 696e 6720 652e 672e 2074  following e.g. t
-00011530: 6865 0d0a 2020 2069 6e63 6c75 6465 6420  he..   included 
-00011540: 6060 7070 7866 5f65 7861 6d70 6c65 5f6d  ``ppxf_example_m
-00011550: 6f6e 7465 6361 726c 6f5f 7369 6d75 6c61  ontecarlo_simula
-00011560: 7469 6f6e 2e70 7960 6020 726f 7574 696e  tion.py`` routin
-00011570: 652e 2041 646f 7074 2061 730d 0a20 2020  e. Adopt as..   
-00011580: 6060 532f 4e60 6020 696e 2074 6865 2073  ``S/N`` in the s
-00011590: 696d 756c 6174 696f 6e20 7468 6520 6368  imulation the ch
-000115a0: 6f73 656e 2076 616c 7565 2060 6028 532f  osen value ``(S/
-000115b0: 4e29 5f6d 696e 6060 2061 6e64 2061 7320  N)_min`` and as 
-000115c0: 696e 7075 740d 0a20 2020 6060 5b68 332c  input..   ``[h3,
-000115d0: 2068 345d 6060 2074 6865 206d 6178 696d   h4]`` the maxim
-000115e0: 756d 2072 6570 7265 7365 6e74 6174 6976  um representativ
-000115f0: 6520 7661 6c75 6573 206d 6561 7375 7265  e values measure
-00011600: 6420 696e 2074 6865 0d0a 2020 206e 6f6e  d in the..   non
-00011610: 2d70 656e 616c 697a 6564 2060 6070 5058  -penalized ``pPX
-00011620: 4660 6020 6669 7420 6f66 2074 6865 2070  F`` fit of the p
-00011630: 7265 7669 6f75 7320 7374 6570 3b0d 0a34  revious step;..4
-00011640: 2e20 4368 6f6f 7365 2061 7320 7468 6520  . Choose as the 
-00011650: 7065 6e61 6c74 7920 2860 6062 6961 7360  penalty (``bias`
-00011660: 6029 2074 6865 202a 6c61 7267 6573 742a  `) the *largest*
-00011670: 2076 616c 7565 2073 7563 6820 7468 6174   value such that
-00011680: 2c20 666f 720d 0a20 2020 6060 7369 676d  , for..   ``sigm
-00011690: 6120 3e20 332a 7665 6c73 6361 6c65 6060  a > 3*velscale``
-000116a0: 2c20 7468 6520 6176 6572 6167 6520 6469  , the average di
-000116b0: 6666 6572 656e 6365 2064 656c 7461 2062  fference delta b
-000116c0: 6574 7765 656e 2074 6865 206f 7574 7075  etween the outpu
-000116d0: 740d 0a20 2020 6060 5b68 332c 2068 345d  t..   ``[h3, h4]
-000116e0: 6060 2061 6e64 2074 6865 2069 6e70 7574  `` and the input
-000116f0: 2060 605b 6833 2c20 6834 5d60 6020 6973   ``[h3, h4]`` is
-00011700: 2077 656c 6c20 7769 7468 696e 2028 652e   well within (e.
-00011710: 672e 0d0a 2020 2060 6064 656c 7461 207e  g...   ``delta ~
-00011720: 2072 6d73 2f33 6060 2920 7468 6520 726d   rms/3``) the rm
-00011730: 7320 7363 6174 7465 7220 6f66 2074 6865  s scatter of the
-00011740: 2073 696d 756c 6174 6564 2076 616c 7565   simulated value
-00011750: 7320 2873 6565 2061 6e0d 0a20 2020 6578  s (see an..   ex
-00011760: 616d 706c 6520 696e 2046 6967 2e20 3220  ample in Fig. 2 
-00011770: 6f66 2060 456d 7365 6c6c 656d 2065 7420  of `Emsellem et 
-00011780: 616c 2e20 3230 3034 0d0a 2020 203c 6874  al. 2004..   <ht
-00011790: 7470 3a2f 2f75 692e 6164 7361 6273 2e68  tp://ui.adsabs.h
-000117a0: 6172 7661 7264 2e65 6475 2f61 6273 2f32  arvard.edu/abs/2
-000117b0: 3030 344d 4e52 4153 2e33 3532 2e2e 3732  004MNRAS.352..72
-000117c0: 3145 3e60 5f29 2e0d 0a0d 0a50 726f 626c  1E>`_).....Probl
-000117d0: 656d 7320 7769 7468 2059 6f75 7220 4669  ems with Your Fi
-000117e0: 7273 7420 4669 743f 0d0a 2d2d 2d2d 2d2d  rst Fit?..------
-000117f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011800: 2d2d 2d2d 2d2d 2d0d 0a0d 0a43 6f6d 6d6f  -------....Commo
-00011810: 6e20 7072 6f62 6c65 6d73 2077 6974 6820  n problems with 
-00011820: 796f 7572 2066 6972 7374 2060 6070 5058  your first ``pPX
-00011830: 4660 6020 6669 7420 6172 6520 6361 7573  F`` fit are caus
-00011840: 6564 2062 7920 696e 636f 7272 6563 740d  ed by incorrect.
-00011850: 0a77 6176 656c 656e 6774 6820 7261 6e67  .wavelength rang
-00011860: 6573 206f 7220 6469 6666 6572 656e 7420  es or different 
-00011870: 7665 6c6f 6369 7479 2073 6361 6c65 7320  velocity scales 
-00011880: 6265 7477 6565 6e20 6761 6c61 7879 2061  between galaxy a
-00011890: 6e64 0d0a 7465 6d70 6c61 7465 732e 2054  nd..templates. T
-000118a0: 6f20 7175 6963 6b6c 7920 6465 7465 6374  o quickly detect
-000118b0: 2074 6865 7365 2070 726f 626c 656d 7320   these problems 
-000118c0: 7472 7920 746f 206f 7665 7270 6c6f 7420  try to overplot 
-000118d0: 7468 6520 286c 6f67 0d0a 7265 6269 6e6e  the (log..rebinn
-000118e0: 6564 2920 6761 6c61 7879 2061 6e64 2074  ed) galaxy and t
-000118f0: 6865 2074 656d 706c 6174 6520 6a75 7374  he template just
-00011900: 2062 6566 6f72 6520 6361 6c6c 696e 6720   before calling 
-00011910: 7468 6520 6060 7050 5846 6060 0d0a 7072  the ``pPXF``..pr
-00011920: 6f63 6564 7572 652e 0d0a 0d0a 596f 7520  ocedure.....You 
-00011930: 6361 6e20 7573 6520 736f 6d65 7468 696e  can use somethin
-00011940: 6720 6c69 6b65 2074 6865 2066 6f6c 6c6f  g like the follo
-00011950: 7769 6e67 2050 7974 686f 6e20 6c69 6e65  wing Python line
-00011960: 7320 7768 696c 6520 6164 6a75 7374 696e  s while adjustin
-00011970: 6720 7468 650d 0a73 6d6f 6f74 6869 6e67  g the..smoothing
-00011980: 2077 696e 646f 7720 616e 6420 7468 6520   window and the 
-00011990: 7069 7865 6c73 2073 6869 6674 2e20 4966  pixels shift. If
-000119a0: 2079 6f75 2063 616e 6e6f 7420 6765 7420   you cannot get 
-000119b0: 6120 726f 7567 6820 6d61 7463 680d 0a62  a rough match..b
-000119c0: 7920 6579 6520 6974 206d 6561 6e73 2073  y eye it means s
-000119d0: 6f6d 6574 6869 6e67 2069 7320 7772 6f6e  omething is wron
-000119e0: 6720 616e 6420 6974 2069 7320 756e 6c69  g and it is unli
-000119f0: 6b65 6c79 2074 6861 7420 6060 7050 5846  kely that ``pPXF
-00011a00: 6060 0d0a 286f 7220 616e 7920 6f74 6865  ``..(or any othe
-00011a10: 7220 7072 6f67 7261 6d29 2077 696c 6c20  r program) will 
-00011a20: 6669 6e64 2061 2067 6f6f 6420 6d61 7463  find a good matc
-00011a30: 683a 0d0a 0d0a 2e2e 2063 6f64 652d 626c  h:...... code-bl
-00011a40: 6f63 6b3a 3a20 7079 7468 6f6e 0d0a 0d0a  ock:: python....
-00011a50: 2020 2020 696d 706f 7274 206e 756d 7079      import numpy
-00011a60: 2061 7320 6e70 0d0a 2020 2020 696d 706f   as np..    impo
-00011a70: 7274 206d 6174 706c 6f74 6c69 622e 7079  rt matplotlib.py
-00011a80: 706c 6f74 2061 7320 706c 740d 0a20 2020  plot as plt..   
-00011a90: 2066 726f 6d20 7363 6970 7920 696d 706f   from scipy impo
-00011aa0: 7274 206e 6469 6d61 6765 0d0a 0d0a 2020  rt ndimage....  
-00011ab0: 2020 7369 676d 6120 3d20 3220 2020 2020    sigma = 2     
-00011ac0: 2020 2320 5665 6c6f 6369 7479 2064 6973    # Velocity dis
-00011ad0: 7065 7273 696f 6e20 696e 2070 6978 656c  persion in pixel
-00011ae0: 730d 0a20 2020 2073 6869 6674 203d 202d  s..    shift = -
-00011af0: 3230 2020 2020 2023 2056 656c 6f63 6974  20     # Velocit
-00011b00: 7920 7368 6966 7420 696e 2070 6978 656c  y shift in pixel
-00011b10: 730d 0a20 2020 2074 656d 706c 6174 6520  s..    template 
-00011b20: 3d20 6e70 2e72 6f6c 6c28 6e64 696d 6167  = np.roll(ndimag
-00011b30: 652e 6761 7573 7369 616e 5f66 696c 7465  e.gaussian_filte
-00011b40: 7231 6428 7465 6d70 6c61 7465 2c20 7369  r1d(template, si
-00011b50: 676d 6129 2c20 7368 6966 7429 0d0a 2020  gma), shift)..  
-00011b60: 2020 706c 742e 706c 6f74 2867 616c 6178    plt.plot(galax
-00011b70: 792c 2027 6b27 290d 0a20 2020 2070 6c74  y, 'k')..    plt
-00011b80: 2e70 6c6f 7428 7465 6d70 6c61 7465 2a6e  .plot(template*n
-00011b90: 702e 6d65 6469 616e 2867 616c 6178 7929  p.median(galaxy)
-00011ba0: 2f6e 702e 6d65 6469 616e 2874 656d 706c  /np.median(templ
-00011bb0: 6174 6529 2c20 2772 2729 0d0a 0d0a 2323  ate), 'r')....##
-00011bc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00011bd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00010f80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00010f90: 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a 5468 6520  --------....The 
+00010fa0: 6060 6269 6173 6060 206b 6579 776f 7264  ``bias`` keyword
+00010fb0: 2069 7320 6f6e 6c79 2075 7365 6420 6966   is only used if
+00010fc0: 2060 606d 6f6d 656e 7473 203e 2032 6060   ``moments > 2``
+00010fd0: 2c20 6f74 6865 7277 6973 6520 6974 2069  , otherwise it i
+00010fe0: 7320 6967 6e6f 7265 642e 0d0a 0d0a 5468  s ignored.....Th
+00010ff0: 6520 6060 7050 5846 6060 2072 6f75 7469  e ``pPXF`` routi
+00011000: 6e65 2063 616e 2067 6976 6520 7365 6e73  ne can give sens
+00011010: 6962 6c65 2071 7569 636b 2072 6573 756c  ible quick resul
+00011020: 7473 2077 6974 6820 7468 6520 6465 6661  ts with the defa
+00011030: 756c 740d 0a60 6062 6961 7360 6020 7061  ult..``bias`` pa
+00011040: 7261 6d65 7465 722c 2068 6f77 6576 6572  rameter, however
+00011050: 2c20 6c69 6b65 2069 6e20 616e 7920 7065  , like in any pe
+00011060: 6e61 6c69 7a65 642f 6669 6c74 6572 6564  nalized/filtered
+00011070: 2f72 6567 756c 6172 697a 6564 0d0a 6d65  /regularized..me
+00011080: 7468 6f64 2c20 7468 6520 6f70 7469 6d61  thod, the optima
+00011090: 6c20 616d 6f75 6e74 206f 6620 7065 6e61  l amount of pena
+000110a0: 6c69 7a61 7469 6f6e 2067 656e 6572 616c  lization general
+000110b0: 6c79 2064 6570 656e 6473 206f 6e20 7468  ly depends on th
+000110c0: 6520 7072 6f62 6c65 6d0d 0a75 6e64 6572  e problem..under
+000110d0: 2073 7475 6479 2e0d 0a0d 0a54 6865 2067   study.....The g
+000110e0: 656e 6572 616c 2072 756c 6520 6865 7265  eneral rule here
+000110f0: 2069 7320 7468 6174 2074 6865 2070 656e   is that the pen
+00011100: 616c 7479 2073 686f 756c 6420 6c65 6176  alty should leav
+00011110: 6520 7468 6520 6c69 6e65 2d6f 662d 7369  e the line-of-si
+00011120: 6768 740d 0a76 656c 6f63 6974 792d 6469  ght..velocity-di
+00011130: 7374 7269 6275 7469 6f6e 2028 4c4f 5356  stribution (LOSV
+00011140: 4429 2076 6972 7475 616c 6c79 2075 6e61  D) virtually una
+00011150: 6666 6563 7465 642c 2077 6865 6e20 6974  ffected, when it
+00011160: 2069 7320 7765 6c6c 2073 616d 706c 6564   is well sampled
+00011170: 0d0a 616e 6420 7468 6520 7369 676e 616c  ..and the signal
+00011180: 2d74 6f2d 6e6f 6973 6520 7261 7469 6f20  -to-noise ratio 
+00011190: 2860 6053 2f4e 6060 2920 6973 2073 7566  (``S/N``) is suf
+000111a0: 6669 6369 656e 746c 7920 6869 6768 2e0d  ficiently high..
+000111b0: 0a0d 0a45 5841 4d50 4c45 3a20 4966 2079  ...EXAMPLE: If y
+000111c0: 6f75 2065 7870 6563 7420 6120 4c4f 5356  ou expect a LOSV
+000111d0: 4420 7769 7468 2075 7020 746f 2061 2068  D with up to a h
+000111e0: 6967 6820 6060 6834 207e 2030 2e32 6060  igh ``h4 ~ 0.2``
+000111f0: 2061 6e64 2079 6f75 720d 0a61 646f 7074   and your..adopt
+00011200: 6564 2070 656e 616c 7479 2028 6060 6269  ed penalty (``bi
+00011210: 6173 6060 2920 6269 6173 6573 2074 6865  as``) biases the
+00011220: 2073 6f6c 7574 696f 6e20 746f 7761 7264   solution toward
+00011230: 7320 6120 6d75 6368 206c 6f77 6572 0d0a  s a much lower..
+00011240: 6060 6834 207e 2030 2e31 6060 2c20 6576  ``h4 ~ 0.1``, ev
+00011250: 656e 2077 6865 6e20 7468 6520 6d65 6173  en when the meas
+00011260: 7572 6564 2060 6073 6967 6d61 203e 2033  ured ``sigma > 3
+00011270: 2a76 656c 7363 616c 6560 6020 616e 6420  *velscale`` and 
+00011280: 7468 6520 532f 4e20 6973 0d0a 6869 6768  the S/N is..high
+00011290: 2c20 7468 656e 2079 6f75 2061 7265 202a  , then you are *
+000112a0: 6d69 7375 7369 6e67 2a20 7468 6520 6060  misusing* the ``
+000112b0: 7050 5846 6060 206d 6574 686f 6421 0d0a  pPXF`` method!..
+000112c0: 0d0a 5448 4520 5245 4349 5045 3a20 5468  ..THE RECIPE: Th
+000112d0: 6520 666f 6c6c 6f77 696e 6720 6973 2061  e following is a
+000112e0: 2073 696d 706c 6520 7072 6163 7469 6361   simple practica
+000112f0: 6c20 7265 6369 7065 2066 6f72 2061 2073  l recipe for a s
+00011300: 656e 7369 626c 650d 0a64 6574 6572 6d69  ensible..determi
+00011310: 6e61 7469 6f6e 206f 6620 7468 6520 7065  nation of the pe
+00011320: 6e61 6c74 7920 696e 2060 6070 5058 4660  nalty in ``pPXF`
+00011330: 603a 0d0a 0d0a 312e 2043 686f 6f73 6520  `:....1. Choose 
+00011340: 6120 6d69 6e69 6d75 6d20 6060 2853 2f4e  a minimum ``(S/N
+00011350: 295f 6d69 6e60 6020 6c65 7665 6c20 666f  )_min`` level fo
+00011360: 7220 796f 7572 206b 696e 656d 6174 6963  r your kinematic
+00011370: 7320 6578 7472 6163 7469 6f6e 2061 6e64  s extraction and
+00011380: 0d0a 2020 2073 7061 7469 616c 6c79 2062  ..   spatially b
+00011390: 696e 2079 6f75 7220 6461 7461 2073 6f20  in your data so 
+000113a0: 7468 6174 2074 6865 7265 2061 7265 206e  that there are n
+000113b0: 6f20 7370 6563 7472 6120 6265 6c6f 7720  o spectra below 
+000113c0: 6060 2853 2f4e 295f 6d69 6e60 603b 0d0a  ``(S/N)_min``;..
+000113d0: 322e 2050 6572 666f 726d 2061 2066 6974  2. Perform a fit
+000113e0: 206f 6620 796f 7572 206b 696e 656d 6174   of your kinemat
+000113f0: 6963 7320 2a77 6974 686f 7574 2a20 7065  ics *without* pe
+00011400: 6e61 6c74 7920 286b 6579 776f 7264 2060  nalty (keyword `
+00011410: 6062 6961 733d 3060 6029 2e0d 0a20 2020  `bias=0``)...   
+00011420: 5468 6520 736f 6c75 7469 6f6e 2077 696c  The solution wil
+00011430: 6c20 6265 206e 6f69 7379 2061 6e64 206d  l be noisy and m
+00011440: 6179 2062 6520 6166 6665 6374 6564 2062  ay be affected b
+00011450: 7920 7370 7572 696f 7573 2073 6f6c 7574  y spurious solut
+00011460: 696f 6e73 2c0d 0a20 2020 686f 7765 7665  ions,..   howeve
+00011470: 722c 2074 6869 7320 7374 6570 2077 696c  r, this step wil
+00011480: 6c20 616c 6c6f 7720 796f 7520 746f 2063  l allow you to c
+00011490: 6865 636b 2074 6865 2065 7870 6563 7465  heck the expecte
+000114a0: 6420 6176 6572 6167 6520 7261 6e67 6573  d average ranges
+000114b0: 0d0a 2020 2069 6e20 7468 6520 4761 7573  ..   in the Gaus
+000114c0: 732d 4865 726d 6974 6520 7061 7261 6d65  s-Hermite parame
+000114d0: 7465 7273 2060 605b 6833 2c20 6834 5d60  ters ``[h3, h4]`
+000114e0: 6020 666f 7220 7468 6520 6761 6c61 7879  ` for the galaxy
+000114f0: 2075 6e64 6572 2073 7475 6479 3b0d 0a33   under study;..3
+00011500: 2e20 5065 7266 6f72 6d20 6120 4d6f 6e74  . Perform a Mont
+00011510: 6520 4361 726c 6f20 7369 6d75 6c61 7469  e Carlo simulati
+00011520: 6f6e 206f 6620 796f 7572 2073 7065 6374  on of your spect
+00011530: 7261 2c20 666f 6c6c 6f77 696e 6720 652e  ra, following e.
+00011540: 672e 2074 6865 0d0a 2020 2069 6e63 6c75  g. the..   inclu
+00011550: 6465 6420 6060 7070 7866 5f65 7861 6d70  ded ``ppxf_examp
+00011560: 6c65 5f6d 6f6e 7465 6361 726c 6f5f 7369  le_montecarlo_si
+00011570: 6d75 6c61 7469 6f6e 2e70 7960 6020 726f  mulation.py`` ro
+00011580: 7574 696e 652e 2041 646f 7074 2061 730d  utine. Adopt as.
+00011590: 0a20 2020 6060 532f 4e60 6020 696e 2074  .   ``S/N`` in t
+000115a0: 6865 2073 696d 756c 6174 696f 6e20 7468  he simulation th
+000115b0: 6520 6368 6f73 656e 2076 616c 7565 2060  e chosen value `
+000115c0: 6028 532f 4e29 5f6d 696e 6060 2061 6e64  `(S/N)_min`` and
+000115d0: 2061 7320 696e 7075 740d 0a20 2020 6060   as input..   ``
+000115e0: 5b68 332c 2068 345d 6060 2074 6865 206d  [h3, h4]`` the m
+000115f0: 6178 696d 756d 2072 6570 7265 7365 6e74  aximum represent
+00011600: 6174 6976 6520 7661 6c75 6573 206d 6561  ative values mea
+00011610: 7375 7265 6420 696e 2074 6865 0d0a 2020  sured in the..  
+00011620: 206e 6f6e 2d70 656e 616c 697a 6564 2060   non-penalized `
+00011630: 6070 5058 4660 6020 6669 7420 6f66 2074  `pPXF`` fit of t
+00011640: 6865 2070 7265 7669 6f75 7320 7374 6570  he previous step
+00011650: 3b0d 0a34 2e20 4368 6f6f 7365 2061 7320  ;..4. Choose as 
+00011660: 7468 6520 7065 6e61 6c74 7920 2860 6062  the penalty (``b
+00011670: 6961 7360 6029 2074 6865 202a 6c61 7267  ias``) the *larg
+00011680: 6573 742a 2076 616c 7565 2073 7563 6820  est* value such 
+00011690: 7468 6174 2c20 666f 720d 0a20 2020 6060  that, for..   ``
+000116a0: 7369 676d 6120 3e20 332a 7665 6c73 6361  sigma > 3*velsca
+000116b0: 6c65 6060 2c20 7468 6520 6176 6572 6167  le``, the averag
+000116c0: 6520 6469 6666 6572 656e 6365 2064 656c  e difference del
+000116d0: 7461 2062 6574 7765 656e 2074 6865 206f  ta between the o
+000116e0: 7574 7075 740d 0a20 2020 6060 5b68 332c  utput..   ``[h3,
+000116f0: 2068 345d 6060 2061 6e64 2074 6865 2069   h4]`` and the i
+00011700: 6e70 7574 2060 605b 6833 2c20 6834 5d60  nput ``[h3, h4]`
+00011710: 6020 6973 2077 656c 6c20 7769 7468 696e  ` is well within
+00011720: 2028 652e 672e 0d0a 2020 2060 6064 656c   (e.g...   ``del
+00011730: 7461 207e 2072 6d73 2f33 6060 2920 7468  ta ~ rms/3``) th
+00011740: 6520 726d 7320 7363 6174 7465 7220 6f66  e rms scatter of
+00011750: 2074 6865 2073 696d 756c 6174 6564 2076   the simulated v
+00011760: 616c 7565 7320 2873 6565 2061 6e0d 0a20  alues (see an.. 
+00011770: 2020 6578 616d 706c 6520 696e 2046 6967    example in Fig
+00011780: 2e20 3220 6f66 2060 456d 7365 6c6c 656d  . 2 of `Emsellem
+00011790: 2065 7420 616c 2e20 3230 3034 0d0a 2020   et al. 2004..  
+000117a0: 203c 6874 7470 3a2f 2f75 692e 6164 7361   <http://ui.adsa
+000117b0: 6273 2e68 6172 7661 7264 2e65 6475 2f61  bs.harvard.edu/a
+000117c0: 6273 2f32 3030 344d 4e52 4153 2e33 3532  bs/2004MNRAS.352
+000117d0: 2e2e 3732 3145 3e60 5f29 2e0d 0a0d 0a50  ..721E>`_).....P
+000117e0: 726f 626c 656d 7320 7769 7468 2059 6f75  roblems with You
+000117f0: 7220 4669 7273 7420 4669 743f 0d0a 2d2d  r First Fit?..--
+00011800: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00011810: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a43  -----------....C
+00011820: 6f6d 6d6f 6e20 7072 6f62 6c65 6d73 2077  ommon problems w
+00011830: 6974 6820 796f 7572 2066 6972 7374 2060  ith your first `
+00011840: 6070 5058 4660 6020 6669 7420 6172 6520  `pPXF`` fit are 
+00011850: 6361 7573 6564 2062 7920 696e 636f 7272  caused by incorr
+00011860: 6563 740d 0a77 6176 656c 656e 6774 6820  ect..wavelength 
+00011870: 7261 6e67 6573 206f 7220 6469 6666 6572  ranges or differ
+00011880: 656e 7420 7665 6c6f 6369 7479 2073 6361  ent velocity sca
+00011890: 6c65 7320 6265 7477 6565 6e20 6761 6c61  les between gala
+000118a0: 7879 2061 6e64 0d0a 7465 6d70 6c61 7465  xy and..template
+000118b0: 732e 2054 6f20 7175 6963 6b6c 7920 6465  s. To quickly de
+000118c0: 7465 6374 2074 6865 7365 2070 726f 626c  tect these probl
+000118d0: 656d 7320 7472 7920 746f 206f 7665 7270  ems try to overp
+000118e0: 6c6f 7420 7468 6520 286c 6f67 0d0a 7265  lot the (log..re
+000118f0: 6269 6e6e 6564 2920 6761 6c61 7879 2061  binned) galaxy a
+00011900: 6e64 2074 6865 2074 656d 706c 6174 6520  nd the template 
+00011910: 6a75 7374 2062 6566 6f72 6520 6361 6c6c  just before call
+00011920: 696e 6720 7468 6520 6060 7050 5846 6060  ing the ``pPXF``
+00011930: 0d0a 7072 6f63 6564 7572 652e 0d0a 0d0a  ..procedure.....
+00011940: 596f 7520 6361 6e20 7573 6520 736f 6d65  You can use some
+00011950: 7468 696e 6720 6c69 6b65 2074 6865 2066  thing like the f
+00011960: 6f6c 6c6f 7769 6e67 2050 7974 686f 6e20  ollowing Python 
+00011970: 6c69 6e65 7320 7768 696c 6520 6164 6a75  lines while adju
+00011980: 7374 696e 6720 7468 650d 0a73 6d6f 6f74  sting the..smoot
+00011990: 6869 6e67 2077 696e 646f 7720 616e 6420  hing window and 
+000119a0: 7468 6520 7069 7865 6c73 2073 6869 6674  the pixels shift
+000119b0: 2e20 4966 2079 6f75 2063 616e 6e6f 7420  . If you cannot 
+000119c0: 6765 7420 6120 726f 7567 6820 6d61 7463  get a rough matc
+000119d0: 680d 0a62 7920 6579 6520 6974 206d 6561  h..by eye it mea
+000119e0: 6e73 2073 6f6d 6574 6869 6e67 2069 7320  ns something is 
+000119f0: 7772 6f6e 6720 616e 6420 6974 2069 7320  wrong and it is 
+00011a00: 756e 6c69 6b65 6c79 2074 6861 7420 6060  unlikely that ``
+00011a10: 7050 5846 6060 0d0a 286f 7220 616e 7920  pPXF``..(or any 
+00011a20: 6f74 6865 7220 7072 6f67 7261 6d29 2077  other program) w
+00011a30: 696c 6c20 6669 6e64 2061 2067 6f6f 6420  ill find a good 
+00011a40: 6d61 7463 683a 0d0a 0d0a 2e2e 2063 6f64  match:...... cod
+00011a50: 652d 626c 6f63 6b3a 3a20 7079 7468 6f6e  e-block:: python
+00011a60: 0d0a 0d0a 2020 2020 696d 706f 7274 206e  ....    import n
+00011a70: 756d 7079 2061 7320 6e70 0d0a 2020 2020  umpy as np..    
+00011a80: 696d 706f 7274 206d 6174 706c 6f74 6c69  import matplotli
+00011a90: 622e 7079 706c 6f74 2061 7320 706c 740d  b.pyplot as plt.
+00011aa0: 0a20 2020 2066 726f 6d20 7363 6970 7920  .    from scipy 
+00011ab0: 696d 706f 7274 206e 6469 6d61 6765 0d0a  import ndimage..
+00011ac0: 0d0a 2020 2020 7369 676d 6120 3d20 3220  ..    sigma = 2 
+00011ad0: 2020 2020 2020 2320 5665 6c6f 6369 7479        # Velocity
+00011ae0: 2064 6973 7065 7273 696f 6e20 696e 2070   dispersion in p
+00011af0: 6978 656c 730d 0a20 2020 2073 6869 6674  ixels..    shift
+00011b00: 203d 202d 3230 2020 2020 2023 2056 656c   = -20     # Vel
+00011b10: 6f63 6974 7920 7368 6966 7420 696e 2070  ocity shift in p
+00011b20: 6978 656c 730d 0a20 2020 2074 656d 706c  ixels..    templ
+00011b30: 6174 6520 3d20 6e70 2e72 6f6c 6c28 6e64  ate = np.roll(nd
+00011b40: 696d 6167 652e 6761 7573 7369 616e 5f66  image.gaussian_f
+00011b50: 696c 7465 7231 6428 7465 6d70 6c61 7465  ilter1d(template
+00011b60: 2c20 7369 676d 6129 2c20 7368 6966 7429  , sigma), shift)
+00011b70: 0d0a 2020 2020 706c 742e 706c 6f74 2867  ..    plt.plot(g
+00011b80: 616c 6178 792c 2027 6b27 290d 0a20 2020  alaxy, 'k')..   
+00011b90: 2070 6c74 2e70 6c6f 7428 7465 6d70 6c61   plt.plot(templa
+00011ba0: 7465 2a6e 702e 6d65 6469 616e 2867 616c  te*np.median(gal
+00011bb0: 6178 7929 2f6e 702e 6d65 6469 616e 2874  axy)/np.median(t
+00011bc0: 656d 706c 6174 6529 2c20 2772 2729 0d0a  emplate), 'r')..
+00011bd0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
 00011be0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00011bf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00011c00: 2323 2323 2323 2323 230d 0a0d 0a0d 0a4c  #########......L
-00011c10: 6963 656e 7365 0d0a 2d2d 2d2d 2d2d 2d0d  icense..-------.
-00011c20: 0a0d 0a4f 7468 6572 2f50 726f 7072 6965  ...Other/Proprie
-00011c30: 7461 7279 204c 6963 656e 7365 0d0a 0d0a  tary License....
-00011c40: 436f 7079 7269 6768 7420 2863 2920 3230  Copyright (c) 20
-00011c50: 3031 2d32 3032 3420 4d69 6368 656c 6520  01-2024 Michele 
-00011c60: 4361 7070 656c 6c61 7269 0d0a 0d0a 5468  Cappellari....Th
-00011c70: 6973 2073 6f66 7477 6172 6520 6973 2070  is software is p
-00011c80: 726f 7669 6465 6420 6173 2069 7320 7769  rovided as is wi
-00011c90: 7468 206e 6f20 7761 7272 616e 7479 2e20  th no warranty. 
-00011ca0: 596f 7520 6d61 7920 7573 6520 6974 2066  You may use it f
-00011cb0: 6f72 0d0a 6e6f 6e2d 636f 6d6d 6572 6369  or..non-commerci
-00011cc0: 616c 2070 7572 706f 7365 7320 616e 6420  al purposes and 
-00011cd0: 6d6f 6469 6679 2069 7420 666f 7220 7065  modify it for pe
-00011ce0: 7273 6f6e 616c 206f 7220 696e 7465 726e  rsonal or intern
-00011cf0: 616c 2075 7365 2c20 6173 206c 6f6e 670d  al use, as long.
-00011d00: 0a61 7320 796f 7520 696e 636c 7564 6520  .as you include 
-00011d10: 7468 6973 2063 6f70 7972 6967 6874 2061  this copyright a
-00011d20: 6e64 2064 6973 636c 6169 6d65 7220 696e  nd disclaimer in
-00011d30: 2061 6c6c 2063 6f70 6965 732e 2059 6f75   all copies. You
-00011d40: 206d 6179 206e 6f74 0d0a 7265 6469 7374   may not..redist
-00011d50: 7269 6275 7465 2074 6865 2063 6f64 652e  ribute the code.
-00011d60: 0d0a 0d0a 2323 2323 2323 2323 2323 2323  ....############
-00011d70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00011c00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00011c10: 2323 2323 2323 2323 2323 2323 230d 0a0d  #############...
+00011c20: 0a0d 0a4c 6963 656e 7365 0d0a 2d2d 2d2d  ...License..----
+00011c30: 2d2d 2d0d 0a0d 0a4f 7468 6572 2f50 726f  ---....Other/Pro
+00011c40: 7072 6965 7461 7279 204c 6963 656e 7365  prietary License
+00011c50: 0d0a 0d0a 436f 7079 7269 6768 7420 2863  ....Copyright (c
+00011c60: 2920 3230 3031 2d32 3032 3420 4d69 6368  ) 2001-2024 Mich
+00011c70: 656c 6520 4361 7070 656c 6c61 7269 0d0a  ele Cappellari..
+00011c80: 0d0a 5468 6973 2073 6f66 7477 6172 6520  ..This software 
+00011c90: 6973 2070 726f 7669 6465 6420 6173 2069  is provided as i
+00011ca0: 7320 7769 7468 206e 6f20 7761 7272 616e  s with no warran
+00011cb0: 7479 2e20 596f 7520 6d61 7920 7573 6520  ty. You may use 
+00011cc0: 6974 2066 6f72 0d0a 6e6f 6e2d 636f 6d6d  it for..non-comm
+00011cd0: 6572 6369 616c 2070 7572 706f 7365 7320  ercial purposes 
+00011ce0: 616e 6420 6d6f 6469 6679 2069 7420 666f  and modify it fo
+00011cf0: 7220 7065 7273 6f6e 616c 206f 7220 696e  r personal or in
+00011d00: 7465 726e 616c 2075 7365 2c20 6173 206c  ternal use, as l
+00011d10: 6f6e 670d 0a61 7320 796f 7520 696e 636c  ong..as you incl
+00011d20: 7564 6520 7468 6973 2063 6f70 7972 6967  ude this copyrig
+00011d30: 6874 2061 6e64 2064 6973 636c 6169 6d65  ht and disclaime
+00011d40: 7220 696e 2061 6c6c 2063 6f70 6965 732e  r in all copies.
+00011d50: 2059 6f75 206d 6179 206e 6f74 0d0a 7265   You may not..re
+00011d60: 6469 7374 7269 6275 7465 2074 6865 2063  distribute the c
+00011d70: 6f64 652e 0d0a 0d0a 2323 2323 2323 2323  ode.....########
 00011d80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00011d90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00011da0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00011db0: 0a0d 0a43 6861 6e67 656c 6f67 0d0a 2d2d  ...Changelog..--
-00011dc0: 2d2d 2d2d 2d2d 2d0d 0a0d 0a56 392e 322e  -------....V9.2.
-00011dd0: 313a 204d 432c 204f 7866 6f72 642c 2031  1: MC, Oxford, 1
-00011de0: 3820 4170 7269 6c20 3230 3234 0d0a 2b2b  8 April 2024..++
-00011df0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00011e00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-00011e10: 0a0d 0a2d 202a 2a49 6d70 726f 7665 642a  ...- **Improved*
-00011e20: 2a20 6060 7370 735f 7574 696c 2e73 796e  * ``sps_util.syn
-00011e30: 7468 6574 6963 5f70 686f 746f 6d65 7472  thetic_photometr
-00011e40: 7960 603a 2041 6363 6570 7473 2069 6e70  y``: Accepts inp
-00011e50: 7574 2077 6176 656c 656e 6774 6873 0d0a  ut wavelengths..
-00011e60: 2020 7468 6174 2061 7265 206e 6f74 2065    that are not e
-00011e70: 7665 6e6c 7920 7370 6163 6564 2e0d 0a2d  venly spaced...-
-00011e80: 202a 2a41 6464 6564 2a2a 2060 6070 7078   **Added** ``ppx
-00011e90: 665f 7574 696c 2e6d 6167 5f73 7065 6374  f_util.mag_spect
-00011ea0: 7275 6d60 603a 2041 206e 6577 2066 756e  rum``: A new fun
-00011eb0: 6374 696f 6e20 746f 2067 6574 2074 6865  ction to get the
-00011ec0: 2061 7070 6172 656e 740d 0a20 206d 6167   apparent..  mag
-00011ed0: 6e69 7475 6465 2066 726f 6d20 6120 7370  nitude from a sp
-00011ee0: 6563 7472 756d 2069 6e20 616e 7920 7068  ectrum in any ph
-00011ef0: 6f74 6f6d 6574 7269 6320 6261 6e64 2c20  otometric band, 
-00011f00: 6174 2061 6e79 2072 6564 7368 6966 742c  at any redshift,
-00011f10: 2069 6e20 6569 7468 6572 0d0a 2020 7468   in either..  th
-00011f20: 6520 4142 206f 7220 5665 6761 206d 6167  e AB or Vega mag
-00011f30: 6e69 7475 6465 2073 7973 7465 6d2e 0d0a  nitude system...
-00011f40: 2d20 2a2a 496d 7072 6f76 6564 2a2a 2060  - **Improved** `
-00011f50: 6070 7078 6660 603a 204e 6f77 2063 6f6e  `ppxf``: Now con
-00011f60: 7369 6465 7273 2074 6865 2067 6976 656e  siders the given
-00011f70: 2060 6067 6f6f 6470 6978 656c 7360 6020   ``goodpixels`` 
-00011f80: 7768 656e 2063 6865 636b 696e 670d 0a20  when checking.. 
-00011f90: 2074 6861 7420 7468 6520 6060 7465 6d70   that the ``temp
-00011fa0: 6c61 7465 7360 6020 636f 7665 7220 7468  lates`` cover th
-00011fb0: 6520 6675 6c6c 2060 6067 616c 6178 7960  e full ``galaxy`
-00011fc0: 6020 7370 6563 7472 756d 2c20 6966 2062  ` spectrum, if b
-00011fd0: 6f74 6820 6060 6c61 6d60 600d 0a20 2061  oth ``lam``..  a
-00011fe0: 6e64 2060 606c 616d 5f74 656d 7060 6020  nd ``lam_temp`` 
-00011ff0: 6172 6520 7072 6f76 6964 6564 2e0d 0a2d  are provided...-
-00012000: 202a 2a41 6464 6564 2a2a 2060 6070 7078   **Added** ``ppx
-00012010: 6660 603a 2041 6c6c 6f77 2066 6f72 2076  f``: Allow for v
-00012020: 6172 6961 626c 6520 7374 6570 2073 697a  ariable step siz
-00012030: 6520 6163 726f 7373 2069 6e74 6572 7661  e across interva
-00012040: 6c73 2061 6e64 0d0a 2020 6469 6d65 6e73  ls and..  dimens
-00012050: 696f 6e73 2069 6e20 7468 6520 6e75 6d65  ions in the nume
-00012060: 7269 6361 6c20 6465 7269 7661 7469 7665  rical derivative
-00012070: 7320 7573 6564 2066 6f72 2072 6567 756c  s used for regul
-00012080: 6172 697a 6174 696f 6e2c 2077 6974 6820  arization, with 
-00012090: 7468 6520 6e65 770d 0a20 206b 6579 776f  the new..  keywo
-000120a0: 7264 2060 6072 6567 5f73 7465 7060 602e  rd ``reg_step``.
-000120b0: 0d0a 2d20 2a2a 4669 7865 642a 2a20 6060  ..- **Fixed** ``
-000120c0: 7070 7866 6060 3a20 4176 6f69 6473 206e  ppxf``: Avoids n
-000120d0: 6577 2060 6053 796e 7461 7857 6172 6e69  ew ``SyntaxWarni
-000120e0: 6e67 6060 2069 6e20 4d61 7470 6c6f 746c  ng`` in Matplotl
-000120f0: 6962 204c 6154 6558 2073 7472 696e 670d  ib LaTeX string.
-00012100: 0a20 2069 6e20 7468 6520 6c61 7465 7374  .  in the latest
-00012110: 2050 7974 686f 6e20 332e 3132 2e0d 0a2d   Python 3.12...-
-00012120: 202a 2a46 6978 6564 2a2a 2060 6070 7078   **Fixed** ``ppx
-00012130: 6660 603a 2041 766f 6964 2070 726f 6772  f``: Avoid progr
-00012140: 616d 2073 746f 7020 7768 656e 2070 6173  am stop when pas
-00012150: 7369 6e67 2061 6e20 696e 7075 7420 636f  sing an input co
-00012160: 7661 7269 616e 6365 0d0a 2020 6d61 7472  variance..  matr
-00012170: 6978 2077 6869 6c65 2066 6974 7469 6e67  ix while fitting
-00012180: 2066 6f72 2067 6173 2065 6d69 7373 696f   for gas emissio
-00012190: 6e20 6c69 6e65 732e 2054 6861 6e6b 7320  n lines. Thanks 
-000121a0: 746f 204a 6163 6b73 6f6e 204f 446f 6e6e  to Jackson ODonn
-000121b0: 656c 6c0d 0a20 2028 7563 7363 2e65 6475  ell..  (ucsc.edu
-000121c0: 2920 666f 7220 7468 6520 7265 706f 7274  ) for the report
-000121d0: 2e0d 0a0d 0a56 392e 312e 313a 204d 432c  .....V9.1.1: MC,
-000121e0: 204f 7866 6f72 642c 2031 3820 4a61 6e75   Oxford, 18 Janu
-000121f0: 6172 7920 3230 3234 0d0a 2b2b 2b2b 2b2b  ary 2024..++++++
-00012200: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012210: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00012220: 0a2d 202a 2a49 6d70 726f 7665 642a 2a20  .- **Improved** 
-00012230: 6060 7370 735f 7574 696c 2e6d 6173 735f  ``sps_util.mass_
-00012240: 746f 5f6c 6967 6874 6060 3a20 4e6f 7720  to_light``: Now 
-00012250: 6974 2063 616e 2063 616c 6375 6c61 7465  it can calculate
-00012260: 2074 6865 2073 7465 6c6c 6172 0d0a 2020   the stellar..  
-00012270: 6d61 7373 2d74 6f2d 6c69 6768 7420 7261  mass-to-light ra
-00012280: 7469 6f20 2860 604d 2a2f 4c60 6029 2066  tio (``M*/L``) f
-00012290: 6f72 2061 6e79 2073 7465 6c6c 6172 2070  or any stellar p
-000122a0: 6f70 756c 6174 696f 6e20 7379 6e74 6865  opulation synthe
-000122b0: 7369 7320 2853 5053 290d 0a20 206d 6f64  sis (SPS)..  mod
-000122c0: 656c 2c20 616e 7920 6669 6c74 6572 2c20  el, any filter, 
-000122d0: 616e 6420 616e 7920 7265 6473 6869 6674  and any redshift
-000122e0: 2c20 7573 696e 6720 7468 6520 6f75 7470  , using the outp
-000122f0: 7574 2077 6569 6768 7473 2066 726f 6d20  ut weights from 
-00012300: 6060 7050 5846 6060 2e0d 0a20 204e 6f20  ``pPXF``...  No 
-00012310: 6e65 6564 2066 6f72 2070 7265 2d63 6f6d  need for pre-com
-00012320: 7075 7465 6420 7461 626c 6573 2061 6e79  puted tables any
-00012330: 6d6f 7265 2e0d 0a2d 202a 2a41 6464 6564  more...- **Added
-00012340: 2a2a 2060 6070 7078 665f 7574 696c 2e6d  ** ``ppxf_util.m
-00012350: 6167 5f73 756e 6060 3a20 4120 6e65 7720  ag_sun``: A new 
-00012360: 6675 6e63 7469 6f6e 2074 6f20 6765 7420  function to get 
-00012370: 7468 6520 6162 736f 6c75 7465 2073 6f6c  the absolute sol
-00012380: 6172 0d0a 2020 6d61 676e 6974 7564 6520  ar..  magnitude 
-00012390: 696e 2061 6e79 2070 686f 746f 6d65 7472  in any photometr
-000123a0: 6963 2062 616e 642c 2061 7420 616e 7920  ic band, at any 
-000123b0: 7265 6473 6869 6674 2c20 696e 2065 6974  redshift, in eit
-000123c0: 6865 7220 7468 6520 4142 206f 7220 5665  her the AB or Ve
-000123d0: 6761 0d0a 2020 6d61 676e 6974 7564 6520  ga..  magnitude 
-000123e0: 7379 7374 656d 2e0d 0a0d 0a56 392e 302e  system.....V9.0.
-000123f0: 323a 204d 432c 204f 7866 6f72 642c 2033  2: MC, Oxford, 3
-00012400: 3020 4e6f 7665 6d62 6572 2032 3032 330d  0 November 2023.
-00012410: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-00012420: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012430: 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6070 7078  +++++....- ``ppx
-00012440: 6660 603a 2046 6978 6564 2062 7567 2069  f``: Fixed bug i
-00012450: 6e20 7468 6520 6175 746f 6d61 7469 6320  n the automatic 
-00012460: 7472 756e 6361 7469 6f6e 206f 6620 7468  truncation of th
-00012470: 6520 7465 6d70 6c61 7465 2077 6176 656c  e template wavel
-00012480: 656e 6774 682c 0d0a 2020 7768 656e 2075  ength,..  when u
-00012490: 7369 6e67 2060 6062 6f75 6e64 7360 6020  sing ``bounds`` 
-000124a0: 746f 6765 7468 6572 2077 6974 6820 6060  together with ``
-000124b0: 6c61 6d60 6020 616e 6420 6060 6c61 6d5f  lam`` and ``lam_
-000124c0: 7465 6d70 6060 2e0d 0a0d 0a56 392e 302e  temp``.....V9.0.
-000124d0: 313a 204d 432c 204f 7866 6f72 642c 2031  1: MC, Oxford, 1
-000124e0: 3220 4e6f 7665 6d62 6572 2032 3032 330d  2 November 2023.
-000124f0: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-00012500: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012510: 2b2b 2b2b 2b0d 0a0d 0a2d 2052 6570 6c61  +++++....- Repla
-00012520: 6365 6420 6060 6d69 6c65 735f 7574 696c  ced ``miles_util
-00012530: 6060 2077 6974 6820 6060 7370 735f 7574  `` with ``sps_ut
-00012540: 696c 6060 2c20 6120 7665 7273 6174 696c  il``, a versatil
-00012550: 6520 616e 6420 666c 6578 6962 6c65 2066  e and flexible f
-00012560: 756e 6374 696f 6e0d 0a20 2074 6861 7420  unction..  that 
-00012570: 7375 7070 6f72 7473 2076 6172 696f 7573  supports various
-00012580: 2073 7465 6c6c 6172 2070 6f70 756c 6174   stellar populat
-00012590: 696f 6e20 7379 6e74 6865 7369 7320 2853  ion synthesis (S
-000125a0: 5053 2920 6d6f 6465 6c73 2e20 4375 7272  PS) models. Curr
-000125b0: 656e 746c 792c 2049 0d0a 2020 6469 7374  ently, I..  dist
-000125c0: 7269 6275 7465 2028 7769 7468 2070 6572  ribute (with per
-000125d0: 6d69 7373 696f 6e29 2074 6865 2060 6045  mission) the ``E
-000125e0: 2d4d 494c 4553 6060 2028 5661 7a64 656b  -MILES`` (Vazdek
-000125f0: 6973 2b32 3031 3629 2c20 6060 4741 4c41  is+2016), ``GALA
-00012600: 5845 5660 600d 0a20 2028 4272 757a 7561  XEV``..  (Bruzua
-00012610: 6c20 2620 4368 6172 6c6f 7420 3230 3033  l & Charlot 2003
-00012620: 2920 616e 6420 6060 6673 7073 6060 2028  ) and ``fsps`` (
-00012630: 436f 6e72 6f79 2b32 3030 392c 3230 3130  Conroy+2009,2010
-00012640: 2920 7374 656c 6c61 7220 706f 7075 6c61  ) stellar popula
-00012650: 7469 6f6e 0d0a 2020 7465 6d70 6c61 7465  tion..  template
-00012660: 732e 204f 6e65 2063 616e 206e 6f77 2063  s. One can now c
-00012670: 6861 6e67 6520 5350 5320 6279 206a 7573  hange SPS by jus
-00012680: 7420 6d6f 6469 6679 696e 6720 7468 6520  t modifying the 
-00012690: 6669 6c65 6e61 6d65 2e0d 0a20 200d 0a20  filename...  .. 
-000126a0: 2049 4d50 4f52 5441 4e54 3a20 4920 6e6f   IMPORTANT: I no
-000126b0: 206c 6f6e 6765 7220 696e 636c 7564 6520   longer include 
-000126c0: 7468 6520 5350 5320 6d6f 6465 6c73 2069  the SPS models i
-000126d0: 6e20 7468 6520 6060 7050 5846 6060 2070  n the ``pPXF`` p
-000126e0: 6163 6b61 6765 2c20 6475 6520 746f 0d0a  ackage, due to..
-000126f0: 2020 6669 6c65 2073 697a 6520 636f 6e73    file size cons
-00012700: 7472 6169 6e74 732e 204f 6e65 206d 7573  traints. One mus
-00012710: 7420 646f 776e 6c6f 6164 2074 6865 2053  t download the S
-00012720: 5053 2074 656d 706c 6174 6573 2073 6570  PS templates sep
-00012730: 6172 6174 656c 7920 6166 7465 720d 0a20  arately after.. 
-00012740: 2074 6865 2060 6070 5058 4660 6020 696e   the ``pPXF`` in
-00012750: 7374 616c 6c61 7469 6f6e 2c20 6173 2064  stallation, as d
-00012760: 656d 6f6e 7374 7261 7465 6420 696e 2061  emonstrated in a
-00012770: 6c6c 2074 6865 2060 6070 5058 4660 6020  ll the ``pPXF`` 
-00012780: 6578 616d 706c 6573 2e0d 0a2d 2049 2061  examples...- I a
-00012790: 6461 7074 6564 2061 6c6c 2065 7861 6d70  dapted all examp
-000127a0: 6c65 7320 696e 636c 7564 6564 2069 6e20  les included in 
-000127b0: 7468 6520 7061 636b 6167 6520 746f 2075  the package to u
-000127c0: 7365 2074 6865 206e 6577 2060 6073 7073  se the new ``sps
-000127d0: 5f75 7469 6c60 602e 200d 0a2d 2060 6070  _util``. ..- ``p
-000127e0: 7078 662e 706c 6f74 6060 3a20 4e65 7720  pxf.plot``: New 
-000127f0: 6b65 7977 6f72 6420 6060 6c61 6d5f 666c  keyword ``lam_fl
-00012800: 616d 6060 2074 6f20 706c 6f74 2060 606c  am`` to plot ``l
-00012810: 616d 2a66 286c 616d 2920 3d20 6e75 2a66  am*f(lam) = nu*f
-00012820: 286e 7529 6060 2e0d 0a2d 2060 6070 7078  (nu)``...- ``ppx
-00012830: 665f 7574 696c 2e73 796e 7468 6574 6963  f_util.synthetic
-00012840: 5f70 686f 746f 6d65 7472 7960 603a 2043  _photometry``: C
-00012850: 6f6e 7665 7274 6564 2066 726f 6d20 6120  onverted from a 
-00012860: 6675 6e63 7469 6f6e 2074 6f20 6120 636c  function to a cl
-00012870: 6173 732e 0d0a 2020 4164 6465 6420 6060  ass...  Added ``
-00012880: 2e6c 616d 5f70 6976 6060 2061 7474 7269  .lam_piv`` attri
-00012890: 6275 7465 2074 6f20 636f 6d70 7574 6520  bute to compute 
-000128a0: 7468 6520 7069 766f 7420 7761 7665 6c65  the pivot wavele
-000128b0: 6e67 7468 206f 6620 6561 6368 2066 696c  ngth of each fil
-000128c0: 7465 722e 0d0a 2d20 6060 7070 7866 5f75  ter...- ``ppxf_u
-000128d0: 7469 6c2e 7661 7273 6d6f 6f74 6860 603a  til.varsmooth``:
-000128e0: 2053 7065 6369 616c 697a 6564 2066 6173   Specialized fas
-000128f0: 7465 7220 636f 6e76 6f6c 7574 696f 6e20  ter convolution 
-00012900: 6966 2073 6967 6d61 2069 7320 6120 7363  if sigma is a sc
-00012910: 616c 6172 2e0d 0a20 2077 6869 6c65 2075  alar...  while u
-00012920: 7369 6e67 2074 6865 2061 6e61 6c79 7469  sing the analyti
-00012930: 6320 466f 7572 6965 7220 7472 616e 7366  c Fourier transf
-00012940: 6f72 6d20 746f 2064 6561 6c20 7769 7468  orm to deal with
-00012950: 2075 6e64 6572 7361 6d70 6c69 6e67 2e0d   undersampling..
-00012960: 0a2d 2060 6070 7078 6660 603a 2052 6169  .- ``ppxf``: Rai
-00012970: 7365 6420 616e 2065 7272 6f72 2069 6620  sed an error if 
-00012980: 6060 7068 6f74 6060 2069 6e70 7574 2069  ``phot`` input i
-00012990: 7320 6e6f 7420 6669 6e69 7465 2e0d 0a0d  s not finite....
-000129a0: 0a56 382e 322e 363a 204d 432c 204f 7866  .V8.2.6: MC, Oxf
-000129b0: 6f72 642c 2036 204a 756c 7920 3230 3233  ord, 6 July 2023
-000129c0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-000129d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000129e0: 2b0d 0a0d 0a2d 2060 6063 6170 6669 7460  +....- ``capfit`
-000129f0: 603a 2052 656c 6178 6564 2074 6f6c 6572  `: Relaxed toler
-00012a00: 616e 6365 2077 6865 6e20 6368 6563 6b69  ance when checki
-00012a10: 6e67 2069 6e69 7469 616c 2067 7565 7373  ng initial guess
-00012a20: 2066 6561 7369 6269 6c69 7479 2e0d 0a2d   feasibility...-
-00012a30: 2060 6070 7078 665f 7574 696c 6060 3a20   ``ppxf_util``: 
-00012a40: 4669 7865 6420 7072 6f67 7261 6d20 7374  Fixed program st
-00012a50: 6f70 2069 6e20 6060 6761 7573 7369 616e  op in ``gaussian
-00012a60: 5f66 696c 7465 7231 6460 6020 7768 656e  _filter1d`` when
-00012a70: 2060 6073 6967 3d30 6060 2e0d 0a20 2054   ``sig=0``...  T
-00012a80: 6861 6e6b 7320 746f 204a 6573 7365 2056  hanks to Jesse V
-00012a90: 616e 2064 6520 5361 6e64 6520 2873 7964  an de Sande (syd
-00012aa0: 6e65 792e 6564 752e 6175 2920 666f 7220  ney.edu.au) for 
-00012ab0: 7468 6520 7265 706f 7274 2e0d 0a0d 0a56  the report.....V
-00012ac0: 382e 322e 343a 204d 432c 204f 7866 6f72  8.2.4: MC, Oxfor
-00012ad0: 642c 2031 3220 4d61 7920 3230 3233 0d0a  d, 12 May 2023..
-00012ae0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012af0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-00012b00: 0a0d 0a2d 2060 6070 7078 6660 603a 2046  ...- ``ppxf``: F
-00012b10: 6978 6564 2069 6e63 6f72 7265 6374 6c79  ixed incorrectly
-00012b20: 2073 7769 7463 6869 6e67 2074 6f20 6060   switching to ``
-00012b30: 6d65 7468 6f64 3d27 6c69 6e65 6172 2760  method='linear'`
-00012b40: 6020 7768 656e 2072 6571 7565 7374 696e  ` when requestin
-00012b50: 670d 0a20 2074 6f20 6669 7420 7374 656c  g..  to fit stel
-00012b60: 6c61 7220 7265 6464 656e 696e 6720 616c  lar reddening al
-00012b70: 6f6e 652c 2077 6869 6c65 2061 6c6c 206f  one, while all o
-00012b80: 7468 6572 2070 6172 616d 6574 6572 7320  ther parameters 
-00012b90: 6172 6520 6669 7865 642e 2054 6861 6e6b  are fixed. Thank
-00012ba0: 730d 0a20 2074 6f20 4a6f 6e67 2043 6875  s..  to Jong Chu
-00012bb0: 6c20 4c65 6520 286b 6173 692e 7265 2e6b  l Lee (kasi.re.k
-00012bc0: 7229 2066 6f72 2061 2063 6c65 6172 2065  r) for a clear e
-00012bd0: 7861 6d70 6c65 206f 6620 7265 7072 6f64  xample of reprod
-00012be0: 7563 696e 6720 7468 6520 6275 672e 0d0a  ucing the bug...
-00012bf0: 0d0a 5638 2e32 2e33 3a20 4d43 2c20 4f78  ..V8.2.3: MC, Ox
-00012c00: 666f 7264 2c20 3520 4a61 6e75 6172 7920  ford, 5 January 
-00012c10: 3230 3233 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2023..++++++++++
-00012c20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012c30: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060  ++++++++....- ``
-00012c40: 7070 7866 6060 3a20 4669 7865 6420 7072  ppxf``: Fixed pr
-00012c50: 6f67 7261 6d20 7374 6f70 2077 6865 6e20  ogram stop when 
-00012c60: 6669 7474 696e 6720 626f 7468 2073 6b79  fitting both sky
-00012c70: 2073 7065 6374 7261 2061 6e64 2067 6173   spectra and gas
-00012c80: 2065 6d69 7373 696f 6e0d 0a20 206c 696e   emission..  lin
-00012c90: 6573 2e20 4d61 6e79 2074 6861 6e6b 7320  es. Many thanks 
-00012ca0: 746f 2041 6461 7273 6820 5261 6e6a 616e  to Adarsh Ranjan
-00012cb0: 2028 6b61 7369 2e72 652e 6b72 2920 666f   (kasi.re.kr) fo
-00012cc0: 7220 6120 636c 6561 7220 6578 616d 706c  r a clear exampl
-00012cd0: 650d 0a20 206f 6620 7265 7072 6f64 7563  e..  of reproduc
-00012ce0: 696e 6720 7468 6520 7072 6f62 6c65 6d20  ing the problem 
-00012cf0: 616e 6420 666f 7220 7468 6520 6275 6720  and for the bug 
-00012d00: 6669 782e 0d0a 2d20 6060 7070 7866 6060  fix...- ``ppxf``
-00012d10: 3a20 5261 6973 6520 616e 2065 7272 6f72  : Raise an error
-00012d20: 2069 6620 6060 7665 6c73 6361 6c65 6060   if ``velscale``
-00012d30: 2069 7320 6e6f 7420 6120 7363 616c 6172   is not a scalar
-00012d40: 2e20 5570 6461 7465 6420 6578 616d 706c  . Updated exampl
-00012d50: 650d 0a20 2070 726f 6365 6475 7265 732e  e..  procedures.
-00012d60: 2054 6869 7320 6669 7865 7320 6120 7072   This fixes a pr
-00012d70: 6f67 7261 6d20 7374 6f70 2064 7565 2074  ogram stop due t
-00012d80: 6f20 6120 6368 616e 6765 2069 6e20 4e75  o a change in Nu
-00012d90: 6d50 7920 312e 3234 2e0d 0a2d 2060 6070  mPy 1.24...- ``p
-00012da0: 7078 665f 7574 696c 6060 3a20 4368 616e  pxf_util``: Chan
-00012db0: 6765 6420 6060 6c6f 675f 7265 6269 6e60  ged ``log_rebin`
-00012dc0: 6020 746f 2072 6574 7572 6e20 6060 7665  ` to return ``ve
-00012dd0: 6c73 6361 6c65 6060 2061 7320 6120 7363  lscale`` as a sc
-00012de0: 616c 6172 2e0d 0a2d 204e 6577 2065 7861  alar...- New exa
-00012df0: 6d70 6c65 2070 726f 6365 6475 7265 2060  mple procedure `
-00012e00: 6070 7078 665f 6578 616d 706c 655f 6761  `ppxf_example_ga
-00012e10: 735f 7364 7373 5f74 6965 642e 7079 6060  s_sdss_tied.py``
-00012e20: 2074 6f20 696c 6c75 7374 7261 7465 2074   to illustrate t
-00012e30: 6865 0d0a 2020 7573 6520 6f66 2074 6865  he..  use of the
-00012e40: 2060 6074 6965 6460 6020 616e 6420 6060   ``tied`` and ``
-00012e50: 636f 6e73 7472 5f6b 696e 656d 6060 206b  constr_kinem`` k
-00012e60: 6579 776f 7264 732e 0d0a 0d0a 5638 2e32  eywords.....V8.2
-00012e70: 2e32 3a20 4d43 2c20 4f78 666f 7264 2c20  .2: MC, Oxford, 
-00012e80: 3131 204f 6374 6f62 6572 2032 3032 320d  11 October 2022.
-00012e90: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-00012ea0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012eb0: 2b2b 2b2b 0d0a 0d0a 2d20 6060 7070 7866  ++++....- ``ppxf
-00012ec0: 6060 3a20 4669 7865 6420 7072 6f67 7261  ``: Fixed progra
-00012ed0: 6d20 7374 6f70 2077 6974 6820 6060 7469  m stop with ``ti
-00012ee0: 6564 6060 206f 7220 6060 6669 7865 6460  ed`` or ``fixed`
-00012ef0: 6020 6b65 7977 6f72 6473 2061 6e64 0d0a  ` keywords and..
-00012f00: 2020 6e6f 6e6c 696e 6561 7220 7661 7269    nonlinear vari
-00012f10: 6162 6c65 7320 696e 2061 6464 6974 696f  ables in additio
-00012f20: 6e20 746f 2074 6865 206b 696e 656d 6174  n to the kinemat
-00012f30: 6963 732e 2054 6861 6e6b 7320 746f 2054  ics. Thanks to T
-00012f40: 6f62 6961 7320 4c6f 6f73 6572 0d0a 2020  obias Looser..  
-00012f50: 2863 616d 2e61 632e 756b 2920 666f 7220  (cam.ac.uk) for 
-00012f60: 7468 6520 7265 706f 7274 2061 6e64 2066  the report and f
-00012f70: 6978 2e0d 0a0d 0a56 382e 322e 313a 204d  ix.....V8.2.1: M
-00012f80: 432c 204f 7866 6f72 642c 2033 2053 6570  C, Oxford, 3 Sep
-00012f90: 7465 6d62 6572 2032 3032 320d 0a2b 2b2b  tember 2022..+++
-00012fa0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012fb0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012fc0: 2b0d 0a0d 0a2d 2060 6070 7078 6660 603a  +....- ``ppxf``:
-00012fd0: 204e 6577 206b 6579 776f 7264 2060 6064   New keyword ``d
-00012fe0: 7573 7460 6020 7768 6963 6820 616c 6c6f  ust`` which allo
-00012ff0: 7773 206f 6e65 2074 6f20 6173 736f 6369  ws one to associ
-00013000: 6174 6520 6469 6666 6572 656e 740d 0a20  ate different.. 
-00013010: 2067 656e 6572 616c 2061 7474 656e 7561   general attenua
-00013020: 7469 6f6e 2066 756e 6374 696f 6e73 2074  tion functions t
-00013030: 6f20 6469 6666 6572 656e 7420 7365 7473  o different sets
-00013040: 206f 6620 7465 6d70 6c61 7465 732e 2054   of templates. T
-00013050: 6869 7320 6973 2075 7365 6675 6c0d 0a20  his is useful.. 
-00013060: 2066 6f72 2065 7861 6d70 6c65 2074 6f20   for example to 
-00013070: 6170 706c 7920 7468 7265 6520 6469 6666  apply three diff
-00013080: 6572 656e 7420 6174 7465 6e75 6174 696f  erent attenuatio
-00013090: 6e20 6675 6e63 7469 6f6e 7320 746f 2074  n functions to t
-000130a0: 6865 2079 6f75 6e67 2061 6e64 0d0a 2020  he young and..  
-000130b0: 6f6c 6420 7374 656c 6c61 7220 7465 6d70  old stellar temp
-000130c0: 6c61 7465 7320 616e 6420 746f 2074 6865  lates and to the
-000130d0: 2067 6173 2065 6d69 7373 696f 6e20 6c69   gas emission li
-000130e0: 6e65 7320 7265 7370 6563 7469 7665 6c79  nes respectively
-000130f0: 2e0d 0a2d 2060 6070 7078 6660 603a 2055  ...- ``ppxf``: U
-00013100: 7365 7320 6060 415f 5660 6020 696e 7374  ses ``A_V`` inst
-00013110: 6561 6420 6f66 2060 6045 2842 2d56 2960  ead of ``E(B-V)`
-00013120: 6020 746f 2070 6172 616d 6574 7269 7a65  ` to parametrize
-00013130: 2061 7474 656e 7561 7469 6f6e 2c20 7768   attenuation, wh
-00013140: 656e 0d0a 2020 7573 696e 6720 7468 6520  en..  using the 
-00013150: 6e6f 772d 6f62 736f 6c65 7465 206b 6579  now-obsolete key
-00013160: 776f 7264 7320 6060 7265 6464 656e 696e  words ``reddenin
-00013170: 6760 6020 616e 6420 2060 6067 6173 5f72  g`` and  ``gas_r
-00013180: 6564 6465 6e69 6e67 6060 2e0d 0a2d 2060  eddening``...- `
-00013190: 6070 7078 6660 603a 204e 6577 2064 6566  `ppxf``: New def
-000131a0: 6175 6c74 2066 756e 6374 696f 6e20 6060  ault function ``
-000131b0: 6174 7465 6e75 6174 696f 6e28 2960 602e  attenuation()``.
-000131c0: 2048 6f77 6576 6572 2c20 6f6e 6520 6361   However, one ca
-000131d0: 6e20 6e6f 7720 7573 650d 0a20 2067 656e  n now use..  gen
-000131e0: 6572 616c 2061 7474 656e 7561 7469 6f6e  eral attenuation
-000131f0: 2066 756e 6374 696f 6e73 2077 6974 6820   functions with 
-00013200: 616e 2061 7262 6974 7261 7279 206e 756d  an arbitrary num
-00013210: 6265 7220 6f66 2062 6f75 6e64 206f 7220  ber of bound or 
-00013220: 6669 7865 640d 0a20 2070 6172 616d 6574  fixed..  paramet
-00013230: 6572 732e 0d0a 2d20 6060 7070 7866 6060  ers...- ``ppxf``
-00013240: 3a20 4e65 7720 696e 7465 726e 616c 2066  : New internal f
-00013250: 756e 6374 696f 6e73 2060 6073 6574 5f6c  unctions ``set_l
-00013260: 616d 5f69 6e70 7574 6060 2c20 6060 7365  am_input``, ``se
-00013270: 745f 6761 735f 696e 7075 7460 602c 0d0a  t_gas_input``,..
-00013280: 2020 6060 7365 745f 6475 7374 5f69 6e70    ``set_dust_inp
-00013290: 7574 6060 2c20 6060 7365 745f 7068 6f74  ut``, ``set_phot
-000132a0: 5f69 6e70 7574 6060 2074 6f20 6f72 6761  _input`` to orga
-000132b0: 6e69 7a65 2074 6865 2063 6f64 652e 0d0a  nize the code...
-000132c0: 2d20 6060 7070 7866 6060 3a20 496d 7072  - ``ppxf``: Impr
-000132d0: 6f76 6564 2076 6572 7469 6361 6c20 7363  oved vertical sc
-000132e0: 616c 696e 6720 6f66 2064 6566 6175 6c74  aling of default
-000132f0: 2070 6c6f 7473 2e0d 0a2d 2060 6070 7078   plots...- ``ppx
-00013300: 6660 603a 204e 6577 206b 6579 776f 7264  f``: New keyword
-00013310: 7320 6060 7070 2e70 6c6f 7428 7370 6563  s ``pp.plot(spec
-00013320: 3d54 7275 652c 2070 686f 743d 5472 7565  =True, phot=True
-00013330: 2960 6020 746f 2070 6c6f 7420 6f6e 6c79  )`` to plot only
-00013340: 2074 6865 0d0a 2020 7068 6f74 6f6d 6574   the..  photomet
-00013350: 7269 6320 6f72 2073 7065 6374 726f 7363  ric or spectrosc
-00013360: 6f70 6963 2062 6573 7420 6669 7473 2072  opic best fits r
-00013370: 6573 7065 6374 6976 656c 792e 0d0a 2d20  espectively...- 
-00013380: 6060 7070 7866 5f75 7469 6c60 603a 204e  ``ppxf_util``: N
-00013390: 6577 2066 756e 6374 696f 6e20 6060 7661  ew function ``va
-000133a0: 7273 6d6f 6f74 6860 6020 666f 7220 4761  rsmooth`` for Ga
-000133b0: 7573 7369 616e 2063 6f6e 766f 6c75 7469  ussian convoluti
-000133c0: 6f6e 2077 6974 6820 610d 0a20 2076 6172  on with a..  var
-000133d0: 6961 626c 6520 7369 676d 612e 2055 6e6c  iable sigma. Unl
-000133e0: 696b 6520 7468 6520 7369 6d69 6c61 7220  ike the similar 
-000133f0: 6060 6761 7573 7369 616e 5f66 696c 7465  ``gaussian_filte
-00013400: 7231 6460 602c 2074 6869 7320 6e65 7720  r1d``, this new 
-00013410: 6675 6e63 7469 6f6e 0d0a 2020 7573 6573  function..  uses
-00013420: 2046 4654 2061 6e64 2074 6865 2061 6e61   FFT and the ana
-00013430: 6c79 7469 6320 466f 7572 6965 7220 5472  lytic Fourier Tr
-00013440: 616e 7366 6f72 6d20 6f66 2061 2047 6175  ansform of a Gau
-00013450: 7373 6961 6e2c 206c 696b 6520 6060 7070  ssian, like ``pp
-00013460: 7866 6060 2e0d 0a2d 2060 6070 7078 665f  xf``...- ``ppxf_
-00013470: 7574 696c 6060 3a20 496e 636c 7564 6564  util``: Included
-00013480: 2061 6464 6974 696f 6e61 6c20 6761 7320   additional gas 
-00013490: 656d 6973 7369 6f6e 206c 696e 6573 2069  emission lines i
-000134a0: 6e20 6060 656d 6973 7369 6f6e 5f6c 696e  n ``emission_lin
-000134b0: 6573 2829 6060 2e0d 0a2d 2060 6063 6170  es()``...- ``cap
-000134c0: 6669 7460 603a 2055 7365 2060 6073 6369  fit``: Use ``sci
-000134d0: 7079 2e6f 7074 696d 697a 652e 6c69 6e70  py.optimize.linp
-000134e0: 726f 6728 6d65 7468 6f64 3d27 6869 6768  rog(method='high
-000134f0: 7327 2960 6020 746f 2066 696e 6420 6665  s')`` to find fe
-00013500: 6173 6962 6c65 0d0a 2020 7374 6172 7469  asible..  starti
-00013510: 6e67 2070 6f69 6e74 2069 6e20 6060 6c73  ng point in ``ls
-00013520: 715f 6c69 6e60 602e 2054 6869 7320 656c  q_lin``. This el
-00013530: 696d 696e 6174 6573 2070 6f73 7369 626c  iminates possibl
-00013540: 6520 7072 6f67 7261 6d20 7374 6f70 7320  e program stops 
-00013550: 696e 0d0a 2020 6365 7274 6169 6e20 7369  in..  certain si
-00013560: 7475 6174 696f 6e73 2077 6974 6820 6c69  tuations with li
-00013570: 6e65 6172 6c79 2064 6570 656e 6465 6e74  nearly dependent
-00013580: 2063 6f6e 7374 7261 696e 7473 2e0d 0a2d   constraints...-
-00013590: 2060 6063 6170 6669 7460 603a 2053 6574   ``capfit``: Set
-000135a0: 2064 6566 6175 6c74 2060 606c 696e 6561   default ``linea
-000135b0: 725f 6d65 7468 6f64 3d27 6c73 715f 6c69  r_method='lsq_li
-000135c0: 6e27 6060 2e20 5468 6973 2072 656d 6f76  n'``. This remov
-000135d0: 6573 2074 6865 206e 6565 640d 0a20 2074  es the need..  t
-000135e0: 6f20 696e 7374 616c 6c20 6060 6376 786f  o install ``cvxo
-000135f0: 7074 6060 2077 6865 6e20 7573 696e 6720  pt`` when using 
-00013600: 6060 636f 6e73 7472 5f6b 696e 656d 6060  ``constr_kinem``
-00013610: 2069 6e20 6060 7050 5846 6060 2e0d 0a0d   in ``pPXF``....
-00013620: 0a56 382e 312e 303a 204d 432c 204f 7866  .V8.1.0: MC, Oxf
-00013630: 6f72 642c 2031 3020 4a75 6e65 2032 3032  ord, 10 June 202
-00013640: 320d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  2..+++++++++++++
-00013650: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00013660: 2b2b 2b0d 0a0d 0a2d 2060 6070 7078 6660  +++....- ``ppxf`
-00013670: 603a 204d 6f72 6520 6163 6375 7261 7465  `: More accurate
-00013680: 2064 6574 6572 6d69 6e61 7469 6f6e 206f   determination o
-00013690: 6620 7468 6520 7261 6e67 6520 666f 7220  f the range for 
-000136a0: 7472 756e 6361 7469 6e67 2074 6865 0d0a  truncating the..
-000136b0: 2020 7465 6d70 6c61 7465 7320 7768 656e    templates when
-000136c0: 2070 6173 7369 6e67 2062 6f74 6820 6060   passing both ``
-000136d0: 6c61 6d5f 7465 6d70 6060 2061 6e64 2060  lam_temp`` and `
-000136e0: 606c 616d 6060 2e0d 0a2d 2060 6070 7078  `lam``...- ``ppx
-000136f0: 6660 603a 2043 6865 636b 2066 6f72 2060  f``: Check for `
-00013700: 606c 616d 6060 206f 7220 6060 6c61 6d5f  `lam`` or ``lam_
-00013710: 7465 6d70 6060 2063 6f6e 7369 7374 656e  temp`` consisten
-00013720: 6379 2077 6974 6820 6060 7665 6c73 6361  cy with ``velsca
-00013730: 6c65 6060 2061 6e64 0d0a 2020 7265 7475  le`` and..  retu
-00013740: 726e 2061 6e20 6572 726f 7220 6966 2074  rn an error if t
-00013750: 6865 7920 646f 206e 6f74 206d 6174 6368  hey do not match
-00013760: 2e0d 0a2d 2060 6070 7078 6660 603a 2055  ...- ``ppxf``: U
-00013770: 7365 206d 6963 726f 6d65 7472 6520 756e  se micrometre un
-00013780: 6974 7320 616e 6420 6465 6e73 6572 2074  its and denser t
-00013790: 6963 6b20 6c61 6265 6c73 2066 6f72 2074  ick labels for t
-000137a0: 6865 206c 6f67 6172 6974 686d 6963 0d0a  he logarithmic..
-000137b0: 2020 7761 7665 6c65 6e67 7468 2061 7869    wavelength axi
-000137c0: 732e 0d0a 2d20 6060 7070 7866 5f75 7469  s...- ``ppxf_uti
-000137d0: 6c2e 7379 6e74 6865 7469 635f 7068 6f74  l.synthetic_phot
-000137e0: 6f6d 6574 7279 6060 3a20 6d6f 7665 6420  ometry``: moved 
-000137f0: 6672 6f6d 2060 606d 696c 6573 5f75 7469  from ``miles_uti
-00013800: 6c60 6020 616e 6420 6d61 6465 2069 740d  l`` and made it.
-00013810: 0a20 2069 6e64 6570 656e 6465 6e74 206f  .  independent o
-00013820: 6620 7468 6520 7374 656c 6c61 7220 6c69  f the stellar li
-00013830: 6272 6172 792e 2041 646f 7074 6564 2074  brary. Adopted t
-00013840: 6865 2073 616d 6520 6669 6c74 6572 2066  he same filter f
-00013850: 696c 6520 666f 726d 6174 2061 730d 0a20  ile format as.. 
-00013860: 2045 415a 592c 2046 4153 542c 2048 7970   EAZY, FAST, Hyp
-00013870: 6572 5a2e 2e2e 2066 6f72 2069 6e74 6572  erZ... for inter
-00013880: 6f70 6572 6162 696c 6974 792e 0d0a 2020  operability...  
-00013890: 416c 6c6f 7720 7061 7373 696e 6720 6120  Allow passing a 
-000138a0: 6669 6c65 2077 6974 6820 7573 6572 2d64  file with user-d
-000138b0: 6566 696e 6564 2066 696c 7465 7220 7265  efined filter re
-000138c0: 7370 6f6e 7365 2066 756e 6374 696f 6e73  sponse functions
-000138d0: 2e0d 0a2d 2060 6070 7078 665f 7574 696c  ...- ``ppxf_util
-000138e0: 2e6c 6f67 5f72 6562 696e 6060 3a20 5375  .log_rebin``: Su
-000138f0: 7070 6f72 7420 6972 7265 6775 6c61 726c  pport irregularl
-00013900: 7920 7361 6d70 6c65 6420 696e 7075 7420  y sampled input 
-00013910: 7761 7665 6c65 6e67 7468 2e0d 0a2d 2060  wavelength...- `
-00013920: 6070 7078 665f 7574 696c 2e67 6175 7373  `ppxf_util.gauss
-00013930: 6961 6e5f 6669 6c74 6572 3164 6060 3a20  ian_filter1d``: 
-00013940: 4e65 7720 6b65 7977 6f72 6420 6060 6d6f  New keyword ``mo
-00013950: 6465 3d27 636f 6e73 7461 6e74 2760 6020  de='constant'`` 
-00013960: 6f72 0d0a 2020 6060 6d6f 6465 3d27 7772  or..  ``mode='wr
-00013970: 6170 2760 602e 0d0a 2d20 5570 6461 7465  ap'``...- Update
-00013980: 6420 6060 7070 7866 5f65 7861 6d70 6c65  d ``ppxf_example
-00013990: 5f70 6f70 756c 6174 696f 6e5f 7068 6f74  _population_phot
-000139a0: 6f6d 6574 7279 2e70 7960 600d 0a0d 0a56  ometry.py``....V
-000139b0: 382e 302e 323a 204d 432c 204f 7866 6f72  8.0.2: MC, Oxfor
-000139c0: 642c 2032 3820 4d61 7263 6820 3230 3232  d, 28 March 2022
-000139d0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-000139e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000139f0: 2b2b 2b0d 0a0d 0a2d 2060 6070 7078 6660  +++....- ``ppxf`
-00013a00: 603a 2041 6c6c 6f77 2066 6974 7469 6e67  `: Allow fitting
-00013a10: 2070 686f 746f 6d65 7472 6963 206d 6561   photometric mea
-00013a20: 7375 7265 6d65 6e74 7320 2853 4544 2066  surements (SED f
-00013a30: 6974 7469 6e67 2920 746f 6765 7468 6572  itting) together
-00013a40: 2077 6974 680d 0a20 2061 2073 7065 6374   with..  a spect
-00013a50: 7275 6d2e 2054 6869 7320 6973 2069 6d70  rum. This is imp
-00013a60: 6c65 6d65 6e74 6564 2076 6961 2074 6865  lemented via the
-00013a70: 206e 6577 206b 6579 776f 7264 2060 6070   new keyword ``p
-00013a80: 686f 7460 6020 7061 7373 696e 6720 610d  hot`` passing a.
-00013a90: 0a20 2064 6963 7469 6f6e 6172 7920 6f66  .  dictionary of
-00013aa0: 2070 6172 616d 6574 6572 732e 0d0a 2d20   parameters...- 
-00013ab0: 6060 7070 7866 6060 3a20 706c 6f74 2070  ``ppxf``: plot p
-00013ac0: 686f 746f 6d65 7472 6963 2066 6974 2074  hotometric fit t
-00013ad0: 6f67 6574 6865 7220 7769 7468 2073 7065  ogether with spe
-00013ae0: 6374 7275 6d20 7768 656e 2066 6974 7469  ctrum when fitti
-00013af0: 6e67 0d0a 2020 7068 6f74 6f6d 6574 7279  ng..  photometry
-00013b00: 2e0d 0a2d 2060 6070 7078 6660 603a 204e  ...- ``ppxf``: N
-00013b10: 6577 206b 6579 776f 7264 2060 606c 616d  ew keyword ``lam
-00013b20: 5f74 656d 7060 6020 746f 2069 6e70 7574  _temp`` to input
-00013b30: 2074 6865 2074 656d 706c 6174 6573 2077   the templates w
-00013b40: 6176 656c 656e 6774 682e 2057 6865 6e0d  avelength. When.
-00013b50: 0a20 2074 6869 7320 6973 2067 6976 656e  .  this is given
-00013b60: 2c20 746f 6765 7468 6572 2077 6974 6820  , together with 
-00013b70: 7468 6520 6761 6c61 7879 2077 6176 656c  the galaxy wavel
-00013b80: 656e 6774 6820 6060 6c61 6d60 602c 2074  ength ``lam``, t
-00013b90: 6865 2074 656d 706c 6174 6573 2061 7265  he templates are
-00013ba0: 0d0a 2020 6175 746f 6d61 7469 6361 6c6c  ..  automaticall
-00013bb0: 7920 7472 756e 6361 7465 6420 746f 2061  y truncated to a
-00013bc0: 6e20 6f70 7469 6d61 6c20 7761 7665 6c65  n optimal wavele
-00013bd0: 6e67 7468 2072 616e 6765 2c20 616e 6420  ngth range, and 
-00013be0: 6974 2062 6563 6f6d 6573 0d0a 2020 756e  it becomes..  un
-00013bf0: 6e65 6365 7373 6172 7920 746f 2075 7365  necessary to use
-00013c00: 2074 6865 206b 6579 776f 7264 2060 6076   the keyword ``v
-00013c10: 7379 7374 6060 2e0d 0a2d 2060 6070 7078  syst``...- ``ppx
-00013c20: 6660 603a 2057 6172 6e69 6e67 2069 6620  f``: Warning if 
-00013c30: 6060 7465 6d70 6c61 7465 7360 6020 6172  ``templates`` ar
-00013c40: 6520 6060 3e20 3278 6060 206c 6f6e 6765  e ``> 2x`` longe
-00013c50: 7220 7468 616e 2060 6067 616c 6178 7960  r than ``galaxy`
-00013c60: 602e 0d0a 2d20 6060 7070 7866 6060 3a20  `...- ``ppxf``: 
-00013c70: 5768 656e 2066 6974 7469 6e67 2070 686f  When fitting pho
-00013c80: 746f 6d65 7472 7920 6f6e 6520 6361 6e20  tometry one can 
-00013c90: 696e 7075 7420 6578 7465 6e64 6564 2074  input extended t
-00013ca0: 656d 706c 6174 6520 7370 6563 7472 6120  emplate spectra 
-00013cb0: 746f 0d0a 2020 6f76 6572 706c 6f74 2074  to..  overplot t
-00013cc0: 6865 2065 7874 7261 706f 6c61 7465 6420  he extrapolated 
-00013cd0: 6265 7374 2d66 6974 2073 7065 6374 7275  best-fit spectru
-00013ce0: 6d20 746f 6765 7468 6572 2077 6974 6820  m together with 
-00013cf0: 7468 6520 7068 6f74 6f6d 6574 7279 2e0d  the photometry..
-00013d00: 0a2d 204e 6577 2064 656d 6f20 6669 6c65  .- New demo file
-00013d10: 206f 6e20 7068 6f74 6f6d 6574 7269 6320   on photometric 
-00013d20: 6669 7474 696e 670d 0a20 2060 6070 7078  fitting..  ``ppx
-00013d30: 665f 6578 616d 706c 655f 706f 7075 6c61  f_example_popula
-00013d40: 7469 6f6e 5f70 686f 746f 6d65 7472 792e  tion_photometry.
-00013d50: 7079 6060 2e0d 0a2d 2060 606d 696c 6573  py``...- ``miles
-00013d60: 5f75 7469 6c2e 7068 6f74 6f6d 6574 7279  _util.photometry
-00013d70: 5f66 726f 6d5f 7461 626c 6560 603a 204e  _from_table``: N
-00013d80: 6577 2065 7861 6d70 6c65 2066 756e 6374  ew example funct
-00013d90: 696f 6e20 746f 2069 6c6c 7573 7472 6174  ion to illustrat
-00013da0: 6520 7468 650d 0a20 2067 656e 6572 6174  e the..  generat
-00013db0: 696f 6e20 6f66 2074 6865 2069 6e70 7574  ion of the input
-00013dc0: 2070 686f 746f 6d65 7472 6963 2074 656d   photometric tem
-00013dd0: 706c 6174 6573 2066 6f72 2074 6865 2060  plates for the `
-00013de0: 6070 686f 7460 6020 6b65 7977 6f72 642c  `phot`` keyword,
-00013df0: 2075 7369 6e67 0d0a 2020 7461 6275 6c61   using..  tabula
-00013e00: 7465 6420 5353 5020 6d6f 6465 6c20 6d61  ted SSP model ma
-00013e10: 676e 6974 7564 6573 2e0d 0a2d 2060 606d  gnitudes...- ``m
-00013e20: 696c 6573 5f75 7469 6c2e 7068 6f74 6f6d  iles_util.photom
-00013e30: 6574 7279 5f66 726f 6d5f 7370 6563 7472  etry_from_spectr
-00013e40: 6160 603a 204e 6577 2065 7861 6d70 6c65  a``: New example
-00013e50: 2066 756e 6374 696f 6e20 746f 2069 6c6c   function to ill
-00013e60: 7573 7472 6174 650d 0a20 2074 6865 2067  ustrate..  the g
-00013e70: 656e 6572 6174 696f 6e20 6f66 2070 686f  eneration of pho
-00013e80: 746f 6d65 7472 6963 2074 656d 706c 6174  tometric templat
-00013e90: 6573 2066 726f 6d20 7468 6520 7370 6563  es from the spec
-00013ea0: 7472 6120 7573 696e 6720 6669 6c74 6572  tra using filter
-00013eb0: 0d0a 2020 7265 7370 6f6e 7365 732e 0d0a  ..  responses...
-00013ec0: 2d20 5265 706c 6163 6564 204d 494c 4553  - Replaced MILES
-00013ed0: 2073 7065 6374 7261 6c20 6d6f 6465 6c73   spectral models
-00013ee0: 206f 6620 5661 7a64 656b 6973 2065 7420   of Vazdekis et 
-00013ef0: 616c 2e20 2832 3031 3029 2077 6974 6820  al. (2010) with 
-00013f00: 452d 4d49 4c45 5320 6d6f 6465 6c73 0d0a  E-MILES models..
-00013f10: 2020 6f66 2056 617a 6465 6b69 7320 6574    of Vazdekis et
-00013f20: 2061 6c2e 2028 3230 3136 292e 2054 6861   al. (2016). Tha
-00013f30: 6e6b 7320 746f 2041 6c65 7861 6e64 7265  nks to Alexandre
-00013f40: 2056 617a 6465 6b69 7320 2869 6163 2e65   Vazdekis (iac.e
-00013f50: 7329 2066 6f72 2074 6865 0d0a 2020 7065  s) for the..  pe
-00013f60: 726d 6973 7369 6f6e 2e0d 0a2d 2041 6461  rmission...- Ada
-00013f70: 7074 6564 2061 6c6c 2060 6070 5058 4660  pted all ``pPXF`
-00013f80: 6020 6578 616d 706c 6573 2074 6f20 7573  ` examples to us
-00013f90: 6520 7468 6520 452d 4d49 4c45 5320 7465  e the E-MILES te
-00013fa0: 6d70 6c61 7465 732e 0d0a 2d20 6060 6d69  mplates...- ``mi
-00013fb0: 6c65 735f 7574 696c 2e6d 696c 6573 6060  les_util.miles``
-00013fc0: 3a20 6368 616e 6765 6420 6e61 6d65 7320  : changed names 
-00013fd0: 6f66 206f 7574 7075 7420 7761 7665 6c65  of output wavele
-00013fe0: 6e67 7468 2060 602e 6c6e 5f6c 616d 5f74  ngth ``.ln_lam_t
-00013ff0: 656d 7060 6020 746f 0d0a 2020 6d61 6b65  emp`` to..  make
-00014000: 2063 6c65 6172 2074 6865 7920 7265 7072   clear they repr
-00014010: 6573 656e 7420 6e61 7475 7261 6c20 6c6f  esent natural lo
-00014020: 6761 7269 7468 6d73 2e0d 0a2d 2060 606d  garithms...- ``m
-00014030: 696c 6573 5f75 7469 6c2e 6d69 6c65 7360  iles_util.miles`
-00014040: 603a 2073 6574 2060 6046 5748 4d5f 6761  `: set ``FWHM_ga
-00014050: 6c3d 4e6f 6e65 6060 2074 6f20 736b 6970  l=None`` to skip
-00014060: 2074 656d 706c 6174 6573 2063 6f6e 766f   templates convo
-00014070: 6c75 7469 6f6e 2e0d 0a2d 2060 6070 7078  lution...- ``ppx
-00014080: 6660 603a 204f 7074 696f 6e61 6c6c 7920  f``: Optionally 
-00014090: 7065 7266 6f72 6d73 2067 6c6f 6261 6c20  performs global 
-000140a0: 6f70 7469 6d69 7a61 7469 6f6e 206f 6620  optimization of 
-000140b0: 7468 6520 6e6f 6e2d 6c69 6e65 6172 0d0a  the non-linear..
-000140c0: 2020 7061 7261 6d65 7465 7273 2e20 5468    parameters. Th
-000140d0: 6973 2069 7320 696d 706c 656d 656e 7465  is is implemente
-000140e0: 6420 7669 6120 7468 6520 6e65 7720 6b65  d via the new ke
-000140f0: 7977 6f72 6420 6060 676c 6f62 616c 5f73  yword ``global_s
-00014100: 6561 7263 6860 602e 0d0a 2d20 6060 7070  earch``...- ``pp
-00014110: 7866 6060 3a20 416c 6c6f 7720 7468 6520  xf``: Allow the 
-00014120: 7573 6520 6f66 206d 756c 7469 706c 6963  use of multiplic
-00014130: 6174 6976 6520 706f 6c79 6e6f 6d69 616c  ative polynomial
-00014140: 7320 746f 6765 7468 6572 2077 6974 680d  s together with.
-00014150: 0a20 2072 6564 6465 6e69 6e67 2e0d 0a2d  .  reddening...-
-00014160: 2060 6070 7078 6660 603a 2050 6c6f 7420   ``ppxf``: Plot 
-00014170: 696e 6469 7669 6475 616c 2067 6173 2065  individual gas e
-00014180: 6d69 7373 696f 6e20 636f 6d70 6f6e 656e  mission componen
-00014190: 7473 2069 6e20 6164 6469 7469 6f6e 2074  ts in addition t
-000141a0: 6f20 7468 6569 7220 7375 6d2e 0d0a 2d20  o their sum...- 
-000141b0: 6060 7070 7866 6060 3a20 5570 6461 7465  ``ppxf``: Update
-000141c0: 6420 646f 6373 7472 696e 6720 646f 6375  d docstring docu
-000141d0: 6d65 6e74 6174 696f 6e20 666f 7220 7468  mentation for th
-000141e0: 6520 6e65 7720 6665 6174 7572 6573 2e0d  e new features..
-000141f0: 0a2d 2060 6063 6170 6669 7460 603a 2043  .- ``capfit``: C
-00014200: 6f6d 706c 6574 656c 7920 7265 6d6f 7665  ompletely remove
-00014210: 6420 7469 6564 2f66 6978 6564 2076 6172  d tied/fixed var
-00014220: 6961 626c 6573 2066 726f 6d20 7468 6520  iables from the 
-00014230: 6f70 7469 6d69 7a61 7469 6f6e 2061 6e64  optimization and
-00014240: 0d0a 2020 636f 6e73 7472 6169 6e74 732e  ..  constraints.
-00014250: 2054 6869 7320 696d 7072 6f76 6573 2074   This improves t
-00014260: 6865 2063 6f6e 6469 7469 6f6e 696e 6720  he conditioning 
-00014270: 6f66 2074 6865 204a 6163 6f62 6961 6e20  of the Jacobian 
-00014280: 616e 6420 6675 7274 6865 720d 0a20 2073  and further..  s
-00014290: 7472 656e 6774 6865 6e73 2074 6865 2072  trengthens the r
-000142a0: 6f62 7573 746e 6573 7320 6f66 2074 6865  obustness of the
-000142b0: 206f 7074 696d 697a 6174 696f 6e2e 0d0a   optimization...
-000142c0: 2d20 6060 6d69 6c65 735f 7574 696c 6060  - ``miles_util``
-000142d0: 3a20 6669 7865 6420 6060 666c 7578 6060  : fixed ``flux``
-000142e0: 2061 7272 6179 206d 6973 6d61 7463 6820   array mismatch 
-000142f0: 7768 656e 2075 7369 6e67 2060 6061 6765  when using ``age
-00014300: 5f72 616e 6765 6060 206f 720d 0a20 2060  _range`` or..  `
-00014310: 606d 6574 616c 5f72 616e 6765 6060 2e20  `metal_range``. 
-00014320: 5468 616e 6b73 2074 6f20 4461 7669 6465  Thanks to Davide
-00014330: 2042 6576 6163 7175 6120 2869 6e61 662e   Bevacqua (inaf.
-00014340: 6974 2920 666f 7220 7468 6520 7265 706f  it) for the repo
-00014350: 7274 2e0d 0a2d 2060 6070 7078 6660 603a  rt...- ``ppxf``:
-00014360: 2046 6978 6564 2070 726f 6772 616d 2073   Fixed program s
-00014370: 746f 7020 7768 656e 2066 6974 7469 6e67  top when fitting
-00014380: 2067 6173 2077 6974 6820 6120 7465 6d70   gas with a temp
-00014390: 6c61 7465 206c 656e 6774 6820 7468 6174  late length that
-000143a0: 2069 730d 0a20 206e 6f74 2061 206d 756c   is..  not a mul
-000143b0: 7469 706c 6520 6f66 2060 6076 656c 7363  tiple of ``velsc
-000143c0: 616c 655f 7261 7469 6f60 602e 0d0a 0d0a  ale_ratio``.....
-000143d0: 5637 2e34 2e35 3a20 4d43 2c20 4f78 666f  V7.4.5: MC, Oxfo
-000143e0: 7264 2c20 3136 204a 756c 7920 3230 3231  rd, 16 July 2021
-000143f0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-00014400: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00014410: 2b2b 0d0a 0d0a 2d20 6060 7070 7866 6060  ++....- ``ppxf``
-00014420: 3a20 4e65 7720 6b65 7977 6f72 6420 6060  : New keyword ``
-00014430: 7070 2e70 6c6f 7428 636c 6970 5f67 6173  pp.plot(clip_gas
-00014440: 3d54 7275 6529 6060 2074 6f20 6967 6e6f  =True)`` to igno
-00014450: 7265 2074 6865 2067 6173 2065 6d69 7373  re the gas emiss
-00014460: 696f 6e0d 0a20 206c 696e 6573 2077 6869  ion..  lines whi
-00014470: 6c65 2064 6574 6572 6d69 6e69 6e67 2074  le determining t
-00014480: 6865 2070 6c6f 7474 696e 6720 7261 6e67  he plotting rang
-00014490: 6573 2066 6f72 2074 6865 2062 6573 742d  es for the best-
-000144a0: 6669 7474 696e 6720 6d6f 6465 6c2e 0d0a  fitting model...
-000144b0: 2d20 6060 6d69 6c65 735f 7574 696c 6060  - ``miles_util``
-000144c0: 3a20 4e65 7720 6174 7472 6962 7574 6520  : New attribute 
-000144d0: 6060 2e66 6c75 7860 6020 746f 2063 6f6e  ``.flux`` to con
-000144e0: 7665 7274 2062 6574 7765 656e 206c 6967  vert between lig
-000144f0: 6874 2d77 6569 6768 7465 640d 0a20 2061  ht-weighted..  a
-00014500: 6e64 206d 6173 732d 7765 6967 6874 6564  nd mass-weighted
-00014510: 2073 7465 6c6c 6172 2070 6f70 756c 6174   stellar populat
-00014520: 696f 6e20 7175 616e 7469 7469 6573 2e20  ion quantities. 
-00014530: 5570 6461 7465 6420 7468 6520 636f 7272  Updated the corr
-00014540: 6573 706f 6e64 696e 670d 0a20 2064 6f63  esponding..  doc
-00014550: 756d 656e 7461 7469 6f6e 2069 6e20 7468  umentation in th
-00014560: 6520 646f 6373 7472 696e 672e 0d0a 2d20  e docstring...- 
-00014570: 6060 7070 7866 5f65 7861 6d70 6c65 5f70  ``ppxf_example_p
-00014580: 6f70 756c 6174 696f 6e5f 6761 735f 7364  opulation_gas_sd
-00014590: 7373 6060 3a20 5368 6f77 2068 6f77 2074  ss``: Show how t
-000145a0: 6f20 636f 6e76 6572 7420 6265 7477 6565  o convert betwee
-000145b0: 6e20 6c69 6768 742d 7765 6967 6874 6564  n light-weighted
-000145c0: 0d0a 2020 616e 6420 6d61 7373 2d77 6569  ..  and mass-wei
-000145d0: 6768 7465 6420 7374 656c 6c61 7220 706f  ghted stellar po
-000145e0: 7075 6c61 7469 6f6e 2075 7369 6e67 2074  pulation using t
-000145f0: 6865 206e 6577 2060 606d 696c 6573 2e66  he new ``miles.f
-00014600: 6c75 7860 6020 6174 7472 6962 7574 652e  lux`` attribute.
-00014610: 0d0a 2d20 6060 7070 7866 5f75 7469 6c2e  ..- ``ppxf_util.
-00014620: 6c6f 675f 7265 6269 6e60 603a 2073 7570  log_rebin``: sup
-00014630: 706f 7274 2066 6173 7420 6c6f 6720 7265  port fast log re
-00014640: 6269 6e6e 696e 6720 6f66 2061 6c6c 2063  binning of all c
-00014650: 6f6c 756d 6e73 206f 6620 322d 6469 6d20  olumns of 2-dim 
-00014660: 6172 7261 7973 2e0d 0a0d 0a56 372e 342e  arrays.....V7.4.
-00014670: 343a 204d 432c 204f 7866 6f72 642c 2031  4: MC, Oxford, 1
-00014680: 3020 4665 6272 7561 7279 2032 3032 310d  0 February 2021.
-00014690: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-000146a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000146b0: 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6070 7078  +++++....- ``ppx
-000146c0: 6660 603a 204d 6f72 6520 726f 6275 7374  f``: More robust
-000146d0: 206d 6174 7269 7820 7363 616c 696e 6720   matrix scaling 
-000146e0: 7768 656e 2075 7369 6e67 206c 696e 6561  when using linea
-000146f0: 7220 6571 7561 6c69 7479 2063 6f6e 7374  r equality const
-00014700: 7261 696e 7473 0d0a 2020 696e 2060 6063  raints..  in ``c
-00014710: 6f6e 7374 725f 7465 6d70 6c60 6020 7769  onstr_templ`` wi
-00014720: 7468 2060 606c 696e 6561 725f 6d65 7468  th ``linear_meth
-00014730: 6f64 3d27 6c73 715f 626f 7827 6060 2e20  od='lsq_box'``. 
-00014740: 5468 616e 6b73 2074 6f20 5368 7261 7661  Thanks to Shrava
-00014750: 6e20 5368 6574 7479 0d0a 2020 2870 6b75  n Shetty..  (pku
-00014760: 2e65 6475 2e63 6e29 2066 6f72 2061 2064  .edu.cn) for a d
-00014770: 6574 6169 6c65 6420 7265 706f 7274 2061  etailed report a
-00014780: 6e64 2066 6f72 2074 6573 7469 6e67 206d  nd for testing m
-00014790: 7920 6669 782e 0d0a 0d0a 5637 2e34 2e33  y fix.....V7.4.3
-000147a0: 3a20 4d43 2c20 4f78 666f 7264 2c20 3231  : MC, Oxford, 21
-000147b0: 2044 6563 656d 6265 7220 3230 3230 0d0a   December 2020..
-000147c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000147d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000147e0: 2b2b 2b2b 0d0a 0d0a 2d20 6060 6361 7066  ++++....- ``capf
-000147f0: 6974 6060 3a20 4e65 7720 6060 6c69 6e65  it``: New ``line
-00014800: 6172 5f6d 6574 686f 6460 6020 6b65 7977  ar_method`` keyw
-00014810: 6f72 6420 746f 2073 656c 6563 7420 6265  ord to select be
-00014820: 7477 6565 6e20 6060 6376 786f 7074 6060  tween ``cvxopt``
-00014830: 206f 720d 0a20 2060 606c 7371 5f6c 696e   or..  ``lsq_lin
-00014840: 6060 2c20 7768 656e 2075 7369 6e67 206c  ``, when using l
-00014850: 696e 6561 7220 636f 6e73 7472 6169 6e74  inear constraint
-00014860: 732c 2066 6f72 2063 6173 6573 2077 6865  s, for cases whe
-00014870: 7265 2074 6865 206c 6174 7465 7220 7374  re the latter st
-00014880: 6f70 732e 0d0a 2020 5468 6520 6060 6376  ops...  The ``cv
-00014890: 786f 7074 6060 2070 6163 6b61 6765 206d  xopt`` package m
-000148a0: 7573 7420 6265 2069 6e73 7461 6c6c 6564  ust be installed
-000148b0: 2077 6865 6e20 7365 7474 696e 6720 7468   when setting th
-000148c0: 6174 206f 7074 696f 6e2e 0d0a 2d20 6060  at option...- ``
-000148d0: 7070 7866 6060 3a20 4164 6170 7465 6420  ppxf``: Adapted 
-000148e0: 746f 2075 7365 2060 6063 6170 6669 7460  to use ``capfit`
-000148f0: 6020 7769 7468 2060 606c 696e 6561 725f  ` with ``linear_
-00014900: 6d65 7468 6f64 3d27 6376 786f 7074 2760  method='cvxopt'`
-00014910: 6020 7768 656e 0d0a 2020 656e 666f 7263  ` when..  enforc
-00014920: 696e 6720 6c69 6e65 6172 2063 6f6e 7374  ing linear const
-00014930: 7261 696e 7473 206f 6e20 7468 6520 6b69  raints on the ki
-00014940: 6e65 6d61 7469 6373 2077 6974 6820 6060  nematics with ``
-00014950: 636f 6e73 7472 5f6b 696e 656d 6060 2e0d  constr_kinem``..
-00014960: 0a2d 2060 6070 7078 6660 603a 2049 6e63  .- ``ppxf``: Inc
-00014970: 6c75 6465 6420 4e4f 5445 2069 6e20 7468  luded NOTE in th
-00014980: 6520 646f 6375 6d65 6e74 6174 696f 6e20  e documentation 
-00014990: 6f66 2060 6063 6f6e 7374 725f 6b69 6e65  of ``constr_kine
-000149a0: 6d60 602e 0d0a 2020 416c 6c20 6368 616e  m``...  All chan
-000149b0: 6765 7320 6162 6f76 6520 7765 7265 2061  ges above were a
-000149c0: 6674 6572 2064 6574 6169 6c65 6420 7265  fter detailed re
-000149d0: 706f 7274 7320 6279 204b 796c 6520 5765  ports by Kyle We
-000149e0: 7374 6661 6c6c 2028 7563 6f6c 6963 6b2e  stfall (ucolick.
-000149f0: 6f72 6729 2e0d 0a0d 0a56 372e 342e 323a  org).....V7.4.2:
-00014a00: 204d 432c 204f 7866 6f72 642c 2039 204f   MC, Oxford, 9 O
-00014a10: 6374 6f62 6572 2032 3032 300d 0a2b 2b2b  ctober 2020..+++
-00014a20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00014a30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-00014a40: 0a0d 0a2d 2060 6070 7078 6660 603a 2043  ...- ``ppxf``: C
-00014a50: 6f72 7265 6374 6564 2074 7970 6f20 696e  orrected typo in
-00014a60: 2065 7861 6d70 6c65 2069 6e20 7468 6520   example in the 
-00014a70: 646f 6375 6d65 6e74 6174 696f 6e20 6f66  documentation of
-00014a80: 2060 6063 6f6e 7374 725f 7465 6d70 6c60   ``constr_templ`
-00014a90: 602e 0d0a 2d20 6060 7070 7866 6060 3a20  `...- ``ppxf``: 
-00014aa0: 4368 6563 6b20 7468 6174 2060 6063 6f6e  Check that ``con
-00014ab0: 7374 725f 7465 6d70 6c60 6020 616e 6420  str_templ`` and 
-00014ac0: 6060 636f 6e73 7472 5f6b 696e 656d 6060  ``constr_kinem``
-00014ad0: 2061 7265 2064 6963 7469 6f6e 6172 6965   are dictionarie
-00014ae0: 732e 0d0a 2020 5468 616e 6b73 2074 6f20  s...  Thanks to 
-00014af0: 4461 7669 6465 2042 6576 6163 7175 6120  Davide Bevacqua 
-00014b00: 2875 6e69 626f 2e69 7429 2066 6f72 2074  (unibo.it) for t
-00014b10: 6865 2066 6565 6462 6163 6b2e 0d0a 0d0a  he feedback.....
-00014b20: 5637 2e34 2e31 3a20 4d43 2c20 4f78 666f  V7.4.1: MC, Oxfo
-00014b30: 7264 2c20 3131 2053 6570 7465 6d62 6572  rd, 11 September
-00014b40: 2032 3032 300d 0a2b 2b2b 2b2b 2b2b 2b2b   2020..+++++++++
-00014b50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00014b60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-00014b70: 2d20 6060 6361 7066 6974 6060 3a20 4669  - ``capfit``: Fi
-00014b80: 7865 6420 706f 7373 6962 6c65 2069 6e66  xed possible inf
-00014b90: 696e 6974 6520 6c6f 6f70 2069 6e20 6060  inite loop in ``
-00014ba0: 6c73 715f 626f 7860 6020 616e 6420 6060  lsq_box`` and ``
-00014bb0: 6c73 715f 6c69 6e60 602e 0d0a 2020 5468  lsq_lin``...  Th
-00014bc0: 616e 6b73 2074 6f20 5368 7261 7661 6e20  anks to Shravan 
-00014bd0: 5368 6574 7479 2028 706b 752e 6564 752e  Shetty (pku.edu.
-00014be0: 636e 2920 666f 7220 7468 6520 6465 7461  cn) for the deta
-00014bf0: 696c 6564 2072 6570 6f72 7420 616e 6420  iled report and 
-00014c00: 746f 2062 6f74 680d 0a20 2068 696d 2061  to both..  him a
-00014c10: 6e64 204b 796c 6520 5765 7374 6661 6c6c  nd Kyle Westfall
-00014c20: 2028 7563 6f6c 6963 6b2e 6f72 6729 2066   (ucolick.org) f
-00014c30: 6f72 2074 6573 7469 6e67 2074 6865 2066  or testing the f
-00014c40: 6978 2e0d 0a2d 2060 6063 6170 6669 7460  ix...- ``capfit`
-00014c50: 603a 2055 7365 204e 756d 5079 2072 6174  `: Use NumPy rat
-00014c60: 6865 7220 7468 616e 2074 6865 2053 6369  her than the Sci
-00014c70: 5079 2076 6572 7369 6f6e 206f 6620 6060  Py version of ``
-00014c80: 6c69 6e61 6c67 2e6c 7374 7371 6060 2074  linalg.lstsq`` t
-00014c90: 6f0d 0a20 2061 766f 6964 2061 2063 7572  o..  avoid a cur
-00014ca0: 7265 6e74 2053 6369 5079 2062 7567 2069  rent SciPy bug i
-00014cb0: 6e20 7468 6520 6465 6661 756c 7420 6372  n the default cr
-00014cc0: 6974 6572 696f 6e20 666f 7220 7261 6e6b  iterion for rank
-00014cd0: 2064 6566 6963 6965 6e63 792e 0d0a 2d20   deficiency...- 
-00014ce0: 6060 6361 7066 6974 6060 3a20 5265 6e61  ``capfit``: Rena
-00014cf0: 6d65 6420 6060 636f 6e64 6060 206b 6579  med ``cond`` key
-00014d00: 776f 7264 2074 6f20 6060 7263 6f6e 6460  word to ``rcond`
-00014d10: 6020 666f 7220 636f 6e73 6973 7465 6e63  ` for consistenc
-00014d20: 7920 7769 7468 204e 756d 5079 2e0d 0a2d  y with NumPy...-
-00014d30: 2060 6063 6170 6669 7460 603a 2050 6173   ``capfit``: Pas
-00014d40: 7365 6420 6060 7263 6f6e 6460 6020 6b65  sed ``rcond`` ke
-00014d50: 7977 6f72 6420 746f 2060 6063 6f76 5f65  yword to ``cov_e
-00014d60: 7272 6060 2066 756e 6374 696f 6e2e 0d0a  rr`` function...
-00014d70: 2d20 6060 7070 7866 6060 3a20 7265 6d6f  - ``ppxf``: remo
-00014d80: 7665 6420 6060 7263 6f6e 6460 6020 6b65  ved ``rcond`` ke
-00014d90: 7977 6f72 6420 696e 2060 6063 6170 6669  yword in ``capfi
-00014da0: 7460 6020 6361 6c6c 2e20 5573 6520 6465  t`` call. Use de
-00014db0: 6661 756c 7420 696e 7374 6561 642e 0d0a  fault instead...
-00014dc0: 0d0a 5637 2e34 2e30 3a20 4d43 2c20 4f78  ..V7.4.0: MC, Ox
-00014dd0: 666f 7264 2c20 3230 2041 7567 7573 7420  ford, 20 August 
-00014de0: 3230 3230 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2020..++++++++++
-00014df0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00014e00: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060  ++++++++....- ``
-00014e10: 6361 7066 6974 6060 3a20 4e65 7720 6675  capfit``: New fu
-00014e20: 6e63 7469 6f6e 2060 606c 7371 5f6c 696e  nction ``lsq_lin
-00014e30: 6060 2069 6d70 6c65 6d65 6e74 696e 6720  `` implementing 
-00014e40: 6120 6c69 6e65 6172 206c 6561 7374 2d73  a linear least-s
-00014e50: 7175 6172 6573 0d0a 2020 6c69 6e65 6172  quares..  linear
-00014e60: 6c79 2063 6f6e 7374 7261 696e 6564 2061  ly constrained a
-00014e70: 6c67 6f72 6974 686d 2073 7570 706f 7274  lgorithm support
-00014e80: 696e 6720 7261 6e6b 2d64 6566 6963 6965  ing rank-deficie
-00014e90: 6e74 206d 6174 7269 6365 7320 616e 6420  nt matrices and 
-00014ea0: 616c 6c6f 7769 6e67 0d0a 2020 666f 7220  allowing..  for 
-00014eb0: 6120 7374 6172 7469 6e67 2067 7565 7373  a starting guess
-00014ec0: 2e0d 0a2d 2060 6063 6170 6669 7460 603a  ...- ``capfit``:
-00014ed0: 2052 656d 6f76 6564 2074 6865 2060 606c   Removed the ``l
-00014ee0: 7371 6c69 6e60 6020 7072 6f63 6564 7572  sqlin`` procedur
-00014ef0: 6520 7768 6963 6820 6973 2073 7570 6572  e which is super
-00014f00: 7365 6465 6420 6279 2060 606c 7371 5f6c  seded by ``lsq_l
-00014f10: 696e 6060 2e0d 0a2d 2060 6063 6170 6669  in``...- ``capfi
-00014f20: 7460 603a 2052 656e 616d 6564 2060 606c  t``: Renamed ``l
-00014f30: 7371 626f 7860 6020 746f 2060 606c 7371  sqbox`` to ``lsq
-00014f40: 5f62 6f78 6060 2061 6e64 2072 6576 6973  _box`` and revis
-00014f50: 6564 2069 7473 2069 6e74 6572 6661 6365  ed its interface
-00014f60: 2e0d 0a2d 2060 6070 7078 6660 603a 204d  ...- ``ppxf``: M
-00014f70: 6f64 6966 6965 6420 746f 2075 7365 2074  odified to use t
-00014f80: 6865 206e 6577 2060 606c 7371 5f6c 696e  he new ``lsq_lin
-00014f90: 6060 2061 6e64 2074 6865 2075 7064 6174  `` and the updat
-00014fa0: 6564 2060 606c 7371 5f62 6f78 6060 2066  ed ``lsq_box`` f
-00014fb0: 756e 6374 696f 6e73 2e0d 0a2d 2060 6070  unctions...- ``p
-00014fc0: 7078 6660 603a 204d 6f72 6520 6578 616d  pxf``: More exam
-00014fd0: 706c 6573 2066 6f72 2074 6865 2060 6063  ples for the ``c
-00014fe0: 6f6e 7374 725f 7465 6d70 6c60 6020 616e  onstr_templ`` an
-00014ff0: 6420 6060 636f 6e73 7472 5f6b 696e 656d  d ``constr_kinem
-00015000: 6060 206b 6579 776f 7264 732e 0d0a 2d20  `` keywords...- 
-00015010: 5365 7420 7265 6473 6869 6674 2060 607a  Set redshift ``z
-00015020: 203d 2030 6060 2077 6865 6e20 6f6e 6520   = 0`` when one 
-00015030: 756e 636f 6d6d 656e 7473 2074 6865 206c  uncomments the l
-00015040: 696e 6573 2074 6f20 6272 696e 6720 7468  ines to bring th
-00015050: 6520 7370 6563 7472 756d 2074 6f0d 0a20  e spectrum to.. 
-00015060: 2074 6865 2072 6573 742d 6672 616d 6520   the rest-frame 
-00015070: 696e 2060 6070 7078 665f 6578 616d 706c  in ``ppxf_exampl
-00015080: 655f 6b69 6e65 6d61 7469 6373 5f73 6473  e_kinematics_sds
-00015090: 732e 7079 6060 2e20 5468 616e 6b73 2074  s.py``. Thanks t
-000150a0: 6f0d 0a20 2056 6169 6465 6869 2053 2e20  o..  Vaidehi S. 
-000150b0: 5061 6c69 7961 2028 6465 7379 2e64 6529  Paliya (desy.de)
-000150c0: 2066 6f72 2070 6f69 6e74 696e 6720 6f75   for pointing ou
-000150d0: 7420 7468 6520 696e 636f 6e73 6973 7465  t the inconsiste
-000150e0: 6e63 7920 696e 206d 7920 6578 616d 706c  ncy in my exampl
-000150f0: 652e 0d0a 0d0a 5637 2e33 2e30 3a20 4d43  e.....V7.3.0: MC
-00015100: 2c20 4f78 666f 7264 2c20 3130 204a 756c  , Oxford, 10 Jul
-00015110: 7920 3230 3230 0d0a 2b2b 2b2b 2b2b 2b2b  y 2020..++++++++
-00015120: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00015130: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060  ++++++++....- ``
-00015140: 6361 7066 6974 6060 3a20 4e65 7720 6675  capfit``: New fu
-00015150: 6e63 7469 6f6e 2060 606c 7371 626f 7860  nction ``lsqbox`
-00015160: 6020 696d 706c 656d 656e 7469 6e67 2061  ` implementing a
-00015170: 2066 6173 7420 6c69 6e65 6172 206c 6561   fast linear lea
-00015180: 7374 2d73 7175 6172 6573 0d0a 2020 626f  st-squares..  bo
-00015190: 782d 636f 6e73 7472 6169 6e65 6420 2862  x-constrained (b
-000151a0: 6f75 6e64 7329 2061 6c67 6f72 6974 686d  ounds) algorithm
-000151b0: 2077 6869 6368 2061 6c6c 6f77 7320 666f   which allows fo
-000151c0: 7220 6120 7374 6172 7469 6e67 2067 7565  r a starting gue
-000151d0: 7373 2e0d 0a20 2057 6869 6c65 2074 6573  ss...  While tes
-000151e0: 7469 6e67 2049 2061 6c73 6f20 6469 7363  ting I also disc
-000151f0: 6f76 6572 6564 2061 206d 616a 6f72 206d  overed a major m
-00015200: 6973 7461 6b65 2069 6e20 7468 6520 6375  istake in the cu
-00015210: 7272 656e 7420 696d 706c 656d 656e 7461  rrent implementa
-00015220: 7469 6f6e 0d0a 2020 6f66 2060 6073 6369  tion..  of ``sci
-00015230: 7079 2e6f 7074 696d 697a 652e 6c73 715f  py.optimize.lsq_
-00015240: 6c69 6e65 6172 6060 2028 6d79 2066 6978  linear`` (my fix
-00015250: 2077 6173 206c 6174 6572 2069 6e63 6c75   was later inclu
-00015260: 6465 6420 696e 2053 6369 7079 2031 2e36  ded in Scipy 1.6
-00015270: 292e 0d0a 2d20 6060 7070 7866 6060 3a20  )...- ``ppxf``: 
-00015280: 5468 6520 6e65 7720 6060 6c69 6e65 6172  The new ``linear
-00015290: 5f6d 6574 686f 643d 276c 7371 626f 7827  _method='lsqbox'
-000152a0: 6060 2061 6e64 2060 606c 696e 6561 725f  `` and ``linear_
-000152b0: 6d65 7468 6f64 3d27 6376 786f 7074 2760  method='cvxopt'`
-000152c0: 600d 0a20 206e 6f77 2075 7365 2061 6e20  `..  now use an 
-000152d0: 696e 6974 6961 6c20 6775 6573 7320 666f  initial guess fo
-000152e0: 7220 7468 6520 736f 6c75 7469 6f6e 2c20  r the solution, 
-000152f0: 7768 6963 6820 7369 676e 6966 6963 616e  which significan
-00015300: 746c 7920 7370 6565 6473 2075 7020 7468  tly speeds up th
-00015310: 650d 0a20 206b 696e 656d 6174 6963 2066  e..  kinematic f
-00015320: 6974 2077 6974 6820 6d75 6c74 6970 6c65  it with multiple
-00015330: 2074 656d 706c 6174 6573 2e20 4173 2061   templates. As a
-00015340: 6e20 6578 616d 706c 652c 206d 7920 7072  n example, my pr
-00015350: 6f63 6564 7572 650d 0a20 2060 6070 7078  ocedure..  ``ppx
-00015360: 665f 6578 616d 706c 655f 706f 7075 6c61  f_example_popula
-00015370: 7469 6f6e 5f67 6173 5f73 6473 7360 6020  tion_gas_sdss`` 
-00015380: 6973 206e 6f77 2061 626f 7574 2034 2074  is now about 4 t
-00015390: 696d 6573 2066 6173 7465 7220 7769 7468  imes faster with
-000153a0: 2074 6865 206e 6577 0d0a 2020 6060 6c69   the new..  ``li
-000153b0: 6e65 6172 5f6d 6574 686f 643d 276c 7371  near_method='lsq
-000153c0: 626f 7827 6060 2074 6861 6e20 7769 7468  box'`` than with
-000153d0: 2074 6865 206c 6567 6163 7920 6060 6c69   the legacy ``li
-000153e0: 6e65 6172 5f6d 6574 686f 643d 276e 6e6c  near_method='nnl
-000153f0: 7327 6060 2e0d 0a2d 2060 6070 7078 6660  s'``...- ``ppxf`
-00015400: 603a 2041 6464 6564 2073 7570 706f 7274  `: Added support
-00015410: 2066 6f72 206c 696e 6561 7220 6571 7561   for linear equa
-00015420: 6c69 7479 2063 6f6e 7374 7261 696e 7473  lity constraints
-00015430: 206f 6e20 7468 6520 7465 6d70 6c61 7465   on the template
-00015440: 730d 0a20 2060 6063 6f6e 7374 725f 7465  s..  ``constr_te
-00015450: 6d70 6c60 6020 616e 6420 666f 7220 7573  mpl`` and for us
-00015460: 696e 6720 7468 6520 6b65 7977 6f72 6420  ing the keyword 
-00015470: 6060 6672 6163 7469 6f6e 6060 2077 6974  ``fraction`` wit
-00015480: 6820 626f 7468 0d0a 2020 6060 6c69 6e65  h both..  ``line
-00015490: 6172 5f6d 6574 686f 643d 276c 7371 626f  ar_method='lsqbo
-000154a0: 7827 6060 2061 6e64 2060 606c 696e 6561  x'`` and ``linea
-000154b0: 725f 6d65 7468 6f64 3d27 6e6e 6c73 2760  r_method='nnls'`
-000154c0: 602e 0d0a 2d20 5072 696e 7420 6060 6465  `...- Print ``de
-000154d0: 6772 6565 6060 2061 6e64 2060 606d 6465  gree`` and ``mde
-000154e0: 6772 6565 6060 2077 6974 6820 7468 6520  gree`` with the 
-000154f0: 6669 6e61 6c20 7265 7375 6c74 732e 0d0a  final results...
-00015500: 2d20 5365 7420 6060 6c69 6e65 6172 3d54  - Set ``linear=T
-00015510: 7275 6560 6020 6175 746f 6d61 7469 6361  rue`` automatica
-00015520: 6c6c 7920 6966 2074 6865 2066 6974 2068  lly if the fit h
-00015530: 6173 206e 6f20 6672 6565 206e 6f6e 2d6c  as no free non-l
-00015540: 696e 6561 7220 7061 7261 6d65 7465 7273  inear parameters
-00015550: 2c0d 0a20 2074 6f20 6176 6f69 6420 6120  ,..  to avoid a 
-00015560: 7072 6f67 7261 6d20 7374 6f70 2e20 5468  program stop. Th
-00015570: 616e 6b73 2074 6f20 5368 7261 7661 6e20  anks to Shravan 
-00015580: 5368 6574 7479 2028 706b 752e 6564 752e  Shetty (pku.edu.
-00015590: 636e 2920 666f 7220 7468 6520 7265 706f  cn) for the repo
-000155a0: 7274 2e0d 0a0d 0a56 372e 322e 313a 204d  rt.....V7.2.1: M
-000155b0: 432c 204f 7866 6f72 642c 2031 3220 4a75  C, Oxford, 12 Ju
-000155c0: 6e65 2032 3032 300d 0a2b 2b2b 2b2b 2b2b  ne 2020..+++++++
-000155d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000155e0: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2060  +++++++++....- `
-000155f0: 6063 6170 6669 7460 603a 204e 6577 2069  `capfit``: New i
-00015600: 6e70 7574 206b 6579 776f 7264 2060 6063  nput keyword ``c
-00015610: 6f6e 6460 6020 666f 7220 4a61 636f 6269  ond`` for Jacobi
-00015620: 616e 2072 616e 6b20 746f 6c65 7261 6e63  an rank toleranc
-00015630: 652e 0d0a 2d20 6060 6361 7066 6974 6060  e...- ``capfit``
-00015640: 3a20 5573 6520 6060 6276 6c73 6060 2074  : Use ``bvls`` t
-00015650: 6f20 736f 6c76 6520 7175 6164 7261 7469  o solve quadrati
-00015660: 6320 7375 6270 726f 626c 656d 2077 6974  c subproblem wit
-00015670: 6820 6f6e 6c79 2060 6062 6f75 6e64 7360  h only ``bounds`
-00015680: 602e 0d0a 2d20 6060 7070 7866 6060 3a20  `...- ``ppxf``: 
-00015690: 5365 7420 6060 636f 6e64 3d31 652d 3760  Set ``cond=1e-7`
-000156a0: 6020 696e 2060 6063 6170 6669 7460 6020  ` in ``capfit`` 
-000156b0: 6361 6c6c 2c20 7768 656e 2075 7369 6e67  call, when using
-000156c0: 206c 696e 6561 7220 636f 6e73 7472 6169   linear constrai
-000156d0: 6e74 732e 0d0a 2020 5468 6520 6060 6361  nts...  The ``ca
-000156e0: 7066 6974 6060 2072 656c 6174 6564 2063  pfit`` related c
-000156f0: 6861 6e67 6573 2077 6572 6520 6475 6520  hanges were due 
-00015700: 746f 2064 6574 6169 6c65 6420 6665 6564  to detailed feed
-00015710: 6261 636b 2062 7920 4b79 6c65 2057 6573  back by Kyle Wes
-00015720: 7466 616c 6c0d 0a20 2028 7563 6f6c 6963  tfall..  (ucolic
-00015730: 6b2e 6f72 6729 2c20 746f 2064 6561 6c20  k.org), to deal 
-00015740: 7769 7468 2073 6974 7561 7469 6f6e 7320  with situations 
-00015750: 7769 7468 2064 6567 656e 6572 6174 6520  with degenerate 
-00015760: 4a61 636f 6269 616e 732c 206c 696b 6520  Jacobians, like 
-00015770: 7768 656e 0d0a 2020 7468 6572 6520 6973  when..  there is
-00015780: 206e 6f20 7374 656c 6c61 7220 636f 6e74   no stellar cont
-00015790: 696e 7575 6d20 616e 6420 6f6e 6520 7573  inuum and one us
-000157a0: 6573 206d 756c 7469 706c 6963 6174 6976  es multiplicativ
-000157b0: 6520 706f 6c79 6e6f 6d69 616c 732e 0d0a  e polynomials...
-000157c0: 2d20 6060 7070 7866 6060 3a20 436c 6172  - ``ppxf``: Clar
-000157d0: 6966 6965 6420 646f 6375 6d65 6e74 6174  ified documentat
-000157e0: 696f 6e20 666f 7220 6060 2e67 6173 5f7a  ion for ``.gas_z
-000157f0: 6572 6f5f 7465 6d70 6c61 7465 6060 2061  ero_template`` a
-00015800: 6e64 2074 6865 0d0a 2020 636f 7272 6573  nd the..  corres
-00015810: 706f 6e64 696e 6720 7761 726e 696e 6720  ponding warning 
-00015820: 6d65 7373 6167 652c 2061 6674 6572 2066  message, after f
-00015830: 6565 6462 6163 6b20 6279 204c 6175 7261  eedback by Laura
-00015840: 2053 616c 6f20 2875 6d6e 2e65 6475 292e   Salo (umn.edu).
-00015850: 0d0a 0d0a 5637 2e32 2e30 3a20 4d43 2c20  ....V7.2.0: MC, 
-00015860: 4f78 666f 7264 2c20 3420 4d61 7920 3230  Oxford, 4 May 20
-00015870: 3230 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  20..++++++++++++
-00015880: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00015890: 2b2b 0d0a 0d0a 2d20 416c 6c6f 7720 666f  ++....- Allow fo
-000158a0: 7220 6060 6c69 6e65 6172 5f6d 6574 686f  r ``linear_metho
-000158b0: 643d 2763 7678 6f70 7427 6060 2077 6865  d='cvxopt'`` whe
-000158c0: 6e20 7468 6520 6f70 7469 6f6e 616c 2060  n the optional `
-000158d0: 6063 7678 6f70 7460 6020 7061 636b 6167  `cvxopt`` packag
-000158e0: 650d 0a20 2069 7320 696e 7374 616c 6c65  e..  is installe
-000158f0: 642e 0d0a 0d0a 5637 2e31 2e30 3a20 4d43  d.....V7.1.0: MC
-00015900: 2c20 4f78 666f 7264 2c20 3330 2041 7072  , Oxford, 30 Apr
-00015910: 696c 2032 3032 300d 0a2b 2b2b 2b2b 2b2b  il 2020..+++++++
-00015920: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00015930: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-00015940: 496e 7472 6f64 7563 6564 206e 6577 2060  Introduced new `
-00015950: 6070 7078 6660 6020 6b65 7977 6f72 6420  `ppxf`` keyword 
-00015960: 6060 6c69 6e65 6172 5f6d 6574 686f 6460  ``linear_method`
-00015970: 602c 2061 6e64 2063 6f72 7265 7370 6f6e  `, and correspon
-00015980: 6469 6e67 2063 6861 6e67 6573 0d0a 2020  ding changes..  
-00015990: 696e 2074 6865 2063 6f64 652c 2074 6f20  in the code, to 
-000159a0: 7365 6c65 6374 2062 6574 7765 656e 2074  select between t
-000159b0: 6865 206f 6c64 2028 276e 6e6c 7327 2920  he old ('nnls') 
-000159c0: 616e 6420 7468 6520 6e65 7720 2827 6c73  and the new ('ls
-000159d0: 716c 696e 2729 0d0a 2020 6170 7072 6f61  qlin')..  approa
-000159e0: 6368 2074 6f20 7468 6520 736f 6c75 7469  ch to the soluti
-000159f0: 6f6e 206f 6620 7468 6520 6c69 6e65 6172  on of the linear
-00015a00: 206c 6561 7374 2d73 7175 6172 6573 2073   least-squares s
-00015a10: 7562 7072 6f62 6c65 6d20 696e 2060 6070  ubproblem in ``p
-00015a20: 7078 6660 602e 0d0a 2020 5468 616e 6b73  pxf``...  Thanks
-00015a30: 2074 6f20 5361 6d20 5661 7567 6861 6e20   to Sam Vaughan 
-00015a40: 2873 7964 6e65 792e 6564 752e 6175 2920  (sydney.edu.au) 
-00015a50: 666f 7220 6120 636f 6e76 696e 6369 6e67  for a convincing
-00015a60: 206d 696e 696d 616c 2065 7861 6d70 6c65   minimal example
-00015a70: 0d0a 2020 696c 6c75 7374 7261 7469 6e67  ..  illustrating
-00015a80: 2074 6865 2075 7365 6675 6c6e 6573 7320   the usefulness 
-00015a90: 6f66 2074 6869 7320 6b65 7977 6f72 642e  of this keyword.
-00015aa0: 0d0a 0d0a 5637 2e30 2e31 3a20 4d43 2c20  ....V7.0.1: MC, 
-00015ab0: 4f78 666f 7264 2c20 3820 4170 7269 6c20  Oxford, 8 April 
-00015ac0: 3230 3230 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2020..++++++++++
-00015ad0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00015ae0: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5375 7070  ++++++....- Supp
-00015af0: 6f72 7420 6060 2e67 6173 5f7a 6572 6f5f  ort ``.gas_zero_
-00015b00: 7465 6d70 6c61 7465 6060 2061 6e64 2060  template`` and `
-00015b10: 6066 7261 6374 696f 6e60 6020 746f 6765  `fraction`` toge
-00015b20: 7468 6572 2077 6974 6820 6f74 6865 720d  ther with other.
-00015b30: 0a20 2065 7175 616c 6974 7920 636f 6e73  .  equality cons
-00015b40: 7472 6169 6e74 732e 0d0a 2d20 496e 636c  traints...- Incl
-00015b50: 7564 6564 2060 606e 702e 7061 6428 2e2e  uded ``np.pad(..
-00015b60: 2e6d 6f64 653d 2763 6f6e 7374 616e 7427  .mode='constant'
-00015b70: 2960 6020 666f 7220 6261 636b 7761 7264  )`` for backward
-00015b80: 2063 6f6d 7061 7469 6269 6c69 7479 2077   compatibility w
-00015b90: 6974 680d 0a20 204e 756d 7079 2031 2e31  ith..  Numpy 1.1
-00015ba0: 362e 2054 6861 6e6b 7320 746f 2053 6872  6. Thanks to Shr
-00015bb0: 6176 616e 2053 6865 7474 7920 284b 4941  avan Shetty (KIA
-00015bc0: 412d 504b 5529 2066 6f72 2074 6865 2073  A-PKU) for the s
-00015bd0: 7567 6765 7374 696f 6e2e 0d0a 2d20 4669  uggestion...- Fi
-00015be0: 7820 6060 7265 6269 6e28 2960 6020 6e6f  x ``rebin()`` no
-00015bf0: 7420 7265 7461 696e 696e 6720 7468 6520  t retaining the 
-00015c00: 6469 6d65 6e73 696f 6e61 6c69 7479 206f  dimensionality o
-00015c10: 6620 616e 2069 6e70 7574 2063 6f6c 756d  f an input colum
-00015c20: 6e2d 7665 6374 6f72 2e0d 0a20 2054 6869  n-vector...  Thi
-00015c30: 7320 7265 7375 6c74 6564 2069 6e20 6120  s resulted in a 
-00015c40: 7072 6f67 7261 6d20 7374 6f70 2077 6974  program stop wit
-00015c50: 6820 6120 7369 6e67 6c65 2067 6173 2074  h a single gas t
-00015c60: 656d 706c 6174 6520 616e 640d 0a20 2060  emplate and..  `
-00015c70: 6076 656c 7363 616c 655f 7261 7469 6f20  `velscale_ratio 
-00015c80: 3e20 3160 602e 2054 6861 6e6b 7320 746f  > 1``. Thanks to
-00015c90: 205a 6869 7975 616e 204a 6920 2861 7374   Zhiyuan Ji (ast
-00015ca0: 726f 2e75 6d61 7373 2e65 6475 2920 666f  ro.umass.edu) fo
-00015cb0: 7220 6120 636c 6561 720d 0a20 2065 7861  r a clear..  exa
-00015cc0: 6d70 6c65 2072 6570 726f 6475 6369 6e67  mple reproducing
-00015cd0: 2074 6865 2062 7567 2e0d 0a2d 2060 6063   the bug...- ``c
-00015ce0: 6170 6669 7460 603a 204e 6577 206b 6579  apfit``: New key
-00015cf0: 776f 7264 2060 6063 6f6e 6460 6020 666f  word ``cond`` fo
-00015d00: 7220 6060 6c73 716c 696e 6060 2e0d 0a2d  r ``lsqlin``...-
-00015d10: 2060 6063 6170 6669 7460 603a 2052 656c   ``capfit``: Rel
-00015d20: 6178 6564 2061 7373 6572 7469 6f6e 2066  axed assertion f
-00015d30: 6f72 2069 6e63 6f6e 7369 7374 656e 7420  or inconsistent 
-00015d40: 696e 6571 7561 6c69 7469 6573 2069 6e20  inequalities in 
-00015d50: 6060 6c73 716c 696e 6060 0d0a 2020 746f  ``lsqlin``..  to
-00015d60: 2061 766f 6964 2066 616c 7365 2070 6f73   avoid false pos
-00015d70: 6974 6976 6573 2e20 5468 616e 6b73 2074  itives. Thanks t
-00015d80: 6f20 4b79 6c65 2057 6573 7466 616c 6c20  o Kyle Westfall 
-00015d90: 2855 434f 204c 6963 6b29 2066 6f72 2061  (UCO Lick) for a
-00015da0: 2064 6574 6169 6c65 640d 0a20 2062 7567   detailed..  bug
-00015db0: 2072 6570 6f72 742e 0d0a 0d0a 5637 2e30   report.....V7.0
-00015dc0: 2e30 3a20 4d43 2c20 4f78 666f 7264 2c20  .0: MC, Oxford, 
-00015dd0: 3130 204a 616e 7561 7279 2032 3032 300d  10 January 2020.
-00015de0: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-00015df0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00015e00: 2b2b 2b2b 0d0a 0d0a 2d20 6060 6361 7066  ++++....- ``capf
-00015e10: 6974 6060 3a20 4e65 7720 6765 6e65 7261  it``: New genera
-00015e20: 6c20 6c69 6e65 6172 206c 6561 7374 2d73  l linear least-s
-00015e30: 7175 6172 6573 206f 7074 696d 697a 6174  quares optimizat
-00015e40: 696f 6e20 6675 6e63 7469 6f6e 0d0a 2020  ion function..  
-00015e50: 6060 6c73 716c 696e 6060 2077 6869 6368  ``lsqlin`` which
-00015e60: 2069 7320 6e6f 7720 7573 6564 2074 6f20   is now used to 
-00015e70: 736f 6c76 6520 7468 6520 7175 6164 7261  solve the quadra
-00015e80: 7469 6320 7375 6270 726f 626c 656d 2e0d  tic subproblem..
-00015e90: 0a2d 2060 6063 6170 6669 7460 603a 2041  .- ``capfit``: A
-00015ea0: 6c6c 6f77 2066 6f72 206c 696e 6561 7220  llow for linear 
-00015eb0: 696e 6571 7561 6c69 7479 2f65 7175 616c  inequality/equal
-00015ec0: 6974 7920 636f 6e73 7472 6169 6e74 730d  ity constraints.
-00015ed0: 0a20 2060 6041 5f69 6e65 7160 602c 2060  .  ``A_ineq``, `
-00015ee0: 6062 5f69 6e65 7160 6020 616e 6420 2060  `b_ineq`` and  `
-00015ef0: 6041 5f65 7160 602c 2060 6062 5f65 7160  `A_eq``, ``b_eq`
-00015f00: 602e 0d0a 2d20 6060 7070 7866 6060 3a20  `...- ``ppxf``: 
-00015f10: 5573 6520 2866 6173 7465 7229 2060 6063  Use (faster) ``c
-00015f20: 6170 6669 742e 6c73 716c 696e 6060 2066  apfit.lsqlin`` f
-00015f30: 6f72 2074 6865 206c 696e 6561 7220 6669  or the linear fi
-00015f40: 742e 0d0a 2d20 6060 7070 7866 6060 3a20  t...- ``ppxf``: 
-00015f50: 5573 6520 7570 6461 7465 6420 6060 6361  Use updated ``ca
-00015f60: 7066 6974 2e63 6170 6669 7460 6020 666f  pfit.capfit`` fo
-00015f70: 7220 7468 6520 6e6f 6e2d 6c69 6e65 6172  r the non-linear
-00015f80: 206f 7074 696d 697a 6174 696f 6e2e 0d0a   optimization...
-00015f90: 2d20 6060 7070 7866 6060 3a20 416c 6c6f  - ``ppxf``: Allo
-00015fa0: 7720 666f 7220 6c69 6e65 6172 2065 7175  w for linear equ
-00015fb0: 616c 6974 6965 732f 696e 6571 7561 6c69  alities/inequali
-00015fc0: 7469 6573 2066 6f72 2062 6f74 6820 7468  ties for both th
-00015fd0: 6520 7465 6d70 6c61 7465 0d0a 2020 7765  e template..  we
-00015fe0: 6967 6874 7320 616e 6420 7468 6520 6b69  ights and the ki
-00015ff0: 6e65 6d61 7469 6320 7061 7261 6d65 7465  nematic paramete
-00016000: 7273 2077 6974 6820 7468 6520 6060 636f  rs with the ``co
-00016010: 6e73 7472 5f74 656d 706c 6060 2061 6e64  nstr_templ`` and
-00016020: 0d0a 2020 6060 636f 6e73 7472 5f6b 696e  ..  ``constr_kin
-00016030: 656d 6060 206f 7074 696f 6e61 6c20 6b65  em`` optional ke
-00016040: 7977 6f72 6473 2e0d 0a2d 2060 6070 7078  ywords...- ``ppx
-00016050: 6660 603a 204e 6577 2060 6073 6574 5f6c  f``: New ``set_l
-00016060: 696e 6561 725f 636f 6e73 7472 6169 6e74  inear_constraint
-00016070: 7360 6020 6675 6e63 7469 6f6e 2e0d 0a2d  s`` function...-
-00016080: 2060 6070 7078 6660 603a 2055 7064 6174   ``ppxf``: Updat
-00016090: 6564 2064 6f63 756d 656e 7461 7469 6f6e  ed documentation
-000160a0: 2e0d 0a0d 0a56 362e 372e 3137 3a20 4d43  .....V6.7.17: MC
-000160b0: 2c20 4f78 666f 7264 2c20 3134 204e 6f76  , Oxford, 14 Nov
-000160c0: 656d 6265 7220 3230 3139 0d0a 2b2b 2b2b  ember 2019..++++
-000160d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000160e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000160f0: 2b0d 0a0d 0a2d 2060 6063 6170 6669 7460  +....- ``capfit`
-00016100: 603a 2057 7269 7474 656e 2063 6f6d 706c  `: Written compl
-00016110: 6574 6520 646f 6375 6d65 6e74 6174 696f  ete documentatio
-00016120: 6e2e 0d0a 2d20 6060 6361 7066 6974 6060  n...- ``capfit``
-00016130: 3a20 496d 7072 6f76 6564 2070 7269 6e74  : Improved print
-00016140: 2066 6f72 6d61 7474 696e 672e 0d0a 2d20   formatting...- 
-00016150: 6060 6361 7066 6974 6060 3a20 5265 7475  ``capfit``: Retu
-00016160: 726e 2060 602e 6d65 7373 6167 6560 6020  rn ``.message`` 
-00016170: 6174 7472 6962 7574 652e 0d0a 2d20 6060  attribute...- ``
-00016180: 6361 7066 6974 6060 3a20 496d 7072 6f76  capfit``: Improv
-00016190: 6564 2060 6078 746f 6c60 6020 636f 6e76  ed ``xtol`` conv
-000161a0: 6572 6765 6e63 6520 7465 7374 2e0d 0a2d  ergence test...-
-000161b0: 2060 6063 6170 6669 7460 603a 204f 6e6c   ``capfit``: Onl
-000161c0: 7920 6163 6365 7074 2066 696e 616c 206d  y accept final m
-000161d0: 6f76 6520 6966 2060 6063 6869 3260 6020  ove if ``chi2`` 
-000161e0: 6465 6372 6561 7365 642e 0d0a 2d20 6060  decreased...- ``
-000161f0: 6361 7066 6974 6060 3a20 5374 7269 6374  capfit``: Strict
-00016200: 6c79 2073 6174 6973 6679 2062 6f75 6e64  ly satisfy bound
-00016210: 7320 6475 7269 6e67 204a 6163 6f62 6961  s during Jacobia
-00016220: 6e20 636f 6d70 7574 6174 696f 6e2e 0d0a  n computation...
-00016230: 0d0a 5636 2e37 2e31 363a 204d 432c 204f  ..V6.7.16: MC, O
-00016240: 7866 6f72 642c 2031 3220 4a75 6e65 2032  xford, 12 June 2
-00016250: 3031 390d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  019..+++++++++++
-00016260: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016270: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060 6361  ++++++....- ``ca
-00016280: 7066 6974 6060 3a20 5573 6520 6f6e 6c79  pfit``: Use only
-00016290: 2066 7265 6520 7061 7261 6d65 7465 7273   free parameters
-000162a0: 2066 6f72 2060 6078 746f 6c60 6020 636f   for ``xtol`` co
-000162b0: 6e76 6572 6765 6e63 6520 7465 7374 2e0d  nvergence test..
-000162c0: 0a2d 2060 6063 6170 6669 7460 603a 2044  .- ``capfit``: D
-000162d0: 6573 6372 6962 6520 696e 2077 6f72 6473  escribe in words
-000162e0: 2063 6f6e 7665 7267 656e 6365 2073 7461   convergence sta
-000162f0: 7475 7320 7769 7468 206e 6f6e 7a65 726f  tus with nonzero
-00016300: 2060 6076 6572 626f 7365 6060 2e0d 0a2d   ``verbose``...-
-00016310: 2060 6063 6170 6669 7460 603a 2046 6978   ``capfit``: Fix
-00016320: 6564 2070 726f 6772 616d 2073 746f 7020  ed program stop 
-00016330: 7768 656e 2060 6061 6273 5f73 7465 7060  when ``abs_step`
-00016340: 6020 6973 2075 6e64 6566 696e 6564 2e0d  ` is undefined..
-00016350: 0a2d 2060 6063 6170 6669 7460 603a 2046  .- ``capfit``: F
-00016360: 6978 6564 2069 676e 6f72 696e 6720 6f70  ixed ignoring op
-00016370: 7469 6f6e 616c 2060 606d 6178 5f6e 6665  tional ``max_nfe
-00016380: 7660 602e 0d0a 0d0a 5636 2e37 2e31 353a  v``.....V6.7.15:
-00016390: 204d 432c 204f 7866 6f72 642c 2037 2046   MC, Oxford, 7 F
-000163a0: 6562 7275 6172 7920 3230 3139 0d0a 2b2b  ebruary 2019..++
-000163b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000163c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000163d0: 2b2b 0d0a 2d20 5265 6d6f 7665 6420 756e  ++..- Removed un
-000163e0: 7573 6564 2060 6072 6560 6020 696d 706f  used ``re`` impo
-000163f0: 7274 2e0d 0a2d 2052 656d 6f76 6564 2053  rt...- Removed S
-00016400: 6369 7079 2773 2060 606e 6578 745f 6661  cipy's ``next_fa
-00016410: 7374 5f6c 656e 6060 2075 7361 6765 2064  st_len`` usage d
-00016420: 7565 2074 6f20 616e 2069 7373 7565 2077  ue to an issue w
-00016430: 6974 6820 6f64 6420 7061 6464 696e 6720  ith odd padding 
-00016440: 7369 7a65 2e0d 0a20 2054 6861 6e6b 7320  size...  Thanks 
-00016450: 746f 2045 7269 6320 456d 7365 6c6c 656d  to Eric Emsellem
-00016460: 2028 4553 4f29 2066 6f72 2061 2063 6c65   (ESO) for a cle
-00016470: 6172 2065 7861 6d70 6c65 2069 6c6c 7573  ar example illus
-00016480: 7472 6174 696e 6720 7468 6973 2072 6172  trating this rar
-00016490: 6520 616e 640d 0a20 2073 7562 746c 6520  e and..  subtle 
-000164a0: 6275 672e 0d0a 0d0a 5636 2e37 2e31 343a  bug.....V6.7.14:
-000164b0: 204d 432c 204f 7866 6f72 642c 2032 3720   MC, Oxford, 27 
-000164c0: 4e6f 7665 6d62 6572 2032 3031 380d 0a2b  November 2018..+
-000164d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000164e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000164f0: 2b2b 2b2b 2b0d 0a2d 2050 7269 6e74 2074  +++++..- Print t
-00016500: 6865 2075 7365 6420 6060 7469 6564 6060  he used ``tied``
-00016510: 2070 6172 616d 6574 6572 7320 6571 7561   parameters equa
-00016520: 6c69 7469 6573 2c20 6966 2061 6e79 2e0d  lities, if any..
-00016530: 0a2d 2052 6574 7572 6e20 6060 2e6e 646f  .- Return ``.ndo
-00016540: 6660 6020 6174 7472 6962 7574 652e 0d0a  f`` attribute...
-00016550: 2d20 446f 206e 6f74 2072 656d 6f76 6520  - Do not remove 
-00016560: 6060 6669 7865 6460 6020 6f72 2060 6074  ``fixed`` or ``t
-00016570: 6965 6460 6020 7061 7261 6d65 7465 7273  ied`` parameters
-00016580: 2066 726f 6d20 7468 6520 444f 4620 6361   from the DOF ca
-00016590: 6c63 756c 6174 696f 6e2e 0d0a 2020 5468  lculation...  Th
-000165a0: 616e 6b73 2074 6f20 4a6f 616e 6e61 2057  anks to Joanna W
-000165b0: 6f6f 2028 556e 6976 2e20 6f66 2056 6963  oo (Univ. of Vic
-000165c0: 746f 7269 6129 2066 6f72 2074 6865 2063  toria) for the c
-000165d0: 6f72 7265 6374 696f 6e2e 0d0a 2d20 5265  orrection...- Re
-000165e0: 706c 6163 6564 2060 606e 6f72 6d61 6c69  placed ``normali
-000165f0: 7a65 6060 2c20 6060 6d69 6e5f 6167 6560  ze``, ``min_age`
-00016600: 602c 2060 606d 6178 5f61 6765 6060 2061  `, ``max_age`` a
-00016610: 6e64 2060 606d 6574 616c 6060 206b 6579  nd ``metal`` key
-00016620: 776f 7264 7320 7769 7468 0d0a 2020 6060  words with..  ``
-00016630: 6e6f 726d 5f72 616e 6765 6060 2c20 6060  norm_range``, ``
-00016640: 6167 655f 7261 6e67 6560 6020 616e 6420  age_range`` and 
-00016650: 6060 6d65 7461 6c5f 7261 6e67 6560 6020  ``metal_range`` 
-00016660: 696e 2060 6070 7078 662e 6d69 6c65 735f  in ``ppxf.miles_
-00016670: 7574 696c 2e6d 696c 6573 6060 2e0d 0a2d  util.miles``...-
-00016680: 2046 6978 6564 2060 6063 6c6f 636b 6060   Fixed ``clock``
-00016690: 2060 6044 6570 7265 6361 7469 6f6e 5761   ``DeprecationWa
-000166a0: 726e 696e 6760 6020 696e 2050 7974 686f  rning`` in Pytho
-000166b0: 6e20 332e 372e 0d0a 0d0a 5636 2e37 2e31  n 3.7.....V6.7.1
-000166c0: 333a 204d 432c 204f 7866 6f72 642c 2032  3: MC, Oxford, 2
-000166d0: 3020 5365 7074 656d 6265 7220 3230 3138  0 September 2018
-000166e0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-000166f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016700: 2b2b 2b2b 2b2b 2b2b 0d0a 2d20 4578 7061  ++++++++..- Expa
-00016710: 6e64 6564 2064 6f63 756d 656e 7461 7469  nded documentati
-00016720: 6f6e 206f 6620 6060 7265 6464 656e 696e  on of ``reddenin
-00016730: 6760 6020 616e 6420 6060 6761 735f 7265  g`` and ``gas_re
-00016740: 6464 656e 696e 6760 602e 0d0a 2020 5468  ddening``...  Th
-00016750: 616e 6b73 2074 6f20 4e69 636b 2042 6f61  anks to Nick Boa
-00016760: 7264 6d61 6e20 2855 6e69 762e 2055 7461  rdman (Univ. Uta
-00016770: 6829 2066 6f72 2074 6865 2066 6565 6462  h) for the feedb
-00016780: 6163 6b2e 0d0a 2d20 6060 6361 7066 6974  ack...- ``capfit
-00016790: 6060 206e 6f77 2072 6169 7365 7320 616e  `` now raises an
-000167a0: 2065 7272 6f72 2069 6620 6f6e 6520 7472   error if one tr
-000167b0: 6965 7320 746f 2074 6965 2070 6172 616d  ies to tie param
-000167c0: 6574 6572 7320 746f 2074 6865 6d73 656c  eters to themsel
-000167d0: 7665 732e 0d0a 2020 5468 616e 6b73 2074  ves...  Thanks t
-000167e0: 6f20 4b79 6c65 2057 6573 7466 616c 6c20  o Kyle Westfall 
-000167f0: 2855 6e69 762e 2053 616e 7461 2043 7275  (Univ. Santa Cru
-00016800: 7a29 2066 6f72 2074 6865 2073 7567 6765  z) for the sugge
-00016810: 7374 696f 6e2e 0d0a 2d20 6060 6361 7066  stion...- ``capf
-00016820: 6974 6060 2075 7365 7320 5079 7468 6f6e  it`` uses Python
-00016830: 2033 2e36 2066 2d73 7472 696e 6773 2e0d   3.6 f-strings..
-00016840: 0a0d 0a56 362e 372e 3132 3a20 4d43 2c20  ...V6.7.12: MC, 
-00016850: 4f78 666f 7264 2c20 3920 4a75 6c79 2032  Oxford, 9 July 2
-00016860: 3031 380d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  018..+++++++++++
-00016870: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016880: 2b2b 2b2b 2b0d 0a2d 2041 6c6c 6f77 2066  +++++..- Allow f
-00016890: 6f72 2060 6076 656c 7363 616c 6560 6020  or ``velscale`` 
-000168a0: 616e 6420 6060 7673 7973 7460 6020 746f  and ``vsyst`` to
-000168b0: 2062 6520 4e75 6d70 7920 6172 7261 7973   be Numpy arrays
-000168c0: 2072 6174 6865 7220 7468 616e 2073 6361   rather than sca
-000168d0: 6c61 7273 2e0d 0a2d 2049 6d70 726f 7665  lars...- Improve
-000168e0: 6420 6372 6974 6572 696f 6e20 666f 7220  d criterion for 
-000168f0: 7768 656e 2074 6865 2042 616c 6d65 7220  when the Balmer 
-00016900: 7365 7269 6573 2069 7320 7769 7468 696e  series is within
-00016910: 2074 6865 2066 6974 7465 6420 7761 7665   the fitted wave
-00016920: 6c65 6e67 7468 0d0a 2020 7261 6e67 6520  length..  range 
-00016930: 696e 2060 6070 7078 662e 7070 7866 5f75  in ``ppxf.ppxf_u
-00016940: 7469 6c2e 656d 6973 7369 6f6e 5f6c 696e  til.emission_lin
-00016950: 6573 6060 2e20 5468 616e 6b73 2074 6f20  es``. Thanks to 
-00016960: 5361 6d20 5661 7567 6861 6e0d 0a20 2028  Sam Vaughan..  (
-00016970: 556e 6976 2e20 6f66 204f 7866 6f72 6429  Univ. of Oxford)
-00016980: 2066 6f72 2074 6865 2066 6565 6462 6163   for the feedbac
-00016990: 6b2e 0d0a 2d20 496e 636c 7564 6564 2060  k...- Included `
-000169a0: 6077 6964 7468 6060 206b 6579 776f 7264  `width`` keyword
-000169b0: 2069 6e20 6060 7070 7866 2e70 7078 665f   in ``ppxf.ppxf_
-000169c0: 7574 696c 2e64 6574 6572 6d69 6e65 5f67  util.determine_g
-000169d0: 6f6f 6470 6978 656c 7360 602e 0d0a 2020  oodpixels``...  
-000169e0: 5468 616e 6b73 2074 6f20 4765 6f72 6765  Thanks to George
-000169f0: 2050 7269 766f 6e20 2855 6e69 762e 206f   Privon (Univ. o
-00016a00: 6620 466c 6f72 6964 6129 2066 6f72 2074  f Florida) for t
-00016a10: 6865 2073 7567 6765 7374 696f 6e2e 0d0a  he suggestion...
-00016a20: 2d20 4578 7061 6e64 6564 2060 602e 6761  - Expanded ``.ga
-00016a30: 735f 666c 7578 6060 2064 6f63 756d 656e  s_flux`` documen
-00016a40: 7461 7469 6f6e 2e0d 0a0d 0a56 362e 372e  tation.....V6.7.
-00016a50: 3131 3a20 4d43 2c20 4f78 666f 7264 2c20  11: MC, Oxford, 
-00016a60: 3520 4a75 6e65 2032 3031 380d 0a2b 2b2b  5 June 2018..+++
-00016a70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016a80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00016a90: 0a2d 2046 6f72 6d61 7474 6564 2060 6070  .- Formatted ``p
-00016aa0: 7078 662e 7079 6060 2064 6f63 7374 7269  pxf.py`` docstri
-00016ab0: 6e67 2069 6e20 7265 5374 7275 6374 7572  ng in reStructur
-00016ac0: 6564 5465 7874 2e0d 0a2d 2052 656d 6f76  edText...- Remov
-00016ad0: 6564 2043 4841 4e47 454c 4f47 2066 726f  ed CHANGELOG fro
-00016ae0: 6d20 7468 6520 636f 6465 2061 6e64 2070  m the code and p
-00016af0: 6c61 6365 6420 6974 2069 6e20 6120 7365  laced it in a se
-00016b00: 7061 7261 7465 2066 696c 652e 0d0a 2d20  parate file...- 
-00016b10: 4d6f 6469 6669 6564 2060 6073 6574 7570  Modified ``setup
-00016b20: 2e70 7960 6020 746f 2073 686f 7720 6865  .py`` to show he
-00016b30: 6c70 2061 6e64 2043 4841 4e47 454c 4f47  lp and CHANGELOG
-00016b40: 206f 6e20 5079 5069 2070 6167 652e 0d0a   on PyPi page...
-00016b50: 2d20 496e 636c 7564 6564 2060 6070 7078  - Included ``ppx
-00016b60: 662e 5f5f 7665 7273 696f 6e5f 5f60 602e  f.__version__``.
-00016b70: 0d0a 0d0a 5636 2e37 2e38 3a20 4d43 2c20  ....V6.7.8: MC, 
-00016b80: 4f78 666f 7264 2c20 3231 204d 6179 2032  Oxford, 21 May 2
-00016b90: 3031 380d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  018..+++++++++++
-00016ba0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016bb0: 2b2b 2b2b 0d0a 0d0a 2d20 4d6f 7665 6420  ++++....- Moved 
-00016bc0: 7061 636b 6167 6520 746f 2074 6865 2050  package to the P
-00016bd0: 7974 686f 6e20 5061 636b 6167 6520 496e  ython Package In
-00016be0: 6465 7820 2850 7950 6929 2e0d 0a2d 2044  dex (PyPi)...- D
-00016bf0: 726f 7070 6564 206c 6567 6163 7920 5079  ropped legacy Py
-00016c00: 7468 6f6e 2032 2e37 2073 7570 706f 7274  thon 2.7 support
-00016c10: 2e0d 0a0d 0a56 362e 372e 363a 204d 432c  .....V6.7.6: MC,
-00016c20: 204f 7866 6f72 642c 2031 3620 4170 7269   Oxford, 16 Apri
-00016c30: 6c20 3230 3138 0d0a 2b2b 2b2b 2b2b 2b2b  l 2018..++++++++
-00016c40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016c50: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2043  +++++++++....- C
-00016c60: 6861 6e67 6564 2069 6d70 6f72 7473 2066  hanged imports f
-00016c70: 6f72 2074 6865 2063 6f6e 7665 7273 696f  or the conversio
-00016c80: 6e20 6f66 2070 5058 4620 746f 2061 2070  n of pPXF to a p
-00016c90: 6163 6b61 6765 2e0d 0a20 2054 6861 6e6b  ackage...  Thank
-00016ca0: 7320 746f 204a 6f65 2042 7572 6368 6574  s to Joe Burchet
-00016cb0: 7420 2853 616e 7461 2043 7275 7a29 2066  t (Santa Cruz) f
-00016cc0: 6f72 2074 6865 2073 7567 6765 7374 696f  or the suggestio
-00016cd0: 6e2e 0d0a 0d0a 5636 2e37 2e35 3a20 4d43  n.....V6.7.5: MC
-00016ce0: 2c20 4f78 666f 7264 2c20 3130 2041 7072  , Oxford, 10 Apr
-00016cf0: 696c 2032 3031 380d 0a2b 2b2b 2b2b 2b2b  il 2018..+++++++
-00016d00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016d10: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-00016d20: 4669 7865 6420 7379 6e74 6178 2065 7272  Fixed syntax err
-00016d30: 6f72 2075 6e64 6572 2050 7974 686f 6e20  or under Python 
-00016d40: 322e 372e 0d0a 0d0a 5636 2e37 2e34 3a20  2.7.....V6.7.4: 
-00016d50: 4d43 2c20 4f78 666f 7264 2c20 3136 2046  MC, Oxford, 16 F
-00016d60: 6562 7275 6172 7920 3230 3138 0d0a 2b2b  ebruary 2018..++
-00016d70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016d80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016d90: 2b2b 0d0a 0d0a 2d20 4669 7865 6420 6275  ++....- Fixed bu
-00016da0: 6720 696e 2060 6072 6564 6465 6e69 6e67  g in ``reddening
-00016db0: 5f63 616c 3030 2829 6060 2e20 4974 206f  _cal00()``. It o
-00016dc0: 6e6c 7920 6166 6665 6374 6564 204e 4952  nly affected NIR
-00016dd0: 206c 616d 203e 2031 3030 3020 6e6d 2e0d   lam > 1000 nm..
-00016de0: 0a0d 0a56 362e 372e 333a 204d 432c 204f  ...V6.7.3: MC, O
-00016df0: 7866 6f72 642c 2038 2046 6562 7275 6172  xford, 8 Februar
-00016e00: 7920 3230 3138 0d0a 2b2b 2b2b 2b2b 2b2b  y 2018..++++++++
+00011da0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00011db0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00011dc0: 2323 230d 0a0d 0a43 6861 6e67 656c 6f67  ###....Changelog
+00011dd0: 0d0a 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a56  ..---------....V
+00011de0: 392e 322e 323a 204d 432c 204f 7866 6f72  9.2.2: MC, Oxfor
+00011df0: 642c 2032 3020 4d61 7920 3230 3234 0d0a  d, 20 May 2024..
+00011e00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00011e10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+00011e20: 0a0d 0a2d 2060 6070 7078 6660 603a 2046  ...- ``ppxf``: F
+00011e30: 6978 6564 2061 6e20 6973 7375 6520 7768  ixed an issue wh
+00011e40: 6572 6520 7468 6520 6162 7365 6e63 6520  ere the absence 
+00011e50: 6f66 2074 6865 2060 6072 6567 5f64 696d  of the ``reg_dim
+00011e60: 6060 206b 6579 776f 7264 2063 6f75 6c64  `` keyword could
+00011e70: 0d0a 2020 6861 6c74 2074 6865 2070 726f  ..  halt the pro
+00011e80: 6772 616d 2028 6275 6720 6672 6f6d 2056  gram (bug from V
+00011e90: 392e 322e 3129 2e20 5468 616e 6b73 2074  9.2.1). Thanks t
+00011ea0: 6f20 4a65 7373 6520 7661 6e20 6465 2053  o Jesse van de S
+00011eb0: 616e 6465 0d0a 2020 2875 6e73 772e 6564  ande..  (unsw.ed
+00011ec0: 752e 6175 2920 616e 6420 4c75 697a 2041  u.au) and Luiz A
+00011ed0: 2e20 5369 6c76 612d 4c69 6d61 2028 556e  . Silva-Lima (Un
+00011ee0: 6976 2e20 53c3 83c2 a36f 2050 6175 6c6f  iv. S....o Paulo
+00011ef0: 2c20 4272 617a 696c 2920 666f 7220 7468  , Brazil) for th
+00011f00: 650d 0a20 2072 6570 6f72 742e 0d0a 0d0a  e..  report.....
+00011f10: 2d20 6060 7070 7866 6060 3a20 4176 6f69  - ``ppxf``: Avoi
+00011f20: 6420 706f 7373 6962 6c65 2070 726f 6772  d possible progr
+00011f30: 616d 2073 746f 7020 7768 656e 2060 6074  am stop when ``t
+00011f40: 656d 706c 6174 6573 6060 2061 7265 2073  emplates`` are s
+00011f50: 686f 7274 6572 2074 6861 6e0d 0a20 2060  horter than..  `
+00011f60: 6067 616c 6178 7960 6020 2862 7567 2066  `galaxy`` (bug f
+00011f70: 726f 6d20 5639 2e32 2e31 292e 0d0a 0d0a  rom V9.2.1).....
+00011f80: 2d20 6060 7070 7866 6060 3a20 4176 6f69  - ``ppxf``: Avoi
+00011f90: 6420 7472 756e 6361 7469 6e67 2060 6074  d truncating ``t
+00011fa0: 656d 706c 6174 6573 6060 2074 6f20 6060  emplates`` to ``
+00011fb0: 676f 6f64 7069 7865 6c73 6060 2069 6e20  goodpixels`` in 
+00011fc0: 7468 6520 6669 6e61 6c20 706c 6f74 2c0d  the final plot,.
+00011fd0: 0a20 2077 6865 6e20 626f 7468 2060 606c  .  when both ``l
+00011fe0: 616d 6060 2061 6e64 2060 606c 616d 5f74  am`` and ``lam_t
+00011ff0: 656d 7060 6020 7061 7261 6d65 7465 7273  emp`` parameters
+00012000: 2061 7265 2073 7570 706c 6965 642e 2049   are supplied. I
+00012010: 6e73 7465 6164 2c20 7368 6f77 2074 6865  nstead, show the
+00012020: 0d0a 2020 6060 7465 6d70 6c61 7465 7360  ..  ``templates`
+00012030: 6020 6f76 6572 2074 6865 2066 756c 6c20  ` over the full 
+00012040: 6060 6761 6c61 7879 6060 2073 7065 6374  ``galaxy`` spect
+00012050: 7261 6c20 7261 6e67 652e 0d0a 2020 0d0a  ral range...  ..
+00012060: 2d20 6060 7070 7866 6060 3a20 436f 7272  - ``ppxf``: Corr
+00012070: 6563 7465 6420 6265 6861 7669 6f75 7220  ected behaviour 
+00012080: 746f 206f 6e6c 7920 7573 6520 7468 6520  to only use the 
+00012090: 7261 6e67 6520 6265 7477 6565 6e20 7468  range between th
+000120a0: 6520 6669 7273 7420 616e 640d 0a20 206c  e first and..  l
+000120b0: 6173 7420 6060 676f 6f64 7069 7865 6c73  ast ``goodpixels
+000120c0: 6060 2066 6f72 2064 6574 6572 6d69 6e69  `` for determini
+000120d0: 6e67 2074 6865 2076 6572 7469 6361 6c20  ng the vertical 
+000120e0: 706c 6f74 7469 6e67 2072 616e 6765 2e20  plotting range. 
+000120f0: 2054 6861 6e6b 7320 746f 0d0a 2020 4461   Thanks to..  Da
+00012100: 7669 6420 476f 6f64 696e 6720 2863 6863  vid Gooding (chc
+00012110: 682e 6f78 2e61 632e 756b 2920 666f 7220  h.ox.ac.uk) for 
+00012120: 696c 6c75 7374 7261 7469 6e67 2074 6865  illustrating the
+00012130: 2070 726f 626c 656d 2e0d 0a0d 0a2d 2060   problem.....- `
+00012140: 6070 7078 665f 6578 616d 706c 655f 6b69  `ppxf_example_ki
+00012150: 6e65 6d61 7469 6373 5f73 6473 732e 7079  nematics_sdss.py
+00012160: 6060 3a20 4d6f 6469 6669 6564 2074 6865  ``: Modified the
+00012170: 2065 7861 6d70 6c65 2074 6f20 6465 2d72   example to de-r
+00012180: 6564 7368 6966 7420 7468 650d 0a20 2073  edshift the..  s
+00012190: 7065 6374 7275 6d20 6279 2064 6566 6175  pectrum by defau
+000121a0: 6c74 2c20 6d69 6e69 6d69 7a69 6e67 2070  lt, minimizing p
+000121b0: 6f74 656e 7469 616c 2063 6f6e 6675 7369  otential confusi
+000121c0: 6f6e 2e0d 0a0d 0a56 392e 322e 313a 204d  on.....V9.2.1: M
+000121d0: 432c 204f 7866 6f72 642c 2031 3820 4170  C, Oxford, 18 Ap
+000121e0: 7269 6c20 3230 3234 0d0a 2b2b 2b2b 2b2b  ril 2024..++++++
+000121f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00012200: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+00012210: 2060 6073 7073 5f75 7469 6c2e 7379 6e74   ``sps_util.synt
+00012220: 6865 7469 635f 7068 6f74 6f6d 6574 7279  hetic_photometry
+00012230: 6060 3a20 4163 6365 7074 7320 696e 7075  ``: Accepts inpu
+00012240: 7420 7761 7665 6c65 6e67 7468 7320 7468  t wavelengths th
+00012250: 6174 2061 7265 206e 6f74 0d0a 2020 6576  at are not..  ev
+00012260: 656e 6c79 2073 7061 6365 642e 0d0a 2d20  enly spaced...- 
+00012270: 6060 7070 7866 5f75 7469 6c2e 6d61 675f  ``ppxf_util.mag_
+00012280: 7370 6563 7472 756d 6060 3a20 4120 6e65  spectrum``: A ne
+00012290: 7720 6675 6e63 7469 6f6e 2074 6f20 6765  w function to ge
+000122a0: 7420 7468 6520 6170 7061 7265 6e74 206d  t the apparent m
+000122b0: 6167 6e69 7475 6465 2066 726f 6d0d 0a20  agnitude from.. 
+000122c0: 2061 2073 7065 6374 7275 6d20 696e 2061   a spectrum in a
+000122d0: 6e79 2070 686f 746f 6d65 7472 6963 2062  ny photometric b
+000122e0: 616e 642c 2061 7420 616e 7920 7265 6473  and, at any reds
+000122f0: 6869 6674 2c20 696e 2065 6974 6865 7220  hift, in either 
+00012300: 7468 6520 4142 206f 7220 5665 6761 0d0a  the AB or Vega..
+00012310: 2020 6d61 676e 6974 7564 6520 7379 7374    magnitude syst
+00012320: 656d 2e0d 0a2d 2060 6070 7078 6660 603a  em...- ``ppxf``:
+00012330: 204e 6f77 2063 6f6e 7369 6465 7273 2074   Now considers t
+00012340: 6865 2067 6976 656e 2060 6067 6f6f 6470  he given ``goodp
+00012350: 6978 656c 7360 6020 7768 656e 2063 6865  ixels`` when che
+00012360: 636b 696e 6720 7468 6174 2074 6865 0d0a  cking that the..
+00012370: 2020 6060 7465 6d70 6c61 7465 7360 6020    ``templates`` 
+00012380: 636f 7665 7220 7468 6520 6675 6c6c 2060  cover the full `
+00012390: 6067 616c 6178 7960 6020 7370 6563 7472  `galaxy`` spectr
+000123a0: 756d 2c20 6966 2062 6f74 6820 6060 6c61  um, if both ``la
+000123b0: 6d60 6020 616e 640d 0a20 2060 606c 616d  m`` and..  ``lam
+000123c0: 5f74 656d 7060 6020 6172 6520 7072 6f76  _temp`` are prov
+000123d0: 6964 6564 2e0d 0a2d 2060 6070 7078 6660  ided...- ``ppxf`
+000123e0: 603a 2041 6c6c 6f77 2066 6f72 2076 6172  `: Allow for var
+000123f0: 6961 626c 6520 7374 6570 2073 697a 6520  iable step size 
+00012400: 6163 726f 7373 2069 6e74 6572 7661 6c73  across intervals
+00012410: 2061 6e64 2064 696d 656e 7369 6f6e 7320   and dimensions 
+00012420: 696e 2074 6865 0d0a 2020 6e75 6d65 7269  in the..  numeri
+00012430: 6361 6c20 6465 7269 7661 7469 7665 7320  cal derivatives 
+00012440: 7573 6564 2066 6f72 2072 6567 756c 6172  used for regular
+00012450: 697a 6174 696f 6e2c 2077 6974 6820 7468  ization, with th
+00012460: 6520 6e65 7720 6b65 7977 6f72 640d 0a20  e new keyword.. 
+00012470: 2060 6072 6567 5f73 7465 7060 602e 0d0a   ``reg_step``...
+00012480: 2d20 6060 7070 7866 6060 3a20 4176 6f69  - ``ppxf``: Avoi
+00012490: 6473 206e 6577 2060 6053 796e 7461 7857  ds new ``SyntaxW
+000124a0: 6172 6e69 6e67 6060 2069 6e20 4d61 7470  arning`` in Matp
+000124b0: 6c6f 746c 6962 204c 6154 6558 2073 7472  lotlib LaTeX str
+000124c0: 696e 6720 696e 2074 6865 0d0a 2020 6c61  ing in the..  la
+000124d0: 7465 7374 2050 7974 686f 6e20 332e 3132  test Python 3.12
+000124e0: 2e0d 0a2d 2060 6070 7078 6660 603a 2041  ...- ``ppxf``: A
+000124f0: 766f 6964 2070 726f 6772 616d 2073 746f  void program sto
+00012500: 7020 7768 656e 2070 6173 7369 6e67 2061  p when passing a
+00012510: 6e20 696e 7075 7420 636f 7661 7269 616e  n input covarian
+00012520: 6365 206d 6174 7269 7820 7768 696c 650d  ce matrix while.
+00012530: 0a20 2066 6974 7469 6e67 2066 6f72 2067  .  fitting for g
+00012540: 6173 2065 6d69 7373 696f 6e20 6c69 6e65  as emission line
+00012550: 732e 2054 6861 6e6b 7320 746f 204a 6163  s. Thanks to Jac
+00012560: 6b73 6f6e 204f 446f 6e6e 656c 6c20 2875  kson ODonnell (u
+00012570: 6373 632e 6564 7529 2066 6f72 2074 6865  csc.edu) for the
+00012580: 0d0a 2020 7265 706f 7274 2e0d 0a0d 0a56  ..  report.....V
+00012590: 392e 312e 313a 204d 432c 204f 7866 6f72  9.1.1: MC, Oxfor
+000125a0: 642c 2031 3820 4a61 6e75 6172 7920 3230  d, 18 January 20
+000125b0: 3234 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  24..++++++++++++
+000125c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000125d0: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6073  +++++++....- ``s
+000125e0: 7073 5f75 7469 6c2e 6d61 7373 5f74 6f5f  ps_util.mass_to_
+000125f0: 6c69 6768 7460 603a 204e 6f77 2069 7420  light``: Now it 
+00012600: 6361 6e20 6361 6c63 756c 6174 6520 7468  can calculate th
+00012610: 6520 7374 656c 6c61 7220 6d61 7373 2d74  e stellar mass-t
+00012620: 6f2d 6c69 6768 740d 0a20 2072 6174 696f  o-light..  ratio
+00012630: 2028 6060 4d2a 2f4c 6060 2920 666f 7220   (``M*/L``) for 
+00012640: 616e 7920 7374 656c 6c61 7220 706f 7075  any stellar popu
+00012650: 6c61 7469 6f6e 2073 796e 7468 6573 6973  lation synthesis
+00012660: 2028 5350 5329 206d 6f64 656c 2c20 616e   (SPS) model, an
+00012670: 790d 0a20 2066 696c 7465 722c 2061 6e64  y..  filter, and
+00012680: 2061 6e79 2072 6564 7368 6966 742c 2075   any redshift, u
+00012690: 7369 6e67 2074 6865 206f 7574 7075 7420  sing the output 
+000126a0: 7765 6967 6874 7320 6672 6f6d 2060 6070  weights from ``p
+000126b0: 5058 4660 602e 204e 6f20 6e65 6564 2066  PXF``. No need f
+000126c0: 6f72 0d0a 2020 7072 652d 636f 6d70 7574  or..  pre-comput
+000126d0: 6564 2074 6162 6c65 7320 616e 796d 6f72  ed tables anymor
+000126e0: 652e 0d0a 2d20 6060 7070 7866 5f75 7469  e...- ``ppxf_uti
+000126f0: 6c2e 6d61 675f 7375 6e60 603a 2041 206e  l.mag_sun``: A n
+00012700: 6577 2066 756e 6374 696f 6e20 746f 2067  ew function to g
+00012710: 6574 2074 6865 2061 6273 6f6c 7574 6520  et the absolute 
+00012720: 736f 6c61 7220 6d61 676e 6974 7564 6520  solar magnitude 
+00012730: 696e 0d0a 2020 616e 7920 7068 6f74 6f6d  in..  any photom
+00012740: 6574 7269 6320 6261 6e64 2c20 6174 2061  etric band, at a
+00012750: 6e79 2072 6564 7368 6966 742c 2069 6e20  ny redshift, in 
+00012760: 6569 7468 6572 2074 6865 2041 4220 6f72  either the AB or
+00012770: 2056 6567 6120 6d61 676e 6974 7564 650d   Vega magnitude.
+00012780: 0a20 2073 7973 7465 6d2e 0d0a 0d0a 5639  .  system.....V9
+00012790: 2e30 2e32 3a20 4d43 2c20 4f78 666f 7264  .0.2: MC, Oxford
+000127a0: 2c20 3330 204e 6f76 656d 6265 7220 3230  , 30 November 20
+000127b0: 3233 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  23..++++++++++++
+000127c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000127d0: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060  ++++++++....- ``
+000127e0: 7070 7866 6060 3a20 4669 7865 6420 6275  ppxf``: Fixed bu
+000127f0: 6720 696e 2074 6865 2061 7574 6f6d 6174  g in the automat
+00012800: 6963 2074 7275 6e63 6174 696f 6e20 6f66  ic truncation of
+00012810: 2074 6865 2074 656d 706c 6174 6520 7761   the template wa
+00012820: 7665 6c65 6e67 7468 2c0d 0a20 2077 6865  velength,..  whe
+00012830: 6e20 7573 696e 6720 6060 626f 756e 6473  n using ``bounds
+00012840: 6060 2074 6f67 6574 6865 7220 7769 7468  `` together with
+00012850: 2060 606c 616d 6060 2061 6e64 2060 606c   ``lam`` and ``l
+00012860: 616d 5f74 656d 7060 602e 0d0a 0d0a 5639  am_temp``.....V9
+00012870: 2e30 2e31 3a20 4d43 2c20 4f78 666f 7264  .0.1: MC, Oxford
+00012880: 2c20 3132 204e 6f76 656d 6265 7220 3230  , 12 November 20
+00012890: 3233 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  23..++++++++++++
+000128a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000128b0: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5265  ++++++++....- Re
+000128c0: 706c 6163 6564 2060 606d 696c 6573 5f75  placed ``miles_u
+000128d0: 7469 6c60 6020 7769 7468 2060 6073 7073  til`` with ``sps
+000128e0: 5f75 7469 6c60 602c 2061 2076 6572 7361  _util``, a versa
+000128f0: 7469 6c65 2061 6e64 2066 6c65 7869 626c  tile and flexibl
+00012900: 6520 6675 6e63 7469 6f6e 0d0a 2020 7468  e function..  th
+00012910: 6174 2073 7570 706f 7274 7320 7661 7269  at supports vari
+00012920: 6f75 7320 7374 656c 6c61 7220 706f 7075  ous stellar popu
+00012930: 6c61 7469 6f6e 2073 796e 7468 6573 6973  lation synthesis
+00012940: 2028 5350 5329 206d 6f64 656c 732e 2043   (SPS) models. C
+00012950: 7572 7265 6e74 6c79 2c20 490d 0a20 2064  urrently, I..  d
+00012960: 6973 7472 6962 7574 6520 2877 6974 6820  istribute (with 
+00012970: 7065 726d 6973 7369 6f6e 2920 7468 6520  permission) the 
+00012980: 6060 452d 4d49 4c45 5360 6020 2856 617a  ``E-MILES`` (Vaz
+00012990: 6465 6b69 732b 3230 3136 292c 2060 6047  dekis+2016), ``G
+000129a0: 414c 4158 4556 6060 0d0a 2020 2842 7275  ALAXEV``..  (Bru
+000129b0: 7a75 616c 2026 2043 6861 726c 6f74 2032  zual & Charlot 2
+000129c0: 3030 3329 2061 6e64 2060 6066 7370 7360  003) and ``fsps`
+000129d0: 6020 2843 6f6e 726f 792b 3230 3039 2c32  ` (Conroy+2009,2
+000129e0: 3031 3029 2073 7465 6c6c 6172 2070 6f70  010) stellar pop
+000129f0: 756c 6174 696f 6e0d 0a20 2074 656d 706c  ulation..  templ
+00012a00: 6174 6573 2e20 4f6e 6520 6361 6e20 6e6f  ates. One can no
+00012a10: 7720 6368 616e 6765 2053 5053 2062 7920  w change SPS by 
+00012a20: 6a75 7374 206d 6f64 6966 7969 6e67 2074  just modifying t
+00012a30: 6865 2066 696c 656e 616d 652e 0d0a 2020  he filename...  
+00012a40: 0d0a 2020 494d 504f 5254 414e 543a 2049  ..  IMPORTANT: I
+00012a50: 206e 6f20 6c6f 6e67 6572 2069 6e63 6c75   no longer inclu
+00012a60: 6465 2074 6865 2053 5053 206d 6f64 656c  de the SPS model
+00012a70: 7320 696e 2074 6865 2060 6070 5058 4660  s in the ``pPXF`
+00012a80: 6020 7061 636b 6167 652c 2064 7565 2074  ` package, due t
+00012a90: 6f0d 0a20 2066 696c 6520 7369 7a65 2063  o..  file size c
+00012aa0: 6f6e 7374 7261 696e 7473 2e20 4f6e 6520  onstraints. One 
+00012ab0: 6d75 7374 2064 6f77 6e6c 6f61 6420 7468  must download th
+00012ac0: 6520 5350 5320 7465 6d70 6c61 7465 7320  e SPS templates 
+00012ad0: 7365 7061 7261 7465 6c79 2061 6674 6572  separately after
+00012ae0: 0d0a 2020 7468 6520 6060 7050 5846 6060  ..  the ``pPXF``
+00012af0: 2069 6e73 7461 6c6c 6174 696f 6e2c 2061   installation, a
+00012b00: 7320 6465 6d6f 6e73 7472 6174 6564 2069  s demonstrated i
+00012b10: 6e20 616c 6c20 7468 6520 6060 7050 5846  n all the ``pPXF
+00012b20: 6060 2065 7861 6d70 6c65 732e 0d0a 2d20  `` examples...- 
+00012b30: 4920 6164 6170 7465 6420 616c 6c20 6578  I adapted all ex
+00012b40: 616d 706c 6573 2069 6e63 6c75 6465 6420  amples included 
+00012b50: 696e 2074 6865 2070 6163 6b61 6765 2074  in the package t
+00012b60: 6f20 7573 6520 7468 6520 6e65 7720 6060  o use the new ``
+00012b70: 7370 735f 7574 696c 6060 2e20 0d0a 2d20  sps_util``. ..- 
+00012b80: 6060 7070 7866 2e70 6c6f 7460 603a 204e  ``ppxf.plot``: N
+00012b90: 6577 206b 6579 776f 7264 2060 606c 616d  ew keyword ``lam
+00012ba0: 5f66 6c61 6d60 6020 746f 2070 6c6f 7420  _flam`` to plot 
+00012bb0: 6060 6c61 6d2a 6628 6c61 6d29 203d 206e  ``lam*f(lam) = n
+00012bc0: 752a 6628 6e75 2960 602e 0d0a 2d20 6060  u*f(nu)``...- ``
+00012bd0: 7070 7866 5f75 7469 6c2e 7379 6e74 6865  ppxf_util.synthe
+00012be0: 7469 635f 7068 6f74 6f6d 6574 7279 6060  tic_photometry``
+00012bf0: 3a20 436f 6e76 6572 7465 6420 6672 6f6d  : Converted from
+00012c00: 2061 2066 756e 6374 696f 6e20 746f 2061   a function to a
+00012c10: 2063 6c61 7373 2e0d 0a20 2041 6464 6564   class...  Added
+00012c20: 2060 602e 6c61 6d5f 7069 7660 6020 6174   ``.lam_piv`` at
+00012c30: 7472 6962 7574 6520 746f 2063 6f6d 7075  tribute to compu
+00012c40: 7465 2074 6865 2070 6976 6f74 2077 6176  te the pivot wav
+00012c50: 656c 656e 6774 6820 6f66 2065 6163 6820  elength of each 
+00012c60: 6669 6c74 6572 2e0d 0a2d 2060 6070 7078  filter...- ``ppx
+00012c70: 665f 7574 696c 2e76 6172 736d 6f6f 7468  f_util.varsmooth
+00012c80: 6060 3a20 5370 6563 6961 6c69 7a65 6420  ``: Specialized 
+00012c90: 6661 7374 6572 2063 6f6e 766f 6c75 7469  faster convoluti
+00012ca0: 6f6e 2069 6620 7369 676d 6120 6973 2061  on if sigma is a
+00012cb0: 2073 6361 6c61 722e 0d0a 2020 7768 696c   scalar...  whil
+00012cc0: 6520 7573 696e 6720 7468 6520 616e 616c  e using the anal
+00012cd0: 7974 6963 2046 6f75 7269 6572 2074 7261  ytic Fourier tra
+00012ce0: 6e73 666f 726d 2074 6f20 6465 616c 2077  nsform to deal w
+00012cf0: 6974 6820 756e 6465 7273 616d 706c 696e  ith undersamplin
+00012d00: 672e 0d0a 2d20 6060 7070 7866 6060 3a20  g...- ``ppxf``: 
+00012d10: 5261 6973 6564 2061 6e20 6572 726f 7220  Raised an error 
+00012d20: 6966 2060 6070 686f 7460 6020 696e 7075  if ``phot`` inpu
+00012d30: 7420 6973 206e 6f74 2066 696e 6974 652e  t is not finite.
+00012d40: 0d0a 0d0a 5638 2e32 2e36 3a20 4d43 2c20  ....V8.2.6: MC, 
+00012d50: 4f78 666f 7264 2c20 3620 4a75 6c79 2032  Oxford, 6 July 2
+00012d60: 3032 330d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  023..+++++++++++
+00012d70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00012d80: 2b2b 2b2b 0d0a 0d0a 2d20 6060 6361 7066  ++++....- ``capf
+00012d90: 6974 6060 3a20 5265 6c61 7865 6420 746f  it``: Relaxed to
+00012da0: 6c65 7261 6e63 6520 7768 656e 2063 6865  lerance when che
+00012db0: 636b 696e 6720 696e 6974 6961 6c20 6775  cking initial gu
+00012dc0: 6573 7320 6665 6173 6962 696c 6974 792e  ess feasibility.
+00012dd0: 0d0a 2d20 6060 7070 7866 5f75 7469 6c60  ..- ``ppxf_util`
+00012de0: 603a 2046 6978 6564 2070 726f 6772 616d  `: Fixed program
+00012df0: 2073 746f 7020 696e 2060 6067 6175 7373   stop in ``gauss
+00012e00: 6961 6e5f 6669 6c74 6572 3164 6060 2077  ian_filter1d`` w
+00012e10: 6865 6e20 6060 7369 673d 3060 602e 0d0a  hen ``sig=0``...
+00012e20: 2020 5468 616e 6b73 2074 6f20 4a65 7373    Thanks to Jess
+00012e30: 6520 5661 6e20 6465 2053 616e 6465 2028  e Van de Sande (
+00012e40: 7379 646e 6579 2e65 6475 2e61 7529 2066  sydney.edu.au) f
+00012e50: 6f72 2074 6865 2072 6570 6f72 742e 0d0a  or the report...
+00012e60: 0d0a 5638 2e32 2e34 3a20 4d43 2c20 4f78  ..V8.2.4: MC, Ox
+00012e70: 666f 7264 2c20 3132 204d 6179 2032 3032  ford, 12 May 202
+00012e80: 330d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  3..+++++++++++++
+00012e90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00012ea0: 2b2b 0d0a 0d0a 2d20 6060 7070 7866 6060  ++....- ``ppxf``
+00012eb0: 3a20 4669 7865 6420 696e 636f 7272 6563  : Fixed incorrec
+00012ec0: 746c 7920 7377 6974 6368 696e 6720 746f  tly switching to
+00012ed0: 2060 606d 6574 686f 643d 276c 696e 6561   ``method='linea
+00012ee0: 7227 6060 2077 6865 6e20 7265 7175 6573  r'`` when reques
+00012ef0: 7469 6e67 0d0a 2020 746f 2066 6974 2073  ting..  to fit s
+00012f00: 7465 6c6c 6172 2072 6564 6465 6e69 6e67  tellar reddening
+00012f10: 2061 6c6f 6e65 2c20 7768 696c 6520 616c   alone, while al
+00012f20: 6c20 6f74 6865 7220 7061 7261 6d65 7465  l other paramete
+00012f30: 7273 2061 7265 2066 6978 6564 2e20 5468  rs are fixed. Th
+00012f40: 616e 6b73 0d0a 2020 746f 204a 6f6e 6720  anks..  to Jong 
+00012f50: 4368 756c 204c 6565 2028 6b61 7369 2e72  Chul Lee (kasi.r
+00012f60: 652e 6b72 2920 666f 7220 6120 636c 6561  e.kr) for a clea
+00012f70: 7220 6578 616d 706c 6520 6f66 2072 6570  r example of rep
+00012f80: 726f 6475 6369 6e67 2074 6865 2062 7567  roducing the bug
+00012f90: 2e0d 0a0d 0a56 382e 322e 333a 204d 432c  .....V8.2.3: MC,
+00012fa0: 204f 7866 6f72 642c 2035 204a 616e 7561   Oxford, 5 Janua
+00012fb0: 7279 2032 3032 330d 0a2b 2b2b 2b2b 2b2b  ry 2023..+++++++
+00012fc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00012fd0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+00012fe0: 2060 6070 7078 6660 603a 2046 6978 6564   ``ppxf``: Fixed
+00012ff0: 2070 726f 6772 616d 2073 746f 7020 7768   program stop wh
+00013000: 656e 2066 6974 7469 6e67 2062 6f74 6820  en fitting both 
+00013010: 736b 7920 7370 6563 7472 6120 616e 6420  sky spectra and 
+00013020: 6761 7320 656d 6973 7369 6f6e 0d0a 2020  gas emission..  
+00013030: 6c69 6e65 732e 204d 616e 7920 7468 616e  lines. Many than
+00013040: 6b73 2074 6f20 4164 6172 7368 2052 616e  ks to Adarsh Ran
+00013050: 6a61 6e20 286b 6173 692e 7265 2e6b 7229  jan (kasi.re.kr)
+00013060: 2066 6f72 2061 2063 6c65 6172 2065 7861   for a clear exa
+00013070: 6d70 6c65 0d0a 2020 6f66 2072 6570 726f  mple..  of repro
+00013080: 6475 6369 6e67 2074 6865 2070 726f 626c  ducing the probl
+00013090: 656d 2061 6e64 2066 6f72 2074 6865 2062  em and for the b
+000130a0: 7567 2066 6978 2e0d 0a2d 2060 6070 7078  ug fix...- ``ppx
+000130b0: 6660 603a 2052 6169 7365 2061 6e20 6572  f``: Raise an er
+000130c0: 726f 7220 6966 2060 6076 656c 7363 616c  ror if ``velscal
+000130d0: 6560 6020 6973 206e 6f74 2061 2073 6361  e`` is not a sca
+000130e0: 6c61 722e 2055 7064 6174 6564 2065 7861  lar. Updated exa
+000130f0: 6d70 6c65 0d0a 2020 7072 6f63 6564 7572  mple..  procedur
+00013100: 6573 2e20 5468 6973 2066 6978 6573 2061  es. This fixes a
+00013110: 2070 726f 6772 616d 2073 746f 7020 6475   program stop du
+00013120: 6520 746f 2061 2063 6861 6e67 6520 696e  e to a change in
+00013130: 204e 756d 5079 2031 2e32 342e 0d0a 2d20   NumPy 1.24...- 
+00013140: 6060 7070 7866 5f75 7469 6c60 603a 2043  ``ppxf_util``: C
+00013150: 6861 6e67 6564 2060 606c 6f67 5f72 6562  hanged ``log_reb
+00013160: 696e 6060 2074 6f20 7265 7475 726e 2060  in`` to return `
+00013170: 6076 656c 7363 616c 6560 6020 6173 2061  `velscale`` as a
+00013180: 2073 6361 6c61 722e 0d0a 2d20 4e65 7720   scalar...- New 
+00013190: 6578 616d 706c 6520 7072 6f63 6564 7572  example procedur
+000131a0: 6520 6060 7070 7866 5f65 7861 6d70 6c65  e ``ppxf_example
+000131b0: 5f67 6173 5f73 6473 735f 7469 6564 2e70  _gas_sdss_tied.p
+000131c0: 7960 6020 746f 2069 6c6c 7573 7472 6174  y`` to illustrat
+000131d0: 6520 7468 650d 0a20 2075 7365 206f 6620  e the..  use of 
+000131e0: 7468 6520 6060 7469 6564 6060 2061 6e64  the ``tied`` and
+000131f0: 2060 6063 6f6e 7374 725f 6b69 6e65 6d60   ``constr_kinem`
+00013200: 6020 6b65 7977 6f72 6473 2e0d 0a0d 0a56  ` keywords.....V
+00013210: 382e 322e 323a 204d 432c 204f 7866 6f72  8.2.2: MC, Oxfor
+00013220: 642c 2031 3120 4f63 746f 6265 7220 3230  d, 11 October 20
+00013230: 3232 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  22..++++++++++++
+00013240: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00013250: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6070  +++++++....- ``p
+00013260: 7078 6660 603a 2046 6978 6564 2070 726f  pxf``: Fixed pro
+00013270: 6772 616d 2073 746f 7020 7769 7468 2060  gram stop with `
+00013280: 6074 6965 6460 6020 6f72 2060 6066 6978  `tied`` or ``fix
+00013290: 6564 6060 206b 6579 776f 7264 7320 616e  ed`` keywords an
+000132a0: 640d 0a20 206e 6f6e 6c69 6e65 6172 2076  d..  nonlinear v
+000132b0: 6172 6961 626c 6573 2069 6e20 6164 6469  ariables in addi
+000132c0: 7469 6f6e 2074 6f20 7468 6520 6b69 6e65  tion to the kine
+000132d0: 6d61 7469 6373 2e20 5468 616e 6b73 2074  matics. Thanks t
+000132e0: 6f20 546f 6269 6173 204c 6f6f 7365 720d  o Tobias Looser.
+000132f0: 0a20 2028 6361 6d2e 6163 2e75 6b29 2066  .  (cam.ac.uk) f
+00013300: 6f72 2074 6865 2072 6570 6f72 7420 616e  or the report an
+00013310: 6420 6669 782e 0d0a 0d0a 5638 2e32 2e31  d fix.....V8.2.1
+00013320: 3a20 4d43 2c20 4f78 666f 7264 2c20 3320  : MC, Oxford, 3 
+00013330: 5365 7074 656d 6265 7220 3230 3232 0d0a  September 2022..
+00013340: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00013350: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00013360: 2b2b 2b2b 0d0a 0d0a 2d20 6060 7070 7866  ++++....- ``ppxf
+00013370: 6060 3a20 4e65 7720 6b65 7977 6f72 6420  ``: New keyword 
+00013380: 6060 6475 7374 6060 2077 6869 6368 2061  ``dust`` which a
+00013390: 6c6c 6f77 7320 6f6e 6520 746f 2061 7373  llows one to ass
+000133a0: 6f63 6961 7465 2064 6966 6665 7265 6e74  ociate different
+000133b0: 0d0a 2020 6765 6e65 7261 6c20 6174 7465  ..  general atte
+000133c0: 6e75 6174 696f 6e20 6675 6e63 7469 6f6e  nuation function
+000133d0: 7320 746f 2064 6966 6665 7265 6e74 2073  s to different s
+000133e0: 6574 7320 6f66 2074 656d 706c 6174 6573  ets of templates
+000133f0: 2e20 5468 6973 2069 7320 7573 6566 756c  . This is useful
+00013400: 0d0a 2020 666f 7220 6578 616d 706c 6520  ..  for example 
+00013410: 746f 2061 7070 6c79 2074 6872 6565 2064  to apply three d
+00013420: 6966 6665 7265 6e74 2061 7474 656e 7561  ifferent attenua
+00013430: 7469 6f6e 2066 756e 6374 696f 6e73 2074  tion functions t
+00013440: 6f20 7468 6520 796f 756e 6720 616e 640d  o the young and.
+00013450: 0a20 206f 6c64 2073 7465 6c6c 6172 2074  .  old stellar t
+00013460: 656d 706c 6174 6573 2061 6e64 2074 6f20  emplates and to 
+00013470: 7468 6520 6761 7320 656d 6973 7369 6f6e  the gas emission
+00013480: 206c 696e 6573 2072 6573 7065 6374 6976   lines respectiv
+00013490: 656c 792e 0d0a 2d20 6060 7070 7866 6060  ely...- ``ppxf``
+000134a0: 3a20 5573 6573 2060 6041 5f56 6060 2069  : Uses ``A_V`` i
+000134b0: 6e73 7465 6164 206f 6620 6060 4528 422d  nstead of ``E(B-
+000134c0: 5629 6060 2074 6f20 7061 7261 6d65 7472  V)`` to parametr
+000134d0: 697a 6520 6174 7465 6e75 6174 696f 6e2c  ize attenuation,
+000134e0: 2077 6865 6e0d 0a20 2075 7369 6e67 2074   when..  using t
+000134f0: 6865 206e 6f77 2d6f 6273 6f6c 6574 6520  he now-obsolete 
+00013500: 6b65 7977 6f72 6473 2060 6072 6564 6465  keywords ``redde
+00013510: 6e69 6e67 6060 2061 6e64 2020 6060 6761  ning`` and  ``ga
+00013520: 735f 7265 6464 656e 696e 6760 602e 0d0a  s_reddening``...
+00013530: 2d20 6060 7070 7866 6060 3a20 4e65 7720  - ``ppxf``: New 
+00013540: 6465 6661 756c 7420 6675 6e63 7469 6f6e  default function
+00013550: 2060 6061 7474 656e 7561 7469 6f6e 2829   ``attenuation()
+00013560: 6060 2e20 486f 7765 7665 722c 206f 6e65  ``. However, one
+00013570: 2063 616e 206e 6f77 2075 7365 0d0a 2020   can now use..  
+00013580: 6765 6e65 7261 6c20 6174 7465 6e75 6174  general attenuat
+00013590: 696f 6e20 6675 6e63 7469 6f6e 7320 7769  ion functions wi
+000135a0: 7468 2061 6e20 6172 6269 7472 6172 7920  th an arbitrary 
+000135b0: 6e75 6d62 6572 206f 6620 626f 756e 6420  number of bound 
+000135c0: 6f72 2066 6978 6564 0d0a 2020 7061 7261  or fixed..  para
+000135d0: 6d65 7465 7273 2e0d 0a2d 2060 6070 7078  meters...- ``ppx
+000135e0: 6660 603a 204e 6577 2069 6e74 6572 6e61  f``: New interna
+000135f0: 6c20 6675 6e63 7469 6f6e 7320 6060 7365  l functions ``se
+00013600: 745f 6c61 6d5f 696e 7075 7460 602c 2060  t_lam_input``, `
+00013610: 6073 6574 5f67 6173 5f69 6e70 7574 6060  `set_gas_input``
+00013620: 2c0d 0a20 2060 6073 6574 5f64 7573 745f  ,..  ``set_dust_
+00013630: 696e 7075 7460 602c 2060 6073 6574 5f70  input``, ``set_p
+00013640: 686f 745f 696e 7075 7460 6020 746f 206f  hot_input`` to o
+00013650: 7267 616e 697a 6520 7468 6520 636f 6465  rganize the code
+00013660: 2e0d 0a2d 2060 6070 7078 6660 603a 2049  ...- ``ppxf``: I
+00013670: 6d70 726f 7665 6420 7665 7274 6963 616c  mproved vertical
+00013680: 2073 6361 6c69 6e67 206f 6620 6465 6661   scaling of defa
+00013690: 756c 7420 706c 6f74 732e 0d0a 2d20 6060  ult plots...- ``
+000136a0: 7070 7866 6060 3a20 4e65 7720 6b65 7977  ppxf``: New keyw
+000136b0: 6f72 6473 2060 6070 702e 706c 6f74 2873  ords ``pp.plot(s
+000136c0: 7065 633d 5472 7565 2c20 7068 6f74 3d54  pec=True, phot=T
+000136d0: 7275 6529 6060 2074 6f20 706c 6f74 206f  rue)`` to plot o
+000136e0: 6e6c 7920 7468 650d 0a20 2070 686f 746f  nly the..  photo
+000136f0: 6d65 7472 6963 206f 7220 7370 6563 7472  metric or spectr
+00013700: 6f73 636f 7069 6320 6265 7374 2066 6974  oscopic best fit
+00013710: 7320 7265 7370 6563 7469 7665 6c79 2e0d  s respectively..
+00013720: 0a2d 2060 6070 7078 665f 7574 696c 6060  .- ``ppxf_util``
+00013730: 3a20 4e65 7720 6675 6e63 7469 6f6e 2060  : New function `
+00013740: 6076 6172 736d 6f6f 7468 6060 2066 6f72  `varsmooth`` for
+00013750: 2047 6175 7373 6961 6e20 636f 6e76 6f6c   Gaussian convol
+00013760: 7574 696f 6e20 7769 7468 2061 0d0a 2020  ution with a..  
+00013770: 7661 7269 6162 6c65 2073 6967 6d61 2e20  variable sigma. 
+00013780: 556e 6c69 6b65 2074 6865 2073 696d 696c  Unlike the simil
+00013790: 6172 2060 6067 6175 7373 6961 6e5f 6669  ar ``gaussian_fi
+000137a0: 6c74 6572 3164 6060 2c20 7468 6973 206e  lter1d``, this n
+000137b0: 6577 2066 756e 6374 696f 6e0d 0a20 2075  ew function..  u
+000137c0: 7365 7320 4646 5420 616e 6420 7468 6520  ses FFT and the 
+000137d0: 616e 616c 7974 6963 2046 6f75 7269 6572  analytic Fourier
+000137e0: 2054 7261 6e73 666f 726d 206f 6620 6120   Transform of a 
+000137f0: 4761 7573 7369 616e 2c20 6c69 6b65 2060  Gaussian, like `
+00013800: 6070 7078 6660 602e 0d0a 2d20 6060 7070  `ppxf``...- ``pp
+00013810: 7866 5f75 7469 6c60 603a 2049 6e63 6c75  xf_util``: Inclu
+00013820: 6465 6420 6164 6469 7469 6f6e 616c 2067  ded additional g
+00013830: 6173 2065 6d69 7373 696f 6e20 6c69 6e65  as emission line
+00013840: 7320 696e 2060 6065 6d69 7373 696f 6e5f  s in ``emission_
+00013850: 6c69 6e65 7328 2960 602e 0d0a 2d20 6060  lines()``...- ``
+00013860: 6361 7066 6974 6060 3a20 5573 6520 6060  capfit``: Use ``
+00013870: 7363 6970 792e 6f70 7469 6d69 7a65 2e6c  scipy.optimize.l
+00013880: 696e 7072 6f67 286d 6574 686f 643d 2768  inprog(method='h
+00013890: 6967 6873 2729 6060 2074 6f20 6669 6e64  ighs')`` to find
+000138a0: 2066 6561 7369 626c 650d 0a20 2073 7461   feasible..  sta
+000138b0: 7274 696e 6720 706f 696e 7420 696e 2060  rting point in `
+000138c0: 606c 7371 5f6c 696e 6060 2e20 5468 6973  `lsq_lin``. This
+000138d0: 2065 6c69 6d69 6e61 7465 7320 706f 7373   eliminates poss
+000138e0: 6962 6c65 2070 726f 6772 616d 2073 746f  ible program sto
+000138f0: 7073 2069 6e0d 0a20 2063 6572 7461 696e  ps in..  certain
+00013900: 2073 6974 7561 7469 6f6e 7320 7769 7468   situations with
+00013910: 206c 696e 6561 726c 7920 6465 7065 6e64   linearly depend
+00013920: 656e 7420 636f 6e73 7472 6169 6e74 732e  ent constraints.
+00013930: 0d0a 2d20 6060 6361 7066 6974 6060 3a20  ..- ``capfit``: 
+00013940: 5365 7420 6465 6661 756c 7420 6060 6c69  Set default ``li
+00013950: 6e65 6172 5f6d 6574 686f 643d 276c 7371  near_method='lsq
+00013960: 5f6c 696e 2760 602e 2054 6869 7320 7265  _lin'``. This re
+00013970: 6d6f 7665 7320 7468 6520 6e65 6564 0d0a  moves the need..
+00013980: 2020 746f 2069 6e73 7461 6c6c 2060 6063    to install ``c
+00013990: 7678 6f70 7460 6020 7768 656e 2075 7369  vxopt`` when usi
+000139a0: 6e67 2060 6063 6f6e 7374 725f 6b69 6e65  ng ``constr_kine
+000139b0: 6d60 6020 696e 2060 6070 5058 4660 602e  m`` in ``pPXF``.
+000139c0: 0d0a 0d0a 5638 2e31 2e30 3a20 4d43 2c20  ....V8.1.0: MC, 
+000139d0: 4f78 666f 7264 2c20 3130 204a 756e 6520  Oxford, 10 June 
+000139e0: 3230 3232 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2022..++++++++++
+000139f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00013a00: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060 7070  ++++++....- ``pp
+00013a10: 7866 6060 3a20 4d6f 7265 2061 6363 7572  xf``: More accur
+00013a20: 6174 6520 6465 7465 726d 696e 6174 696f  ate determinatio
+00013a30: 6e20 6f66 2074 6865 2072 616e 6765 2066  n of the range f
+00013a40: 6f72 2074 7275 6e63 6174 696e 6720 7468  or truncating th
+00013a50: 650d 0a20 2074 656d 706c 6174 6573 2077  e..  templates w
+00013a60: 6865 6e20 7061 7373 696e 6720 626f 7468  hen passing both
+00013a70: 2060 606c 616d 5f74 656d 7060 6020 616e   ``lam_temp`` an
+00013a80: 6420 6060 6c61 6d60 602e 0d0a 2d20 6060  d ``lam``...- ``
+00013a90: 7070 7866 6060 3a20 4368 6563 6b20 666f  ppxf``: Check fo
+00013aa0: 7220 6060 6c61 6d60 6020 6f72 2060 606c  r ``lam`` or ``l
+00013ab0: 616d 5f74 656d 7060 6020 636f 6e73 6973  am_temp`` consis
+00013ac0: 7465 6e63 7920 7769 7468 2060 6076 656c  tency with ``vel
+00013ad0: 7363 616c 6560 6020 616e 640d 0a20 2072  scale`` and..  r
+00013ae0: 6574 7572 6e20 616e 2065 7272 6f72 2069  eturn an error i
+00013af0: 6620 7468 6579 2064 6f20 6e6f 7420 6d61  f they do not ma
+00013b00: 7463 682e 0d0a 2d20 6060 7070 7866 6060  tch...- ``ppxf``
+00013b10: 3a20 5573 6520 6d69 6372 6f6d 6574 7265  : Use micrometre
+00013b20: 2075 6e69 7473 2061 6e64 2064 656e 7365   units and dense
+00013b30: 7220 7469 636b 206c 6162 656c 7320 666f  r tick labels fo
+00013b40: 7220 7468 6520 6c6f 6761 7269 7468 6d69  r the logarithmi
+00013b50: 630d 0a20 2077 6176 656c 656e 6774 6820  c..  wavelength 
+00013b60: 6178 6973 2e0d 0a2d 2060 6070 7078 665f  axis...- ``ppxf_
+00013b70: 7574 696c 2e73 796e 7468 6574 6963 5f70  util.synthetic_p
+00013b80: 686f 746f 6d65 7472 7960 603a 206d 6f76  hotometry``: mov
+00013b90: 6564 2066 726f 6d20 6060 6d69 6c65 735f  ed from ``miles_
+00013ba0: 7574 696c 6060 2061 6e64 206d 6164 6520  util`` and made 
+00013bb0: 6974 0d0a 2020 696e 6465 7065 6e64 656e  it..  independen
+00013bc0: 7420 6f66 2074 6865 2073 7465 6c6c 6172  t of the stellar
+00013bd0: 206c 6962 7261 7279 2e20 4164 6f70 7465   library. Adopte
+00013be0: 6420 7468 6520 7361 6d65 2066 696c 7465  d the same filte
+00013bf0: 7220 6669 6c65 2066 6f72 6d61 7420 6173  r file format as
+00013c00: 0d0a 2020 4541 5a59 2c20 4641 5354 2c20  ..  EAZY, FAST, 
+00013c10: 4879 7065 725a 2e2e 2e20 666f 7220 696e  HyperZ... for in
+00013c20: 7465 726f 7065 7261 6269 6c69 7479 2e0d  teroperability..
+00013c30: 0a20 2041 6c6c 6f77 2070 6173 7369 6e67  .  Allow passing
+00013c40: 2061 2066 696c 6520 7769 7468 2075 7365   a file with use
+00013c50: 722d 6465 6669 6e65 6420 6669 6c74 6572  r-defined filter
+00013c60: 2072 6573 706f 6e73 6520 6675 6e63 7469   response functi
+00013c70: 6f6e 732e 0d0a 2d20 6060 7070 7866 5f75  ons...- ``ppxf_u
+00013c80: 7469 6c2e 6c6f 675f 7265 6269 6e60 603a  til.log_rebin``:
+00013c90: 2053 7570 706f 7274 2069 7272 6567 756c   Support irregul
+00013ca0: 6172 6c79 2073 616d 706c 6564 2069 6e70  arly sampled inp
+00013cb0: 7574 2077 6176 656c 656e 6774 682e 0d0a  ut wavelength...
+00013cc0: 2d20 6060 7070 7866 5f75 7469 6c2e 6761  - ``ppxf_util.ga
+00013cd0: 7573 7369 616e 5f66 696c 7465 7231 6460  ussian_filter1d`
+00013ce0: 603a 204e 6577 206b 6579 776f 7264 2060  `: New keyword `
+00013cf0: 606d 6f64 653d 2763 6f6e 7374 616e 7427  `mode='constant'
+00013d00: 6060 206f 720d 0a20 2060 606d 6f64 653d  `` or..  ``mode=
+00013d10: 2777 7261 7027 6060 2e0d 0a2d 2055 7064  'wrap'``...- Upd
+00013d20: 6174 6564 2060 6070 7078 665f 6578 616d  ated ``ppxf_exam
+00013d30: 706c 655f 706f 7075 6c61 7469 6f6e 5f70  ple_population_p
+00013d40: 686f 746f 6d65 7472 792e 7079 6060 0d0a  hotometry.py``..
+00013d50: 0d0a 5638 2e30 2e32 3a20 4d43 2c20 4f78  ..V8.0.2: MC, Ox
+00013d60: 666f 7264 2c20 3238 204d 6172 6368 2032  ford, 28 March 2
+00013d70: 3032 320d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  022..+++++++++++
+00013d80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00013d90: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060 7070  ++++++....- ``pp
+00013da0: 7866 6060 3a20 416c 6c6f 7720 6669 7474  xf``: Allow fitt
+00013db0: 696e 6720 7068 6f74 6f6d 6574 7269 6320  ing photometric 
+00013dc0: 6d65 6173 7572 656d 656e 7473 2028 5345  measurements (SE
+00013dd0: 4420 6669 7474 696e 6729 2074 6f67 6574  D fitting) toget
+00013de0: 6865 7220 7769 7468 0d0a 2020 6120 7370  her with..  a sp
+00013df0: 6563 7472 756d 2e20 5468 6973 2069 7320  ectrum. This is 
+00013e00: 696d 706c 656d 656e 7465 6420 7669 6120  implemented via 
+00013e10: 7468 6520 6e65 7720 6b65 7977 6f72 6420  the new keyword 
+00013e20: 6060 7068 6f74 6060 2070 6173 7369 6e67  ``phot`` passing
+00013e30: 2061 0d0a 2020 6469 6374 696f 6e61 7279   a..  dictionary
+00013e40: 206f 6620 7061 7261 6d65 7465 7273 2e0d   of parameters..
+00013e50: 0a2d 2060 6070 7078 6660 603a 2070 6c6f  .- ``ppxf``: plo
+00013e60: 7420 7068 6f74 6f6d 6574 7269 6320 6669  t photometric fi
+00013e70: 7420 746f 6765 7468 6572 2077 6974 6820  t together with 
+00013e80: 7370 6563 7472 756d 2077 6865 6e20 6669  spectrum when fi
+00013e90: 7474 696e 670d 0a20 2070 686f 746f 6d65  tting..  photome
+00013ea0: 7472 792e 0d0a 2d20 6060 7070 7866 6060  try...- ``ppxf``
+00013eb0: 3a20 4e65 7720 6b65 7977 6f72 6420 6060  : New keyword ``
+00013ec0: 6c61 6d5f 7465 6d70 6060 2074 6f20 696e  lam_temp`` to in
+00013ed0: 7075 7420 7468 6520 7465 6d70 6c61 7465  put the template
+00013ee0: 7320 7761 7665 6c65 6e67 7468 2e20 5768  s wavelength. Wh
+00013ef0: 656e 0d0a 2020 7468 6973 2069 7320 6769  en..  this is gi
+00013f00: 7665 6e2c 2074 6f67 6574 6865 7220 7769  ven, together wi
+00013f10: 7468 2074 6865 2067 616c 6178 7920 7761  th the galaxy wa
+00013f20: 7665 6c65 6e67 7468 2060 606c 616d 6060  velength ``lam``
+00013f30: 2c20 7468 6520 7465 6d70 6c61 7465 7320  , the templates 
+00013f40: 6172 650d 0a20 2061 7574 6f6d 6174 6963  are..  automatic
+00013f50: 616c 6c79 2074 7275 6e63 6174 6564 2074  ally truncated t
+00013f60: 6f20 616e 206f 7074 696d 616c 2077 6176  o an optimal wav
+00013f70: 656c 656e 6774 6820 7261 6e67 652c 2061  elength range, a
+00013f80: 6e64 2069 7420 6265 636f 6d65 730d 0a20  nd it becomes.. 
+00013f90: 2075 6e6e 6563 6573 7361 7279 2074 6f20   unnecessary to 
+00013fa0: 7573 6520 7468 6520 6b65 7977 6f72 6420  use the keyword 
+00013fb0: 6060 7673 7973 7460 602e 0d0a 2d20 6060  ``vsyst``...- ``
+00013fc0: 7070 7866 6060 3a20 5761 726e 696e 6720  ppxf``: Warning 
+00013fd0: 6966 2060 6074 656d 706c 6174 6573 6060  if ``templates``
+00013fe0: 2061 7265 2060 603e 2032 7860 6020 6c6f   are ``> 2x`` lo
+00013ff0: 6e67 6572 2074 6861 6e20 6060 6761 6c61  nger than ``gala
+00014000: 7879 6060 2e0d 0a2d 2060 6070 7078 6660  xy``...- ``ppxf`
+00014010: 603a 2057 6865 6e20 6669 7474 696e 6720  `: When fitting 
+00014020: 7068 6f74 6f6d 6574 7279 206f 6e65 2063  photometry one c
+00014030: 616e 2069 6e70 7574 2065 7874 656e 6465  an input extende
+00014040: 6420 7465 6d70 6c61 7465 2073 7065 6374  d template spect
+00014050: 7261 2074 6f0d 0a20 206f 7665 7270 6c6f  ra to..  overplo
+00014060: 7420 7468 6520 6578 7472 6170 6f6c 6174  t the extrapolat
+00014070: 6564 2062 6573 742d 6669 7420 7370 6563  ed best-fit spec
+00014080: 7472 756d 2074 6f67 6574 6865 7220 7769  trum together wi
+00014090: 7468 2074 6865 2070 686f 746f 6d65 7472  th the photometr
+000140a0: 792e 0d0a 2d20 4e65 7720 6465 6d6f 2066  y...- New demo f
+000140b0: 696c 6520 6f6e 2070 686f 746f 6d65 7472  ile on photometr
+000140c0: 6963 2066 6974 7469 6e67 0d0a 2020 6060  ic fitting..  ``
+000140d0: 7070 7866 5f65 7861 6d70 6c65 5f70 6f70  ppxf_example_pop
+000140e0: 756c 6174 696f 6e5f 7068 6f74 6f6d 6574  ulation_photomet
+000140f0: 7279 2e70 7960 602e 0d0a 2d20 6060 6d69  ry.py``...- ``mi
+00014100: 6c65 735f 7574 696c 2e70 686f 746f 6d65  les_util.photome
+00014110: 7472 795f 6672 6f6d 5f74 6162 6c65 6060  try_from_table``
+00014120: 3a20 4e65 7720 6578 616d 706c 6520 6675  : New example fu
+00014130: 6e63 7469 6f6e 2074 6f20 696c 6c75 7374  nction to illust
+00014140: 7261 7465 2074 6865 0d0a 2020 6765 6e65  rate the..  gene
+00014150: 7261 7469 6f6e 206f 6620 7468 6520 696e  ration of the in
+00014160: 7075 7420 7068 6f74 6f6d 6574 7269 6320  put photometric 
+00014170: 7465 6d70 6c61 7465 7320 666f 7220 7468  templates for th
+00014180: 6520 6060 7068 6f74 6060 206b 6579 776f  e ``phot`` keywo
+00014190: 7264 2c20 7573 696e 670d 0a20 2074 6162  rd, using..  tab
+000141a0: 756c 6174 6564 2053 5350 206d 6f64 656c  ulated SSP model
+000141b0: 206d 6167 6e69 7475 6465 732e 0d0a 2d20   magnitudes...- 
+000141c0: 6060 6d69 6c65 735f 7574 696c 2e70 686f  ``miles_util.pho
+000141d0: 746f 6d65 7472 795f 6672 6f6d 5f73 7065  tometry_from_spe
+000141e0: 6374 7261 6060 3a20 4e65 7720 6578 616d  ctra``: New exam
+000141f0: 706c 6520 6675 6e63 7469 6f6e 2074 6f20  ple function to 
+00014200: 696c 6c75 7374 7261 7465 0d0a 2020 7468  illustrate..  th
+00014210: 6520 6765 6e65 7261 7469 6f6e 206f 6620  e generation of 
+00014220: 7068 6f74 6f6d 6574 7269 6320 7465 6d70  photometric temp
+00014230: 6c61 7465 7320 6672 6f6d 2074 6865 2073  lates from the s
+00014240: 7065 6374 7261 2075 7369 6e67 2066 696c  pectra using fil
+00014250: 7465 720d 0a20 2072 6573 706f 6e73 6573  ter..  responses
+00014260: 2e0d 0a2d 2052 6570 6c61 6365 6420 4d49  ...- Replaced MI
+00014270: 4c45 5320 7370 6563 7472 616c 206d 6f64  LES spectral mod
+00014280: 656c 7320 6f66 2056 617a 6465 6b69 7320  els of Vazdekis 
+00014290: 6574 2061 6c2e 2028 3230 3130 2920 7769  et al. (2010) wi
+000142a0: 7468 2045 2d4d 494c 4553 206d 6f64 656c  th E-MILES model
+000142b0: 730d 0a20 206f 6620 5661 7a64 656b 6973  s..  of Vazdekis
+000142c0: 2065 7420 616c 2e20 2832 3031 3629 2e20   et al. (2016). 
+000142d0: 5468 616e 6b73 2074 6f20 416c 6578 616e  Thanks to Alexan
+000142e0: 6472 6520 5661 7a64 656b 6973 2028 6961  dre Vazdekis (ia
+000142f0: 632e 6573 2920 666f 7220 7468 650d 0a20  c.es) for the.. 
+00014300: 2070 6572 6d69 7373 696f 6e2e 0d0a 2d20   permission...- 
+00014310: 4164 6170 7465 6420 616c 6c20 6060 7050  Adapted all ``pP
+00014320: 5846 6060 2065 7861 6d70 6c65 7320 746f  XF`` examples to
+00014330: 2075 7365 2074 6865 2045 2d4d 494c 4553   use the E-MILES
+00014340: 2074 656d 706c 6174 6573 2e0d 0a2d 2060   templates...- `
+00014350: 606d 696c 6573 5f75 7469 6c2e 6d69 6c65  `miles_util.mile
+00014360: 7360 603a 2063 6861 6e67 6564 206e 616d  s``: changed nam
+00014370: 6573 206f 6620 6f75 7470 7574 2077 6176  es of output wav
+00014380: 656c 656e 6774 6820 6060 2e6c 6e5f 6c61  elength ``.ln_la
+00014390: 6d5f 7465 6d70 6060 2074 6f0d 0a20 206d  m_temp`` to..  m
+000143a0: 616b 6520 636c 6561 7220 7468 6579 2072  ake clear they r
+000143b0: 6570 7265 7365 6e74 206e 6174 7572 616c  epresent natural
+000143c0: 206c 6f67 6172 6974 686d 732e 0d0a 2d20   logarithms...- 
+000143d0: 6060 6d69 6c65 735f 7574 696c 2e6d 696c  ``miles_util.mil
+000143e0: 6573 6060 3a20 7365 7420 6060 4657 484d  es``: set ``FWHM
+000143f0: 5f67 616c 3d4e 6f6e 6560 6020 746f 2073  _gal=None`` to s
+00014400: 6b69 7020 7465 6d70 6c61 7465 7320 636f  kip templates co
+00014410: 6e76 6f6c 7574 696f 6e2e 0d0a 2d20 6060  nvolution...- ``
+00014420: 7070 7866 6060 3a20 4f70 7469 6f6e 616c  ppxf``: Optional
+00014430: 6c79 2070 6572 666f 726d 7320 676c 6f62  ly performs glob
+00014440: 616c 206f 7074 696d 697a 6174 696f 6e20  al optimization 
+00014450: 6f66 2074 6865 206e 6f6e 2d6c 696e 6561  of the non-linea
+00014460: 720d 0a20 2070 6172 616d 6574 6572 732e  r..  parameters.
+00014470: 2054 6869 7320 6973 2069 6d70 6c65 6d65   This is impleme
+00014480: 6e74 6564 2076 6961 2074 6865 206e 6577  nted via the new
+00014490: 206b 6579 776f 7264 2060 6067 6c6f 6261   keyword ``globa
+000144a0: 6c5f 7365 6172 6368 6060 2e0d 0a2d 2060  l_search``...- `
+000144b0: 6070 7078 6660 603a 2041 6c6c 6f77 2074  `ppxf``: Allow t
+000144c0: 6865 2075 7365 206f 6620 6d75 6c74 6970  he use of multip
+000144d0: 6c69 6361 7469 7665 2070 6f6c 796e 6f6d  licative polynom
+000144e0: 6961 6c73 2074 6f67 6574 6865 7220 7769  ials together wi
+000144f0: 7468 0d0a 2020 7265 6464 656e 696e 672e  th..  reddening.
+00014500: 0d0a 2d20 6060 7070 7866 6060 3a20 506c  ..- ``ppxf``: Pl
+00014510: 6f74 2069 6e64 6976 6964 7561 6c20 6761  ot individual ga
+00014520: 7320 656d 6973 7369 6f6e 2063 6f6d 706f  s emission compo
+00014530: 6e65 6e74 7320 696e 2061 6464 6974 696f  nents in additio
+00014540: 6e20 746f 2074 6865 6972 2073 756d 2e0d  n to their sum..
+00014550: 0a2d 2060 6070 7078 6660 603a 2055 7064  .- ``ppxf``: Upd
+00014560: 6174 6564 2064 6f63 7374 7269 6e67 2064  ated docstring d
+00014570: 6f63 756d 656e 7461 7469 6f6e 2066 6f72  ocumentation for
+00014580: 2074 6865 206e 6577 2066 6561 7475 7265   the new feature
+00014590: 732e 0d0a 2d20 6060 6361 7066 6974 6060  s...- ``capfit``
+000145a0: 3a20 436f 6d70 6c65 7465 6c79 2072 656d  : Completely rem
+000145b0: 6f76 6564 2074 6965 642f 6669 7865 6420  oved tied/fixed 
+000145c0: 7661 7269 6162 6c65 7320 6672 6f6d 2074  variables from t
+000145d0: 6865 206f 7074 696d 697a 6174 696f 6e20  he optimization 
+000145e0: 616e 640d 0a20 2063 6f6e 7374 7261 696e  and..  constrain
+000145f0: 7473 2e20 5468 6973 2069 6d70 726f 7665  ts. This improve
+00014600: 7320 7468 6520 636f 6e64 6974 696f 6e69  s the conditioni
+00014610: 6e67 206f 6620 7468 6520 4a61 636f 6269  ng of the Jacobi
+00014620: 616e 2061 6e64 2066 7572 7468 6572 0d0a  an and further..
+00014630: 2020 7374 7265 6e67 7468 656e 7320 7468    strengthens th
+00014640: 6520 726f 6275 7374 6e65 7373 206f 6620  e robustness of 
+00014650: 7468 6520 6f70 7469 6d69 7a61 7469 6f6e  the optimization
+00014660: 2e0d 0a2d 2060 606d 696c 6573 5f75 7469  ...- ``miles_uti
+00014670: 6c60 603a 2066 6978 6564 2060 6066 6c75  l``: fixed ``flu
+00014680: 7860 6020 6172 7261 7920 6d69 736d 6174  x`` array mismat
+00014690: 6368 2077 6865 6e20 7573 696e 6720 6060  ch when using ``
+000146a0: 6167 655f 7261 6e67 6560 6020 6f72 0d0a  age_range`` or..
+000146b0: 2020 6060 6d65 7461 6c5f 7261 6e67 6560    ``metal_range`
+000146c0: 602e 2054 6861 6e6b 7320 746f 2044 6176  `. Thanks to Dav
+000146d0: 6964 6520 4265 7661 6371 7561 2028 696e  ide Bevacqua (in
+000146e0: 6166 2e69 7429 2066 6f72 2074 6865 2072  af.it) for the r
+000146f0: 6570 6f72 742e 0d0a 2d20 6060 7070 7866  eport...- ``ppxf
+00014700: 6060 3a20 4669 7865 6420 7072 6f67 7261  ``: Fixed progra
+00014710: 6d20 7374 6f70 2077 6865 6e20 6669 7474  m stop when fitt
+00014720: 696e 6720 6761 7320 7769 7468 2061 2074  ing gas with a t
+00014730: 656d 706c 6174 6520 6c65 6e67 7468 2074  emplate length t
+00014740: 6861 7420 6973 0d0a 2020 6e6f 7420 6120  hat is..  not a 
+00014750: 6d75 6c74 6970 6c65 206f 6620 6060 7665  multiple of ``ve
+00014760: 6c73 6361 6c65 5f72 6174 696f 6060 2e0d  lscale_ratio``..
+00014770: 0a0d 0a56 372e 342e 353a 204d 432c 204f  ...V7.4.5: MC, O
+00014780: 7866 6f72 642c 2031 3620 4a75 6c79 2032  xford, 16 July 2
+00014790: 3032 310d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  021..+++++++++++
+000147a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000147b0: 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6070 7078  +++++....- ``ppx
+000147c0: 6660 603a 204e 6577 206b 6579 776f 7264  f``: New keyword
+000147d0: 2060 6070 702e 706c 6f74 2863 6c69 705f   ``pp.plot(clip_
+000147e0: 6761 733d 5472 7565 2960 6020 746f 2069  gas=True)`` to i
+000147f0: 676e 6f72 6520 7468 6520 6761 7320 656d  gnore the gas em
+00014800: 6973 7369 6f6e 0d0a 2020 6c69 6e65 7320  ission..  lines 
+00014810: 7768 696c 6520 6465 7465 726d 696e 696e  while determinin
+00014820: 6720 7468 6520 706c 6f74 7469 6e67 2072  g the plotting r
+00014830: 616e 6765 7320 666f 7220 7468 6520 6265  anges for the be
+00014840: 7374 2d66 6974 7469 6e67 206d 6f64 656c  st-fitting model
+00014850: 2e0d 0a2d 2060 606d 696c 6573 5f75 7469  ...- ``miles_uti
+00014860: 6c60 603a 204e 6577 2061 7474 7269 6275  l``: New attribu
+00014870: 7465 2060 602e 666c 7578 6060 2074 6f20  te ``.flux`` to 
+00014880: 636f 6e76 6572 7420 6265 7477 6565 6e20  convert between 
+00014890: 6c69 6768 742d 7765 6967 6874 6564 0d0a  light-weighted..
+000148a0: 2020 616e 6420 6d61 7373 2d77 6569 6768    and mass-weigh
+000148b0: 7465 6420 7374 656c 6c61 7220 706f 7075  ted stellar popu
+000148c0: 6c61 7469 6f6e 2071 7561 6e74 6974 6965  lation quantitie
+000148d0: 732e 2055 7064 6174 6564 2074 6865 2063  s. Updated the c
+000148e0: 6f72 7265 7370 6f6e 6469 6e67 0d0a 2020  orresponding..  
+000148f0: 646f 6375 6d65 6e74 6174 696f 6e20 696e  documentation in
+00014900: 2074 6865 2064 6f63 7374 7269 6e67 2e0d   the docstring..
+00014910: 0a2d 2060 6070 7078 665f 6578 616d 706c  .- ``ppxf_exampl
+00014920: 655f 706f 7075 6c61 7469 6f6e 5f67 6173  e_population_gas
+00014930: 5f73 6473 7360 603a 2053 686f 7720 686f  _sdss``: Show ho
+00014940: 7720 746f 2063 6f6e 7665 7274 2062 6574  w to convert bet
+00014950: 7765 656e 206c 6967 6874 2d77 6569 6768  ween light-weigh
+00014960: 7465 640d 0a20 2061 6e64 206d 6173 732d  ted..  and mass-
+00014970: 7765 6967 6874 6564 2073 7465 6c6c 6172  weighted stellar
+00014980: 2070 6f70 756c 6174 696f 6e20 7573 696e   population usin
+00014990: 6720 7468 6520 6e65 7720 6060 6d69 6c65  g the new ``mile
+000149a0: 732e 666c 7578 6060 2061 7474 7269 6275  s.flux`` attribu
+000149b0: 7465 2e0d 0a2d 2060 6070 7078 665f 7574  te...- ``ppxf_ut
+000149c0: 696c 2e6c 6f67 5f72 6562 696e 6060 3a20  il.log_rebin``: 
+000149d0: 7375 7070 6f72 7420 6661 7374 206c 6f67  support fast log
+000149e0: 2072 6562 696e 6e69 6e67 206f 6620 616c   rebinning of al
+000149f0: 6c20 636f 6c75 6d6e 7320 6f66 2032 2d64  l columns of 2-d
+00014a00: 696d 2061 7272 6179 732e 0d0a 0d0a 5637  im arrays.....V7
+00014a10: 2e34 2e34 3a20 4d43 2c20 4f78 666f 7264  .4.4: MC, Oxford
+00014a20: 2c20 3130 2046 6562 7275 6172 7920 3230  , 10 February 20
+00014a30: 3231 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  21..++++++++++++
+00014a40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00014a50: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060  ++++++++....- ``
+00014a60: 7070 7866 6060 3a20 4d6f 7265 2072 6f62  ppxf``: More rob
+00014a70: 7573 7420 6d61 7472 6978 2073 6361 6c69  ust matrix scali
+00014a80: 6e67 2077 6865 6e20 7573 696e 6720 6c69  ng when using li
+00014a90: 6e65 6172 2065 7175 616c 6974 7920 636f  near equality co
+00014aa0: 6e73 7472 6169 6e74 730d 0a20 2069 6e20  nstraints..  in 
+00014ab0: 6060 636f 6e73 7472 5f74 656d 706c 6060  ``constr_templ``
+00014ac0: 2077 6974 6820 6060 6c69 6e65 6172 5f6d   with ``linear_m
+00014ad0: 6574 686f 643d 276c 7371 5f62 6f78 2760  ethod='lsq_box'`
+00014ae0: 602e 2054 6861 6e6b 7320 746f 2053 6872  `. Thanks to Shr
+00014af0: 6176 616e 2053 6865 7474 790d 0a20 2028  avan Shetty..  (
+00014b00: 706b 752e 6564 752e 636e 2920 666f 7220  pku.edu.cn) for 
+00014b10: 6120 6465 7461 696c 6564 2072 6570 6f72  a detailed repor
+00014b20: 7420 616e 6420 666f 7220 7465 7374 696e  t and for testin
+00014b30: 6720 6d79 2066 6978 2e0d 0a0d 0a56 372e  g my fix.....V7.
+00014b40: 342e 333a 204d 432c 204f 7866 6f72 642c  4.3: MC, Oxford,
+00014b50: 2032 3120 4465 6365 6d62 6572 2032 3032   21 December 202
+00014b60: 300d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  0..+++++++++++++
+00014b70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00014b80: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6063  +++++++....- ``c
+00014b90: 6170 6669 7460 603a 204e 6577 2060 606c  apfit``: New ``l
+00014ba0: 696e 6561 725f 6d65 7468 6f64 6060 206b  inear_method`` k
+00014bb0: 6579 776f 7264 2074 6f20 7365 6c65 6374  eyword to select
+00014bc0: 2062 6574 7765 656e 2060 6063 7678 6f70   between ``cvxop
+00014bd0: 7460 6020 6f72 0d0a 2020 6060 6c73 715f  t`` or..  ``lsq_
+00014be0: 6c69 6e60 602c 2077 6865 6e20 7573 696e  lin``, when usin
+00014bf0: 6720 6c69 6e65 6172 2063 6f6e 7374 7261  g linear constra
+00014c00: 696e 7473 2c20 666f 7220 6361 7365 7320  ints, for cases 
+00014c10: 7768 6572 6520 7468 6520 6c61 7474 6572  where the latter
+00014c20: 2073 746f 7073 2e0d 0a20 2054 6865 2060   stops...  The `
+00014c30: 6063 7678 6f70 7460 6020 7061 636b 6167  `cvxopt`` packag
+00014c40: 6520 6d75 7374 2062 6520 696e 7374 616c  e must be instal
+00014c50: 6c65 6420 7768 656e 2073 6574 7469 6e67  led when setting
+00014c60: 2074 6861 7420 6f70 7469 6f6e 2e0d 0a2d   that option...-
+00014c70: 2060 6070 7078 6660 603a 2041 6461 7074   ``ppxf``: Adapt
+00014c80: 6564 2074 6f20 7573 6520 6060 6361 7066  ed to use ``capf
+00014c90: 6974 6060 2077 6974 6820 6060 6c69 6e65  it`` with ``line
+00014ca0: 6172 5f6d 6574 686f 643d 2763 7678 6f70  ar_method='cvxop
+00014cb0: 7427 6060 2077 6865 6e0d 0a20 2065 6e66  t'`` when..  enf
+00014cc0: 6f72 6369 6e67 206c 696e 6561 7220 636f  orcing linear co
+00014cd0: 6e73 7472 6169 6e74 7320 6f6e 2074 6865  nstraints on the
+00014ce0: 206b 696e 656d 6174 6963 7320 7769 7468   kinematics with
+00014cf0: 2060 6063 6f6e 7374 725f 6b69 6e65 6d60   ``constr_kinem`
+00014d00: 602e 0d0a 2d20 6060 7070 7866 6060 3a20  `...- ``ppxf``: 
+00014d10: 496e 636c 7564 6564 204e 4f54 4520 696e  Included NOTE in
+00014d20: 2074 6865 2064 6f63 756d 656e 7461 7469   the documentati
+00014d30: 6f6e 206f 6620 6060 636f 6e73 7472 5f6b  on of ``constr_k
+00014d40: 696e 656d 6060 2e0d 0a20 2041 6c6c 2063  inem``...  All c
+00014d50: 6861 6e67 6573 2061 626f 7665 2077 6572  hanges above wer
+00014d60: 6520 6166 7465 7220 6465 7461 696c 6564  e after detailed
+00014d70: 2072 6570 6f72 7473 2062 7920 4b79 6c65   reports by Kyle
+00014d80: 2057 6573 7466 616c 6c20 2875 636f 6c69   Westfall (ucoli
+00014d90: 636b 2e6f 7267 292e 0d0a 0d0a 5637 2e34  ck.org).....V7.4
+00014da0: 2e32 3a20 4d43 2c20 4f78 666f 7264 2c20  .2: MC, Oxford, 
+00014db0: 3920 4f63 746f 6265 7220 3230 3230 0d0a  9 October 2020..
+00014dc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00014dd0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00014de0: 2b2b 0d0a 0d0a 2d20 6060 7070 7866 6060  ++....- ``ppxf``
+00014df0: 3a20 436f 7272 6563 7465 6420 7479 706f  : Corrected typo
+00014e00: 2069 6e20 6578 616d 706c 6520 696e 2074   in example in t
+00014e10: 6865 2064 6f63 756d 656e 7461 7469 6f6e  he documentation
+00014e20: 206f 6620 6060 636f 6e73 7472 5f74 656d   of ``constr_tem
+00014e30: 706c 6060 2e0d 0a2d 2060 6070 7078 6660  pl``...- ``ppxf`
+00014e40: 603a 2043 6865 636b 2074 6861 7420 6060  `: Check that ``
+00014e50: 636f 6e73 7472 5f74 656d 706c 6060 2061  constr_templ`` a
+00014e60: 6e64 2060 6063 6f6e 7374 725f 6b69 6e65  nd ``constr_kine
+00014e70: 6d60 6020 6172 6520 6469 6374 696f 6e61  m`` are dictiona
+00014e80: 7269 6573 2e0d 0a20 2054 6861 6e6b 7320  ries...  Thanks 
+00014e90: 746f 2044 6176 6964 6520 4265 7661 6371  to Davide Bevacq
+00014ea0: 7561 2028 756e 6962 6f2e 6974 2920 666f  ua (unibo.it) fo
+00014eb0: 7220 7468 6520 6665 6564 6261 636b 2e0d  r the feedback..
+00014ec0: 0a0d 0a56 372e 342e 313a 204d 432c 204f  ...V7.4.1: MC, O
+00014ed0: 7866 6f72 642c 2031 3120 5365 7074 656d  xford, 11 Septem
+00014ee0: 6265 7220 3230 3230 0d0a 2b2b 2b2b 2b2b  ber 2020..++++++
+00014ef0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00014f00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+00014f10: 0a0d 0a2d 2060 6063 6170 6669 7460 603a  ...- ``capfit``:
+00014f20: 2046 6978 6564 2070 6f73 7369 626c 6520   Fixed possible 
+00014f30: 696e 6669 6e69 7465 206c 6f6f 7020 696e  infinite loop in
+00014f40: 2060 606c 7371 5f62 6f78 6060 2061 6e64   ``lsq_box`` and
+00014f50: 2060 606c 7371 5f6c 696e 6060 2e0d 0a20   ``lsq_lin``... 
+00014f60: 2054 6861 6e6b 7320 746f 2053 6872 6176   Thanks to Shrav
+00014f70: 616e 2053 6865 7474 7920 2870 6b75 2e65  an Shetty (pku.e
+00014f80: 6475 2e63 6e29 2066 6f72 2074 6865 2064  du.cn) for the d
+00014f90: 6574 6169 6c65 6420 7265 706f 7274 2061  etailed report a
+00014fa0: 6e64 2074 6f20 626f 7468 0d0a 2020 6869  nd to both..  hi
+00014fb0: 6d20 616e 6420 4b79 6c65 2057 6573 7466  m and Kyle Westf
+00014fc0: 616c 6c20 2875 636f 6c69 636b 2e6f 7267  all (ucolick.org
+00014fd0: 2920 666f 7220 7465 7374 696e 6720 7468  ) for testing th
+00014fe0: 6520 6669 782e 0d0a 2d20 6060 6361 7066  e fix...- ``capf
+00014ff0: 6974 6060 3a20 5573 6520 4e75 6d50 7920  it``: Use NumPy 
+00015000: 7261 7468 6572 2074 6861 6e20 7468 6520  rather than the 
+00015010: 5363 6950 7920 7665 7273 696f 6e20 6f66  SciPy version of
+00015020: 2060 606c 696e 616c 672e 6c73 7473 7160   ``linalg.lstsq`
+00015030: 6020 746f 0d0a 2020 6176 6f69 6420 6120  ` to..  avoid a 
+00015040: 6375 7272 656e 7420 5363 6950 7920 6275  current SciPy bu
+00015050: 6720 696e 2074 6865 2064 6566 6175 6c74  g in the default
+00015060: 2063 7269 7465 7269 6f6e 2066 6f72 2072   criterion for r
+00015070: 616e 6b20 6465 6669 6369 656e 6379 2e0d  ank deficiency..
+00015080: 0a2d 2060 6063 6170 6669 7460 603a 2052  .- ``capfit``: R
+00015090: 656e 616d 6564 2060 6063 6f6e 6460 6020  enamed ``cond`` 
+000150a0: 6b65 7977 6f72 6420 746f 2060 6072 636f  keyword to ``rco
+000150b0: 6e64 6060 2066 6f72 2063 6f6e 7369 7374  nd`` for consist
+000150c0: 656e 6379 2077 6974 6820 4e75 6d50 792e  ency with NumPy.
+000150d0: 0d0a 2d20 6060 6361 7066 6974 6060 3a20  ..- ``capfit``: 
+000150e0: 5061 7373 6564 2060 6072 636f 6e64 6060  Passed ``rcond``
+000150f0: 206b 6579 776f 7264 2074 6f20 6060 636f   keyword to ``co
+00015100: 765f 6572 7260 6020 6675 6e63 7469 6f6e  v_err`` function
+00015110: 2e0d 0a2d 2060 6070 7078 6660 603a 2072  ...- ``ppxf``: r
+00015120: 656d 6f76 6564 2060 6072 636f 6e64 6060  emoved ``rcond``
+00015130: 206b 6579 776f 7264 2069 6e20 6060 6361   keyword in ``ca
+00015140: 7066 6974 6060 2063 616c 6c2e 2055 7365  pfit`` call. Use
+00015150: 2064 6566 6175 6c74 2069 6e73 7465 6164   default instead
+00015160: 2e0d 0a0d 0a56 372e 342e 303a 204d 432c  .....V7.4.0: MC,
+00015170: 204f 7866 6f72 642c 2032 3020 4175 6775   Oxford, 20 Augu
+00015180: 7374 2032 3032 300d 0a2b 2b2b 2b2b 2b2b  st 2020..+++++++
+00015190: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000151a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+000151b0: 2060 6063 6170 6669 7460 603a 204e 6577   ``capfit``: New
+000151c0: 2066 756e 6374 696f 6e20 6060 6c73 715f   function ``lsq_
+000151d0: 6c69 6e60 6020 696d 706c 656d 656e 7469  lin`` implementi
+000151e0: 6e67 2061 206c 696e 6561 7220 6c65 6173  ng a linear leas
+000151f0: 742d 7371 7561 7265 730d 0a20 206c 696e  t-squares..  lin
+00015200: 6561 726c 7920 636f 6e73 7472 6169 6e65  early constraine
+00015210: 6420 616c 676f 7269 7468 6d20 7375 7070  d algorithm supp
+00015220: 6f72 7469 6e67 2072 616e 6b2d 6465 6669  orting rank-defi
+00015230: 6369 656e 7420 6d61 7472 6963 6573 2061  cient matrices a
+00015240: 6e64 2061 6c6c 6f77 696e 670d 0a20 2066  nd allowing..  f
+00015250: 6f72 2061 2073 7461 7274 696e 6720 6775  or a starting gu
+00015260: 6573 732e 0d0a 2d20 6060 6361 7066 6974  ess...- ``capfit
+00015270: 6060 3a20 5265 6d6f 7665 6420 7468 6520  ``: Removed the 
+00015280: 6060 6c73 716c 696e 6060 2070 726f 6365  ``lsqlin`` proce
+00015290: 6475 7265 2077 6869 6368 2069 7320 7375  dure which is su
+000152a0: 7065 7273 6564 6564 2062 7920 6060 6c73  perseded by ``ls
+000152b0: 715f 6c69 6e60 602e 0d0a 2d20 6060 6361  q_lin``...- ``ca
+000152c0: 7066 6974 6060 3a20 5265 6e61 6d65 6420  pfit``: Renamed 
+000152d0: 6060 6c73 7162 6f78 6060 2074 6f20 6060  ``lsqbox`` to ``
+000152e0: 6c73 715f 626f 7860 6020 616e 6420 7265  lsq_box`` and re
+000152f0: 7669 7365 6420 6974 7320 696e 7465 7266  vised its interf
+00015300: 6163 652e 0d0a 2d20 6060 7070 7866 6060  ace...- ``ppxf``
+00015310: 3a20 4d6f 6469 6669 6564 2074 6f20 7573  : Modified to us
+00015320: 6520 7468 6520 6e65 7720 6060 6c73 715f  e the new ``lsq_
+00015330: 6c69 6e60 6020 616e 6420 7468 6520 7570  lin`` and the up
+00015340: 6461 7465 6420 6060 6c73 715f 626f 7860  dated ``lsq_box`
+00015350: 6020 6675 6e63 7469 6f6e 732e 0d0a 2d20  ` functions...- 
+00015360: 6060 7070 7866 6060 3a20 4d6f 7265 2065  ``ppxf``: More e
+00015370: 7861 6d70 6c65 7320 666f 7220 7468 6520  xamples for the 
+00015380: 6060 636f 6e73 7472 5f74 656d 706c 6060  ``constr_templ``
+00015390: 2061 6e64 2060 6063 6f6e 7374 725f 6b69   and ``constr_ki
+000153a0: 6e65 6d60 6020 6b65 7977 6f72 6473 2e0d  nem`` keywords..
+000153b0: 0a2d 2053 6574 2072 6564 7368 6966 7420  .- Set redshift 
+000153c0: 6060 7a20 3d20 3060 6020 7768 656e 206f  ``z = 0`` when o
+000153d0: 6e65 2075 6e63 6f6d 6d65 6e74 7320 7468  ne uncomments th
+000153e0: 6520 6c69 6e65 7320 746f 2062 7269 6e67  e lines to bring
+000153f0: 2074 6865 2073 7065 6374 7275 6d20 746f   the spectrum to
+00015400: 0d0a 2020 7468 6520 7265 7374 2d66 7261  ..  the rest-fra
+00015410: 6d65 2069 6e20 6060 7070 7866 5f65 7861  me in ``ppxf_exa
+00015420: 6d70 6c65 5f6b 696e 656d 6174 6963 735f  mple_kinematics_
+00015430: 7364 7373 2e70 7960 602e 2054 6861 6e6b  sdss.py``. Thank
+00015440: 7320 746f 0d0a 2020 5661 6964 6568 6920  s to..  Vaidehi 
+00015450: 532e 2050 616c 6979 6120 2864 6573 792e  S. Paliya (desy.
+00015460: 6465 2920 666f 7220 706f 696e 7469 6e67  de) for pointing
+00015470: 206f 7574 2074 6865 2069 6e63 6f6e 7369   out the inconsi
+00015480: 7374 656e 6379 2069 6e20 6d79 2065 7861  stency in my exa
+00015490: 6d70 6c65 2e0d 0a0d 0a56 372e 332e 303a  mple.....V7.3.0:
+000154a0: 204d 432c 204f 7866 6f72 642c 2031 3020   MC, Oxford, 10 
+000154b0: 4a75 6c79 2032 3032 300d 0a2b 2b2b 2b2b  July 2020..+++++
+000154c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000154d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+000154e0: 2060 6063 6170 6669 7460 603a 204e 6577   ``capfit``: New
+000154f0: 2066 756e 6374 696f 6e20 6060 6c73 7162   function ``lsqb
+00015500: 6f78 6060 2069 6d70 6c65 6d65 6e74 696e  ox`` implementin
+00015510: 6720 6120 6661 7374 206c 696e 6561 7220  g a fast linear 
+00015520: 6c65 6173 742d 7371 7561 7265 730d 0a20  least-squares.. 
+00015530: 2062 6f78 2d63 6f6e 7374 7261 696e 6564   box-constrained
+00015540: 2028 626f 756e 6473 2920 616c 676f 7269   (bounds) algori
+00015550: 7468 6d20 7768 6963 6820 616c 6c6f 7773  thm which allows
+00015560: 2066 6f72 2061 2073 7461 7274 696e 6720   for a starting 
+00015570: 6775 6573 732e 0d0a 2020 5768 696c 6520  guess...  While 
+00015580: 7465 7374 696e 6720 4920 616c 736f 2064  testing I also d
+00015590: 6973 636f 7665 7265 6420 6120 6d61 6a6f  iscovered a majo
+000155a0: 7220 6d69 7374 616b 6520 696e 2074 6865  r mistake in the
+000155b0: 2063 7572 7265 6e74 2069 6d70 6c65 6d65   current impleme
+000155c0: 6e74 6174 696f 6e0d 0a20 206f 6620 6060  ntation..  of ``
+000155d0: 7363 6970 792e 6f70 7469 6d69 7a65 2e6c  scipy.optimize.l
+000155e0: 7371 5f6c 696e 6561 7260 6020 286d 7920  sq_linear`` (my 
+000155f0: 6669 7820 7761 7320 6c61 7465 7220 696e  fix was later in
+00015600: 636c 7564 6564 2069 6e20 5363 6970 7920  cluded in Scipy 
+00015610: 312e 3629 2e0d 0a2d 2060 6070 7078 6660  1.6)...- ``ppxf`
+00015620: 603a 2054 6865 206e 6577 2060 606c 696e  `: The new ``lin
+00015630: 6561 725f 6d65 7468 6f64 3d27 6c73 7162  ear_method='lsqb
+00015640: 6f78 2760 6020 616e 6420 6060 6c69 6e65  ox'`` and ``line
+00015650: 6172 5f6d 6574 686f 643d 2763 7678 6f70  ar_method='cvxop
+00015660: 7427 6060 0d0a 2020 6e6f 7720 7573 6520  t'``..  now use 
+00015670: 616e 2069 6e69 7469 616c 2067 7565 7373  an initial guess
+00015680: 2066 6f72 2074 6865 2073 6f6c 7574 696f   for the solutio
+00015690: 6e2c 2077 6869 6368 2073 6967 6e69 6669  n, which signifi
+000156a0: 6361 6e74 6c79 2073 7065 6564 7320 7570  cantly speeds up
+000156b0: 2074 6865 0d0a 2020 6b69 6e65 6d61 7469   the..  kinemati
+000156c0: 6320 6669 7420 7769 7468 206d 756c 7469  c fit with multi
+000156d0: 706c 6520 7465 6d70 6c61 7465 732e 2041  ple templates. A
+000156e0: 7320 616e 2065 7861 6d70 6c65 2c20 6d79  s an example, my
+000156f0: 2070 726f 6365 6475 7265 0d0a 2020 6060   procedure..  ``
+00015700: 7070 7866 5f65 7861 6d70 6c65 5f70 6f70  ppxf_example_pop
+00015710: 756c 6174 696f 6e5f 6761 735f 7364 7373  ulation_gas_sdss
+00015720: 6060 2069 7320 6e6f 7720 6162 6f75 7420  `` is now about 
+00015730: 3420 7469 6d65 7320 6661 7374 6572 2077  4 times faster w
+00015740: 6974 6820 7468 6520 6e65 770d 0a20 2060  ith the new..  `
+00015750: 606c 696e 6561 725f 6d65 7468 6f64 3d27  `linear_method='
+00015760: 6c73 7162 6f78 2760 6020 7468 616e 2077  lsqbox'`` than w
+00015770: 6974 6820 7468 6520 6c65 6761 6379 2060  ith the legacy `
+00015780: 606c 696e 6561 725f 6d65 7468 6f64 3d27  `linear_method='
+00015790: 6e6e 6c73 2760 602e 0d0a 2d20 6060 7070  nnls'``...- ``pp
+000157a0: 7866 6060 3a20 4164 6465 6420 7375 7070  xf``: Added supp
+000157b0: 6f72 7420 666f 7220 6c69 6e65 6172 2065  ort for linear e
+000157c0: 7175 616c 6974 7920 636f 6e73 7472 6169  quality constrai
+000157d0: 6e74 7320 6f6e 2074 6865 2074 656d 706c  nts on the templ
+000157e0: 6174 6573 0d0a 2020 6060 636f 6e73 7472  ates..  ``constr
+000157f0: 5f74 656d 706c 6060 2061 6e64 2066 6f72  _templ`` and for
+00015800: 2075 7369 6e67 2074 6865 206b 6579 776f   using the keywo
+00015810: 7264 2060 6066 7261 6374 696f 6e60 6020  rd ``fraction`` 
+00015820: 7769 7468 2062 6f74 680d 0a20 2060 606c  with both..  ``l
+00015830: 696e 6561 725f 6d65 7468 6f64 3d27 6c73  inear_method='ls
+00015840: 7162 6f78 2760 6020 616e 6420 6060 6c69  qbox'`` and ``li
+00015850: 6e65 6172 5f6d 6574 686f 643d 276e 6e6c  near_method='nnl
+00015860: 7327 6060 2e0d 0a2d 2050 7269 6e74 2060  s'``...- Print `
+00015870: 6064 6567 7265 6560 6020 616e 6420 6060  `degree`` and ``
+00015880: 6d64 6567 7265 6560 6020 7769 7468 2074  mdegree`` with t
+00015890: 6865 2066 696e 616c 2072 6573 756c 7473  he final results
+000158a0: 2e0d 0a2d 2053 6574 2060 606c 696e 6561  ...- Set ``linea
+000158b0: 723d 5472 7565 6060 2061 7574 6f6d 6174  r=True`` automat
+000158c0: 6963 616c 6c79 2069 6620 7468 6520 6669  ically if the fi
+000158d0: 7420 6861 7320 6e6f 2066 7265 6520 6e6f  t has no free no
+000158e0: 6e2d 6c69 6e65 6172 2070 6172 616d 6574  n-linear paramet
+000158f0: 6572 732c 0d0a 2020 746f 2061 766f 6964  ers,..  to avoid
+00015900: 2061 2070 726f 6772 616d 2073 746f 702e   a program stop.
+00015910: 2054 6861 6e6b 7320 746f 2053 6872 6176   Thanks to Shrav
+00015920: 616e 2053 6865 7474 7920 2870 6b75 2e65  an Shetty (pku.e
+00015930: 6475 2e63 6e29 2066 6f72 2074 6865 2072  du.cn) for the r
+00015940: 6570 6f72 742e 0d0a 0d0a 5637 2e32 2e31  eport.....V7.2.1
+00015950: 3a20 4d43 2c20 4f78 666f 7264 2c20 3132  : MC, Oxford, 12
+00015960: 204a 756e 6520 3230 3230 0d0a 2b2b 2b2b   June 2020..++++
+00015970: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00015980: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+00015990: 2d20 6060 6361 7066 6974 6060 3a20 4e65  - ``capfit``: Ne
+000159a0: 7720 696e 7075 7420 6b65 7977 6f72 6420  w input keyword 
+000159b0: 6060 636f 6e64 6060 2066 6f72 204a 6163  ``cond`` for Jac
+000159c0: 6f62 6961 6e20 7261 6e6b 2074 6f6c 6572  obian rank toler
+000159d0: 616e 6365 2e0d 0a2d 2060 6063 6170 6669  ance...- ``capfi
+000159e0: 7460 603a 2055 7365 2060 6062 766c 7360  t``: Use ``bvls`
+000159f0: 6020 746f 2073 6f6c 7665 2071 7561 6472  ` to solve quadr
+00015a00: 6174 6963 2073 7562 7072 6f62 6c65 6d20  atic subproblem 
+00015a10: 7769 7468 206f 6e6c 7920 6060 626f 756e  with only ``boun
+00015a20: 6473 6060 2e0d 0a2d 2060 6070 7078 6660  ds``...- ``ppxf`
+00015a30: 603a 2053 6574 2060 6063 6f6e 643d 3165  `: Set ``cond=1e
+00015a40: 2d37 6060 2069 6e20 6060 6361 7066 6974  -7`` in ``capfit
+00015a50: 6060 2063 616c 6c2c 2077 6865 6e20 7573  `` call, when us
+00015a60: 696e 6720 6c69 6e65 6172 2063 6f6e 7374  ing linear const
+00015a70: 7261 696e 7473 2e0d 0a20 2054 6865 2060  raints...  The `
+00015a80: 6063 6170 6669 7460 6020 7265 6c61 7465  `capfit`` relate
+00015a90: 6420 6368 616e 6765 7320 7765 7265 2064  d changes were d
+00015aa0: 7565 2074 6f20 6465 7461 696c 6564 2066  ue to detailed f
+00015ab0: 6565 6462 6163 6b20 6279 204b 796c 6520  eedback by Kyle 
+00015ac0: 5765 7374 6661 6c6c 0d0a 2020 2875 636f  Westfall..  (uco
+00015ad0: 6c69 636b 2e6f 7267 292c 2074 6f20 6465  lick.org), to de
+00015ae0: 616c 2077 6974 6820 7369 7475 6174 696f  al with situatio
+00015af0: 6e73 2077 6974 6820 6465 6765 6e65 7261  ns with degenera
+00015b00: 7465 204a 6163 6f62 6961 6e73 2c20 6c69  te Jacobians, li
+00015b10: 6b65 2077 6865 6e0d 0a20 2074 6865 7265  ke when..  there
+00015b20: 2069 7320 6e6f 2073 7465 6c6c 6172 2063   is no stellar c
+00015b30: 6f6e 7469 6e75 756d 2061 6e64 206f 6e65  ontinuum and one
+00015b40: 2075 7365 7320 6d75 6c74 6970 6c69 6361   uses multiplica
+00015b50: 7469 7665 2070 6f6c 796e 6f6d 6961 6c73  tive polynomials
+00015b60: 2e0d 0a2d 2060 6070 7078 6660 603a 2043  ...- ``ppxf``: C
+00015b70: 6c61 7269 6669 6564 2064 6f63 756d 656e  larified documen
+00015b80: 7461 7469 6f6e 2066 6f72 2060 602e 6761  tation for ``.ga
+00015b90: 735f 7a65 726f 5f74 656d 706c 6174 6560  s_zero_template`
+00015ba0: 6020 616e 6420 7468 650d 0a20 2063 6f72  ` and the..  cor
+00015bb0: 7265 7370 6f6e 6469 6e67 2077 6172 6e69  responding warni
+00015bc0: 6e67 206d 6573 7361 6765 2c20 6166 7465  ng message, afte
+00015bd0: 7220 6665 6564 6261 636b 2062 7920 4c61  r feedback by La
+00015be0: 7572 6120 5361 6c6f 2028 756d 6e2e 6564  ura Salo (umn.ed
+00015bf0: 7529 2e0d 0a0d 0a56 372e 322e 303a 204d  u).....V7.2.0: M
+00015c00: 432c 204f 7866 6f72 642c 2034 204d 6179  C, Oxford, 4 May
+00015c10: 2032 3032 300d 0a2b 2b2b 2b2b 2b2b 2b2b   2020..+++++++++
+00015c20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00015c30: 2b2b 2b2b 2b0d 0a0d 0a2d 2041 6c6c 6f77  +++++....- Allow
+00015c40: 2066 6f72 2060 606c 696e 6561 725f 6d65   for ``linear_me
+00015c50: 7468 6f64 3d27 6376 786f 7074 2760 6020  thod='cvxopt'`` 
+00015c60: 7768 656e 2074 6865 206f 7074 696f 6e61  when the optiona
+00015c70: 6c20 6060 6376 786f 7074 6060 2070 6163  l ``cvxopt`` pac
+00015c80: 6b61 6765 0d0a 2020 6973 2069 6e73 7461  kage..  is insta
+00015c90: 6c6c 6564 2e0d 0a0d 0a56 372e 312e 303a  lled.....V7.1.0:
+00015ca0: 204d 432c 204f 7866 6f72 642c 2033 3020   MC, Oxford, 30 
+00015cb0: 4170 7269 6c20 3230 3230 0d0a 2b2b 2b2b  April 2020..++++
+00015cc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00015cd0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+00015ce0: 0a2d 2049 6e74 726f 6475 6365 6420 6e65  .- Introduced ne
+00015cf0: 7720 6060 7070 7866 6060 206b 6579 776f  w ``ppxf`` keywo
+00015d00: 7264 2060 606c 696e 6561 725f 6d65 7468  rd ``linear_meth
+00015d10: 6f64 6060 2c20 616e 6420 636f 7272 6573  od``, and corres
+00015d20: 706f 6e64 696e 6720 6368 616e 6765 730d  ponding changes.
+00015d30: 0a20 2069 6e20 7468 6520 636f 6465 2c20  .  in the code, 
+00015d40: 746f 2073 656c 6563 7420 6265 7477 6565  to select betwee
+00015d50: 6e20 7468 6520 6f6c 6420 2827 6e6e 6c73  n the old ('nnls
+00015d60: 2729 2061 6e64 2074 6865 206e 6577 2028  ') and the new (
+00015d70: 276c 7371 6c69 6e27 290d 0a20 2061 7070  'lsqlin')..  app
+00015d80: 726f 6163 6820 746f 2074 6865 2073 6f6c  roach to the sol
+00015d90: 7574 696f 6e20 6f66 2074 6865 206c 696e  ution of the lin
+00015da0: 6561 7220 6c65 6173 742d 7371 7561 7265  ear least-square
+00015db0: 7320 7375 6270 726f 626c 656d 2069 6e20  s subproblem in 
+00015dc0: 6060 7070 7866 6060 2e0d 0a20 2054 6861  ``ppxf``...  Tha
+00015dd0: 6e6b 7320 746f 2053 616d 2056 6175 6768  nks to Sam Vaugh
+00015de0: 616e 2028 7379 646e 6579 2e65 6475 2e61  an (sydney.edu.a
+00015df0: 7529 2066 6f72 2061 2063 6f6e 7669 6e63  u) for a convinc
+00015e00: 696e 6720 6d69 6e69 6d61 6c20 6578 616d  ing minimal exam
+00015e10: 706c 650d 0a20 2069 6c6c 7573 7472 6174  ple..  illustrat
+00015e20: 696e 6720 7468 6520 7573 6566 756c 6e65  ing the usefulne
+00015e30: 7373 206f 6620 7468 6973 206b 6579 776f  ss of this keywo
+00015e40: 7264 2e0d 0a0d 0a56 372e 302e 313a 204d  rd.....V7.0.1: M
+00015e50: 432c 204f 7866 6f72 642c 2038 2041 7072  C, Oxford, 8 Apr
+00015e60: 696c 2032 3032 300d 0a2b 2b2b 2b2b 2b2b  il 2020..+++++++
+00015e70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00015e80: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2053  +++++++++....- S
+00015e90: 7570 706f 7274 2060 602e 6761 735f 7a65  upport ``.gas_ze
+00015ea0: 726f 5f74 656d 706c 6174 6560 6020 616e  ro_template`` an
+00015eb0: 6420 6060 6672 6163 7469 6f6e 6060 2074  d ``fraction`` t
+00015ec0: 6f67 6574 6865 7220 7769 7468 206f 7468  ogether with oth
+00015ed0: 6572 0d0a 2020 6571 7561 6c69 7479 2063  er..  equality c
+00015ee0: 6f6e 7374 7261 696e 7473 2e0d 0a2d 2049  onstraints...- I
+00015ef0: 6e63 6c75 6465 6420 6060 6e70 2e70 6164  ncluded ``np.pad
+00015f00: 282e 2e2e 6d6f 6465 3d27 636f 6e73 7461  (...mode='consta
+00015f10: 6e74 2729 6060 2066 6f72 2062 6163 6b77  nt')`` for backw
+00015f20: 6172 6420 636f 6d70 6174 6962 696c 6974  ard compatibilit
+00015f30: 7920 7769 7468 0d0a 2020 4e75 6d70 7920  y with..  Numpy 
+00015f40: 312e 3136 2e20 5468 616e 6b73 2074 6f20  1.16. Thanks to 
+00015f50: 5368 7261 7661 6e20 5368 6574 7479 2028  Shravan Shetty (
+00015f60: 4b49 4141 2d50 4b55 2920 666f 7220 7468  KIAA-PKU) for th
+00015f70: 6520 7375 6767 6573 7469 6f6e 2e0d 0a2d  e suggestion...-
+00015f80: 2046 6978 2060 6072 6562 696e 2829 6060   Fix ``rebin()``
+00015f90: 206e 6f74 2072 6574 6169 6e69 6e67 2074   not retaining t
+00015fa0: 6865 2064 696d 656e 7369 6f6e 616c 6974  he dimensionalit
+00015fb0: 7920 6f66 2061 6e20 696e 7075 7420 636f  y of an input co
+00015fc0: 6c75 6d6e 2d76 6563 746f 722e 0d0a 2020  lumn-vector...  
+00015fd0: 5468 6973 2072 6573 756c 7465 6420 696e  This resulted in
+00015fe0: 2061 2070 726f 6772 616d 2073 746f 7020   a program stop 
+00015ff0: 7769 7468 2061 2073 696e 676c 6520 6761  with a single ga
+00016000: 7320 7465 6d70 6c61 7465 2061 6e64 0d0a  s template and..
+00016010: 2020 6060 7665 6c73 6361 6c65 5f72 6174    ``velscale_rat
+00016020: 696f 203e 2031 6060 2e20 5468 616e 6b73  io > 1``. Thanks
+00016030: 2074 6f20 5a68 6979 7561 6e20 4a69 2028   to Zhiyuan Ji (
+00016040: 6173 7472 6f2e 756d 6173 732e 6564 7529  astro.umass.edu)
+00016050: 2066 6f72 2061 2063 6c65 6172 0d0a 2020   for a clear..  
+00016060: 6578 616d 706c 6520 7265 7072 6f64 7563  example reproduc
+00016070: 696e 6720 7468 6520 6275 672e 0d0a 2d20  ing the bug...- 
+00016080: 6060 6361 7066 6974 6060 3a20 4e65 7720  ``capfit``: New 
+00016090: 6b65 7977 6f72 6420 6060 636f 6e64 6060  keyword ``cond``
+000160a0: 2066 6f72 2060 606c 7371 6c69 6e60 602e   for ``lsqlin``.
+000160b0: 0d0a 2d20 6060 6361 7066 6974 6060 3a20  ..- ``capfit``: 
+000160c0: 5265 6c61 7865 6420 6173 7365 7274 696f  Relaxed assertio
+000160d0: 6e20 666f 7220 696e 636f 6e73 6973 7465  n for inconsiste
+000160e0: 6e74 2069 6e65 7175 616c 6974 6965 7320  nt inequalities 
+000160f0: 696e 2060 606c 7371 6c69 6e60 600d 0a20  in ``lsqlin``.. 
+00016100: 2074 6f20 6176 6f69 6420 6661 6c73 6520   to avoid false 
+00016110: 706f 7369 7469 7665 732e 2054 6861 6e6b  positives. Thank
+00016120: 7320 746f 204b 796c 6520 5765 7374 6661  s to Kyle Westfa
+00016130: 6c6c 2028 5543 4f20 4c69 636b 2920 666f  ll (UCO Lick) fo
+00016140: 7220 6120 6465 7461 696c 6564 0d0a 2020  r a detailed..  
+00016150: 6275 6720 7265 706f 7274 2e0d 0a0d 0a56  bug report.....V
+00016160: 372e 302e 303a 204d 432c 204f 7866 6f72  7.0.0: MC, Oxfor
+00016170: 642c 2031 3020 4a61 6e75 6172 7920 3230  d, 10 January 20
+00016180: 3230 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  20..++++++++++++
+00016190: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000161a0: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6063  +++++++....- ``c
+000161b0: 6170 6669 7460 603a 204e 6577 2067 656e  apfit``: New gen
+000161c0: 6572 616c 206c 696e 6561 7220 6c65 6173  eral linear leas
+000161d0: 742d 7371 7561 7265 7320 6f70 7469 6d69  t-squares optimi
+000161e0: 7a61 7469 6f6e 2066 756e 6374 696f 6e0d  zation function.
+000161f0: 0a20 2060 606c 7371 6c69 6e60 6020 7768  .  ``lsqlin`` wh
+00016200: 6963 6820 6973 206e 6f77 2075 7365 6420  ich is now used 
+00016210: 746f 2073 6f6c 7665 2074 6865 2071 7561  to solve the qua
+00016220: 6472 6174 6963 2073 7562 7072 6f62 6c65  dratic subproble
+00016230: 6d2e 0d0a 2d20 6060 6361 7066 6974 6060  m...- ``capfit``
+00016240: 3a20 416c 6c6f 7720 666f 7220 6c69 6e65  : Allow for line
+00016250: 6172 2069 6e65 7175 616c 6974 792f 6571  ar inequality/eq
+00016260: 7561 6c69 7479 2063 6f6e 7374 7261 696e  uality constrain
+00016270: 7473 0d0a 2020 6060 415f 696e 6571 6060  ts..  ``A_ineq``
+00016280: 2c20 6060 625f 696e 6571 6060 2061 6e64  , ``b_ineq`` and
+00016290: 2020 6060 415f 6571 6060 2c20 6060 625f    ``A_eq``, ``b_
+000162a0: 6571 6060 2e0d 0a2d 2060 6070 7078 6660  eq``...- ``ppxf`
+000162b0: 603a 2055 7365 2028 6661 7374 6572 2920  `: Use (faster) 
+000162c0: 6060 6361 7066 6974 2e6c 7371 6c69 6e60  ``capfit.lsqlin`
+000162d0: 6020 666f 7220 7468 6520 6c69 6e65 6172  ` for the linear
+000162e0: 2066 6974 2e0d 0a2d 2060 6070 7078 6660   fit...- ``ppxf`
+000162f0: 603a 2055 7365 2075 7064 6174 6564 2060  `: Use updated `
+00016300: 6063 6170 6669 742e 6361 7066 6974 6060  `capfit.capfit``
+00016310: 2066 6f72 2074 6865 206e 6f6e 2d6c 696e   for the non-lin
+00016320: 6561 7220 6f70 7469 6d69 7a61 7469 6f6e  ear optimization
+00016330: 2e0d 0a2d 2060 6070 7078 6660 603a 2041  ...- ``ppxf``: A
+00016340: 6c6c 6f77 2066 6f72 206c 696e 6561 7220  llow for linear 
+00016350: 6571 7561 6c69 7469 6573 2f69 6e65 7175  equalities/inequ
+00016360: 616c 6974 6965 7320 666f 7220 626f 7468  alities for both
+00016370: 2074 6865 2074 656d 706c 6174 650d 0a20   the template.. 
+00016380: 2077 6569 6768 7473 2061 6e64 2074 6865   weights and the
+00016390: 206b 696e 656d 6174 6963 2070 6172 616d   kinematic param
+000163a0: 6574 6572 7320 7769 7468 2074 6865 2060  eters with the `
+000163b0: 6063 6f6e 7374 725f 7465 6d70 6c60 6020  `constr_templ`` 
+000163c0: 616e 640d 0a20 2060 6063 6f6e 7374 725f  and..  ``constr_
+000163d0: 6b69 6e65 6d60 6020 6f70 7469 6f6e 616c  kinem`` optional
+000163e0: 206b 6579 776f 7264 732e 0d0a 2d20 6060   keywords...- ``
+000163f0: 7070 7866 6060 3a20 4e65 7720 6060 7365  ppxf``: New ``se
+00016400: 745f 6c69 6e65 6172 5f63 6f6e 7374 7261  t_linear_constra
+00016410: 696e 7473 6060 2066 756e 6374 696f 6e2e  ints`` function.
+00016420: 0d0a 2d20 6060 7070 7866 6060 3a20 5570  ..- ``ppxf``: Up
+00016430: 6461 7465 6420 646f 6375 6d65 6e74 6174  dated documentat
+00016440: 696f 6e2e 0d0a 0d0a 5636 2e37 2e31 373a  ion.....V6.7.17:
+00016450: 204d 432c 204f 7866 6f72 642c 2031 3420   MC, Oxford, 14 
+00016460: 4e6f 7665 6d62 6572 2032 3031 390d 0a2b  November 2019..+
+00016470: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016480: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016490: 2b2b 2b2b 0d0a 0d0a 2d20 6060 6361 7066  ++++....- ``capf
+000164a0: 6974 6060 3a20 5772 6974 7465 6e20 636f  it``: Written co
+000164b0: 6d70 6c65 7465 2064 6f63 756d 656e 7461  mplete documenta
+000164c0: 7469 6f6e 2e0d 0a2d 2060 6063 6170 6669  tion...- ``capfi
+000164d0: 7460 603a 2049 6d70 726f 7665 6420 7072  t``: Improved pr
+000164e0: 696e 7420 666f 726d 6174 7469 6e67 2e0d  int formatting..
+000164f0: 0a2d 2060 6063 6170 6669 7460 603a 2052  .- ``capfit``: R
+00016500: 6574 7572 6e20 6060 2e6d 6573 7361 6765  eturn ``.message
+00016510: 6060 2061 7474 7269 6275 7465 2e0d 0a2d  `` attribute...-
+00016520: 2060 6063 6170 6669 7460 603a 2049 6d70   ``capfit``: Imp
+00016530: 726f 7665 6420 6060 7874 6f6c 6060 2063  roved ``xtol`` c
+00016540: 6f6e 7665 7267 656e 6365 2074 6573 742e  onvergence test.
+00016550: 0d0a 2d20 6060 6361 7066 6974 6060 3a20  ..- ``capfit``: 
+00016560: 4f6e 6c79 2061 6363 6570 7420 6669 6e61  Only accept fina
+00016570: 6c20 6d6f 7665 2069 6620 6060 6368 6932  l move if ``chi2
+00016580: 6060 2064 6563 7265 6173 6564 2e0d 0a2d  `` decreased...-
+00016590: 2060 6063 6170 6669 7460 603a 2053 7472   ``capfit``: Str
+000165a0: 6963 746c 7920 7361 7469 7366 7920 626f  ictly satisfy bo
+000165b0: 756e 6473 2064 7572 696e 6720 4a61 636f  unds during Jaco
+000165c0: 6269 616e 2063 6f6d 7075 7461 7469 6f6e  bian computation
+000165d0: 2e0d 0a0d 0a56 362e 372e 3136 3a20 4d43  .....V6.7.16: MC
+000165e0: 2c20 4f78 666f 7264 2c20 3132 204a 756e  , Oxford, 12 Jun
+000165f0: 6520 3230 3139 0d0a 2b2b 2b2b 2b2b 2b2b  e 2019..++++++++
+00016600: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016610: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2060  +++++++++....- `
+00016620: 6063 6170 6669 7460 603a 2055 7365 206f  `capfit``: Use o
+00016630: 6e6c 7920 6672 6565 2070 6172 616d 6574  nly free paramet
+00016640: 6572 7320 666f 7220 6060 7874 6f6c 6060  ers for ``xtol``
+00016650: 2063 6f6e 7665 7267 656e 6365 2074 6573   convergence tes
+00016660: 742e 0d0a 2d20 6060 6361 7066 6974 6060  t...- ``capfit``
+00016670: 3a20 4465 7363 7269 6265 2069 6e20 776f  : Describe in wo
+00016680: 7264 7320 636f 6e76 6572 6765 6e63 6520  rds convergence 
+00016690: 7374 6174 7573 2077 6974 6820 6e6f 6e7a  status with nonz
+000166a0: 6572 6f20 6060 7665 7262 6f73 6560 602e  ero ``verbose``.
+000166b0: 0d0a 2d20 6060 6361 7066 6974 6060 3a20  ..- ``capfit``: 
+000166c0: 4669 7865 6420 7072 6f67 7261 6d20 7374  Fixed program st
+000166d0: 6f70 2077 6865 6e20 6060 6162 735f 7374  op when ``abs_st
+000166e0: 6570 6060 2069 7320 756e 6465 6669 6e65  ep`` is undefine
+000166f0: 642e 0d0a 2d20 6060 6361 7066 6974 6060  d...- ``capfit``
+00016700: 3a20 4669 7865 6420 6967 6e6f 7269 6e67  : Fixed ignoring
+00016710: 206f 7074 696f 6e61 6c20 6060 6d61 785f   optional ``max_
+00016720: 6e66 6576 6060 2e0d 0a0d 0a56 362e 372e  nfev``.....V6.7.
+00016730: 3135 3a20 4d43 2c20 4f78 666f 7264 2c20  15: MC, Oxford, 
+00016740: 3720 4665 6272 7561 7279 2032 3031 390d  7 February 2019.
+00016750: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
+00016760: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016770: 2b2b 2b2b 2b0d 0a2d 2052 656d 6f76 6564  +++++..- Removed
+00016780: 2075 6e75 7365 6420 6060 7265 6060 2069   unused ``re`` i
+00016790: 6d70 6f72 742e 0d0a 2d20 5265 6d6f 7665  mport...- Remove
+000167a0: 6420 5363 6970 7927 7320 6060 6e65 7874  d Scipy's ``next
+000167b0: 5f66 6173 745f 6c65 6e60 6020 7573 6167  _fast_len`` usag
+000167c0: 6520 6475 6520 746f 2061 6e20 6973 7375  e due to an issu
+000167d0: 6520 7769 7468 206f 6464 2070 6164 6469  e with odd paddi
+000167e0: 6e67 2073 697a 652e 0d0a 2020 5468 616e  ng size...  Than
+000167f0: 6b73 2074 6f20 4572 6963 2045 6d73 656c  ks to Eric Emsel
+00016800: 6c65 6d20 2845 534f 2920 666f 7220 6120  lem (ESO) for a 
+00016810: 636c 6561 7220 6578 616d 706c 6520 696c  clear example il
+00016820: 6c75 7374 7261 7469 6e67 2074 6869 7320  lustrating this 
+00016830: 7261 7265 2061 6e64 0d0a 2020 7375 6274  rare and..  subt
+00016840: 6c65 2062 7567 2e0d 0a0d 0a56 362e 372e  le bug.....V6.7.
+00016850: 3134 3a20 4d43 2c20 4f78 666f 7264 2c20  14: MC, Oxford, 
+00016860: 3237 204e 6f76 656d 6265 7220 3230 3138  27 November 2018
+00016870: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+00016880: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016890: 2b2b 2b2b 2b2b 2b2b 0d0a 2d20 5072 696e  ++++++++..- Prin
+000168a0: 7420 7468 6520 7573 6564 2060 6074 6965  t the used ``tie
+000168b0: 6460 6020 7061 7261 6d65 7465 7273 2065  d`` parameters e
+000168c0: 7175 616c 6974 6965 732c 2069 6620 616e  qualities, if an
+000168d0: 792e 0d0a 2d20 5265 7475 726e 2060 602e  y...- Return ``.
+000168e0: 6e64 6f66 6060 2061 7474 7269 6275 7465  ndof`` attribute
+000168f0: 2e0d 0a2d 2044 6f20 6e6f 7420 7265 6d6f  ...- Do not remo
+00016900: 7665 2060 6066 6978 6564 6060 206f 7220  ve ``fixed`` or 
+00016910: 6060 7469 6564 6060 2070 6172 616d 6574  ``tied`` paramet
+00016920: 6572 7320 6672 6f6d 2074 6865 2044 4f46  ers from the DOF
+00016930: 2063 616c 6375 6c61 7469 6f6e 2e0d 0a20   calculation... 
+00016940: 2054 6861 6e6b 7320 746f 204a 6f61 6e6e   Thanks to Joann
+00016950: 6120 576f 6f20 2855 6e69 762e 206f 6620  a Woo (Univ. of 
+00016960: 5669 6374 6f72 6961 2920 666f 7220 7468  Victoria) for th
+00016970: 6520 636f 7272 6563 7469 6f6e 2e0d 0a2d  e correction...-
+00016980: 2052 6570 6c61 6365 6420 6060 6e6f 726d   Replaced ``norm
+00016990: 616c 697a 6560 602c 2060 606d 696e 5f61  alize``, ``min_a
+000169a0: 6765 6060 2c20 6060 6d61 785f 6167 6560  ge``, ``max_age`
+000169b0: 6020 616e 6420 6060 6d65 7461 6c60 6020  ` and ``metal`` 
+000169c0: 6b65 7977 6f72 6473 2077 6974 680d 0a20  keywords with.. 
+000169d0: 2060 606e 6f72 6d5f 7261 6e67 6560 602c   ``norm_range``,
+000169e0: 2060 6061 6765 5f72 616e 6765 6060 2061   ``age_range`` a
+000169f0: 6e64 2060 606d 6574 616c 5f72 616e 6765  nd ``metal_range
+00016a00: 6060 2069 6e20 6060 7070 7866 2e6d 696c  `` in ``ppxf.mil
+00016a10: 6573 5f75 7469 6c2e 6d69 6c65 7360 602e  es_util.miles``.
+00016a20: 0d0a 2d20 4669 7865 6420 6060 636c 6f63  ..- Fixed ``cloc
+00016a30: 6b60 6020 6060 4465 7072 6563 6174 696f  k`` ``Deprecatio
+00016a40: 6e57 6172 6e69 6e67 6060 2069 6e20 5079  nWarning`` in Py
+00016a50: 7468 6f6e 2033 2e37 2e0d 0a0d 0a56 362e  thon 3.7.....V6.
+00016a60: 372e 3133 3a20 4d43 2c20 4f78 666f 7264  7.13: MC, Oxford
+00016a70: 2c20 3230 2053 6570 7465 6d62 6572 2032  , 20 September 2
+00016a80: 3031 380d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  018..+++++++++++
+00016a90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016aa0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a2d 2045  +++++++++++..- E
+00016ab0: 7870 616e 6465 6420 646f 6375 6d65 6e74  xpanded document
+00016ac0: 6174 696f 6e20 6f66 2060 6072 6564 6465  ation of ``redde
+00016ad0: 6e69 6e67 6060 2061 6e64 2060 6067 6173  ning`` and ``gas
+00016ae0: 5f72 6564 6465 6e69 6e67 6060 2e0d 0a20  _reddening``... 
+00016af0: 2054 6861 6e6b 7320 746f 204e 6963 6b20   Thanks to Nick 
+00016b00: 426f 6172 646d 616e 2028 556e 6976 2e20  Boardman (Univ. 
+00016b10: 5574 6168 2920 666f 7220 7468 6520 6665  Utah) for the fe
+00016b20: 6564 6261 636b 2e0d 0a2d 2060 6063 6170  edback...- ``cap
+00016b30: 6669 7460 6020 6e6f 7720 7261 6973 6573  fit`` now raises
+00016b40: 2061 6e20 6572 726f 7220 6966 206f 6e65   an error if one
+00016b50: 2074 7269 6573 2074 6f20 7469 6520 7061   tries to tie pa
+00016b60: 7261 6d65 7465 7273 2074 6f20 7468 656d  rameters to them
+00016b70: 7365 6c76 6573 2e0d 0a20 2054 6861 6e6b  selves...  Thank
+00016b80: 7320 746f 204b 796c 6520 5765 7374 6661  s to Kyle Westfa
+00016b90: 6c6c 2028 556e 6976 2e20 5361 6e74 6120  ll (Univ. Santa 
+00016ba0: 4372 757a 2920 666f 7220 7468 6520 7375  Cruz) for the su
+00016bb0: 6767 6573 7469 6f6e 2e0d 0a2d 2060 6063  ggestion...- ``c
+00016bc0: 6170 6669 7460 6020 7573 6573 2050 7974  apfit`` uses Pyt
+00016bd0: 686f 6e20 332e 3620 662d 7374 7269 6e67  hon 3.6 f-string
+00016be0: 732e 0d0a 0d0a 5636 2e37 2e31 323a 204d  s.....V6.7.12: M
+00016bf0: 432c 204f 7866 6f72 642c 2039 204a 756c  C, Oxford, 9 Jul
+00016c00: 7920 3230 3138 0d0a 2b2b 2b2b 2b2b 2b2b  y 2018..++++++++
+00016c10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016c20: 2b2b 2b2b 2b2b 2b2b 0d0a 2d20 416c 6c6f  ++++++++..- Allo
+00016c30: 7720 666f 7220 6060 7665 6c73 6361 6c65  w for ``velscale
+00016c40: 6060 2061 6e64 2060 6076 7379 7374 6060  `` and ``vsyst``
+00016c50: 2074 6f20 6265 204e 756d 7079 2061 7272   to be Numpy arr
+00016c60: 6179 7320 7261 7468 6572 2074 6861 6e20  ays rather than 
+00016c70: 7363 616c 6172 732e 0d0a 2d20 496d 7072  scalars...- Impr
+00016c80: 6f76 6564 2063 7269 7465 7269 6f6e 2066  oved criterion f
+00016c90: 6f72 2077 6865 6e20 7468 6520 4261 6c6d  or when the Balm
+00016ca0: 6572 2073 6572 6965 7320 6973 2077 6974  er series is wit
+00016cb0: 6869 6e20 7468 6520 6669 7474 6564 2077  hin the fitted w
+00016cc0: 6176 656c 656e 6774 680d 0a20 2072 616e  avelength..  ran
+00016cd0: 6765 2069 6e20 6060 7070 7866 2e70 7078  ge in ``ppxf.ppx
+00016ce0: 665f 7574 696c 2e65 6d69 7373 696f 6e5f  f_util.emission_
+00016cf0: 6c69 6e65 7360 602e 2054 6861 6e6b 7320  lines``. Thanks 
+00016d00: 746f 2053 616d 2056 6175 6768 616e 0d0a  to Sam Vaughan..
+00016d10: 2020 2855 6e69 762e 206f 6620 4f78 666f    (Univ. of Oxfo
+00016d20: 7264 2920 666f 7220 7468 6520 6665 6564  rd) for the feed
+00016d30: 6261 636b 2e0d 0a2d 2049 6e63 6c75 6465  back...- Include
+00016d40: 6420 6060 7769 6474 6860 6020 6b65 7977  d ``width`` keyw
+00016d50: 6f72 6420 696e 2060 6070 7078 662e 7070  ord in ``ppxf.pp
+00016d60: 7866 5f75 7469 6c2e 6465 7465 726d 696e  xf_util.determin
+00016d70: 655f 676f 6f64 7069 7865 6c73 6060 2e0d  e_goodpixels``..
+00016d80: 0a20 2054 6861 6e6b 7320 746f 2047 656f  .  Thanks to Geo
+00016d90: 7267 6520 5072 6976 6f6e 2028 556e 6976  rge Privon (Univ
+00016da0: 2e20 6f66 2046 6c6f 7269 6461 2920 666f  . of Florida) fo
+00016db0: 7220 7468 6520 7375 6767 6573 7469 6f6e  r the suggestion
+00016dc0: 2e0d 0a2d 2045 7870 616e 6465 6420 6060  ...- Expanded ``
+00016dd0: 2e67 6173 5f66 6c75 7860 6020 646f 6375  .gas_flux`` docu
+00016de0: 6d65 6e74 6174 696f 6e2e 0d0a 0d0a 5636  mentation.....V6
+00016df0: 2e37 2e31 313a 204d 432c 204f 7866 6f72  .7.11: MC, Oxfor
+00016e00: 642c 2035 204a 756e 6520 3230 3138 0d0a  d, 5 June 2018..
 00016e10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016e20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
-00016e30: 2050 6c6f 7420 7761 7665 6c65 6e67 7468   Plot wavelength
-00016e40: 2069 6e20 6e6d 2069 6e73 7465 6164 206f   in nm instead o
-00016e50: 6620 416e 6773 7472 6f6d 2c20 666f 6c6c  f Angstrom, foll
-00016e60: 6f77 696e 6720 4941 5520 7275 6c65 732e  owing IAU rules.
-00016e70: 0d0a 2d20 456e 7375 7265 7320 6561 6368  ..- Ensures each
-00016e80: 2065 6c65 6d65 6e74 206f 6620 6060 7374   element of ``st
-00016e90: 6172 7460 6020 6973 206e 6f74 206c 6f6e  art`` is not lon
-00016ea0: 6765 7220 7468 616e 2069 7473 2060 606d  ger than its ``m
-00016eb0: 6f6d 656e 7473 6060 2e0d 0a2d 2052 656d  oments``...- Rem
-00016ec0: 6f76 6564 2075 6e64 6572 7363 6f72 6520  oved underscore 
-00016ed0: 6672 6f6d 2069 6e74 6572 6e61 6c20 6675  from internal fu
-00016ee0: 6e63 7469 6f6e 206e 616d 6573 2e0d 0a2d  nction names...-
-00016ef0: 2049 6e63 6c75 6465 6420 6060 6674 6f6c   Included ``ftol
-00016f00: 6060 206b 6579 776f 7264 2e0d 0a0d 0a56  `` keyword.....V
-00016f10: 362e 372e 323a 204d 432c 204f 7866 6f72  6.7.2: MC, Oxfor
-00016f20: 642c 2033 3020 4a61 6e75 6172 7920 3230  d, 30 January 20
-00016f30: 3138 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  18..++++++++++++
+00016e20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016e30: 0d0a 0d0a 2d20 466f 726d 6174 7465 6420  ....- Formatted 
+00016e40: 6060 7070 7866 2e70 7960 6020 646f 6373  ``ppxf.py`` docs
+00016e50: 7472 696e 6720 696e 2072 6553 7472 7563  tring in reStruc
+00016e60: 7475 7265 6454 6578 742e 0d0a 2d20 5265  turedText...- Re
+00016e70: 6d6f 7665 6420 4348 414e 4745 4c4f 4720  moved CHANGELOG 
+00016e80: 6672 6f6d 2074 6865 2063 6f64 6520 616e  from the code an
+00016e90: 6420 706c 6163 6564 2069 7420 696e 2061  d placed it in a
+00016ea0: 2073 6570 6172 6174 6520 6669 6c65 2e0d   separate file..
+00016eb0: 0a2d 204d 6f64 6966 6965 6420 6060 7365  .- Modified ``se
+00016ec0: 7475 702e 7079 6060 2074 6f20 7368 6f77  tup.py`` to show
+00016ed0: 2068 656c 7020 616e 6420 4348 414e 4745   help and CHANGE
+00016ee0: 4c4f 4720 6f6e 2050 7950 6920 7061 6765  LOG on PyPi page
+00016ef0: 2e0d 0a2d 2049 6e63 6c75 6465 6420 6060  ...- Included ``
+00016f00: 7070 7866 2e5f 5f76 6572 7369 6f6e 5f5f  ppxf.__version__
+00016f10: 6060 2e0d 0a0d 0a56 362e 372e 383a 204d  ``.....V6.7.8: M
+00016f20: 432c 204f 7866 6f72 642c 2032 3120 4d61  C, Oxford, 21 Ma
+00016f30: 7920 3230 3138 0d0a 2b2b 2b2b 2b2b 2b2b  y 2018..++++++++
 00016f40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016f50: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2049 6e63  +++++++....- Inc
-00016f60: 6c75 6465 6420 6475 6e64 6572 206e 616d  luded dunder nam
-00016f70: 6573 2061 7320 7375 6767 6573 7465 6420  es as suggested 
-00016f80: 6279 2050 6574 6572 2057 6569 6c62 6163  by Peter Weilbac
-00016f90: 6865 7220 2850 6f74 7364 616d 292e 0d0a  her (Potsdam)...
-00016fa0: 2d20 4669 7865 6420 7772 6f6e 6720 6060  - Fixed wrong ``
-00016fb0: 2e67 6173 5f72 6564 6465 6e69 6e67 6060  .gas_reddening``
-00016fc0: 2077 6865 6e20 6060 6d64 6567 7265 6520   when ``mdegree 
-00016fd0: 3e20 3060 602e 0d0a 2d20 496d 7072 6f76  > 0``...- Improv
-00016fe0: 6564 2066 6f72 6d61 7474 696e 6720 6f66  ed formatting of
-00016ff0: 2074 6865 2064 6f63 756d 656e 7461 7469   the documentati
-00017000: 6f6e 2e0d 0a0d 0a56 362e 372e 313a 204d  on.....V6.7.1: M
-00017010: 432c 204f 7866 6f72 642c 2032 3920 4e6f  C, Oxford, 29 No
-00017020: 7665 6d62 6572 2032 3031 370d 0a2b 2b2b  vember 2017..+++
-00017030: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017040: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017050: 2b0d 0a0d 0a2d 2052 656d 6f76 6564 2069  +....- Removed i
-00017060: 6d70 6f72 7420 6f66 2060 606d 6973 632e  mport of ``misc.
-00017070: 6661 6374 6f72 6961 6c60 602c 2064 6570  factorial``, dep
-00017080: 7265 6361 7465 6420 696e 2053 6369 7079  recated in Scipy
-00017090: 2031 2e30 2e0d 0a0d 0a56 362e 372e 303a   1.0.....V6.7.0:
-000170a0: 204d 432c 204f 7866 6f72 642c 2036 204e   MC, Oxford, 6 N
-000170b0: 6f76 656d 6265 7220 3230 3137 0d0a 2b2b  ovember 2017..++
-000170c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000170d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000170e0: 2b0d 0a0d 0a2d 2041 6c6c 6f77 2075 7365  +....- Allow use
-000170f0: 7273 2074 6f20 696e 7075 7420 6964 656e  rs to input iden
-00017100: 7469 6361 6c6c 7920 7a65 726f 2067 6173  tically zero gas
-00017110: 2074 656d 706c 6174 6573 2077 6869 6c65   templates while
-00017120: 2073 7469 6c6c 0d0a 2020 7072 6f64 7563   still..  produc
-00017130: 696e 6720 6120 7374 6162 6c65 204e 4e4c  ing a stable NNL
-00017140: 5320 736f 6c75 7469 6f6e 2e20 496e 2074  S solution. In t
-00017150: 6869 7320 6361 7365 2c20 7761 726e 2074  his case, warn t
-00017160: 6865 2075 7365 7220 616e 6420 7365 740d  he user and set.
-00017170: 0a20 2074 6865 202e 6761 735f 7a65 726f  .  the .gas_zero
-00017180: 5f74 656d 706c 6174 6520 6174 7472 6962  _template attrib
-00017190: 7574 652e 2054 6869 7320 7369 7475 6174  ute. This situat
-000171a0: 696f 6e20 6361 6e20 696e 6469 6361 7465  ion can indicate
-000171b0: 2061 6e20 696e 7075 740d 0a20 2062 7567   an input..  bug
-000171c0: 206f 7220 6120 6761 7320 6c69 6e65 2074   or a gas line t
-000171d0: 6861 7420 656e 7469 7265 6c79 2066 616c  hat entirely fal
-000171e0: 6c73 2077 6974 6869 6e20 6120 6d61 736b  ls within a mask
-000171f0: 6564 2072 6567 696f 6e2e 0d0a 2d20 436f  ed region...- Co
-00017200: 7272 6563 7465 6420 6060 6761 735f 666c  rrected ``gas_fl
-00017210: 7578 5f65 7272 6f72 6060 206e 6f72 6d61  ux_error`` norma
-00017220: 6c69 7a61 7469 6f6e 2c20 7768 656e 2069  lization, when i
-00017230: 6e70 7574 206e 6f74 206e 6f72 6d61 6c69  nput not normali
-00017240: 7a65 642e 0d0a 2d20 5265 7475 726e 2060  zed...- Return `
-00017250: 602e 6761 735f 6265 7374 6669 7460 602c  `.gas_bestfit``,
-00017260: 2060 602e 6761 735f 6d70 6f6c 7960 602c   ``.gas_mpoly``,
-00017270: 2060 602e 6d70 6f6c 7960 6020 616e 6420   ``.mpoly`` and 
-00017280: 6060 2e61 706f 6c79 6060 2061 7474 7269  ``.apoly`` attri
-00017290: 6275 7465 732e 0d0a 2d20 446f 206e 6f74  butes...- Do not
-000172a0: 206d 756c 7469 706c 7920 6761 7320 656d   multiply gas em
-000172b0: 6973 7369 6f6e 206c 696e 6573 2062 7920  ission lines by 
-000172c0: 706f 6c79 6e6f 6d69 616c 732c 2069 6e73  polynomials, ins
-000172d0: 7465 6164 2061 6c6c 6f77 2066 6f72 0d0a  tead allow for..
-000172e0: 2020 6060 6761 735f 7265 6464 656e 696e    ``gas_reddenin
-000172f0: 6760 6020 2875 7365 6675 6c20 7769 7468  g`` (useful with
-00017300: 2074 6965 6420 4261 6c6d 6572 2065 6d69   tied Balmer emi
-00017310: 7373 696f 6e20 6c69 6e65 7329 2e0d 0a2d  ssion lines)...-
-00017320: 2055 7365 2060 6061 7876 7370 616e 6060   Use ``axvspan``
-00017330: 2074 6f20 7669 7375 616c 697a 6520 6d61   to visualize ma
-00017340: 736b 6564 2072 6567 696f 6e73 2069 6e20  sked regions in 
-00017350: 7468 6520 706c 6f74 2e0d 0a2d 2046 6978  the plot...- Fix
-00017360: 6564 2070 726f 6772 616d 2073 746f 7020  ed program stop 
-00017370: 7769 7468 2060 606c 696e 6561 7260 6020  with ``linear`` 
-00017380: 6b65 7977 6f72 642e 0d0a 2d20 496e 7472  keyword...- Intr
-00017390: 6f64 7563 6564 2060 6072 6564 6465 6e69  oduced ``reddeni
-000173a0: 6e67 5f66 756e 6360 6020 6b65 7977 6f72  ng_func`` keywor
-000173b0: 642e 0d0a 0d0a 5636 2e36 2e34 3a20 4d43  d.....V6.6.4: MC
-000173c0: 2c20 4f78 666f 7264 2c20 3520 4f63 746f  , Oxford, 5 Octo
-000173d0: 6265 7220 3230 3137 0d0a 2b2b 2b2b 2b2b  ber 2017..++++++
+00016f50: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 204d 6f76  +++++++....- Mov
+00016f60: 6564 2070 6163 6b61 6765 2074 6f20 7468  ed package to th
+00016f70: 6520 5079 7468 6f6e 2050 6163 6b61 6765  e Python Package
+00016f80: 2049 6e64 6578 2028 5079 5069 292e 0d0a   Index (PyPi)...
+00016f90: 2d20 4472 6f70 7065 6420 6c65 6761 6379  - Dropped legacy
+00016fa0: 2050 7974 686f 6e20 322e 3720 7375 7070   Python 2.7 supp
+00016fb0: 6f72 742e 0d0a 0d0a 5636 2e37 2e36 3a20  ort.....V6.7.6: 
+00016fc0: 4d43 2c20 4f78 666f 7264 2c20 3136 2041  MC, Oxford, 16 A
+00016fd0: 7072 696c 2032 3031 380d 0a2b 2b2b 2b2b  pril 2018..+++++
+00016fe0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016ff0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+00017000: 2d20 4368 616e 6765 6420 696d 706f 7274  - Changed import
+00017010: 7320 666f 7220 7468 6520 636f 6e76 6572  s for the conver
+00017020: 7369 6f6e 206f 6620 7050 5846 2074 6f20  sion of pPXF to 
+00017030: 6120 7061 636b 6167 652e 0d0a 2020 5468  a package...  Th
+00017040: 616e 6b73 2074 6f20 4a6f 6520 4275 7263  anks to Joe Burc
+00017050: 6865 7474 2028 5361 6e74 6120 4372 757a  hett (Santa Cruz
+00017060: 2920 666f 7220 7468 6520 7375 6767 6573  ) for the sugges
+00017070: 7469 6f6e 2e0d 0a0d 0a56 362e 372e 353a  tion.....V6.7.5:
+00017080: 204d 432c 204f 7866 6f72 642c 2031 3020   MC, Oxford, 10 
+00017090: 4170 7269 6c20 3230 3138 0d0a 2b2b 2b2b  April 2018..++++
+000170a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000170b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+000170c0: 0a2d 2046 6978 6564 2073 796e 7461 7820  .- Fixed syntax 
+000170d0: 6572 726f 7220 756e 6465 7220 5079 7468  error under Pyth
+000170e0: 6f6e 2032 2e37 2e0d 0a0d 0a56 362e 372e  on 2.7.....V6.7.
+000170f0: 343a 204d 432c 204f 7866 6f72 642c 2031  4: MC, Oxford, 1
+00017100: 3620 4665 6272 7561 7279 2032 3031 380d  6 February 2018.
+00017110: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
+00017120: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017130: 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978 6564  +++++....- Fixed
+00017140: 2062 7567 2069 6e20 6060 7265 6464 656e   bug in ``redden
+00017150: 696e 675f 6361 6c30 3028 2960 602e 2049  ing_cal00()``. I
+00017160: 7420 6f6e 6c79 2061 6666 6563 7465 6420  t only affected 
+00017170: 4e49 5220 6c61 6d20 3e20 3130 3030 206e  NIR lam > 1000 n
+00017180: 6d2e 0d0a 0d0a 5636 2e37 2e33 3a20 4d43  m.....V6.7.3: MC
+00017190: 2c20 4f78 666f 7264 2c20 3820 4665 6272  , Oxford, 8 Febr
+000171a0: 7561 7279 2032 3031 380d 0a2b 2b2b 2b2b  uary 2018..+++++
+000171b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000171c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
+000171d0: 0d0a 2d20 506c 6f74 2077 6176 656c 656e  ..- Plot wavelen
+000171e0: 6774 6820 696e 206e 6d20 696e 7374 6561  gth in nm instea
+000171f0: 6420 6f66 2041 6e67 7374 726f 6d2c 2066  d of Angstrom, f
+00017200: 6f6c 6c6f 7769 6e67 2049 4155 2072 756c  ollowing IAU rul
+00017210: 6573 2e0d 0a2d 2045 6e73 7572 6573 2065  es...- Ensures e
+00017220: 6163 6820 656c 656d 656e 7420 6f66 2060  ach element of `
+00017230: 6073 7461 7274 6060 2069 7320 6e6f 7420  `start`` is not 
+00017240: 6c6f 6e67 6572 2074 6861 6e20 6974 7320  longer than its 
+00017250: 6060 6d6f 6d65 6e74 7360 602e 0d0a 2d20  ``moments``...- 
+00017260: 5265 6d6f 7665 6420 756e 6465 7273 636f  Removed undersco
+00017270: 7265 2066 726f 6d20 696e 7465 726e 616c  re from internal
+00017280: 2066 756e 6374 696f 6e20 6e61 6d65 732e   function names.
+00017290: 0d0a 2d20 496e 636c 7564 6564 2060 6066  ..- Included ``f
+000172a0: 746f 6c60 6020 6b65 7977 6f72 642e 0d0a  tol`` keyword...
+000172b0: 0d0a 5636 2e37 2e32 3a20 4d43 2c20 4f78  ..V6.7.2: MC, Ox
+000172c0: 666f 7264 2c20 3330 204a 616e 7561 7279  ford, 30 January
+000172d0: 2032 3031 380d 0a2b 2b2b 2b2b 2b2b 2b2b   2018..+++++++++
+000172e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000172f0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
+00017300: 496e 636c 7564 6564 2064 756e 6465 7220  Included dunder 
+00017310: 6e61 6d65 7320 6173 2073 7567 6765 7374  names as suggest
+00017320: 6564 2062 7920 5065 7465 7220 5765 696c  ed by Peter Weil
+00017330: 6261 6368 6572 2028 506f 7473 6461 6d29  bacher (Potsdam)
+00017340: 2e0d 0a2d 2046 6978 6564 2077 726f 6e67  ...- Fixed wrong
+00017350: 2060 602e 6761 735f 7265 6464 656e 696e   ``.gas_reddenin
+00017360: 6760 6020 7768 656e 2060 606d 6465 6772  g`` when ``mdegr
+00017370: 6565 203e 2030 6060 2e0d 0a2d 2049 6d70  ee > 0``...- Imp
+00017380: 726f 7665 6420 666f 726d 6174 7469 6e67  roved formatting
+00017390: 206f 6620 7468 6520 646f 6375 6d65 6e74   of the document
+000173a0: 6174 696f 6e2e 0d0a 0d0a 5636 2e37 2e31  ation.....V6.7.1
+000173b0: 3a20 4d43 2c20 4f78 666f 7264 2c20 3239  : MC, Oxford, 29
+000173c0: 204e 6f76 656d 6265 7220 3230 3137 0d0a   November 2017..
+000173d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 000173e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000173f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-00017400: 2d20 4368 6563 6b20 666f 7220 4e61 4e20  - Check for NaN 
-00017410: 696e 2060 6067 616c 6178 7960 6020 616e  in ``galaxy`` an
-00017420: 6420 6368 6563 6b20 616c 6c20 6060 626f  d check all ``bo
-00017430: 756e 6473 6060 2068 6176 6520 7477 6f20  unds`` have two 
-00017440: 656c 656d 656e 7473 2e0d 0a2d 2041 6c6c  elements...- All
-00017450: 6f77 2060 6073 7461 7274 6060 2074 6f20  ow ``start`` to 
-00017460: 6265 2065 6974 6865 7220 6120 6c69 7374  be either a list
-00017470: 206f 7220 616e 2061 7272 6179 206f 7220   or an array or 
-00017480: 7665 6374 6f72 732e 0d0a 0d0a 5636 2e36  vectors.....V6.6
-00017490: 2e33 3a20 4d43 2c20 4f78 666f 7264 2c20  .3: MC, Oxford, 
-000174a0: 3235 2053 6570 7465 6d62 6572 2032 3031  25 September 201
-000174b0: 370d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  7..+++++++++++++
-000174c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000174d0: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5265  ++++++++....- Re
-000174e0: 6475 6365 6420 626f 756e 6473 206f 6e20  duced bounds on 
-000174f0: 6d75 6c74 6970 6c69 6361 7469 7665 2070  multiplicative p
-00017500: 6f6c 796e 6f6d 6961 6c73 2061 6e64 2063  olynomials and c
-00017510: 6c69 7070 6564 2074 6f20 706f 7369 7469  lipped to positi
-00017520: 7665 0d0a 2020 7661 6c75 6573 2e20 5468  ve..  values. Th
-00017530: 616e 6b73 2074 6f20 5869 6861 6e20 4a69  anks to Xihan Ji
-00017540: 2028 5473 696e 6768 7561 2055 6e69 7665   (Tsinghua Unive
-00017550: 7273 6974 7929 2066 6f72 2070 726f 7669  rsity) for provi
-00017560: 6469 6e67 2061 6e0d 0a20 2065 7861 6d70  ding an..  examp
-00017570: 6c65 206f 6620 736c 6967 6874 6c79 206e  le of slightly n
-00017580: 6567 6174 6976 6520 6761 7320 656d 6973  egative gas emis
-00017590: 7369 6f6e 206c 696e 6573 2c20 7768 656e  sion lines, when
-000175a0: 2074 6865 2073 7065 6374 7275 6d0d 0a20   the spectrum.. 
-000175b0: 2063 6f6e 7461 696e 7320 6573 7365 6e74   contains essent
-000175c0: 6961 6c6c 7920 6a75 7374 206e 6f69 7365  ially just noise
-000175d0: 2e0d 0a2d 2049 6d70 726f 7665 6420 7669  ...- Improved vi
-000175e0: 7375 616c 697a 6174 696f 6e20 6f66 206d  sualization of m
-000175f0: 6173 6b65 6420 7069 7865 6c73 2e0d 0a0d  asked pixels....
-00017600: 0a56 362e 362e 323a 204d 432c 204f 7866  .V6.6.2: MC, Oxf
-00017610: 6f72 642c 2031 3520 5365 7074 656d 6265  ord, 15 Septembe
-00017620: 7220 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b  r 2017..++++++++
-00017630: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017640: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00017650: 0a2d 2046 6978 6564 2070 726f 6772 616d  .- Fixed program
-00017660: 2073 746f 7020 7769 7468 2061 2032 2d64   stop with a 2-d
-00017670: 696d 2074 656d 706c 6174 6520 6172 7261  im template arra
-00017680: 7920 616e 6420 7265 6775 6c61 7269 7a61  y and regulariza
-00017690: 7469 6f6e 2e0d 0a20 2054 6861 6e6b 7320  tion...  Thanks 
-000176a0: 746f 2041 6472 6961 6e6f 2050 6f63 6920  to Adriano Poci 
-000176b0: 284d 6163 7175 6172 6965 2055 6e69 7665  (Macquarie Unive
-000176c0: 7273 6974 7929 2066 6f72 2074 6865 2063  rsity) for the c
-000176d0: 6c65 6172 2072 6570 6f72 7420 616e 640d  lear report and.
-000176e0: 0a20 2074 6865 2066 6978 2e0d 0a0d 0a56  .  the fix.....V
-000176f0: 362e 362e 313a 204d 432c 204f 7866 6f72  6.6.1: MC, Oxfor
-00017700: 642c 2034 2041 7567 7573 7420 3230 3137  d, 4 August 2017
-00017710: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-00017720: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017730: 2b2b 2b0d 0a0d 0a2d 2049 6e63 6c75 6465  +++....- Include
-00017740: 6420 6e6f 7465 206f 6e20 6060 2e67 6173  d note on ``.gas
-00017750: 5f66 6c75 7860 6020 6f75 7470 7574 2075  _flux`` output u
-00017760: 6e69 7473 2e20 5468 616e 6b73 2074 6f20  nits. Thanks to 
-00017770: 5869 6861 6e20 4a69 0d0a 2020 2854 7369  Xihan Ji..  (Tsi
-00017780: 6e67 6875 6120 556e 6976 6572 7369 7479  nghua University
-00017790: 2920 666f 7220 7468 6520 6665 6564 6261  ) for the feedba
-000177a0: 636b 2e0d 0a0d 0a56 362e 362e 303a 204d  ck.....V6.6.0: M
-000177b0: 432c 204f 7866 6f72 642c 2032 3720 4a75  C, Oxford, 27 Ju
-000177c0: 6e65 2032 3031 370d 0a2b 2b2b 2b2b 2b2b  ne 2017..+++++++
-000177d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000177e0: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2050  +++++++++....- P
-000177f0: 7269 6e74 2061 6e64 2072 6574 7572 6e20  rint and return 
-00017800: 6761 7320 666c 7578 6573 2061 6e64 2065  gas fluxes and e
-00017810: 7272 6f72 732c 2069 6620 7265 7175 6573  rrors, if reques
-00017820: 7465 642c 2077 6974 6820 7468 6520 6e65  ted, with the ne
-00017830: 770d 0a20 2060 6067 6173 5f63 6f6d 706f  w..  ``gas_compo
-00017840: 6e65 6e74 6060 2061 6e64 2060 6067 6173  nent`` and ``gas
-00017850: 5f6e 616d 6573 6060 206b 6579 776f 7264  _names`` keyword
-00017860: 732e 0d0a 0d0a 5636 2e35 2e30 3a20 4d43  s.....V6.5.0: MC
-00017870: 2c20 4f78 666f 7264 2c20 3233 204a 756e  , Oxford, 23 Jun
-00017880: 6520 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b  e 2017..++++++++
-00017890: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000178a0: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5265  ++++++++....- Re
-000178b0: 706c 6163 6564 2060 604d 5046 4954 6060  placed ``MPFIT``
-000178c0: 2077 6974 6820 6060 6361 7066 6974 6060   with ``capfit``
-000178d0: 2066 6f72 2061 204c 6576 656e 6265 7267   for a Levenberg
-000178e0: 2d4d 6172 7175 6172 6474 206d 6574 686f  -Marquardt metho
-000178f0: 6420 7769 7468 0d0a 2020 6669 7865 6420  d with..  fixed 
-00017900: 6f72 2074 6965 6420 7661 7269 6162 6c65  or tied variable
-00017910: 732c 2077 6869 6368 2072 6967 6f72 6f75  s, which rigorou
-00017920: 736c 7920 6163 636f 756e 7473 2066 6f72  sly accounts for
-00017930: 2062 6f78 2063 6f6e 7374 7261 696e 7473   box constraints
-00017940: 2e0d 0a0d 0a56 362e 342e 323a 204d 432c  .....V6.4.2: MC,
-00017950: 204f 7866 6f72 642c 2032 204a 756e 6520   Oxford, 2 June 
-00017960: 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2017..++++++++++
-00017970: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017980: 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978 6564  +++++....- Fixed
-00017990: 2072 656d 6f76 616c 206f 6620 626f 756e   removal of boun
-000179a0: 6473 2069 6e20 736f 6c75 7469 6f6e 2c20  ds in solution, 
-000179b0: 696e 7472 6f64 7563 6564 2069 6e20 5636  introduced in V6
-000179c0: 2e34 2e31 2e0d 0a20 2054 6861 6e6b 7320  .4.1...  Thanks 
-000179d0: 746f 204b 796c 6520 5765 7374 6661 6c6c  to Kyle Westfall
-000179e0: 2028 556e 6976 2e20 5361 6e74 6120 4372   (Univ. Santa Cr
-000179f0: 757a 2920 666f 7220 7265 706f 7274 696e  uz) for reportin
-00017a00: 6720 7468 6973 2e0d 0a2d 2049 6e63 6c75  g this...- Inclu
-00017a10: 6465 6420 6060 6d65 7468 6f64 6060 206b  ded ``method`` k
-00017a20: 6579 776f 7264 2074 6f20 7573 6520 5363  eyword to use Sc
-00017a30: 6970 7927 7320 6060 6c65 6173 745f 7371  ipy's ``least_sq
-00017a40: 7561 7265 7328 2960 600d 0a20 2061 7320  uares()``..  as 
-00017a50: 616e 2061 6c74 6572 6e61 7469 7665 2074  an alternative t
-00017a60: 6f20 4d50 4649 542e 0d0a 2d20 466f 7263  o MPFIT...- Forc
-00017a70: 6520 666c 6f61 7420 6469 7669 7369 6f6e  e float division
-00017a80: 2069 6e20 7069 7865 6c20 636f 6e76 6572   in pixel conver
-00017a90: 7369 6f6e 206f 6620 6060 7374 6172 7460  sion of ``start`
-00017aa0: 6020 616e 6420 6060 626f 756e 6473 6060  ` and ``bounds``
-00017ab0: 2e0d 0a0d 0a56 362e 342e 313a 204d 432c  .....V6.4.1: MC,
-00017ac0: 204f 7866 6f72 642c 2032 3520 4d61 7920   Oxford, 25 May 
-00017ad0: 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2017..++++++++++
-00017ae0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017af0: 2b2b 2b2b 2b0d 0a0d 0a2d 2060 606c 696e  +++++....- ``lin
-00017b00: 6561 725f 6669 7428 2960 6020 646f 6573  ear_fit()`` does
-00017b10: 206e 6f74 2072 6574 7572 6e20 756e 7573   not return unus
-00017b20: 6564 2073 7461 7475 7320 616e 796d 6f72  ed status anymor
-00017b30: 652c 2066 6f72 0d0a 2020 636f 6e73 6973  e, for..  consis
-00017b40: 7465 6e63 7920 7769 7468 2074 6865 2063  tency with the c
-00017b50: 6f72 7265 7370 6f6e 6469 6e67 2063 6861  orresponding cha
-00017b60: 6e67 6520 746f 2060 6063 6170 5f6d 7066  nge to ``cap_mpf
-00017b70: 6974 6060 2e0d 0a0d 0a56 362e 342e 303a  it``.....V6.4.0:
-00017b80: 204d 432c 204f 7866 6f72 642c 2031 3220   MC, Oxford, 12 
-00017b90: 4d61 7920 3230 3137 0d0a 2b2b 2b2b 2b2b  May 2017..++++++
-00017ba0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017bb0: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2049  +++++++++....- I
-00017bc0: 6e74 726f 6475 6365 6420 6060 7469 6564  ntroduced ``tied
-00017bd0: 6060 206b 6579 776f 7264 2074 6f20 7469  `` keyword to ti
-00017be0: 6520 7061 7261 6d65 7465 7273 2064 7572  e parameters dur
-00017bf0: 696e 6720 6669 7474 696e 672e 0d0a 2d20  ing fitting...- 
-00017c00: 496e 636c 7564 6564 2064 6973 6375 7373  Included discuss
-00017c10: 696f 6e20 6f66 2066 6f72 6d61 6c20 6572  ion of formal er
-00017c20: 726f 7273 206f 6620 6060 2e77 6569 6768  rors of ``.weigh
-00017c30: 7473 6060 2e0d 0a0d 0a56 362e 332e 323a  ts``.....V6.3.2:
-00017c40: 204d 432c 204f 7866 6f72 642c 2034 204d   MC, Oxford, 4 M
-00017c50: 6179 2032 3031 370d 0a2b 2b2b 2b2b 2b2b  ay 2017..+++++++
-00017c60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017c70: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978  +++++++....- Fix
-00017c80: 6564 2070 6f73 7369 626c 6520 7072 6f67  ed possible prog
-00017c90: 7261 6d20 7374 6f70 2069 6e74 726f 6475  ram stop introdu
-00017ca0: 6365 6420 696e 2056 362e 302e 3720 616e  ced in V6.0.7 an
-00017cb0: 6420 636f 6e73 6571 7565 6e74 6c79 0d0a  d consequently..
-00017cc0: 2020 7265 6d6f 7665 6420 756e 6e65 6365    removed unnece
-00017cd0: 7373 6172 7920 6675 6e63 7469 6f6e 2060  ssary function `
-00017ce0: 605f 7465 6d70 6c61 7465 735f 7266 6674  `_templates_rfft
-00017cf0: 2829 6060 2e20 4d61 6e79 2074 6861 6e6b  ()``. Many thank
-00017d00: 7320 746f 0d0a 2020 4a65 7375 7320 4661  s to..  Jesus Fa
-00017d10: 6c63 6f6e 2d42 6172 726f 736f 2066 6f72  lcon-Barroso for
-00017d20: 2061 2076 6572 7920 636c 6561 7220 616e   a very clear an
-00017d30: 6420 7573 6566 756c 2062 7567 2072 6570  d useful bug rep
-00017d40: 6f72 7421 0d0a 0d0a 5636 2e33 2e31 3a20  ort!....V6.3.1: 
-00017d50: 4d43 2c20 4f78 666f 7264 2c20 3133 2041  MC, Oxford, 13 A
-00017d60: 7072 696c 2032 3031 370d 0a2b 2b2b 2b2b  pril 2017..+++++
-00017d70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017d80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-00017d90: 2d20 4669 7865 6420 7072 6f67 7261 6d20  - Fixed program 
-00017da0: 7374 6f70 2077 6865 6e20 6669 7474 696e  stop when fittin
-00017db0: 6720 7477 6f20 6761 6c61 7879 2073 7065  g two galaxy spe
-00017dc0: 6374 7261 2077 6974 680d 0a20 2072 6566  ctra with..  ref
-00017dd0: 6c65 6374 696f 6e2d 7379 6d6d 6574 7269  lection-symmetri
-00017de0: 6320 4c4f 5356 442e 0d0a 0d0a 5636 2e33  c LOSVD.....V6.3
-00017df0: 2e30 3a20 4d43 2c20 4f78 666f 7264 2c20  .0: MC, Oxford, 
-00017e00: 3330 204d 6172 6368 2032 3031 370d 0a2b  30 March 2017..+
-00017e10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017e20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017e30: 0d0a 0d0a 2d20 496e 636c 7564 6564 2060  ....- Included `
-00017e40: 6072 6567 5f6f 7264 6060 206b 6579 776f  `reg_ord`` keywo
-00017e50: 7264 2074 6f20 616c 6c6f 7720 666f 7220  rd to allow for 
-00017e60: 626f 7468 2066 6972 7374 2061 6e64 2073  both first and s
-00017e70: 6563 6f6e 642d 6f72 6465 720d 0a20 2072  econd-order..  r
-00017e80: 6567 756c 6172 697a 6174 696f 6e2e 0d0a  egularization...
-00017e90: 0d0a 5636 2e32 2e30 3a20 4d43 2c20 4f78  ..V6.2.0: MC, Ox
-00017ea0: 666f 7264 2c20 3237 204d 6172 6368 2032  ford, 27 March 2
-00017eb0: 3031 370d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  017..+++++++++++
-00017ec0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017ed0: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 496d 7072  ++++++....- Impr
-00017ee0: 6f76 6564 2063 7572 7661 7475 7265 2063  oved curvature c
-00017ef0: 7269 7465 7269 6f6e 2066 6f72 2072 6567  riterion for reg
-00017f00: 756c 6172 697a 6174 696f 6e20 7768 656e  ularization when
-00017f10: 2060 6064 696d 203e 2031 6060 2e0d 0a0d   ``dim > 1``....
-00017f20: 0a56 362e 312e 303a 204d 432c 204f 7866  .V6.1.0: MC, Oxf
-00017f30: 6f72 642c 2031 3520 4d61 7263 6820 3230  ord, 15 March 20
-00017f40: 3137 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  17..++++++++++++
-00017f50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017f60: 2b2b 2b2b 2b0d 0a0d 0a2d 2049 6e74 726f  +++++....- Intro
-00017f70: 6475 6365 6420 6060 7472 6967 6060 206b  duced ``trig`` k
-00017f80: 6579 776f 7264 2074 6f20 7573 6520 6120  eyword to use a 
-00017f90: 7472 6967 6f6e 6f6d 6574 7269 6320 7365  trigonometric se
-00017fa0: 7269 6573 2061 730d 0a20 2061 6c74 6572  ries as..  alter
-00017fb0: 6e61 7469 7665 2074 6f20 4c65 6765 6e64  native to Legend
-00017fc0: 7265 2070 6f6c 796e 6f6d 6961 6c73 2e0d  re polynomials..
-00017fd0: 0a0d 0a56 362e 302e 373a 204d 432c 204f  ...V6.0.7: MC, O
-00017fe0: 7866 6f72 642c 2031 3320 4d61 7263 6820  xford, 13 March 
-00017ff0: 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2017..++++++++++
+000173f0: 2b2b 2b2b 0d0a 0d0a 2d20 5265 6d6f 7665  ++++....- Remove
+00017400: 6420 696d 706f 7274 206f 6620 6060 6d69  d import of ``mi
+00017410: 7363 2e66 6163 746f 7269 616c 6060 2c20  sc.factorial``, 
+00017420: 6465 7072 6563 6174 6564 2069 6e20 5363  deprecated in Sc
+00017430: 6970 7920 312e 302e 0d0a 0d0a 5636 2e37  ipy 1.0.....V6.7
+00017440: 2e30 3a20 4d43 2c20 4f78 666f 7264 2c20  .0: MC, Oxford, 
+00017450: 3620 4e6f 7665 6d62 6572 2032 3031 370d  6 November 2017.
+00017460: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
+00017470: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017480: 2b2b 2b2b 0d0a 0d0a 2d20 416c 6c6f 7720  ++++....- Allow 
+00017490: 7573 6572 7320 746f 2069 6e70 7574 2069  users to input i
+000174a0: 6465 6e74 6963 616c 6c79 207a 6572 6f20  dentically zero 
+000174b0: 6761 7320 7465 6d70 6c61 7465 7320 7768  gas templates wh
+000174c0: 696c 6520 7374 696c 6c0d 0a20 2070 726f  ile still..  pro
+000174d0: 6475 6369 6e67 2061 2073 7461 626c 6520  ducing a stable 
+000174e0: 4e4e 4c53 2073 6f6c 7574 696f 6e2e 2049  NNLS solution. I
+000174f0: 6e20 7468 6973 2063 6173 652c 2077 6172  n this case, war
+00017500: 6e20 7468 6520 7573 6572 2061 6e64 2073  n the user and s
+00017510: 6574 0d0a 2020 7468 6520 2e67 6173 5f7a  et..  the .gas_z
+00017520: 6572 6f5f 7465 6d70 6c61 7465 2061 7474  ero_template att
+00017530: 7269 6275 7465 2e20 5468 6973 2073 6974  ribute. This sit
+00017540: 7561 7469 6f6e 2063 616e 2069 6e64 6963  uation can indic
+00017550: 6174 6520 616e 2069 6e70 7574 0d0a 2020  ate an input..  
+00017560: 6275 6720 6f72 2061 2067 6173 206c 696e  bug or a gas lin
+00017570: 6520 7468 6174 2065 6e74 6972 656c 7920  e that entirely 
+00017580: 6661 6c6c 7320 7769 7468 696e 2061 206d  falls within a m
+00017590: 6173 6b65 6420 7265 6769 6f6e 2e0d 0a2d  asked region...-
+000175a0: 2043 6f72 7265 6374 6564 2060 6067 6173   Corrected ``gas
+000175b0: 5f66 6c75 785f 6572 726f 7260 6020 6e6f  _flux_error`` no
+000175c0: 726d 616c 697a 6174 696f 6e2c 2077 6865  rmalization, whe
+000175d0: 6e20 696e 7075 7420 6e6f 7420 6e6f 726d  n input not norm
+000175e0: 616c 697a 6564 2e0d 0a2d 2052 6574 7572  alized...- Retur
+000175f0: 6e20 6060 2e67 6173 5f62 6573 7466 6974  n ``.gas_bestfit
+00017600: 6060 2c20 6060 2e67 6173 5f6d 706f 6c79  ``, ``.gas_mpoly
+00017610: 6060 2c20 6060 2e6d 706f 6c79 6060 2061  ``, ``.mpoly`` a
+00017620: 6e64 2060 602e 6170 6f6c 7960 6020 6174  nd ``.apoly`` at
+00017630: 7472 6962 7574 6573 2e0d 0a2d 2044 6f20  tributes...- Do 
+00017640: 6e6f 7420 6d75 6c74 6970 6c79 2067 6173  not multiply gas
+00017650: 2065 6d69 7373 696f 6e20 6c69 6e65 7320   emission lines 
+00017660: 6279 2070 6f6c 796e 6f6d 6961 6c73 2c20  by polynomials, 
+00017670: 696e 7374 6561 6420 616c 6c6f 7720 666f  instead allow fo
+00017680: 720d 0a20 2060 6067 6173 5f72 6564 6465  r..  ``gas_redde
+00017690: 6e69 6e67 6060 2028 7573 6566 756c 2077  ning`` (useful w
+000176a0: 6974 6820 7469 6564 2042 616c 6d65 7220  ith tied Balmer 
+000176b0: 656d 6973 7369 6f6e 206c 696e 6573 292e  emission lines).
+000176c0: 0d0a 2d20 5573 6520 6060 6178 7673 7061  ..- Use ``axvspa
+000176d0: 6e60 6020 746f 2076 6973 7561 6c69 7a65  n`` to visualize
+000176e0: 206d 6173 6b65 6420 7265 6769 6f6e 7320   masked regions 
+000176f0: 696e 2074 6865 2070 6c6f 742e 0d0a 2d20  in the plot...- 
+00017700: 4669 7865 6420 7072 6f67 7261 6d20 7374  Fixed program st
+00017710: 6f70 2077 6974 6820 6060 6c69 6e65 6172  op with ``linear
+00017720: 6060 206b 6579 776f 7264 2e0d 0a2d 2049  `` keyword...- I
+00017730: 6e74 726f 6475 6365 6420 6060 7265 6464  ntroduced ``redd
+00017740: 656e 696e 675f 6675 6e63 6060 206b 6579  ening_func`` key
+00017750: 776f 7264 2e0d 0a0d 0a56 362e 362e 343a  word.....V6.6.4:
+00017760: 204d 432c 204f 7866 6f72 642c 2035 204f   MC, Oxford, 5 O
+00017770: 6374 6f62 6572 2032 3031 370d 0a2b 2b2b  ctober 2017..+++
+00017780: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017790: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+000177a0: 0a0d 0a2d 2043 6865 636b 2066 6f72 204e  ...- Check for N
+000177b0: 614e 2069 6e20 6060 6761 6c61 7879 6060  aN in ``galaxy``
+000177c0: 2061 6e64 2063 6865 636b 2061 6c6c 2060   and check all `
+000177d0: 6062 6f75 6e64 7360 6020 6861 7665 2074  `bounds`` have t
+000177e0: 776f 2065 6c65 6d65 6e74 732e 0d0a 2d20  wo elements...- 
+000177f0: 416c 6c6f 7720 6060 7374 6172 7460 6020  Allow ``start`` 
+00017800: 746f 2062 6520 6569 7468 6572 2061 206c  to be either a l
+00017810: 6973 7420 6f72 2061 6e20 6172 7261 7920  ist or an array 
+00017820: 6f72 2076 6563 746f 7273 2e0d 0a0d 0a56  or vectors.....V
+00017830: 362e 362e 333a 204d 432c 204f 7866 6f72  6.6.3: MC, Oxfor
+00017840: 642c 2032 3520 5365 7074 656d 6265 7220  d, 25 September 
+00017850: 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2017..++++++++++
+00017860: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017870: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+00017880: 2052 6564 7563 6564 2062 6f75 6e64 7320   Reduced bounds 
+00017890: 6f6e 206d 756c 7469 706c 6963 6174 6976  on multiplicativ
+000178a0: 6520 706f 6c79 6e6f 6d69 616c 7320 616e  e polynomials an
+000178b0: 6420 636c 6970 7065 6420 746f 2070 6f73  d clipped to pos
+000178c0: 6974 6976 650d 0a20 2076 616c 7565 732e  itive..  values.
+000178d0: 2054 6861 6e6b 7320 746f 2058 6968 616e   Thanks to Xihan
+000178e0: 204a 6920 2854 7369 6e67 6875 6120 556e   Ji (Tsinghua Un
+000178f0: 6976 6572 7369 7479 2920 666f 7220 7072  iversity) for pr
+00017900: 6f76 6964 696e 6720 616e 0d0a 2020 6578  oviding an..  ex
+00017910: 616d 706c 6520 6f66 2073 6c69 6768 746c  ample of slightl
+00017920: 7920 6e65 6761 7469 7665 2067 6173 2065  y negative gas e
+00017930: 6d69 7373 696f 6e20 6c69 6e65 732c 2077  mission lines, w
+00017940: 6865 6e20 7468 6520 7370 6563 7472 756d  hen the spectrum
+00017950: 0d0a 2020 636f 6e74 6169 6e73 2065 7373  ..  contains ess
+00017960: 656e 7469 616c 6c79 206a 7573 7420 6e6f  entially just no
+00017970: 6973 652e 0d0a 2d20 496d 7072 6f76 6564  ise...- Improved
+00017980: 2076 6973 7561 6c69 7a61 7469 6f6e 206f   visualization o
+00017990: 6620 6d61 736b 6564 2070 6978 656c 732e  f masked pixels.
+000179a0: 0d0a 0d0a 5636 2e36 2e32 3a20 4d43 2c20  ....V6.6.2: MC, 
+000179b0: 4f78 666f 7264 2c20 3135 2053 6570 7465  Oxford, 15 Septe
+000179c0: 6d62 6572 2032 3031 370d 0a2b 2b2b 2b2b  mber 2017..+++++
+000179d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000179e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000179f0: 0d0a 0d0a 2d20 4669 7865 6420 7072 6f67  ....- Fixed prog
+00017a00: 7261 6d20 7374 6f70 2077 6974 6820 6120  ram stop with a 
+00017a10: 322d 6469 6d20 7465 6d70 6c61 7465 2061  2-dim template a
+00017a20: 7272 6179 2061 6e64 2072 6567 756c 6172  rray and regular
+00017a30: 697a 6174 696f 6e2e 0d0a 2020 5468 616e  ization...  Than
+00017a40: 6b73 2074 6f20 4164 7269 616e 6f20 506f  ks to Adriano Po
+00017a50: 6369 2028 4d61 6371 7561 7269 6520 556e  ci (Macquarie Un
+00017a60: 6976 6572 7369 7479 2920 666f 7220 7468  iversity) for th
+00017a70: 6520 636c 6561 7220 7265 706f 7274 2061  e clear report a
+00017a80: 6e64 0d0a 2020 7468 6520 6669 782e 0d0a  nd..  the fix...
+00017a90: 0d0a 5636 2e36 2e31 3a20 4d43 2c20 4f78  ..V6.6.1: MC, Ox
+00017aa0: 666f 7264 2c20 3420 4175 6775 7374 2032  ford, 4 August 2
+00017ab0: 3031 370d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  017..+++++++++++
+00017ac0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017ad0: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 496e 636c  ++++++....- Incl
+00017ae0: 7564 6564 206e 6f74 6520 6f6e 2060 602e  uded note on ``.
+00017af0: 6761 735f 666c 7578 6060 206f 7574 7075  gas_flux`` outpu
+00017b00: 7420 756e 6974 732e 2054 6861 6e6b 7320  t units. Thanks 
+00017b10: 746f 2058 6968 616e 204a 690d 0a20 2028  to Xihan Ji..  (
+00017b20: 5473 696e 6768 7561 2055 6e69 7665 7273  Tsinghua Univers
+00017b30: 6974 7929 2066 6f72 2074 6865 2066 6565  ity) for the fee
+00017b40: 6462 6163 6b2e 0d0a 0d0a 5636 2e36 2e30  dback.....V6.6.0
+00017b50: 3a20 4d43 2c20 4f78 666f 7264 2c20 3237  : MC, Oxford, 27
+00017b60: 204a 756e 6520 3230 3137 0d0a 2b2b 2b2b   June 2017..++++
+00017b70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017b80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+00017b90: 2d20 5072 696e 7420 616e 6420 7265 7475  - Print and retu
+00017ba0: 726e 2067 6173 2066 6c75 7865 7320 616e  rn gas fluxes an
+00017bb0: 6420 6572 726f 7273 2c20 6966 2072 6571  d errors, if req
+00017bc0: 7565 7374 6564 2c20 7769 7468 2074 6865  uested, with the
+00017bd0: 206e 6577 0d0a 2020 6060 6761 735f 636f   new..  ``gas_co
+00017be0: 6d70 6f6e 656e 7460 6020 616e 6420 6060  mponent`` and ``
+00017bf0: 6761 735f 6e61 6d65 7360 6020 6b65 7977  gas_names`` keyw
+00017c00: 6f72 6473 2e0d 0a0d 0a56 362e 352e 303a  ords.....V6.5.0:
+00017c10: 204d 432c 204f 7866 6f72 642c 2032 3320   MC, Oxford, 23 
+00017c20: 4a75 6e65 2032 3031 370d 0a2b 2b2b 2b2b  June 2017..+++++
+00017c30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017c40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+00017c50: 2052 6570 6c61 6365 6420 6060 4d50 4649   Replaced ``MPFI
+00017c60: 5460 6020 7769 7468 2060 6063 6170 6669  T`` with ``capfi
+00017c70: 7460 6020 666f 7220 6120 4c65 7665 6e62  t`` for a Levenb
+00017c80: 6572 672d 4d61 7271 7561 7264 7420 6d65  erg-Marquardt me
+00017c90: 7468 6f64 2077 6974 680d 0a20 2066 6978  thod with..  fix
+00017ca0: 6564 206f 7220 7469 6564 2076 6172 6961  ed or tied varia
+00017cb0: 626c 6573 2c20 7768 6963 6820 7269 676f  bles, which rigo
+00017cc0: 726f 7573 6c79 2061 6363 6f75 6e74 7320  rously accounts 
+00017cd0: 666f 7220 626f 7820 636f 6e73 7472 6169  for box constrai
+00017ce0: 6e74 732e 0d0a 0d0a 5636 2e34 2e32 3a20  nts.....V6.4.2: 
+00017cf0: 4d43 2c20 4f78 666f 7264 2c20 3220 4a75  MC, Oxford, 2 Ju
+00017d00: 6e65 2032 3031 370d 0a2b 2b2b 2b2b 2b2b  ne 2017..+++++++
+00017d10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017d20: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 4669  ++++++++....- Fi
+00017d30: 7865 6420 7265 6d6f 7661 6c20 6f66 2062  xed removal of b
+00017d40: 6f75 6e64 7320 696e 2073 6f6c 7574 696f  ounds in solutio
+00017d50: 6e2c 2069 6e74 726f 6475 6365 6420 696e  n, introduced in
+00017d60: 2056 362e 342e 312e 0d0a 2020 5468 616e   V6.4.1...  Than
+00017d70: 6b73 2074 6f20 4b79 6c65 2057 6573 7466  ks to Kyle Westf
+00017d80: 616c 6c20 2855 6e69 762e 2053 616e 7461  all (Univ. Santa
+00017d90: 2043 7275 7a29 2066 6f72 2072 6570 6f72   Cruz) for repor
+00017da0: 7469 6e67 2074 6869 732e 0d0a 2d20 496e  ting this...- In
+00017db0: 636c 7564 6564 2060 606d 6574 686f 6460  cluded ``method`
+00017dc0: 6020 6b65 7977 6f72 6420 746f 2075 7365  ` keyword to use
+00017dd0: 2053 6369 7079 2773 2060 606c 6561 7374   Scipy's ``least
+00017de0: 5f73 7175 6172 6573 2829 6060 0d0a 2020  _squares()``..  
+00017df0: 6173 2061 6e20 616c 7465 726e 6174 6976  as an alternativ
+00017e00: 6520 746f 204d 5046 4954 2e0d 0a2d 2046  e to MPFIT...- F
+00017e10: 6f72 6365 2066 6c6f 6174 2064 6976 6973  orce float divis
+00017e20: 696f 6e20 696e 2070 6978 656c 2063 6f6e  ion in pixel con
+00017e30: 7665 7273 696f 6e20 6f66 2060 6073 7461  version of ``sta
+00017e40: 7274 6060 2061 6e64 2060 6062 6f75 6e64  rt`` and ``bound
+00017e50: 7360 602e 0d0a 0d0a 5636 2e34 2e31 3a20  s``.....V6.4.1: 
+00017e60: 4d43 2c20 4f78 666f 7264 2c20 3235 204d  MC, Oxford, 25 M
+00017e70: 6179 2032 3031 370d 0a2b 2b2b 2b2b 2b2b  ay 2017..+++++++
+00017e80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017e90: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060  ++++++++....- ``
+00017ea0: 6c69 6e65 6172 5f66 6974 2829 6060 2064  linear_fit()`` d
+00017eb0: 6f65 7320 6e6f 7420 7265 7475 726e 2075  oes not return u
+00017ec0: 6e75 7365 6420 7374 6174 7573 2061 6e79  nused status any
+00017ed0: 6d6f 7265 2c20 666f 720d 0a20 2063 6f6e  more, for..  con
+00017ee0: 7369 7374 656e 6379 2077 6974 6820 7468  sistency with th
+00017ef0: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
+00017f00: 6368 616e 6765 2074 6f20 6060 6361 705f  change to ``cap_
+00017f10: 6d70 6669 7460 602e 0d0a 0d0a 5636 2e34  mpfit``.....V6.4
+00017f20: 2e30 3a20 4d43 2c20 4f78 666f 7264 2c20  .0: MC, Oxford, 
+00017f30: 3132 204d 6179 2032 3031 370d 0a2b 2b2b  12 May 2017..+++
+00017f40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017f50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+00017f60: 2d20 496e 7472 6f64 7563 6564 2060 6074  - Introduced ``t
+00017f70: 6965 6460 6020 6b65 7977 6f72 6420 746f  ied`` keyword to
+00017f80: 2074 6965 2070 6172 616d 6574 6572 7320   tie parameters 
+00017f90: 6475 7269 6e67 2066 6974 7469 6e67 2e0d  during fitting..
+00017fa0: 0a2d 2049 6e63 6c75 6465 6420 6469 7363  .- Included disc
+00017fb0: 7573 7369 6f6e 206f 6620 666f 726d 616c  ussion of formal
+00017fc0: 2065 7272 6f72 7320 6f66 2060 602e 7765   errors of ``.we
+00017fd0: 6967 6874 7360 602e 0d0a 0d0a 5636 2e33  ights``.....V6.3
+00017fe0: 2e32 3a20 4d43 2c20 4f78 666f 7264 2c20  .2: MC, Oxford, 
+00017ff0: 3420 4d61 7920 3230 3137 0d0a 2b2b 2b2b  4 May 2017..++++
 00018000: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018010: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2055 7365  +++++++....- Use
-00018020: 2060 606e 6578 745f 6661 7374 5f6c 656e   ``next_fast_len
-00018030: 2829 6060 2066 6f72 206f 7074 696d 616c  ()`` for optimal
-00018040: 2060 6072 6666 7428 2960 6020 7a65 726f   ``rfft()`` zero
-00018050: 2070 6164 6469 6e67 2e0d 0a2d 2049 6e63   padding...- Inc
-00018060: 6c75 6465 6420 6b65 7977 6f72 6420 6060  luded keyword ``
-00018070: 6761 735f 636f 6d70 6f6e 656e 7460 6020  gas_component`` 
-00018080: 696e 2074 6865 2060 602e 706c 6f74 2829  in the ``.plot()
-00018090: 6060 206d 6574 686f 642c 2074 6f0d 0a20  `` method, to.. 
-000180a0: 2064 6973 7469 6e67 7569 7368 2067 6173   distinguish gas
-000180b0: 2065 6d69 7373 696f 6e20 6c69 6e65 7320   emission lines 
-000180c0: 696e 2062 6573 742d 6669 7474 696e 6720  in best-fitting 
-000180d0: 706c 6f74 732e 0d0a 2d20 496d 7072 6f76  plots...- Improv
-000180e0: 6564 2070 6c6f 7420 6f66 2072 6573 6964  ed plot of resid
-000180f0: 7561 6c73 2066 6f72 206e 6f69 7379 2073  uals for noisy s
-00018100: 7065 6374 7261 2e0d 0a2d 2053 696d 706c  pectra...- Simpl
-00018110: 6966 6965 6420 7265 6775 6c61 7269 7a61  ified regulariza
-00018120: 7469 6f6e 2069 6d70 6c65 6d65 6e74 6174  tion implementat
-00018130: 696f 6e2e 0d0a 0d0a 5636 2e30 2e36 3a20  ion.....V6.0.6: 
-00018140: 4d43 2c20 4f78 666f 7264 2c20 3233 2046  MC, Oxford, 23 F
-00018150: 6562 7275 6172 7920 3230 3137 0d0a 2b2b  ebruary 2017..++
-00018160: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018170: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018180: 2b2b 0d0a 0d0a 2d20 4164 6465 6420 6060  ++....- Added ``
-00018190: 6c69 6e65 6172 5f66 6974 2829 6060 2061  linear_fit()`` a
-000181a0: 6e64 2060 606e 6f6e 6c69 6e65 6172 5f66  nd ``nonlinear_f
-000181b0: 6974 2829 6060 2066 756e 6374 696f 6e73  it()`` functions
-000181c0: 2074 6f20 6265 7474 6572 0d0a 2020 636c   to better..  cl
-000181d0: 6172 6966 7920 7468 6520 636f 6465 2073  arify the code s
-000181e0: 7472 7563 7475 7265 2e20 496e 636c 7564  tructure. Includ
-000181f0: 6564 2060 6074 656d 706c 6174 6573 5f72  ed ``templates_r
-00018200: 6666 7460 6020 6b65 7977 6f72 642e 0d0a  fft`` keyword...
-00018210: 2d20 5570 6461 7465 6420 646f 6375 6d65  - Updated docume
-00018220: 6e74 6174 696f 6e2e 2053 6f6d 6520 636f  ntation. Some co
-00018230: 6465 2073 696d 706c 6966 6963 6174 696f  de simplificatio
-00018240: 6e73 2e0d 0a0d 0a56 362e 302e 353a 204d  ns.....V6.0.5: M
-00018250: 432c 204f 7866 6f72 642c 2032 3120 4665  C, Oxford, 21 Fe
-00018260: 6272 7561 7279 2032 3031 370d 0a2b 2b2b  bruary 2017..+++
-00018270: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018280: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018290: 2b0d 0a0d 0a2d 2043 6f6e 7369 7374 656e  +....- Consisten
-000182a0: 746c 7920 7573 6520 6e65 7720 666f 726d  tly use new form
-000182b0: 6174 5f6f 7574 7075 7428 2920 6675 6e63  at_output() func
-000182c0: 7469 6f6e 2062 6f74 6820 7769 7468 2f77  tion both with/w
-000182d0: 6974 686f 7574 0d0a 2020 7468 6520 6060  ithout..  the ``
-000182e0: 6c69 6e65 6172 6060 206b 6579 776f 7264  linear`` keyword
-000182f0: 2e20 4164 6465 6420 6060 2e73 7461 7475  . Added ``.statu
-00018300: 7360 6020 6174 7472 6962 7574 652e 2043  s`` attribute. C
-00018310: 6861 6e67 6573 2073 7567 6765 7374 6564  hanges suggested
-00018320: 2062 790d 0a20 204b 796c 6520 5765 7374   by..  Kyle West
-00018330: 6661 6c6c 2028 556e 6976 2e20 5361 6e74  fall (Univ. Sant
-00018340: 6120 4372 757a 292e 0d0a 0d0a 5636 2e30  a Cruz).....V6.0
-00018350: 2e34 3a20 4d43 2c20 4f78 666f 7264 2c20  .4: MC, Oxford, 
-00018360: 3330 204a 616e 7561 7279 2032 3031 370d  30 January 2017.
-00018370: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-00018380: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018390: 2b2b 2b2b 0d0a 0d0a 2d20 5265 2d69 6e74  ++++....- Re-int
-000183a0: 726f 6475 6365 6420 6060 6c69 6e65 6172  roduced ``linear
-000183b0: 6060 206b 6579 776f 7264 2074 6f20 6f6e  `` keyword to on
-000183c0: 6c79 2070 6572 666f 726d 2061 206c 696e  ly perform a lin
-000183d0: 6561 7220 6669 7420 616e 640d 0a20 2073  ear fit and..  s
-000183e0: 6b69 7020 7468 6520 6e6f 6e2d 6c69 6e65  kip the non-line
-000183f0: 6172 206f 7074 696d 697a 6174 696f 6e2e  ar optimization.
-00018400: 0d0a 0d0a 5636 2e30 2e33 3a20 4d43 2c20  ....V6.0.3: MC, 
-00018410: 4f78 666f 7264 2c20 3120 4465 6365 6d62  Oxford, 1 Decemb
-00018420: 6572 2032 3031 360d 0a2b 2b2b 2b2b 2b2b  er 2016..+++++++
-00018430: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018440: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-00018450: 2d20 5265 7475 726e 2075 7375 616c 2060  - Return usual `
-00018460: 6043 6869 2a2a 322f 444f 4660 6020 696e  `Chi**2/DOF`` in
-00018470: 7374 6561 6420 6f66 2042 6977 6569 6768  stead of Biweigh
-00018480: 7420 6573 7469 6d61 7465 2e0d 0a0d 0a56  t estimate.....V
-00018490: 362e 302e 323a 204d 432c 204f 7866 6f72  6.0.2: MC, Oxfor
-000184a0: 642c 2031 3520 4175 6775 7374 2032 3031  d, 15 August 201
-000184b0: 360d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  6..+++++++++++++
-000184c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000184d0: 2b2b 2b2b 2b0d 0a0d 0a2d 2049 6d70 726f  +++++....- Impro
-000184e0: 7665 6420 666f 726d 6174 7469 6e67 206f  ved formatting o
-000184f0: 6620 7072 696e 7465 6420 6f75 7470 7574  f printed output
-00018500: 2e0d 0a0d 0a56 362e 302e 313a 204d 432c  .....V6.0.1: MC,
-00018510: 204f 7866 6f72 642c 2031 3020 4175 6775   Oxford, 10 Augu
-00018520: 7374 2032 3031 360d 0a2b 2b2b 2b2b 2b2b  st 2016..+++++++
-00018530: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018540: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
-00018550: 2041 6c6c 6f77 2060 606d 6f6d 656e 7473   Allow ``moments
-00018560: 6060 2074 6f20 6265 2061 6e20 6172 6269  `` to be an arbi
-00018570: 7472 6172 7920 696e 7465 6765 722e 0d0a  trary integer...
-00018580: 2d20 416c 6c6f 7720 666f 7220 7363 616c  - Allow for scal
-00018590: 6172 2060 606d 6f6d 656e 7473 6060 2077  ar ``moments`` w
-000185a0: 6974 6820 6d75 6c74 6970 6c65 206b 696e  ith multiple kin
-000185b0: 656d 6174 6963 2063 6f6d 706f 6e65 6e74  ematic component
-000185c0: 732e 0d0a 0d0a 5636 2e30 2e30 3a20 4d43  s.....V6.0.0: MC
-000185d0: 2c20 4f78 666f 7264 2c20 3238 204a 756c  , Oxford, 28 Jul
-000185e0: 7920 3230 3136 0d0a 2b2b 2b2b 2b2b 2b2b  y 2016..++++++++
-000185f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018600: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 436f  ++++++++....- Co
-00018610: 6d70 7574 6520 7468 6520 466f 7572 6965  mpute the Fourie
-00018620: 7220 5472 616e 7366 6f72 6d20 6f66 2074  r Transform of t
-00018630: 6865 204c 4f53 5644 2061 6e61 6c79 7469  he LOSVD analyti
-00018640: 6361 6c6c 793a 0d0a 2d20 4d61 6a6f 7220  cally:..- Major 
-00018650: 696d 7072 6f76 656d 656e 7420 696e 2076  improvement in v
-00018660: 656c 6f63 6974 7920 6163 6375 7261 6379  elocity accuracy
-00018670: 2077 6865 6e20 6060 7369 676d 6120 3c20   when ``sigma < 
-00018680: 7665 6c73 6361 6c65 6060 2e0d 0a2d 2052  velscale``...- R
-00018690: 656d 6f76 6564 2060 606f 7665 7273 616d  emoved ``oversam
-000186a0: 706c 6560 6020 6b65 7977 6f72 642c 2077  ple`` keyword, w
-000186b0: 6869 6368 2069 7320 6e6f 7720 756e 6e65  hich is now unne
-000186c0: 6365 7373 6172 792e 0d0a 2d20 5265 6d6f  cessary...- Remo
-000186d0: 7665 6420 6c69 6d69 7420 6f6e 2076 656c  ved limit on vel
-000186e0: 6f63 6974 7920 7368 6966 7420 6f66 2074  ocity shift of t
-000186f0: 656d 706c 6174 6573 2e0d 0a2d 2053 696d  emplates...- Sim
-00018700: 706c 6966 6965 6420 4646 5420 7a65 726f  plified FFT zero
-00018710: 2070 6164 6469 6e67 2e20 5570 6461 7465   padding. Update
-00018720: 6420 646f 6375 6d65 6e74 6174 696f 6e2e  d documentation.
-00018730: 0d0a 0d0a 5635 2e33 2e33 3a20 4d43 2c20  ....V5.3.3: MC, 
-00018740: 4f78 666f 7264 2032 3420 4d61 7920 3230  Oxford 24 May 20
-00018750: 3136 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  16..++++++++++++
-00018760: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018770: 2b2b 0d0a 0d0a 2d20 4669 7865 6420 5079  ++....- Fixed Py
-00018780: 7468 6f6e 2032 2063 6f6d 7061 7469 6269  thon 2 compatibi
-00018790: 6c69 7479 2e20 5468 616e 6b73 2074 6f20  lity. Thanks to 
-000187a0: 4d61 7361 746f 204f 6e6f 6465 7261 2028  Masato Onodera (
-000187b0: 4e41 4f4a 292e 0d0a 0d0a 5635 2e33 2e32  NAOJ).....V5.3.2
-000187c0: 3a20 4d43 2c20 4f78 666f 7264 2c20 3232  : MC, Oxford, 22
-000187d0: 204d 6179 2032 3031 360d 0a2b 2b2b 2b2b   May 2016..+++++
-000187e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000187f0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-00018800: 4261 636b 7761 7264 2063 6f6d 7061 7469  Backward compati
-00018810: 6269 6c69 7479 2063 6861 6e67 653a 2061  bility change: a
-00018820: 6c6c 6f77 2060 6073 7461 7274 6060 2074  llow ``start`` t
-00018830: 6f20 6265 2073 6d61 6c6c 6572 2074 6861  o be smaller tha
-00018840: 6e0d 0a20 2060 606d 6f6d 656e 7473 6060  n..  ``moments``
-00018850: 2e20 4166 7465 7220 6665 6564 6261 636b  . After feedback
-00018860: 2062 7920 4d61 7361 746f 204f 6e6f 6465   by Masato Onode
-00018870: 7261 2028 4e41 4f4a 292e 0d0a 2d20 5570  ra (NAOJ)...- Up
-00018880: 6461 7465 6420 646f 6375 6d65 6e74 6174  dated documentat
-00018890: 696f 6e20 6f66 2060 6062 6f75 6e64 7360  ion of ``bounds`
-000188a0: 6020 616e 6420 6060 6669 7865 6460 602e  ` and ``fixed``.
-000188b0: 0d0a 0d0a 5635 2e33 2e31 3a20 4d43 2c20  ....V5.3.1: MC, 
-000188c0: 4f78 666f 7264 2c20 3138 204d 6179 2032  Oxford, 18 May 2
-000188d0: 3031 360d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  016..+++++++++++
-000188e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000188f0: 2b2b 2b2b 0d0a 0d0a 2d20 5573 6520 7761  ++++....- Use wa
-00018900: 7665 6c65 6e67 7468 2069 6e20 7468 6520  velength in the 
-00018910: 706c 6f74 2077 6865 6e20 6176 6169 6c61  plot when availa
-00018920: 626c 652e 204d 616b 6520 6060 706c 6f74  ble. Make ``plot
-00018930: 2829 6060 2061 2063 6c61 7373 2066 756e  ()`` a class fun
-00018940: 6374 696f 6e2e 0d0a 2020 4368 616e 6765  ction...  Change
-00018950: 7320 7375 6767 6573 7465 6420 616e 6420  s suggested and 
-00018960: 7072 6f76 6964 6564 2062 7920 4a6f 6861  provided by Joha
-00018970: 6e6e 2043 6f68 656e 2d54 616e 7567 6920  nn Cohen-Tanugi 
-00018980: 284c 5550 4d29 2e0d 0a0d 0a56 352e 332e  (LUPM).....V5.3.
-00018990: 303a 204d 432c 204f 7866 6f72 642c 2039  0: MC, Oxford, 9
-000189a0: 204d 6179 2032 3031 360d 0a2b 2b2b 2b2b   May 2016..+++++
-000189b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000189c0: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2049  +++++++++....- I
-000189d0: 6e63 6c75 6465 6420 6060 7665 6c73 6361  ncluded ``velsca
-000189e0: 6c65 5f72 6174 696f 6060 206b 6579 776f  le_ratio`` keywo
-000189f0: 7264 2074 6f20 7061 7373 2061 2073 6574  rd to pass a set
-00018a00: 206f 6620 7465 6d70 6c61 7465 7320 7769   of templates wi
-00018a10: 7468 0d0a 2020 6869 6768 6572 2072 6573  th..  higher res
-00018a20: 6f6c 7574 696f 6e20 7468 616e 2074 6865  olution than the
-00018a30: 2067 616c 6178 7920 7370 6563 7472 756d   galaxy spectrum
-00018a40: 2e0d 0a2d 2043 6861 6e67 6564 2060 606f  ...- Changed ``o
-00018a50: 7665 7273 616d 706c 6560 6020 6b65 7977  versample`` keyw
-00018a60: 6f72 6420 746f 2072 6571 7569 7265 2069  ord to require i
-00018a70: 6e74 6567 6572 732c 206e 6f74 2042 6f6f  ntegers, not Boo
-00018a80: 6c65 616e 732e 0d0a 0d0a 5635 2e32 2e30  leans.....V5.2.0
-00018a90: 3a20 4d43 2c20 4261 6c74 696d 6f72 652c  : MC, Baltimore,
-00018aa0: 2032 3620 4170 7269 6c20 3230 3136 0d0a   26 April 2016..
-00018ab0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018ac0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018ad0: 2b2b 2b2b 0d0a 0d0a 2d20 496e 636c 7564  ++++....- Includ
-00018ae0: 6564 2060 6062 6f75 6e64 7360 602c 2060  ed ``bounds``, `
-00018af0: 6066 6978 6564 6060 2061 6e64 2060 6066  `fixed`` and ``f
-00018b00: 7261 6374 696f 6e60 6020 6b65 7977 6f72  raction`` keywor
-00018b10: 6473 2e0d 0a0d 0a56 352e 312e 3138 3a20  ds.....V5.1.18: 
-00018b20: 4d43 2c20 4f78 666f 7264 2c20 3230 2041  MC, Oxford, 20 A
-00018b30: 7072 696c 2032 3031 360d 0a2b 2b2b 2b2b  pril 2016..+++++
-00018b40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018b50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00018b60: 0a2d 2046 6978 6564 2064 6570 7265 6361  .- Fixed depreca
-00018b70: 7469 6f6e 2077 6172 6e69 6e67 2069 6e20  tion warning in 
-00018b80: 4e75 6d70 7920 312e 3131 2e20 4368 616e  Numpy 1.11. Chan
-00018b90: 6765 6420 6f72 6465 7220 6672 6f6d 2031  ged order from 1
-00018ba0: 2074 6f20 330d 0a20 2064 7572 696e 6720   to 3..  during 
-00018bb0: 6f76 6572 7361 6d70 6c69 6e67 2e20 5761  oversampling. Wa
-00018bc0: 726e 2069 6620 7369 676d 6120 6973 2075  rn if sigma is u
-00018bd0: 6e64 6572 2d73 616d 706c 6564 2e0d 0a0d  nder-sampled....
-00018be0: 0a56 352e 312e 3137 3a20 4d43 2c20 4f78  .V5.1.17: MC, Ox
-00018bf0: 666f 7264 2c20 3231 204a 616e 7561 7279  ford, 21 January
-00018c00: 2032 3031 360d 0a2b 2b2b 2b2b 2b2b 2b2b   2016..+++++++++
-00018c10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018c20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
-00018c30: 2045 7870 616e 6465 6420 6578 706c 616e   Expanded explan
-00018c40: 6174 696f 6e20 6f66 2074 6865 2072 656c  ation of the rel
-00018c50: 6174 696f 6e73 6869 7020 6265 7477 6565  ationship betwee
-00018c60: 6e20 6f75 7470 7574 2076 656c 6f63 6974  n output velocit
-00018c70: 7920 616e 6420 7265 6473 6869 6674 2e0d  y and redshift..
-00018c80: 0a0d 0a56 352e 312e 3136 3a20 4d43 2c20  ...V5.1.16: MC, 
-00018c90: 4f78 666f 7264 2c20 3920 4e6f 7665 6d62  Oxford, 9 Novemb
-00018ca0: 6572 2032 3031 350d 0a2b 2b2b 2b2b 2b2b  er 2015..+++++++
-00018cb0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018cc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00018cd0: 0a2d 2046 6978 6564 2070 6f74 656e 7469  .- Fixed potenti
-00018ce0: 616c 6c79 206d 6973 6c65 6164 696e 6720  ally misleading 
-00018cf0: 7479 706f 2069 6e20 646f 6375 6d65 6e74  typo in document
-00018d00: 6174 696f 6e20 6f66 2060 606d 6f6d 656e  ation of ``momen
-00018d10: 7473 6060 2e0d 0a0d 0a56 352e 312e 3135  ts``.....V5.1.15
-00018d20: 3a20 4d43 2c20 4f78 666f 7264 2c20 3232  : MC, Oxford, 22
-00018d30: 204f 6374 6f62 6572 2032 3031 350d 0a2b   October 2015..+
-00018d40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018010: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
+00018020: 4669 7865 6420 706f 7373 6962 6c65 2070  Fixed possible p
+00018030: 726f 6772 616d 2073 746f 7020 696e 7472  rogram stop intr
+00018040: 6f64 7563 6564 2069 6e20 5636 2e30 2e37  oduced in V6.0.7
+00018050: 2061 6e64 2063 6f6e 7365 7175 656e 746c   and consequentl
+00018060: 790d 0a20 2072 656d 6f76 6564 2075 6e6e  y..  removed unn
+00018070: 6563 6573 7361 7279 2066 756e 6374 696f  ecessary functio
+00018080: 6e20 6060 5f74 656d 706c 6174 6573 5f72  n ``_templates_r
+00018090: 6666 7428 2960 602e 204d 616e 7920 7468  fft()``. Many th
+000180a0: 616e 6b73 2074 6f0d 0a20 204a 6573 7573  anks to..  Jesus
+000180b0: 2046 616c 636f 6e2d 4261 7272 6f73 6f20   Falcon-Barroso 
+000180c0: 666f 7220 6120 7665 7279 2063 6c65 6172  for a very clear
+000180d0: 2061 6e64 2075 7365 6675 6c20 6275 6720   and useful bug 
+000180e0: 7265 706f 7274 210d 0a0d 0a56 362e 332e  report!....V6.3.
+000180f0: 313a 204d 432c 204f 7866 6f72 642c 2031  1: MC, Oxford, 1
+00018100: 3320 4170 7269 6c20 3230 3137 0d0a 2b2b  3 April 2017..++
+00018110: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018120: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+00018130: 0a0d 0a2d 2046 6978 6564 2070 726f 6772  ...- Fixed progr
+00018140: 616d 2073 746f 7020 7768 656e 2066 6974  am stop when fit
+00018150: 7469 6e67 2074 776f 2067 616c 6178 7920  ting two galaxy 
+00018160: 7370 6563 7472 6120 7769 7468 0d0a 2020  spectra with..  
+00018170: 7265 666c 6563 7469 6f6e 2d73 796d 6d65  reflection-symme
+00018180: 7472 6963 204c 4f53 5644 2e0d 0a0d 0a56  tric LOSVD.....V
+00018190: 362e 332e 303a 204d 432c 204f 7866 6f72  6.3.0: MC, Oxfor
+000181a0: 642c 2033 3020 4d61 7263 6820 3230 3137  d, 30 March 2017
+000181b0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+000181c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000181d0: 2b2b 2b0d 0a0d 0a2d 2049 6e63 6c75 6465  +++....- Include
+000181e0: 6420 6060 7265 675f 6f72 6460 6020 6b65  d ``reg_ord`` ke
+000181f0: 7977 6f72 6420 746f 2061 6c6c 6f77 2066  yword to allow f
+00018200: 6f72 2062 6f74 6820 6669 7273 7420 616e  or both first an
+00018210: 6420 7365 636f 6e64 2d6f 7264 6572 0d0a  d second-order..
+00018220: 2020 7265 6775 6c61 7269 7a61 7469 6f6e    regularization
+00018230: 2e0d 0a0d 0a56 362e 322e 303a 204d 432c  .....V6.2.0: MC,
+00018240: 204f 7866 6f72 642c 2032 3720 4d61 7263   Oxford, 27 Marc
+00018250: 6820 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b  h 2017..++++++++
+00018260: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018270: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2049  +++++++++....- I
+00018280: 6d70 726f 7665 6420 6375 7276 6174 7572  mproved curvatur
+00018290: 6520 6372 6974 6572 696f 6e20 666f 7220  e criterion for 
+000182a0: 7265 6775 6c61 7269 7a61 7469 6f6e 2077  regularization w
+000182b0: 6865 6e20 6060 6469 6d20 3e20 3160 602e  hen ``dim > 1``.
+000182c0: 0d0a 0d0a 5636 2e31 2e30 3a20 4d43 2c20  ....V6.1.0: MC, 
+000182d0: 4f78 666f 7264 2c20 3135 204d 6172 6368  Oxford, 15 March
+000182e0: 2032 3031 370d 0a2b 2b2b 2b2b 2b2b 2b2b   2017..+++++++++
+000182f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018300: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 496e  ++++++++....- In
+00018310: 7472 6f64 7563 6564 2060 6074 7269 6760  troduced ``trig`
+00018320: 6020 6b65 7977 6f72 6420 746f 2075 7365  ` keyword to use
+00018330: 2061 2074 7269 676f 6e6f 6d65 7472 6963   a trigonometric
+00018340: 2073 6572 6965 7320 6173 0d0a 2020 616c   series as..  al
+00018350: 7465 726e 6174 6976 6520 746f 204c 6567  ternative to Leg
+00018360: 656e 6472 6520 706f 6c79 6e6f 6d69 616c  endre polynomial
+00018370: 732e 0d0a 0d0a 5636 2e30 2e37 3a20 4d43  s.....V6.0.7: MC
+00018380: 2c20 4f78 666f 7264 2c20 3133 204d 6172  , Oxford, 13 Mar
+00018390: 6368 2032 3031 370d 0a2b 2b2b 2b2b 2b2b  ch 2017..+++++++
+000183a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000183b0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
+000183c0: 5573 6520 6060 6e65 7874 5f66 6173 745f  Use ``next_fast_
+000183d0: 6c65 6e28 2960 6020 666f 7220 6f70 7469  len()`` for opti
+000183e0: 6d61 6c20 6060 7266 6674 2829 6060 207a  mal ``rfft()`` z
+000183f0: 6572 6f20 7061 6464 696e 672e 0d0a 2d20  ero padding...- 
+00018400: 496e 636c 7564 6564 206b 6579 776f 7264  Included keyword
+00018410: 2060 6067 6173 5f63 6f6d 706f 6e65 6e74   ``gas_component
+00018420: 6060 2069 6e20 7468 6520 6060 2e70 6c6f  `` in the ``.plo
+00018430: 7428 2960 6020 6d65 7468 6f64 2c20 746f  t()`` method, to
+00018440: 0d0a 2020 6469 7374 696e 6775 6973 6820  ..  distinguish 
+00018450: 6761 7320 656d 6973 7369 6f6e 206c 696e  gas emission lin
+00018460: 6573 2069 6e20 6265 7374 2d66 6974 7469  es in best-fitti
+00018470: 6e67 2070 6c6f 7473 2e0d 0a2d 2049 6d70  ng plots...- Imp
+00018480: 726f 7665 6420 706c 6f74 206f 6620 7265  roved plot of re
+00018490: 7369 6475 616c 7320 666f 7220 6e6f 6973  siduals for nois
+000184a0: 7920 7370 6563 7472 612e 0d0a 2d20 5369  y spectra...- Si
+000184b0: 6d70 6c69 6669 6564 2072 6567 756c 6172  mplified regular
+000184c0: 697a 6174 696f 6e20 696d 706c 656d 656e  ization implemen
+000184d0: 7461 7469 6f6e 2e0d 0a0d 0a56 362e 302e  tation.....V6.0.
+000184e0: 363a 204d 432c 204f 7866 6f72 642c 2032  6: MC, Oxford, 2
+000184f0: 3320 4665 6272 7561 7279 2032 3031 370d  3 February 2017.
+00018500: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
+00018510: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018520: 2b2b 2b2b 2b0d 0a0d 0a2d 2041 6464 6564  +++++....- Added
+00018530: 2060 606c 696e 6561 725f 6669 7428 2960   ``linear_fit()`
+00018540: 6020 616e 6420 6060 6e6f 6e6c 696e 6561  ` and ``nonlinea
+00018550: 725f 6669 7428 2960 6020 6675 6e63 7469  r_fit()`` functi
+00018560: 6f6e 7320 746f 2062 6574 7465 720d 0a20  ons to better.. 
+00018570: 2063 6c61 7269 6679 2074 6865 2063 6f64   clarify the cod
+00018580: 6520 7374 7275 6374 7572 652e 2049 6e63  e structure. Inc
+00018590: 6c75 6465 6420 6060 7465 6d70 6c61 7465  luded ``template
+000185a0: 735f 7266 6674 6060 206b 6579 776f 7264  s_rfft`` keyword
+000185b0: 2e0d 0a2d 2055 7064 6174 6564 2064 6f63  ...- Updated doc
+000185c0: 756d 656e 7461 7469 6f6e 2e20 536f 6d65  umentation. Some
+000185d0: 2063 6f64 6520 7369 6d70 6c69 6669 6361   code simplifica
+000185e0: 7469 6f6e 732e 0d0a 0d0a 5636 2e30 2e35  tions.....V6.0.5
+000185f0: 3a20 4d43 2c20 4f78 666f 7264 2c20 3231  : MC, Oxford, 21
+00018600: 2046 6562 7275 6172 7920 3230 3137 0d0a   February 2017..
+00018610: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018620: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018630: 2b2b 2b2b 0d0a 0d0a 2d20 436f 6e73 6973  ++++....- Consis
+00018640: 7465 6e74 6c79 2075 7365 206e 6577 2066  tently use new f
+00018650: 6f72 6d61 745f 6f75 7470 7574 2829 2066  ormat_output() f
+00018660: 756e 6374 696f 6e20 626f 7468 2077 6974  unction both wit
+00018670: 682f 7769 7468 6f75 740d 0a20 2074 6865  h/without..  the
+00018680: 2060 606c 696e 6561 7260 6020 6b65 7977   ``linear`` keyw
+00018690: 6f72 642e 2041 6464 6564 2060 602e 7374  ord. Added ``.st
+000186a0: 6174 7573 6060 2061 7474 7269 6275 7465  atus`` attribute
+000186b0: 2e20 4368 616e 6765 7320 7375 6767 6573  . Changes sugges
+000186c0: 7465 6420 6279 0d0a 2020 4b79 6c65 2057  ted by..  Kyle W
+000186d0: 6573 7466 616c 6c20 2855 6e69 762e 2053  estfall (Univ. S
+000186e0: 616e 7461 2043 7275 7a29 2e0d 0a0d 0a56  anta Cruz).....V
+000186f0: 362e 302e 343a 204d 432c 204f 7866 6f72  6.0.4: MC, Oxfor
+00018700: 642c 2033 3020 4a61 6e75 6172 7920 3230  d, 30 January 20
+00018710: 3137 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  17..++++++++++++
+00018720: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018730: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2052 652d  +++++++....- Re-
+00018740: 696e 7472 6f64 7563 6564 2060 606c 696e  introduced ``lin
+00018750: 6561 7260 6020 6b65 7977 6f72 6420 746f  ear`` keyword to
+00018760: 206f 6e6c 7920 7065 7266 6f72 6d20 6120   only perform a 
+00018770: 6c69 6e65 6172 2066 6974 2061 6e64 0d0a  linear fit and..
+00018780: 2020 736b 6970 2074 6865 206e 6f6e 2d6c    skip the non-l
+00018790: 696e 6561 7220 6f70 7469 6d69 7a61 7469  inear optimizati
+000187a0: 6f6e 2e0d 0a0d 0a56 362e 302e 333a 204d  on.....V6.0.3: M
+000187b0: 432c 204f 7866 6f72 642c 2031 2044 6563  C, Oxford, 1 Dec
+000187c0: 656d 6265 7220 3230 3136 0d0a 2b2b 2b2b  ember 2016..++++
+000187d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000187e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+000187f0: 0a0d 0a2d 2052 6574 7572 6e20 7573 7561  ...- Return usua
+00018800: 6c20 6060 4368 692a 2a32 2f44 4f46 6060  l ``Chi**2/DOF``
+00018810: 2069 6e73 7465 6164 206f 6620 4269 7765   instead of Biwe
+00018820: 6967 6874 2065 7374 696d 6174 652e 0d0a  ight estimate...
+00018830: 0d0a 5636 2e30 2e32 3a20 4d43 2c20 4f78  ..V6.0.2: MC, Ox
+00018840: 666f 7264 2c20 3135 2041 7567 7573 7420  ford, 15 August 
+00018850: 3230 3136 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2016..++++++++++
+00018860: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018870: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 496d  ++++++++....- Im
+00018880: 7072 6f76 6564 2066 6f72 6d61 7474 696e  proved formattin
+00018890: 6720 6f66 2070 7269 6e74 6564 206f 7574  g of printed out
+000188a0: 7075 742e 0d0a 0d0a 5636 2e30 2e31 3a20  put.....V6.0.1: 
+000188b0: 4d43 2c20 4f78 666f 7264 2c20 3130 2041  MC, Oxford, 10 A
+000188c0: 7567 7573 7420 3230 3136 0d0a 2b2b 2b2b  ugust 2016..++++
+000188d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000188e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
+000188f0: 0d0a 2d20 416c 6c6f 7720 6060 6d6f 6d65  ..- Allow ``mome
+00018900: 6e74 7360 6020 746f 2062 6520 616e 2061  nts`` to be an a
+00018910: 7262 6974 7261 7279 2069 6e74 6567 6572  rbitrary integer
+00018920: 2e0d 0a2d 2041 6c6c 6f77 2066 6f72 2073  ...- Allow for s
+00018930: 6361 6c61 7220 6060 6d6f 6d65 6e74 7360  calar ``moments`
+00018940: 6020 7769 7468 206d 756c 7469 706c 6520  ` with multiple 
+00018950: 6b69 6e65 6d61 7469 6320 636f 6d70 6f6e  kinematic compon
+00018960: 656e 7473 2e0d 0a0d 0a56 362e 302e 303a  ents.....V6.0.0:
+00018970: 204d 432c 204f 7866 6f72 642c 2032 3820   MC, Oxford, 28 
+00018980: 4a75 6c79 2032 3031 360d 0a2b 2b2b 2b2b  July 2016..+++++
+00018990: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000189a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+000189b0: 2043 6f6d 7075 7465 2074 6865 2046 6f75   Compute the Fou
+000189c0: 7269 6572 2054 7261 6e73 666f 726d 206f  rier Transform o
+000189d0: 6620 7468 6520 4c4f 5356 4420 616e 616c  f the LOSVD anal
+000189e0: 7974 6963 616c 6c79 3a0d 0a2d 204d 616a  ytically:..- Maj
+000189f0: 6f72 2069 6d70 726f 7665 6d65 6e74 2069  or improvement i
+00018a00: 6e20 7665 6c6f 6369 7479 2061 6363 7572  n velocity accur
+00018a10: 6163 7920 7768 656e 2060 6073 6967 6d61  acy when ``sigma
+00018a20: 203c 2076 656c 7363 616c 6560 602e 0d0a   < velscale``...
+00018a30: 2d20 5265 6d6f 7665 6420 6060 6f76 6572  - Removed ``over
+00018a40: 7361 6d70 6c65 6060 206b 6579 776f 7264  sample`` keyword
+00018a50: 2c20 7768 6963 6820 6973 206e 6f77 2075  , which is now u
+00018a60: 6e6e 6563 6573 7361 7279 2e0d 0a2d 2052  nnecessary...- R
+00018a70: 656d 6f76 6564 206c 696d 6974 206f 6e20  emoved limit on 
+00018a80: 7665 6c6f 6369 7479 2073 6869 6674 206f  velocity shift o
+00018a90: 6620 7465 6d70 6c61 7465 732e 0d0a 2d20  f templates...- 
+00018aa0: 5369 6d70 6c69 6669 6564 2046 4654 207a  Simplified FFT z
+00018ab0: 6572 6f20 7061 6464 696e 672e 2055 7064  ero padding. Upd
+00018ac0: 6174 6564 2064 6f63 756d 656e 7461 7469  ated documentati
+00018ad0: 6f6e 2e0d 0a0d 0a56 352e 332e 333a 204d  on.....V5.3.3: M
+00018ae0: 432c 204f 7866 6f72 6420 3234 204d 6179  C, Oxford 24 May
+00018af0: 2032 3031 360d 0a2b 2b2b 2b2b 2b2b 2b2b   2016..+++++++++
+00018b00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018b10: 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978 6564  +++++....- Fixed
+00018b20: 2050 7974 686f 6e20 3220 636f 6d70 6174   Python 2 compat
+00018b30: 6962 696c 6974 792e 2054 6861 6e6b 7320  ibility. Thanks 
+00018b40: 746f 204d 6173 6174 6f20 4f6e 6f64 6572  to Masato Onoder
+00018b50: 6120 284e 414f 4a29 2e0d 0a0d 0a56 352e  a (NAOJ).....V5.
+00018b60: 332e 323a 204d 432c 204f 7866 6f72 642c  3.2: MC, Oxford,
+00018b70: 2032 3220 4d61 7920 3230 3136 0d0a 2b2b   22 May 2016..++
+00018b80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018b90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+00018ba0: 0a2d 2042 6163 6b77 6172 6420 636f 6d70  .- Backward comp
+00018bb0: 6174 6962 696c 6974 7920 6368 616e 6765  atibility change
+00018bc0: 3a20 616c 6c6f 7720 6060 7374 6172 7460  : allow ``start`
+00018bd0: 6020 746f 2062 6520 736d 616c 6c65 7220  ` to be smaller 
+00018be0: 7468 616e 0d0a 2020 6060 6d6f 6d65 6e74  than..  ``moment
+00018bf0: 7360 602e 2041 6674 6572 2066 6565 6462  s``. After feedb
+00018c00: 6163 6b20 6279 204d 6173 6174 6f20 4f6e  ack by Masato On
+00018c10: 6f64 6572 6120 284e 414f 4a29 2e0d 0a2d  odera (NAOJ)...-
+00018c20: 2055 7064 6174 6564 2064 6f63 756d 656e   Updated documen
+00018c30: 7461 7469 6f6e 206f 6620 6060 626f 756e  tation of ``boun
+00018c40: 6473 6060 2061 6e64 2060 6066 6978 6564  ds`` and ``fixed
+00018c50: 6060 2e0d 0a0d 0a56 352e 332e 313a 204d  ``.....V5.3.1: M
+00018c60: 432c 204f 7866 6f72 642c 2031 3820 4d61  C, Oxford, 18 Ma
+00018c70: 7920 3230 3136 0d0a 2b2b 2b2b 2b2b 2b2b  y 2016..++++++++
+00018c80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018c90: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2055 7365  +++++++....- Use
+00018ca0: 2077 6176 656c 656e 6774 6820 696e 2074   wavelength in t
+00018cb0: 6865 2070 6c6f 7420 7768 656e 2061 7661  he plot when ava
+00018cc0: 696c 6162 6c65 2e20 4d61 6b65 2060 6070  ilable. Make ``p
+00018cd0: 6c6f 7428 2960 6020 6120 636c 6173 7320  lot()`` a class 
+00018ce0: 6675 6e63 7469 6f6e 2e0d 0a20 2043 6861  function...  Cha
+00018cf0: 6e67 6573 2073 7567 6765 7374 6564 2061  nges suggested a
+00018d00: 6e64 2070 726f 7669 6465 6420 6279 204a  nd provided by J
+00018d10: 6f68 616e 6e20 436f 6865 6e2d 5461 6e75  ohann Cohen-Tanu
+00018d20: 6769 2028 4c55 504d 292e 0d0a 0d0a 5635  gi (LUPM).....V5
+00018d30: 2e33 2e30 3a20 4d43 2c20 4f78 666f 7264  .3.0: MC, Oxford
+00018d40: 2c20 3920 4d61 7920 3230 3136 0d0a 2b2b  , 9 May 2016..++
 00018d50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018d60: 2b2b 2b0d 0a0d 0a2d 2055 7064 6174 6564  +++....- Updated
-00018d70: 2064 6f63 756d 656e 7461 7469 6f6e 2e20   documentation. 
-00018d80: 5468 616e 6b73 2074 6f20 5065 7465 7220  Thanks to Peter 
-00018d90: 5765 696c 6261 6368 6572 2028 506f 7473  Weilbacher (Pots
-00018da0: 6461 6d29 2066 6f72 0d0a 2020 636f 7272  dam) for..  corr
-00018db0: 6563 7469 6f6e 732e 0d0a 0d0a 5635 2e31  ections.....V5.1
-00018dc0: 2e31 343a 204d 432c 204f 7866 6f72 642c  .14: MC, Oxford,
-00018dd0: 2031 3920 4f63 746f 6265 7220 3230 3135   19 October 2015
-00018de0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-00018df0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018e00: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 4669 7865  ++++++....- Fixe
-00018e10: 6420 6465 7072 6563 6174 696f 6e20 7761  d deprecation wa
-00018e20: 726e 696e 6720 696e 204e 756d 7079 2031  rning in Numpy 1
-00018e30: 2e31 302e 0d0a 0d0a 5635 2e31 2e31 333a  .10.....V5.1.13:
-00018e40: 204d 432c 204f 7866 6f72 642c 2032 3420   MC, Oxford, 24 
-00018e50: 4170 7269 6c20 3230 3135 0d0a 2b2b 2b2b  April 2015..++++
+00018d60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+00018d70: 2d20 496e 636c 7564 6564 2060 6076 656c  - Included ``vel
+00018d80: 7363 616c 655f 7261 7469 6f60 6020 6b65  scale_ratio`` ke
+00018d90: 7977 6f72 6420 746f 2070 6173 7320 6120  yword to pass a 
+00018da0: 7365 7420 6f66 2074 656d 706c 6174 6573  set of templates
+00018db0: 2077 6974 680d 0a20 2068 6967 6865 7220   with..  higher 
+00018dc0: 7265 736f 6c75 7469 6f6e 2074 6861 6e20  resolution than 
+00018dd0: 7468 6520 6761 6c61 7879 2073 7065 6374  the galaxy spect
+00018de0: 7275 6d2e 0d0a 2d20 4368 616e 6765 6420  rum...- Changed 
+00018df0: 6060 6f76 6572 7361 6d70 6c65 6060 206b  ``oversample`` k
+00018e00: 6579 776f 7264 2074 6f20 7265 7175 6972  eyword to requir
+00018e10: 6520 696e 7465 6765 7273 2c20 6e6f 7420  e integers, not 
+00018e20: 426f 6f6c 6561 6e73 2e0d 0a0d 0a56 352e  Booleans.....V5.
+00018e30: 322e 303a 204d 432c 2042 616c 7469 6d6f  2.0: MC, Baltimo
+00018e40: 7265 2c20 3236 2041 7072 696c 2032 3031  re, 26 April 201
+00018e50: 360d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  6..+++++++++++++
 00018e60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018e70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
-00018e80: 0d0a 2d20 5570 6461 7465 6420 646f 6375  ..- Updated docu
-00018e90: 6d65 6e74 6174 696f 6e2e 0d0a 0d0a 5635  mentation.....V5
-00018ea0: 2e31 2e31 323a 204d 432c 204f 7866 6f72  .1.12: MC, Oxfor
-00018eb0: 642c 2032 3520 4665 6272 7561 7279 2032  d, 25 February 2
-00018ec0: 3031 350d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  015..+++++++++++
-00018ed0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018ee0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-00018ef0: 5573 6520 6060 636f 6c6f 723d 6060 2069  Use ``color=`` i
-00018f00: 6e73 7465 6164 206f 6620 6060 633d 6060  nstead of ``c=``
-00018f10: 2074 6f20 6176 6f69 6420 6120 6e65 7720   to avoid a new 
-00018f20: 4d61 7470 6c6f 746c 6962 2031 2e34 2062  Matplotlib 1.4 b
-00018f30: 7567 2e0d 0a0d 0a56 352e 312e 3131 3a20  ug.....V5.1.11: 
-00018f40: 4d43 2c20 5379 646e 6579 2c20 3520 4665  MC, Sydney, 5 Fe
-00018f50: 6272 7561 7279 2032 3031 350d 0a2b 2b2b  bruary 2015..+++
-00018f60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018f70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018f80: 2b0d 0a0d 0a2d 2052 6576 6572 7465 6420  +....- Reverted 
-00018f90: 6368 616e 6765 2069 6e74 726f 6475 6365  change introduce
-00018fa0: 6420 696e 2056 352e 312e 322e 2054 6861  d in V5.1.2. Tha
-00018fb0: 6e6b 7320 746f 204e 6f72 6120 4c75 2274  nks to Nora Lu"t
-00018fc0: 7a67 656e 646f 7266 0d0a 2020 666f 7220  zgendorf..  for 
-00018fd0: 7265 706f 7274 696e 6720 7072 6f62 6c65  reporting proble
-00018fe0: 6d73 2077 6974 6820 6060 6f76 6572 7361  ms with ``oversa
-00018ff0: 6d70 6c65 6060 2e0d 0a0d 0a56 352e 312e  mple``.....V5.1.
-00019000: 3130 3a20 4d43 2c20 4f78 666f 7264 2c20  10: MC, Oxford, 
-00019010: 3134 204f 6374 6f62 6572 2032 3031 340d  14 October 2014.
-00019020: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-00019030: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019040: 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978 6564  +++++....- Fixed
-00019050: 2062 7567 2069 6e20 7361 7669 6e67 206f   bug in saving o
-00019060: 7574 7075 7420 696e 7472 6f64 7563 6564  utput introduced
-00019070: 2069 6e20 7468 6520 7072 6576 696f 7573   in the previous
-00019080: 2076 6572 7369 6f6e 2e0d 0a0d 0a56 352e   version.....V5.
-00019090: 312e 393a 204d 432c 204c 6173 2056 6567  1.9: MC, Las Veg
-000190a0: 6173 2041 6972 706f 7274 2c20 3133 2053  as Airport, 13 S
-000190b0: 6570 7465 6d62 6572 2032 3031 340d 0a2b  eptember 2014..+
-000190c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000190d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000190e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-000190f0: 0a0d 0a2d 2050 7265 2d63 6f6d 7075 7465  ...- Pre-compute
-00019100: 2046 4654 2061 6e64 206f 7665 7273 616d   FFT and oversam
-00019110: 706c 696e 6720 6f66 2074 656d 706c 6174  pling of templat
-00019120: 6573 2e20 5468 6973 2073 7065 6564 7320  es. This speeds 
-00019130: 7570 2074 6865 0d0a 2020 6361 6c63 756c  up the..  calcul
-00019140: 6174 696f 6e20 666f 7220 7665 7279 206c  ation for very l
-00019150: 6f6e 6720 6f72 2068 6967 686c 7920 6f76  ong or highly ov
-00019160: 6572 7361 6d70 6c65 6420 7370 6563 7472  ersampled spectr
-00019170: 612e 2054 6861 6e6b 7320 746f 0d0a 2020  a. Thanks to..  
-00019180: 5265 6d63 6f20 7661 6e20 6465 6e20 426f  Remco van den Bo
-00019190: 7363 6820 666f 7220 7265 706f 7274 696e  sch for reportin
-000191a0: 6720 7369 7475 6174 696f 6e73 2077 6865  g situations whe
-000191b0: 7265 2074 6869 7320 6f70 7469 6d69 7a61  re this optimiza
-000191c0: 7469 6f6e 0d0a 2020 6d61 7920 6265 2075  tion..  may be u
-000191d0: 7365 6675 6c2e 0d0a 0d0a 5635 2e31 2e38  seful.....V5.1.8
-000191e0: 3a20 4d43 2c20 5574 6168 2c20 3130 2053  : MC, Utah, 10 S
-000191f0: 6570 7465 6d62 6572 2032 3031 340d 0a2b  eptember 2014..+
+00018e70: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2049 6e63  +++++++....- Inc
+00018e80: 6c75 6465 6420 6060 626f 756e 6473 6060  luded ``bounds``
+00018e90: 2c20 6060 6669 7865 6460 6020 616e 6420  , ``fixed`` and 
+00018ea0: 6060 6672 6163 7469 6f6e 6060 206b 6579  ``fraction`` key
+00018eb0: 776f 7264 732e 0d0a 0d0a 5635 2e31 2e31  words.....V5.1.1
+00018ec0: 383a 204d 432c 204f 7866 6f72 642c 2032  8: MC, Oxford, 2
+00018ed0: 3020 4170 7269 6c20 3230 3136 0d0a 2b2b  0 April 2016..++
+00018ee0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018ef0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018f00: 0d0a 0d0a 2d20 4669 7865 6420 6465 7072  ....- Fixed depr
+00018f10: 6563 6174 696f 6e20 7761 726e 696e 6720  ecation warning 
+00018f20: 696e 204e 756d 7079 2031 2e31 312e 2043  in Numpy 1.11. C
+00018f30: 6861 6e67 6564 206f 7264 6572 2066 726f  hanged order fro
+00018f40: 6d20 3120 746f 2033 0d0a 2020 6475 7269  m 1 to 3..  duri
+00018f50: 6e67 206f 7665 7273 616d 706c 696e 672e  ng oversampling.
+00018f60: 2057 6172 6e20 6966 2073 6967 6d61 2069   Warn if sigma i
+00018f70: 7320 756e 6465 722d 7361 6d70 6c65 642e  s under-sampled.
+00018f80: 0d0a 0d0a 5635 2e31 2e31 373a 204d 432c  ....V5.1.17: MC,
+00018f90: 204f 7866 6f72 642c 2032 3120 4a61 6e75   Oxford, 21 Janu
+00018fa0: 6172 7920 3230 3136 0d0a 2b2b 2b2b 2b2b  ary 2016..++++++
+00018fb0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018fc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
+00018fd0: 0d0a 2d20 4578 7061 6e64 6564 2065 7870  ..- Expanded exp
+00018fe0: 6c61 6e61 7469 6f6e 206f 6620 7468 6520  lanation of the 
+00018ff0: 7265 6c61 7469 6f6e 7368 6970 2062 6574  relationship bet
+00019000: 7765 656e 206f 7574 7075 7420 7665 6c6f  ween output velo
+00019010: 6369 7479 2061 6e64 2072 6564 7368 6966  city and redshif
+00019020: 742e 0d0a 0d0a 5635 2e31 2e31 363a 204d  t.....V5.1.16: M
+00019030: 432c 204f 7866 6f72 642c 2039 204e 6f76  C, Oxford, 9 Nov
+00019040: 656d 6265 7220 3230 3135 0d0a 2b2b 2b2b  ember 2015..++++
+00019050: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019060: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019070: 0d0a 0d0a 2d20 4669 7865 6420 706f 7465  ....- Fixed pote
+00019080: 6e74 6961 6c6c 7920 6d69 736c 6561 6469  ntially misleadi
+00019090: 6e67 2074 7970 6f20 696e 2064 6f63 756d  ng typo in docum
+000190a0: 656e 7461 7469 6f6e 206f 6620 6060 6d6f  entation of ``mo
+000190b0: 6d65 6e74 7360 602e 0d0a 0d0a 5635 2e31  ments``.....V5.1
+000190c0: 2e31 353a 204d 432c 204f 7866 6f72 642c  .15: MC, Oxford,
+000190d0: 2032 3220 4f63 746f 6265 7220 3230 3135   22 October 2015
+000190e0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+000190f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019100: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5570 6461  ++++++....- Upda
+00019110: 7465 6420 646f 6375 6d65 6e74 6174 696f  ted documentatio
+00019120: 6e2e 2054 6861 6e6b 7320 746f 2050 6574  n. Thanks to Pet
+00019130: 6572 2057 6569 6c62 6163 6865 7220 2850  er Weilbacher (P
+00019140: 6f74 7364 616d 2920 666f 720d 0a20 2063  otsdam) for..  c
+00019150: 6f72 7265 6374 696f 6e73 2e0d 0a0d 0a56  orrections.....V
+00019160: 352e 312e 3134 3a20 4d43 2c20 4f78 666f  5.1.14: MC, Oxfo
+00019170: 7264 2c20 3139 204f 6374 6f62 6572 2032  rd, 19 October 2
+00019180: 3031 350d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  015..+++++++++++
+00019190: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000191a0: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2046  +++++++++....- F
+000191b0: 6978 6564 2064 6570 7265 6361 7469 6f6e  ixed deprecation
+000191c0: 2077 6172 6e69 6e67 2069 6e20 4e75 6d70   warning in Nump
+000191d0: 7920 312e 3130 2e0d 0a0d 0a56 352e 312e  y 1.10.....V5.1.
+000191e0: 3133 3a20 4d43 2c20 4f78 666f 7264 2c20  13: MC, Oxford, 
+000191f0: 3234 2041 7072 696c 2032 3031 350d 0a2b  24 April 2015..+
 00019200: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 00019210: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019220: 2b2b 0d0a 0d0a 2d20 4669 7865 6420 7072  ++....- Fixed pr
-00019230: 6f67 7261 6d20 7374 6f70 2077 6974 6820  ogram stop with 
-00019240: 6060 7265 6464 656e 696e 6760 6020 6b65  ``reddening`` ke
-00019250: 7977 6f72 642e 2054 6861 6e6b 7320 746f  yword. Thanks to
-00019260: 204d 6173 6174 616f 0d0a 2020 4f6e 6f64   Masatao..  Onod
-00019270: 6572 6120 666f 7220 7265 706f 7274 696e  era for reportin
-00019280: 6720 7468 6520 7072 6f62 6c65 6d2e 0d0a  g the problem...
-00019290: 0d0a 5635 2e31 2e37 3a20 4d43 2c20 4f78  ..V5.1.7: MC, Ox
-000192a0: 666f 7264 2c20 3320 5365 7074 656d 6265  ford, 3 Septembe
-000192b0: 7220 3230 3134 0d0a 2b2b 2b2b 2b2b 2b2b  r 2014..++++++++
-000192c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000192d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-000192e0: 2d20 5265 6c61 7865 6420 7265 7175 6972  - Relaxed requir
-000192f0: 656d 656e 7420 6f6e 2069 6e70 7574 206d  ement on input m
-00019300: 6178 696d 756d 2076 656c 6f63 6974 7920  aximum velocity 
-00019310: 7368 6966 742e 0d0a 2d20 4d69 6e6f 7220  shift...- Minor 
-00019320: 7265 6f72 6761 6e69 7a61 7469 6f6e 206f  reorganization o
-00019330: 6620 7468 6520 636f 6465 2073 7472 7563  f the code struc
-00019340: 7475 7265 2e0d 0a0d 0a56 352e 312e 363a  ture.....V5.1.6:
-00019350: 204d 432c 204f 7866 6f72 642c 2036 2041   MC, Oxford, 6 A
-00019360: 7567 7573 7420 3230 3134 0d0a 2b2b 2b2b  ugust 2014..++++
-00019370: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019380: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00019390: 0a2d 2043 6174 6368 2061 6e20 6164 6469  .- Catch an addi
-000193a0: 7469 6f6e 616c 2069 6e70 7574 2065 7272  tional input err
-000193b0: 6f72 2e20 5570 6461 7465 6420 646f 6375  or. Updated docu
-000193c0: 6d65 6e74 6174 696f 6e20 666f 7220 5079  mentation for Py
-000193d0: 7468 6f6e 2e0d 0a20 2049 6e63 6c75 6465  thon...  Include
-000193e0: 6420 7465 6d70 6c61 7465 7320 6060 6d61  d templates ``ma
-000193f0: 7472 6978 6060 2069 6e20 6f75 7470 7574  trix`` in output
-00019400: 2e20 4d6f 6469 6669 6564 2070 6c6f 7474  . Modified plott
-00019410: 696e 6720 636f 6c6f 7572 732e 0d0a 0d0a  ing colours.....
-00019420: 5635 2e31 2e35 3a20 4d43 2c20 4f78 666f  V5.1.5: MC, Oxfo
-00019430: 7264 2c20 3231 204a 756e 6520 3230 3134  rd, 21 June 2014
-00019440: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-00019450: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019460: 2b2b 0d0a 0d0a 2d20 4669 7865 6420 6465  ++....- Fixed de
-00019470: 7072 6563 6174 696f 6e20 7761 726e 696e  precation warnin
-00019480: 672e 0d0a 0d0a 5635 2e31 2e34 3a20 4d43  g.....V5.1.4: MC
-00019490: 2c20 4f78 666f 7264 2c20 3235 204d 6179  , Oxford, 25 May
-000194a0: 2032 3031 340d 0a2b 2b2b 2b2b 2b2b 2b2b   2014..+++++++++
-000194b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000194c0: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5375 7070  ++++++....- Supp
-000194d0: 6f72 7420 626f 7468 2050 7974 686f 6e20  ort both Python 
-000194e0: 322e 3720 616e 6420 5079 7468 6f6e 2033  2.7 and Python 3
-000194f0: 2e0d 0a0d 0a56 352e 312e 333a 204d 432c  .....V5.1.3: MC,
-00019500: 204f 7866 6f72 642c 2037 204d 6179 2032   Oxford, 7 May 2
-00019510: 3031 340d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  014..+++++++++++
-00019520: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019530: 2b2b 2b0d 0a0d 0a2d 2041 6c6c 6f77 2066  +++....- Allow f
-00019540: 6f72 2061 6e20 696e 7075 7420 636f 7661  or an input cova
-00019550: 7269 616e 6365 206d 6174 7269 7820 696e  riance matrix in
-00019560: 7374 6561 6420 6f66 2061 6e20 6572 726f  stead of an erro
-00019570: 7220 7370 6563 7472 756d 2e0d 0a0d 0a56  r spectrum.....V
-00019580: 352e 312e 323a 204d 432c 204f 7866 6f72  5.1.2: MC, Oxfor
-00019590: 642c 2036 204d 6179 2032 3031 340d 0a2b  d, 6 May 2014..+
-000195a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000195b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-000195c0: 0a2d 2052 6570 6c61 6365 6420 5245 4249  .- Replaced REBI
-000195d0: 4e20 7769 7468 2049 4e54 4552 504f 4c41  N with INTERPOLA
-000195e0: 5445 202b 202f 4f56 4552 5341 4d50 4c45  TE + /OVERSAMPLE
-000195f0: 206b 6579 776f 7264 2e20 5468 6973 2069   keyword. This i
-00019600: 730d 0a20 2074 6f20 6163 636f 756e 7420  s..  to account 
-00019610: 666f 7220 7468 6520 6661 6374 2074 6861  for the fact tha
-00019620: 7420 7468 6520 4c69 6e65 2053 7072 6561  t the Line Sprea
-00019630: 6420 4675 6e63 7469 6f6e 206f 6620 7468  d Function of th
-00019640: 6520 6f62 7365 7276 6564 0d0a 2020 6761  e observed..  ga
-00019650: 6c61 7879 2073 7065 6374 7275 6d20 616c  laxy spectrum al
-00019660: 7265 6164 7920 696e 636c 7564 6573 2070  ready includes p
-00019670: 6978 656c 2063 6f6e 766f 6c75 7469 6f6e  ixel convolution
-00019680: 2e20 5468 616e 6b73 2074 6f20 4d69 6b65  . Thanks to Mike
-00019690: 0d0a 2020 426c 616e 746f 6e20 666f 7220  ..  Blanton for 
-000196a0: 7468 6520 7375 6767 6573 7469 6f6e 2e0d  the suggestion..
-000196b0: 0a0d 0a56 352e 312e 313a 204d 432c 2044  ...V5.1.1: MC, D
-000196c0: 616c 6c61 7320 4169 7270 6f72 742c 2039  allas Airport, 9
-000196d0: 2046 6562 7275 6172 7920 3230 3134 0d0a   February 2014..
-000196e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000196f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019700: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
-00019710: 2046 6978 6564 2074 7970 6f20 696e 2074   Fixed typo in t
-00019720: 6865 2064 6f63 756d 656e 7461 7469 6f6e  he documentation
-00019730: 206f 6620 6060 6e6e 6c73 5f66 6c61 6773   of ``nnls_flags
-00019740: 6060 2e0d 0a0d 0a56 352e 312e 303a 204d  ``.....V5.1.0: M
-00019750: 432c 204f 7866 6f72 642c 2039 204a 616e  C, Oxford, 9 Jan
-00019760: 7561 7279 2032 3031 340d 0a2b 2b2b 2b2b  uary 2014..+++++
-00019770: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019780: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00019790: 0a2d 2041 6c6c 6f77 2066 6f72 2061 2064  .- Allow for a d
-000197a0: 6966 6665 7265 6e74 204c 4f53 5644 2066  ifferent LOSVD f
-000197b0: 6f72 2065 6163 6820 7465 6d70 6c61 7465  or each template
-000197c0: 2e20 5465 6d70 6c61 7465 7320 6361 6e20  . Templates can 
-000197d0: 6265 2073 7465 6c6c 6172 206f 720d 0a20  be stellar or.. 
-000197e0: 2063 616e 2062 6520 6761 7320 656d 6973   can be gas emis
-000197f0: 7369 6f6e 206c 696e 6573 2e20 4120 7050  sion lines. A pP
-00019800: 5846 2076 6572 7369 6f6e 2061 6461 7074  XF version adapt
-00019810: 6564 2066 6f72 206d 756c 7469 706c 6520  ed for multiple 
-00019820: 6b69 6e65 6d61 7469 630d 0a20 2063 6f6d  kinematic..  com
-00019830: 706f 6e65 6e74 7320 6578 6973 7465 6420  ponents existed 
-00019840: 666f 7220 7965 6172 732e 2049 7420 7761  for years. It wa
-00019850: 7320 7570 6461 7465 6420 696e 204a 414e  s updated in JAN
-00019860: 2f32 3031 3220 666f 7220 7468 6520 7061  /2012 for the pa
-00019870: 7065 7220 6279 0d0a 2020 4a6f 686e 7374  per by..  Johnst
-00019880: 6f6e 2065 7420 616c 2e20 2832 3031 332c  on et al. (2013,
-00019890: 204d 4e52 4153 292e 2054 6869 7320 7665   MNRAS). This ve
-000198a0: 7273 696f 6e20 6d65 7267 6573 2074 686f  rsion merges tho
-000198b0: 7365 2063 6861 6e67 6573 2077 6974 6820  se changes with 
-000198c0: 7468 650d 0a20 2070 7562 6c69 6320 7050  the..  public pP
-000198d0: 5846 2076 6572 7369 6f6e 2c20 6d61 6b69  XF version, maki
-000198e0: 6e67 2073 7572 6520 7468 6174 2061 6c6c  ng sure that all
-000198f0: 2070 7265 7669 6f75 7320 7050 5846 206f   previous pPXF o
-00019900: 7074 696f 6e73 2061 7265 2073 7469 6c6c  ptions are still
-00019910: 0d0a 2020 7375 7070 6f72 7465 642e 0d0a  ..  supported...
-00019920: 0d0a 5635 2e30 2e31 3a20 4d43 2c20 4f78  ..V5.0.1: MC, Ox
-00019930: 666f 7264 2c20 3132 2044 6563 656d 6265  ford, 12 Decembe
-00019940: 7220 3230 3133 0d0a 2b2b 2b2b 2b2b 2b2b  r 2013..++++++++
+00019220: 2b0d 0a0d 0a2d 2055 7064 6174 6564 2064  +....- Updated d
+00019230: 6f63 756d 656e 7461 7469 6f6e 2e0d 0a0d  ocumentation....
+00019240: 0a56 352e 312e 3132 3a20 4d43 2c20 4f78  .V5.1.12: MC, Ox
+00019250: 666f 7264 2c20 3235 2046 6562 7275 6172  ford, 25 Februar
+00019260: 7920 3230 3135 0d0a 2b2b 2b2b 2b2b 2b2b  y 2015..++++++++
+00019270: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019280: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+00019290: 0a2d 2055 7365 2060 6063 6f6c 6f72 3d60  .- Use ``color=`
+000192a0: 6020 696e 7374 6561 6420 6f66 2060 6063  ` instead of ``c
+000192b0: 3d60 6020 746f 2061 766f 6964 2061 206e  =`` to avoid a n
+000192c0: 6577 204d 6174 706c 6f74 6c69 6220 312e  ew Matplotlib 1.
+000192d0: 3420 6275 672e 0d0a 0d0a 5635 2e31 2e31  4 bug.....V5.1.1
+000192e0: 313a 204d 432c 2053 7964 6e65 792c 2035  1: MC, Sydney, 5
+000192f0: 2046 6562 7275 6172 7920 3230 3135 0d0a   February 2015..
+00019300: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019310: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019320: 2b2b 2b2b 0d0a 0d0a 2d20 5265 7665 7274  ++++....- Revert
+00019330: 6564 2063 6861 6e67 6520 696e 7472 6f64  ed change introd
+00019340: 7563 6564 2069 6e20 5635 2e31 2e32 2e20  uced in V5.1.2. 
+00019350: 5468 616e 6b73 2074 6f20 4e6f 7261 204c  Thanks to Nora L
+00019360: 7522 747a 6765 6e64 6f72 660d 0a20 2066  u"tzgendorf..  f
+00019370: 6f72 2072 6570 6f72 7469 6e67 2070 726f  or reporting pro
+00019380: 626c 656d 7320 7769 7468 2060 606f 7665  blems with ``ove
+00019390: 7273 616d 706c 6560 602e 0d0a 0d0a 5635  rsample``.....V5
+000193a0: 2e31 2e31 303a 204d 432c 204f 7866 6f72  .1.10: MC, Oxfor
+000193b0: 642c 2031 3420 4f63 746f 6265 7220 3230  d, 14 October 20
+000193c0: 3134 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  14..++++++++++++
+000193d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000193e0: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 4669  ++++++++....- Fi
+000193f0: 7865 6420 6275 6720 696e 2073 6176 696e  xed bug in savin
+00019400: 6720 6f75 7470 7574 2069 6e74 726f 6475  g output introdu
+00019410: 6365 6420 696e 2074 6865 2070 7265 7669  ced in the previ
+00019420: 6f75 7320 7665 7273 696f 6e2e 0d0a 0d0a  ous version.....
+00019430: 5635 2e31 2e39 3a20 4d43 2c20 4c61 7320  V5.1.9: MC, Las 
+00019440: 5665 6761 7320 4169 7270 6f72 742c 2031  Vegas Airport, 1
+00019450: 3320 5365 7074 656d 6265 7220 3230 3134  3 September 2014
+00019460: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+00019470: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019480: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019490: 2b2b 0d0a 0d0a 2d20 5072 652d 636f 6d70  ++....- Pre-comp
+000194a0: 7574 6520 4646 5420 616e 6420 6f76 6572  ute FFT and over
+000194b0: 7361 6d70 6c69 6e67 206f 6620 7465 6d70  sampling of temp
+000194c0: 6c61 7465 732e 2054 6869 7320 7370 6565  lates. This spee
+000194d0: 6473 2075 7020 7468 650d 0a20 2063 616c  ds up the..  cal
+000194e0: 6375 6c61 7469 6f6e 2066 6f72 2076 6572  culation for ver
+000194f0: 7920 6c6f 6e67 206f 7220 6869 6768 6c79  y long or highly
+00019500: 206f 7665 7273 616d 706c 6564 2073 7065   oversampled spe
+00019510: 6374 7261 2e20 5468 616e 6b73 2074 6f0d  ctra. Thanks to.
+00019520: 0a20 2052 656d 636f 2076 616e 2064 656e  .  Remco van den
+00019530: 2042 6f73 6368 2066 6f72 2072 6570 6f72   Bosch for repor
+00019540: 7469 6e67 2073 6974 7561 7469 6f6e 7320  ting situations 
+00019550: 7768 6572 6520 7468 6973 206f 7074 696d  where this optim
+00019560: 697a 6174 696f 6e0d 0a20 206d 6179 2062  ization..  may b
+00019570: 6520 7573 6566 756c 2e0d 0a0d 0a56 352e  e useful.....V5.
+00019580: 312e 383a 204d 432c 2055 7461 682c 2031  1.8: MC, Utah, 1
+00019590: 3020 5365 7074 656d 6265 7220 3230 3134  0 September 2014
+000195a0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+000195b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000195c0: 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978 6564  +++++....- Fixed
+000195d0: 2070 726f 6772 616d 2073 746f 7020 7769   program stop wi
+000195e0: 7468 2060 6072 6564 6465 6e69 6e67 6060  th ``reddening``
+000195f0: 206b 6579 776f 7264 2e20 5468 616e 6b73   keyword. Thanks
+00019600: 2074 6f20 4d61 7361 7461 6f0d 0a20 204f   to Masatao..  O
+00019610: 6e6f 6465 7261 2066 6f72 2072 6570 6f72  nodera for repor
+00019620: 7469 6e67 2074 6865 2070 726f 626c 656d  ting the problem
+00019630: 2e0d 0a0d 0a56 352e 312e 373a 204d 432c  .....V5.1.7: MC,
+00019640: 204f 7866 6f72 642c 2033 2053 6570 7465   Oxford, 3 Septe
+00019650: 6d62 6572 2032 3031 340d 0a2b 2b2b 2b2b  mber 2014..+++++
+00019660: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019670: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+00019680: 0a0d 0a2d 2052 656c 6178 6564 2072 6571  ...- Relaxed req
+00019690: 7569 7265 6d65 6e74 206f 6e20 696e 7075  uirement on inpu
+000196a0: 7420 6d61 7869 6d75 6d20 7665 6c6f 6369  t maximum veloci
+000196b0: 7479 2073 6869 6674 2e0d 0a2d 204d 696e  ty shift...- Min
+000196c0: 6f72 2072 656f 7267 616e 697a 6174 696f  or reorganizatio
+000196d0: 6e20 6f66 2074 6865 2063 6f64 6520 7374  n of the code st
+000196e0: 7275 6374 7572 652e 0d0a 0d0a 5635 2e31  ructure.....V5.1
+000196f0: 2e36 3a20 4d43 2c20 4f78 666f 7264 2c20  .6: MC, Oxford, 
+00019700: 3620 4175 6775 7374 2032 3031 340d 0a2b  6 August 2014..+
+00019710: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019720: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019730: 0d0a 0d0a 2d20 4361 7463 6820 616e 2061  ....- Catch an a
+00019740: 6464 6974 696f 6e61 6c20 696e 7075 7420  dditional input 
+00019750: 6572 726f 722e 2055 7064 6174 6564 2064  error. Updated d
+00019760: 6f63 756d 656e 7461 7469 6f6e 2066 6f72  ocumentation for
+00019770: 2050 7974 686f 6e2e 0d0a 2020 496e 636c   Python...  Incl
+00019780: 7564 6564 2074 656d 706c 6174 6573 2060  uded templates `
+00019790: 606d 6174 7269 7860 6020 696e 206f 7574  `matrix`` in out
+000197a0: 7075 742e 204d 6f64 6966 6965 6420 706c  put. Modified pl
+000197b0: 6f74 7469 6e67 2063 6f6c 6f75 7273 2e0d  otting colours..
+000197c0: 0a0d 0a56 352e 312e 353a 204d 432c 204f  ...V5.1.5: MC, O
+000197d0: 7866 6f72 642c 2032 3120 4a75 6e65 2032  xford, 21 June 2
+000197e0: 3031 340d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  014..+++++++++++
+000197f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019800: 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978 6564  +++++....- Fixed
+00019810: 2064 6570 7265 6361 7469 6f6e 2077 6172   deprecation war
+00019820: 6e69 6e67 2e0d 0a0d 0a56 352e 312e 343a  ning.....V5.1.4:
+00019830: 204d 432c 204f 7866 6f72 642c 2032 3520   MC, Oxford, 25 
+00019840: 4d61 7920 3230 3134 0d0a 2b2b 2b2b 2b2b  May 2014..++++++
+00019850: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019860: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2053  +++++++++....- S
+00019870: 7570 706f 7274 2062 6f74 6820 5079 7468  upport both Pyth
+00019880: 6f6e 2032 2e37 2061 6e64 2050 7974 686f  on 2.7 and Pytho
+00019890: 6e20 332e 0d0a 0d0a 5635 2e31 2e33 3a20  n 3.....V5.1.3: 
+000198a0: 4d43 2c20 4f78 666f 7264 2c20 3720 4d61  MC, Oxford, 7 Ma
+000198b0: 7920 3230 3134 0d0a 2b2b 2b2b 2b2b 2b2b  y 2014..++++++++
+000198c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000198d0: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 416c 6c6f  ++++++....- Allo
+000198e0: 7720 666f 7220 616e 2069 6e70 7574 2063  w for an input c
+000198f0: 6f76 6172 6961 6e63 6520 6d61 7472 6978  ovariance matrix
+00019900: 2069 6e73 7465 6164 206f 6620 616e 2065   instead of an e
+00019910: 7272 6f72 2073 7065 6374 7275 6d2e 0d0a  rror spectrum...
+00019920: 0d0a 5635 2e31 2e32 3a20 4d43 2c20 4f78  ..V5.1.2: MC, Ox
+00019930: 666f 7264 2c20 3620 4d61 7920 3230 3134  ford, 6 May 2014
+00019940: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
 00019950: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019960: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-00019970: 2d20 4d69 6e6f 7220 636c 6561 6e69 6e67  - Minor cleaning
-00019980: 2061 6e64 2063 6f72 7265 6374 696f 6e73   and corrections
-00019990: 2e0d 0a0d 0a56 352e 302e 303a 204d 432c  .....V5.0.0: MC,
-000199a0: 204f 7866 6f72 642c 2036 2044 6563 656d   Oxford, 6 Decem
-000199b0: 6265 7220 3230 3133 0d0a 2b2b 2b2b 2b2b  ber 2013..++++++
-000199c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000199d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-000199e0: 0a2d 2054 7261 6e73 6c61 7465 6420 6672  .- Translated fr
-000199f0: 6f6d 2049 444c 2069 6e74 6f20 5079 7468  om IDL into Pyth
-00019a00: 6f6e 2061 6e64 2074 6573 7465 6420 6167  on and tested ag
-00019a10: 6169 6e73 7420 7468 6520 6f72 6967 696e  ainst the origin
-00019a20: 616c 2076 6572 7369 6f6e 2e0d 0a0d 0a56  al version.....V
-00019a30: 342e 362e 363a 204d 432c 2050 6172 616e  4.6.6: MC, Paran
-00019a40: 616c 2c20 3820 4e6f 7665 6d62 6572 2032  al, 8 November 2
-00019a50: 3031 330d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  013..+++++++++++
-00019a60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019a70: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2055  +++++++++....- U
-00019a80: 7365 7320 4341 505f 5241 4e47 4520 746f  ses CAP_RANGE to
-00019a90: 2061 766f 6964 2070 6f74 656e 7469 616c   avoid potential
-00019aa0: 206e 616d 696e 6720 636f 6e66 6c69 6374   naming conflict
-00019ab0: 732e 0d0a 0d0a 5634 2e36 2e35 3a20 4d43  s.....V4.6.5: MC
-00019ac0: 2c20 4f78 666f 7264 2c20 3135 204e 6f76  , Oxford, 15 Nov
-00019ad0: 656d 6265 7220 3230 3132 0d0a 2b2b 2b2b  ember 2012..++++
-00019ae0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019af0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019b00: 0d0a 0d0a 2d20 4578 7061 6e64 6564 2064  ....- Expanded d
-00019b10: 6f63 756d 656e 7461 7469 6f6e 206f 6620  ocumentation of 
-00019b20: 5245 4755 4c20 6b65 7977 6f72 642e 0d0a  REGUL keyword...
-00019b30: 0d0a 5634 2e36 2e34 3a20 4d43 2c20 4f78  ..V4.6.4: MC, Ox
-00019b40: 666f 7264 2c20 3920 4465 6365 6d62 6572  ford, 9 December
-00019b50: 2032 3031 310d 0a2b 2b2b 2b2b 2b2b 2b2b   2011..+++++++++
-00019b60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019b70: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-00019b80: 496e 6372 6561 7365 6420 6f76 6572 7361  Increased oversa
-00019b90: 6d70 6c69 6e67 2066 6163 746f 7220 746f  mpling factor to
-00019ba0: 2033 3078 2c20 7768 656e 2074 6865 202f   30x, when the /
-00019bb0: 4f56 4552 5341 4d50 4c45 206b 6579 776f  OVERSAMPLE keywo
-00019bc0: 7264 0d0a 2020 6973 2075 7365 642e 2055  rd..  is used. U
-00019bd0: 7064 6174 6564 2063 6f72 7265 7370 6f6e  pdated correspon
-00019be0: 6469 6e67 2064 6f63 756d 656e 7461 7469  ding documentati
-00019bf0: 6f6e 2e20 5468 616e 6b73 2074 6f20 4e6f  on. Thanks to No
-00019c00: 7261 0d0a 2020 4c75 2274 7a67 656e 646f  ra..  Lu"tzgendo
-00019c10: 7266 2066 6f72 2074 6573 7420 6361 7365  rf for test case
-00019c20: 7320 696c 6c75 7374 7261 7469 6e67 2065  s illustrating e
-00019c30: 7272 6f72 7320 696e 2074 6865 2072 6563  rrors in the rec
-00019c40: 6f76 6572 6564 0d0a 2020 7665 6c6f 6369  overed..  veloci
-00019c50: 7479 2077 6865 6e20 7468 6520 7369 676d  ty when the sigm
-00019c60: 6120 6973 2073 6576 6572 656c 7920 756e  a is severely un
-00019c70: 6465 7273 616d 706c 6564 2e0d 0a0d 0a56  dersampled.....V
-00019c80: 342e 362e 333a 204d 432c 204f 7866 6f72  4.6.3: MC, Oxfor
-00019c90: 6420 3235 204f 6374 6f62 6572 2032 3031  d 25 October 201
-00019ca0: 310d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  1..+++++++++++++
-00019cb0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019cc0: 2b2b 2b2b 2b0d 0a0d 0a2d 2044 6f20 6e6f  +++++....- Do no
-00019cd0: 7420 6368 616e 6765 2054 454d 504c 4154  t change TEMPLAT
-00019ce0: 4553 2061 7272 6179 2069 6e20 6f75 7470  ES array in outp
-00019cf0: 7574 2077 6865 6e20 5245 4755 4c20 6973  ut when REGUL is
-00019d00: 206e 6f6e 7a65 726f 2e0d 0a20 2046 726f   nonzero...  Fro
-00019d10: 6d20 7468 6520 6665 6564 6261 636b 206f  m the feedback o
-00019d20: 6620 5269 6368 6172 6420 4d63 4465 726d  f Richard McDerm
-00019d30: 6964 2e0d 0a0d 0a56 342e 362e 323a 204d  id.....V4.6.2: M
-00019d40: 432c 204f 7866 6f72 642c 2031 3720 4f63  C, Oxford, 17 Oc
-00019d50: 746f 6265 7220 3230 3131 0d0a 2b2b 2b2b  tober 2011..++++
+00019960: 0d0a 0d0a 2d20 5265 706c 6163 6564 2052  ....- Replaced R
+00019970: 4542 494e 2077 6974 6820 494e 5445 5250  EBIN with INTERP
+00019980: 4f4c 4154 4520 2b20 2f4f 5645 5253 414d  OLATE + /OVERSAM
+00019990: 504c 4520 6b65 7977 6f72 642e 2054 6869  PLE keyword. Thi
+000199a0: 7320 6973 0d0a 2020 746f 2061 6363 6f75  s is..  to accou
+000199b0: 6e74 2066 6f72 2074 6865 2066 6163 7420  nt for the fact 
+000199c0: 7468 6174 2074 6865 204c 696e 6520 5370  that the Line Sp
+000199d0: 7265 6164 2046 756e 6374 696f 6e20 6f66  read Function of
+000199e0: 2074 6865 206f 6273 6572 7665 640d 0a20   the observed.. 
+000199f0: 2067 616c 6178 7920 7370 6563 7472 756d   galaxy spectrum
+00019a00: 2061 6c72 6561 6479 2069 6e63 6c75 6465   already include
+00019a10: 7320 7069 7865 6c20 636f 6e76 6f6c 7574  s pixel convolut
+00019a20: 696f 6e2e 2054 6861 6e6b 7320 746f 204d  ion. Thanks to M
+00019a30: 696b 650d 0a20 2042 6c61 6e74 6f6e 2066  ike..  Blanton f
+00019a40: 6f72 2074 6865 2073 7567 6765 7374 696f  or the suggestio
+00019a50: 6e2e 0d0a 0d0a 5635 2e31 2e31 3a20 4d43  n.....V5.1.1: MC
+00019a60: 2c20 4461 6c6c 6173 2041 6972 706f 7274  , Dallas Airport
+00019a70: 2c20 3920 4665 6272 7561 7279 2032 3031  , 9 February 201
+00019a80: 340d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  4..+++++++++++++
+00019a90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019aa0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
+00019ab0: 0d0a 2d20 4669 7865 6420 7479 706f 2069  ..- Fixed typo i
+00019ac0: 6e20 7468 6520 646f 6375 6d65 6e74 6174  n the documentat
+00019ad0: 696f 6e20 6f66 2060 606e 6e6c 735f 666c  ion of ``nnls_fl
+00019ae0: 6167 7360 602e 0d0a 0d0a 5635 2e31 2e30  ags``.....V5.1.0
+00019af0: 3a20 4d43 2c20 4f78 666f 7264 2c20 3920  : MC, Oxford, 9 
+00019b00: 4a61 6e75 6172 7920 3230 3134 0d0a 2b2b  January 2014..++
+00019b10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019b20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019b30: 0d0a 0d0a 2d20 416c 6c6f 7720 666f 7220  ....- Allow for 
+00019b40: 6120 6469 6666 6572 656e 7420 4c4f 5356  a different LOSV
+00019b50: 4420 666f 7220 6561 6368 2074 656d 706c  D for each templ
+00019b60: 6174 652e 2054 656d 706c 6174 6573 2063  ate. Templates c
+00019b70: 616e 2062 6520 7374 656c 6c61 7220 6f72  an be stellar or
+00019b80: 0d0a 2020 6361 6e20 6265 2067 6173 2065  ..  can be gas e
+00019b90: 6d69 7373 696f 6e20 6c69 6e65 732e 2041  mission lines. A
+00019ba0: 2070 5058 4620 7665 7273 696f 6e20 6164   pPXF version ad
+00019bb0: 6170 7465 6420 666f 7220 6d75 6c74 6970  apted for multip
+00019bc0: 6c65 206b 696e 656d 6174 6963 0d0a 2020  le kinematic..  
+00019bd0: 636f 6d70 6f6e 656e 7473 2065 7869 7374  components exist
+00019be0: 6564 2066 6f72 2079 6561 7273 2e20 4974  ed for years. It
+00019bf0: 2077 6173 2075 7064 6174 6564 2069 6e20   was updated in 
+00019c00: 4a41 4e2f 3230 3132 2066 6f72 2074 6865  JAN/2012 for the
+00019c10: 2070 6170 6572 2062 790d 0a20 204a 6f68   paper by..  Joh
+00019c20: 6e73 746f 6e20 6574 2061 6c2e 2028 3230  nston et al. (20
+00019c30: 3133 2c20 4d4e 5241 5329 2e20 5468 6973  13, MNRAS). This
+00019c40: 2076 6572 7369 6f6e 206d 6572 6765 7320   version merges 
+00019c50: 7468 6f73 6520 6368 616e 6765 7320 7769  those changes wi
+00019c60: 7468 2074 6865 0d0a 2020 7075 626c 6963  th the..  public
+00019c70: 2070 5058 4620 7665 7273 696f 6e2c 206d   pPXF version, m
+00019c80: 616b 696e 6720 7375 7265 2074 6861 7420  aking sure that 
+00019c90: 616c 6c20 7072 6576 696f 7573 2070 5058  all previous pPX
+00019ca0: 4620 6f70 7469 6f6e 7320 6172 6520 7374  F options are st
+00019cb0: 696c 6c0d 0a20 2073 7570 706f 7274 6564  ill..  supported
+00019cc0: 2e0d 0a0d 0a56 352e 302e 313a 204d 432c  .....V5.0.1: MC,
+00019cd0: 204f 7866 6f72 642c 2031 3220 4465 6365   Oxford, 12 Dece
+00019ce0: 6d62 6572 2032 3031 330d 0a2b 2b2b 2b2b  mber 2013..+++++
+00019cf0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019d00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+00019d10: 0a0d 0a2d 204d 696e 6f72 2063 6c65 616e  ...- Minor clean
+00019d20: 696e 6720 616e 6420 636f 7272 6563 7469  ing and correcti
+00019d30: 6f6e 732e 0d0a 0d0a 5635 2e30 2e30 3a20  ons.....V5.0.0: 
+00019d40: 4d43 2c20 4f78 666f 7264 2c20 3620 4465  MC, Oxford, 6 De
+00019d50: 6365 6d62 6572 2032 3031 330d 0a2b 2b2b  cember 2013..+++
 00019d60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019d70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-00019d80: 0a0d 0a2d 2049 6e63 6c75 6465 6420 6f70  ...- Included op
-00019d90: 7469 6f6e 2066 6f72 2033 4420 7265 6775  tion for 3D regu
-00019da0: 6c61 7269 7a61 7469 6f6e 2061 6e64 2075  larization and u
-00019db0: 7064 6174 6564 2064 6f63 756d 656e 7461  pdated documenta
-00019dc0: 7469 6f6e 206f 660d 0a20 2052 4547 554c  tion of..  REGUL
-00019dd0: 206b 6579 776f 7264 2e0d 0a0d 0a56 342e   keyword.....V4.
-00019de0: 362e 313a 204d 432c 204f 7866 6f72 642c  6.1: MC, Oxford,
-00019df0: 2032 3920 4a75 6c79 2032 3031 310d 0a2b   29 July 2011..+
+00019d70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019d80: 0d0a 0d0a 2d20 5472 616e 736c 6174 6564  ....- Translated
+00019d90: 2066 726f 6d20 4944 4c20 696e 746f 2050   from IDL into P
+00019da0: 7974 686f 6e20 616e 6420 7465 7374 6564  ython and tested
+00019db0: 2061 6761 696e 7374 2074 6865 206f 7269   against the ori
+00019dc0: 6769 6e61 6c20 7665 7273 696f 6e2e 0d0a  ginal version...
+00019dd0: 0d0a 5634 2e36 2e36 3a20 4d43 2c20 5061  ..V4.6.6: MC, Pa
+00019de0: 7261 6e61 6c2c 2038 204e 6f76 656d 6265  ranal, 8 Novembe
+00019df0: 7220 3230 3133 0d0a 2b2b 2b2b 2b2b 2b2b  r 2013..++++++++
 00019e00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019e10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-00019e20: 0a0d 0a2d 2055 7365 2043 6f79 6f74 6520  ...- Use Coyote 
-00019e30: 4772 6170 6869 6373 2028 6874 7470 3a2f  Graphics (http:/
-00019e40: 2f77 7777 2e69 646c 636f 796f 7465 2e63  /www.idlcoyote.c
-00019e50: 6f6d 2f29 2062 7920 4461 7669 6420 572e  om/) by David W.
-00019e60: 2046 616e 6e69 6e67 2e0d 0a20 2054 6865   Fanning...  The
-00019e70: 2072 6571 7569 7265 6420 726f 7574 696e   required routin
-00019e80: 6573 2061 7265 206e 6f77 2069 6e63 6c75  es are now inclu
-00019e90: 6465 6420 696e 204e 4153 4120 4944 4c20  ded in NASA IDL 
-00019ea0: 4173 7472 6f6e 6f6d 7920 4c69 6272 6172  Astronomy Librar
-00019eb0: 792e 0d0a 0d0a 5634 2e36 2e30 3a20 4d43  y.....V4.6.0: MC
-00019ec0: 2c20 4f78 666f 7264 2c20 3132 2041 7072  , Oxford, 12 Apr
-00019ed0: 696c 2032 3031 310d 0a2b 2b2b 2b2b 2b2b  il 2011..+++++++
-00019ee0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019ef0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-00019f00: 496d 706f 7274 616e 7420 6669 7820 746f  Important fix to
-00019f10: 202f 434c 4541 4e20 7072 6f63 6564 7572   /CLEAN procedur
-00019f20: 653a 2062 6164 2070 6978 656c 7320 6172  e: bad pixels ar
-00019f30: 6520 6e6f 7720 7072 6f70 6572 6c79 0d0a  e now properly..
-00019f40: 2020 7570 6461 7465 6420 6475 7269 6e67    updated during
-00019f50: 2074 6865 2033 7369 676d 6120 6974 6572   the 3sigma iter
-00019f60: 6174 696f 6e73 2e0d 0a0d 0a56 342e 352e  ations.....V4.5.
-00019f70: 303a 204d 432c 204f 7866 6f72 642c 2031  0: MC, Oxford, 1
-00019f80: 3320 4170 7269 6c20 3230 3130 0d0a 2b2b  3 April 2010..++
-00019f90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019fa0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-00019fb0: 0a0d 0a2d 2044 7261 6d61 7469 6320 7370  ...- Dramatic sp
-00019fc0: 6565 6420 7570 2069 6e20 7468 6520 636f  eed up in the co
-00019fd0: 6e76 6f6c 7574 696f 6e20 6f66 206c 6f6e  nvolution of lon
-00019fe0: 6720 7370 6563 7472 612e 0d0a 0d0a 5634  g spectra.....V4
-00019ff0: 2e34 2e30 3a20 4d43 2c20 4f78 666f 7264  .4.0: MC, Oxford
-0001a000: 2c20 3138 2053 6570 7465 6d62 6572 2032  , 18 September 2
-0001a010: 3030 390d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  009..+++++++++++
-0001a020: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a030: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-0001a040: 496e 7472 6f64 7563 6564 2043 616c 7a65  Introduced Calze
-0001a050: 7474 6920 6574 2061 6c2e 2028 3230 3030  tti et al. (2000
-0001a060: 2920 7070 7866 5f52 4544 4445 4e49 4e47  ) ppxf_REDDENING
-0001a070: 5f43 5552 5645 2066 756e 6374 696f 6e20  _CURVE function 
-0001a080: 746f 0d0a 2020 6573 7469 6d61 7465 2074  to..  estimate t
-0001a090: 6865 2072 6564 6465 6e69 6e67 2066 726f  he reddening fro
-0001a0a0: 6d20 7468 6520 6669 742e 0d0a 0d0a 5634  m the fit.....V4
-0001a0b0: 2e33 2e30 3a20 4d43 2c20 4f78 666f 7264  .3.0: MC, Oxford
-0001a0c0: 2c20 3420 4d61 6368 2032 3030 390d 0a2b  , 4 Mach 2009..+
-0001a0d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a0e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
-0001a0f0: 0d0a 2d20 496e 7472 6f64 7563 6564 2052  ..- Introduced R
-0001a100: 4547 554c 206b 6579 776f 7264 2074 6f20  EGUL keyword to 
-0001a110: 7065 7266 6f72 6d20 6c69 6e65 6172 2072  perform linear r
-0001a120: 6567 756c 6172 697a 6174 696f 6e20 6f66  egularization of
-0001a130: 2057 4549 4748 5453 0d0a 2020 696e 206f   WEIGHTS..  in o
-0001a140: 6e65 206f 7220 7477 6f20 6469 6d65 6e73  ne or two dimens
-0001a150: 696f 6e73 2e0d 0a0d 0a56 342e 322e 333a  ions.....V4.2.3:
-0001a160: 204d 432c 204f 7866 6f72 642c 2032 3720   MC, Oxford, 27 
-0001a170: 4e6f 7665 6d62 6572 2032 3030 380d 0a2b  November 2008..+
-0001a180: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a190: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a1a0: 2b2b 2b0d 0a0d 0a2d 2043 6f72 7265 6374  +++....- Correct
-0001a1b0: 6564 2065 7272 6f72 206d 6573 7361 6765  ed error message
-0001a1c0: 2066 6f72 2074 6f6f 2062 6967 2076 656c   for too big vel
-0001a1d0: 6f63 6974 7920 7368 6966 742e 0d0a 0d0a  ocity shift.....
-0001a1e0: 5634 2e32 2e32 3a20 4d43 2c20 5769 6e64  V4.2.2: MC, Wind
-0001a1f0: 686f 656b 2c20 3320 4a75 6c79 2032 3030  hoek, 3 July 200
-0001a200: 380d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  8..+++++++++++++
-0001a210: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a220: 2b2b 2b2b 0d0a 0d0a 2d20 4164 6465 6420  ++++....- Added 
-0001a230: 6b65 7977 6f72 6420 504f 4c59 5745 4947  keyword POLYWEIG
-0001a240: 4854 532e 0d0a 0d0a 5634 2e32 2e31 3a20  HTS.....V4.2.1: 
-0001a250: 4d43 2c20 4f78 666f 7264 2c20 3137 204d  MC, Oxford, 17 M
-0001a260: 6179 2032 3030 380d 0a2b 2b2b 2b2b 2b2b  ay 2008..+++++++
-0001a270: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a280: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5573  ++++++++....- Us
-0001a290: 6520 4c41 5f4c 4541 5354 5f53 5155 4152  e LA_LEAST_SQUAR
-0001a2a0: 4553 2028 4944 4c20 352e 3629 2069 6e73  ES (IDL 5.6) ins
-0001a2b0: 7465 6164 206f 6620 5356 4443 2077 6865  tead of SVDC whe
-0001a2c0: 6e20 6669 7474 696e 6720 6120 7369 6e67  n fitting a sing
-0001a2d0: 6c65 0d0a 2020 7465 6d70 6c61 7465 2e20  le..  template. 
-0001a2e0: 506c 6561 7365 206c 6574 206d 6520 6b6e  Please let me kn
-0001a2f0: 6f77 2069 6620 796f 7520 6e65 6564 2074  ow if you need t
-0001a300: 6f20 7573 6520 7050 5846 2077 6974 6820  o use pPXF with 
-0001a310: 616e 206f 6c64 6572 2049 444c 0d0a 2020  an older IDL..  
-0001a320: 7665 7273 696f 6e2e 0d0a 0d0a 5634 2e32  version.....V4.2
-0001a330: 2e30 3a20 4d43 2c20 4f78 666f 7264 2c20  .0: MC, Oxford, 
-0001a340: 3135 204d 6172 6368 2032 3030 380d 0a2b  15 March 2008..+
-0001a350: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a360: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a370: 0d0a 0d0a 2d20 496e 7472 6f64 7563 6564  ....- Introduced
-0001a380: 206f 7074 696f 6e61 6c20 6669 7474 696e   optional fittin
-0001a390: 6720 6f66 2053 4b59 2073 7065 6374 7275  g of SKY spectru
-0001a3a0: 6d2e 204d 616e 7920 7468 616e 6b73 2074  m. Many thanks t
-0001a3b0: 6f0d 0a20 2041 6e6e 652d 4d61 7269 6520  o..  Anne-Marie 
-0001a3c0: 5765 696a 6d61 6e73 2066 6f72 2074 6573  Weijmans for tes
-0001a3d0: 7469 6e67 2e0d 0a0d 0a56 342e 312e 373a  ting.....V4.1.7:
-0001a3e0: 204d 432c 204f 7866 6f72 642c 2036 204f   MC, Oxford, 6 O
-0001a3f0: 6374 6f62 6572 2032 3030 370d 0a2b 2b2b  ctober 2007..+++
-0001a400: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a410: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-0001a420: 0a0d 0a2d 2055 7064 6174 6564 2064 6f63  ...- Updated doc
-0001a430: 756d 656e 7461 7469 6f6e 2077 6974 6820  umentation with 
-0001a440: 616e 2069 6d70 6f72 7461 6e74 206e 6f74  an important not
-0001a450: 6520 6f6e 2070 656e 616c 7479 2064 6574  e on penalty det
-0001a460: 6572 6d69 6e61 7469 6f6e 2e0d 0a0d 0a56  ermination.....V
-0001a470: 342e 312e 363a 204d 432c 204c 6569 6465  4.1.6: MC, Leide
-0001a480: 6e2c 2032 3020 4a61 6e75 6172 7920 3230  n, 20 January 20
-0001a490: 3036 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  06..++++++++++++
-0001a4a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a4b0: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2050 7269  +++++++....- Pri
-0001a4c0: 6e74 2074 6865 206e 756d 6265 7220 6f66  nt the number of
-0001a4d0: 206e 6f6e 7a65 726f 2074 656d 706c 6174   nonzero templat
-0001a4e0: 6573 2e20 446f 206e 6f74 2070 7269 6e74  es. Do not print
-0001a4f0: 206f 7574 6c69 6572 7320 696e 202f 5155   outliers in /QU
-0001a500: 4945 5420 6d6f 6465 2e0d 0a0d 0a56 342e  IET mode.....V4.
-0001a510: 312e 353a 204d 432c 204c 6569 6465 6e2c  1.5: MC, Leiden,
-0001a520: 2031 3020 4665 6272 7561 7279 2032 3030   10 February 200
-0001a530: 350d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  5..+++++++++++++
-0001a540: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a550: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2056 6572  +++++++....- Ver
-0001a560: 6966 7920 7468 6174 2047 4f4f 4450 4958  ify that GOODPIX
-0001a570: 454c 5320 6973 206d 6f6e 6f74 6f6e 6963  ELS is monotonic
-0001a580: 2061 6e64 2064 6f65 7320 6e6f 7420 636f   and does not co
-0001a590: 6e74 6169 6e20 6475 706c 6963 6174 6564  ntain duplicated
-0001a5a0: 0d0a 2020 7661 6c75 6573 2e20 4166 7465  ..  values. Afte
-0001a5b0: 7220 6665 6564 6261 636b 2066 726f 6d20  r feedback from 
-0001a5c0: 5269 6368 6172 6420 4d63 4465 726d 6964  Richard McDermid
-0001a5d0: 2e0d 0a0d 0a56 342e 312e 343a 204d 432c  .....V4.1.4: MC,
-0001a5e0: 204c 6569 6465 6e2c 2031 3220 4a61 6e75   Leiden, 12 Janu
-0001a5f0: 6172 7920 3230 3035 0d0a 2b2b 2b2b 2b2b  ary 2005..++++++
-0001a600: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a610: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-0001a620: 0a2d 204d 616b 6520 7375 7265 2069 6e70  .- Make sure inp
-0001a630: 7574 204e 4f49 5345 2069 7320 6120 706f  ut NOISE is a po
-0001a640: 7369 7469 7665 2076 6563 746f 722e 0d0a  sitive vector...
-0001a650: 0d0a 5634 2e31 2e33 3a20 4d43 2c20 5669  ..V4.1.3: MC, Vi
-0001a660: 6365 6e7a 612c 2033 3020 4465 6365 6d62  cenza, 30 Decemb
-0001a670: 6572 2032 3030 340d 0a2b 2b2b 2b2b 2b2b  er 2004..+++++++
-0001a680: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a690: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
-0001a6a0: 0d0a 2d20 5570 6461 7465 6420 646f 6375  ..- Updated docu
-0001a6b0: 6d65 6e74 6174 696f 6e2e 0d0a 0d0a 5634  mentation.....V4
-0001a6c0: 2e31 2e32 3a20 4d43 2c20 4c65 6964 656e  .1.2: MC, Leiden
-0001a6d0: 2c20 3131 204e 6f76 656d 6265 7220 3230  , 11 November 20
-0001a6e0: 3034 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  04..++++++++++++
-0001a6f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a700: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 4861  ++++++++....- Ha
-0001a710: 6e64 6c65 2073 7065 6369 616c 2063 6173  ndle special cas
-0001a720: 6520 7768 6572 6520 6120 7369 6e67 6c65  e where a single
-0001a730: 2074 656d 706c 6174 6520 7769 7468 6f75   template withou
-0001a740: 7420 6164 6469 7469 7665 0d0a 2020 706f  t additive..  po
-0001a750: 6c79 6e6f 6d69 616c 7320 6973 2066 6974  lynomials is fit
-0001a760: 7465 6420 746f 2074 6865 2067 616c 6178  ted to the galax
-0001a770: 792e 0d0a 0d0a 5634 2e31 2e31 3a20 4d43  y.....V4.1.1: MC
-0001a780: 2c20 4c65 6964 656e 2c20 3231 2053 6570  , Leiden, 21 Sep
-0001a790: 7465 6d62 6572 2032 3030 340d 0a2b 2b2b  tember 2004..+++
+00019e10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+00019e20: 2d20 5573 6573 2043 4150 5f52 414e 4745  - Uses CAP_RANGE
+00019e30: 2074 6f20 6176 6f69 6420 706f 7465 6e74   to avoid potent
+00019e40: 6961 6c20 6e61 6d69 6e67 2063 6f6e 666c  ial naming confl
+00019e50: 6963 7473 2e0d 0a0d 0a56 342e 362e 353a  icts.....V4.6.5:
+00019e60: 204d 432c 204f 7866 6f72 642c 2031 3520   MC, Oxford, 15 
+00019e70: 4e6f 7665 6d62 6572 2032 3031 320d 0a2b  November 2012..+
+00019e80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019e90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019ea0: 2b2b 2b0d 0a0d 0a2d 2045 7870 616e 6465  +++....- Expande
+00019eb0: 6420 646f 6375 6d65 6e74 6174 696f 6e20  d documentation 
+00019ec0: 6f66 2052 4547 554c 206b 6579 776f 7264  of REGUL keyword
+00019ed0: 2e0d 0a0d 0a56 342e 362e 343a 204d 432c  .....V4.6.4: MC,
+00019ee0: 204f 7866 6f72 642c 2039 2044 6563 656d   Oxford, 9 Decem
+00019ef0: 6265 7220 3230 3131 0d0a 2b2b 2b2b 2b2b  ber 2011..++++++
+00019f00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019f10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+00019f20: 0a2d 2049 6e63 7265 6173 6564 206f 7665  .- Increased ove
+00019f30: 7273 616d 706c 696e 6720 6661 6374 6f72  rsampling factor
+00019f40: 2074 6f20 3330 782c 2077 6865 6e20 7468   to 30x, when th
+00019f50: 6520 2f4f 5645 5253 414d 504c 4520 6b65  e /OVERSAMPLE ke
+00019f60: 7977 6f72 640d 0a20 2069 7320 7573 6564  yword..  is used
+00019f70: 2e20 5570 6461 7465 6420 636f 7272 6573  . Updated corres
+00019f80: 706f 6e64 696e 6720 646f 6375 6d65 6e74  ponding document
+00019f90: 6174 696f 6e2e 2054 6861 6e6b 7320 746f  ation. Thanks to
+00019fa0: 204e 6f72 610d 0a20 204c 7522 747a 6765   Nora..  Lu"tzge
+00019fb0: 6e64 6f72 6620 666f 7220 7465 7374 2063  ndorf for test c
+00019fc0: 6173 6573 2069 6c6c 7573 7472 6174 696e  ases illustratin
+00019fd0: 6720 6572 726f 7273 2069 6e20 7468 6520  g errors in the 
+00019fe0: 7265 636f 7665 7265 640d 0a20 2076 656c  recovered..  vel
+00019ff0: 6f63 6974 7920 7768 656e 2074 6865 2073  ocity when the s
+0001a000: 6967 6d61 2069 7320 7365 7665 7265 6c79  igma is severely
+0001a010: 2075 6e64 6572 7361 6d70 6c65 642e 0d0a   undersampled...
+0001a020: 0d0a 5634 2e36 2e33 3a20 4d43 2c20 4f78  ..V4.6.3: MC, Ox
+0001a030: 666f 7264 2032 3520 4f63 746f 6265 7220  ford 25 October 
+0001a040: 3230 3131 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2011..++++++++++
+0001a050: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a060: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 446f  ++++++++....- Do
+0001a070: 206e 6f74 2063 6861 6e67 6520 5445 4d50   not change TEMP
+0001a080: 4c41 5445 5320 6172 7261 7920 696e 206f  LATES array in o
+0001a090: 7574 7075 7420 7768 656e 2052 4547 554c  utput when REGUL
+0001a0a0: 2069 7320 6e6f 6e7a 6572 6f2e 0d0a 2020   is nonzero...  
+0001a0b0: 4672 6f6d 2074 6865 2066 6565 6462 6163  From the feedbac
+0001a0c0: 6b20 6f66 2052 6963 6861 7264 204d 6344  k of Richard McD
+0001a0d0: 6572 6d69 642e 0d0a 0d0a 5634 2e36 2e32  ermid.....V4.6.2
+0001a0e0: 3a20 4d43 2c20 4f78 666f 7264 2c20 3137  : MC, Oxford, 17
+0001a0f0: 204f 6374 6f62 6572 2032 3031 310d 0a2b   October 2011..+
+0001a100: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a110: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a120: 2b2b 0d0a 0d0a 2d20 496e 636c 7564 6564  ++....- Included
+0001a130: 206f 7074 696f 6e20 666f 7220 3344 2072   option for 3D r
+0001a140: 6567 756c 6172 697a 6174 696f 6e20 616e  egularization an
+0001a150: 6420 7570 6461 7465 6420 646f 6375 6d65  d updated docume
+0001a160: 6e74 6174 696f 6e20 6f66 0d0a 2020 5245  ntation of..  RE
+0001a170: 4755 4c20 6b65 7977 6f72 642e 0d0a 0d0a  GUL keyword.....
+0001a180: 5634 2e36 2e31 3a20 4d43 2c20 4f78 666f  V4.6.1: MC, Oxfo
+0001a190: 7264 2c20 3239 204a 756c 7920 3230 3131  rd, 29 July 2011
+0001a1a0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+0001a1b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a1c0: 2b2b 0d0a 0d0a 2d20 5573 6520 436f 796f  ++....- Use Coyo
+0001a1d0: 7465 2047 7261 7068 6963 7320 2868 7474  te Graphics (htt
+0001a1e0: 703a 2f2f 7777 772e 6964 6c63 6f79 6f74  p://www.idlcoyot
+0001a1f0: 652e 636f 6d2f 2920 6279 2044 6176 6964  e.com/) by David
+0001a200: 2057 2e20 4661 6e6e 696e 672e 0d0a 2020   W. Fanning...  
+0001a210: 5468 6520 7265 7175 6972 6564 2072 6f75  The required rou
+0001a220: 7469 6e65 7320 6172 6520 6e6f 7720 696e  tines are now in
+0001a230: 636c 7564 6564 2069 6e20 4e41 5341 2049  cluded in NASA I
+0001a240: 444c 2041 7374 726f 6e6f 6d79 204c 6962  DL Astronomy Lib
+0001a250: 7261 7279 2e0d 0a0d 0a56 342e 362e 303a  rary.....V4.6.0:
+0001a260: 204d 432c 204f 7866 6f72 642c 2031 3220   MC, Oxford, 12 
+0001a270: 4170 7269 6c20 3230 3131 0d0a 2b2b 2b2b  April 2011..++++
+0001a280: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a290: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+0001a2a0: 0a2d 2049 6d70 6f72 7461 6e74 2066 6978  .- Important fix
+0001a2b0: 2074 6f20 2f43 4c45 414e 2070 726f 6365   to /CLEAN proce
+0001a2c0: 6475 7265 3a20 6261 6420 7069 7865 6c73  dure: bad pixels
+0001a2d0: 2061 7265 206e 6f77 2070 726f 7065 726c   are now properl
+0001a2e0: 790d 0a20 2075 7064 6174 6564 2064 7572  y..  updated dur
+0001a2f0: 696e 6720 7468 6520 3373 6967 6d61 2069  ing the 3sigma i
+0001a300: 7465 7261 7469 6f6e 732e 0d0a 0d0a 5634  terations.....V4
+0001a310: 2e35 2e30 3a20 4d43 2c20 4f78 666f 7264  .5.0: MC, Oxford
+0001a320: 2c20 3133 2041 7072 696c 2032 3031 300d  , 13 April 2010.
+0001a330: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
+0001a340: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a350: 2b2b 0d0a 0d0a 2d20 4472 616d 6174 6963  ++....- Dramatic
+0001a360: 2073 7065 6564 2075 7020 696e 2074 6865   speed up in the
+0001a370: 2063 6f6e 766f 6c75 7469 6f6e 206f 6620   convolution of 
+0001a380: 6c6f 6e67 2073 7065 6374 7261 2e0d 0a0d  long spectra....
+0001a390: 0a56 342e 342e 303a 204d 432c 204f 7866  .V4.4.0: MC, Oxf
+0001a3a0: 6f72 642c 2031 3820 5365 7074 656d 6265  ord, 18 Septembe
+0001a3b0: 7220 3230 3039 0d0a 2b2b 2b2b 2b2b 2b2b  r 2009..++++++++
+0001a3c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a3d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+0001a3e0: 0a2d 2049 6e74 726f 6475 6365 6420 4361  .- Introduced Ca
+0001a3f0: 6c7a 6574 7469 2065 7420 616c 2e20 2832  lzetti et al. (2
+0001a400: 3030 3029 2070 7078 665f 5245 4444 454e  000) ppxf_REDDEN
+0001a410: 494e 475f 4355 5256 4520 6675 6e63 7469  ING_CURVE functi
+0001a420: 6f6e 2074 6f0d 0a20 2065 7374 696d 6174  on to..  estimat
+0001a430: 6520 7468 6520 7265 6464 656e 696e 6720  e the reddening 
+0001a440: 6672 6f6d 2074 6865 2066 6974 2e0d 0a0d  from the fit....
+0001a450: 0a56 342e 332e 303a 204d 432c 204f 7866  .V4.3.0: MC, Oxf
+0001a460: 6f72 642c 2034 204d 6163 6820 3230 3039  ord, 4 Mach 2009
+0001a470: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+0001a480: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a490: 2b0d 0a0d 0a2d 2049 6e74 726f 6475 6365  +....- Introduce
+0001a4a0: 6420 5245 4755 4c20 6b65 7977 6f72 6420  d REGUL keyword 
+0001a4b0: 746f 2070 6572 666f 726d 206c 696e 6561  to perform linea
+0001a4c0: 7220 7265 6775 6c61 7269 7a61 7469 6f6e  r regularization
+0001a4d0: 206f 6620 5745 4947 4854 530d 0a20 2069   of WEIGHTS..  i
+0001a4e0: 6e20 6f6e 6520 6f72 2074 776f 2064 696d  n one or two dim
+0001a4f0: 656e 7369 6f6e 732e 0d0a 0d0a 5634 2e32  ensions.....V4.2
+0001a500: 2e33 3a20 4d43 2c20 4f78 666f 7264 2c20  .3: MC, Oxford, 
+0001a510: 3237 204e 6f76 656d 6265 7220 3230 3038  27 November 2008
+0001a520: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+0001a530: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a540: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 436f 7272  ++++++....- Corr
+0001a550: 6563 7465 6420 6572 726f 7220 6d65 7373  ected error mess
+0001a560: 6167 6520 666f 7220 746f 6f20 6269 6720  age for too big 
+0001a570: 7665 6c6f 6369 7479 2073 6869 6674 2e0d  velocity shift..
+0001a580: 0a0d 0a56 342e 322e 323a 204d 432c 2057  ...V4.2.2: MC, W
+0001a590: 696e 6468 6f65 6b2c 2033 204a 756c 7920  indhoek, 3 July 
+0001a5a0: 3230 3038 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2008..++++++++++
+0001a5b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a5c0: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2041 6464  +++++++....- Add
+0001a5d0: 6564 206b 6579 776f 7264 2050 4f4c 5957  ed keyword POLYW
+0001a5e0: 4549 4748 5453 2e0d 0a0d 0a56 342e 322e  EIGHTS.....V4.2.
+0001a5f0: 313a 204d 432c 204f 7866 6f72 642c 2031  1: MC, Oxford, 1
+0001a600: 3720 4d61 7920 3230 3038 0d0a 2b2b 2b2b  7 May 2008..++++
+0001a610: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a620: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+0001a630: 2055 7365 204c 415f 4c45 4153 545f 5351   Use LA_LEAST_SQ
+0001a640: 5541 5245 5320 2849 444c 2035 2e36 2920  UARES (IDL 5.6) 
+0001a650: 696e 7374 6561 6420 6f66 2053 5644 4320  instead of SVDC 
+0001a660: 7768 656e 2066 6974 7469 6e67 2061 2073  when fitting a s
+0001a670: 696e 676c 650d 0a20 2074 656d 706c 6174  ingle..  templat
+0001a680: 652e 2050 6c65 6173 6520 6c65 7420 6d65  e. Please let me
+0001a690: 206b 6e6f 7720 6966 2079 6f75 206e 6565   know if you nee
+0001a6a0: 6420 746f 2075 7365 2070 5058 4620 7769  d to use pPXF wi
+0001a6b0: 7468 2061 6e20 6f6c 6465 7220 4944 4c0d  th an older IDL.
+0001a6c0: 0a20 2076 6572 7369 6f6e 2e0d 0a0d 0a56  .  version.....V
+0001a6d0: 342e 322e 303a 204d 432c 204f 7866 6f72  4.2.0: MC, Oxfor
+0001a6e0: 642c 2031 3520 4d61 7263 6820 3230 3038  d, 15 March 2008
+0001a6f0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+0001a700: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a710: 2b2b 2b0d 0a0d 0a2d 2049 6e74 726f 6475  +++....- Introdu
+0001a720: 6365 6420 6f70 7469 6f6e 616c 2066 6974  ced optional fit
+0001a730: 7469 6e67 206f 6620 534b 5920 7370 6563  ting of SKY spec
+0001a740: 7472 756d 2e20 4d61 6e79 2074 6861 6e6b  trum. Many thank
+0001a750: 7320 746f 0d0a 2020 416e 6e65 2d4d 6172  s to..  Anne-Mar
+0001a760: 6965 2057 6569 6a6d 616e 7320 666f 7220  ie Weijmans for 
+0001a770: 7465 7374 696e 672e 0d0a 0d0a 5634 2e31  testing.....V4.1
+0001a780: 2e37 3a20 4d43 2c20 4f78 666f 7264 2c20  .7: MC, Oxford, 
+0001a790: 3620 4f63 746f 6265 7220 3230 3037 0d0a  6 October 2007..
 0001a7a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 0001a7b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a7c0: 2b2b 0d0a 0d0a 2d20 496e 6372 6561 7365  ++....- Increase
-0001a7d0: 6420 6d61 7869 6d75 6d20 6e75 6d62 6572  d maximum number
-0001a7e0: 206f 6620 6974 6572 6174 696f 6e73 2049   of iterations I
-0001a7f0: 544d 4158 2069 6e20 4256 4c53 2e20 5468  TMAX in BVLS. Th
-0001a800: 616e 6b73 2074 6f0d 0a20 204a 6573 7573  anks to..  Jesus
-0001a810: 2046 616c 636f 6e2d 4261 7272 6f73 6f20   Falcon-Barroso 
-0001a820: 666f 7220 7265 706f 7274 696e 6720 7072  for reporting pr
-0001a830: 6f62 6c65 6d73 2e0d 0a2d 2049 6e74 726f  oblems...- Intro
-0001a840: 6475 6365 6420 6572 726f 7220 6d65 7373  duced error mess
-0001a850: 6167 6520 7768 656e 2076 656c 6f63 6974  age when velocit
-0001a860: 7920 7368 6966 7420 6973 2074 6f6f 2062  y shift is too b
-0001a870: 6967 2e0d 0a2d 2043 6f72 7265 6374 6564  ig...- Corrected
-0001a880: 206f 7574 7075 7420 7768 656e 204d 4f4d   output when MOM
-0001a890: 454e 5453 3d30 2e0d 0a0d 0a56 342e 312e  ENTS=0.....V4.1.
-0001a8a0: 303a 204d 432c 204c 6569 6465 6e2c 2033  0: MC, Leiden, 3
-0001a8b0: 2053 6570 7465 6d62 6572 2032 3030 340d   September 2004.
-0001a8c0: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-0001a8d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a8e0: 2b2b 2b2b 2b0d 0a0d 0a2d 2043 6f72 7265  +++++....- Corre
-0001a8f0: 6374 6564 2069 6d70 6c65 6d65 6e74 6174  cted implementat
-0001a900: 696f 6e20 6f66 2074 776f 2d73 6964 6564  ion of two-sided
-0001a910: 2066 6974 7469 6e67 206f 6620 7468 6520   fitting of the 
-0001a920: 4c4f 5356 442e 2054 6861 6e6b 730d 0a20  LOSVD. Thanks.. 
-0001a930: 2074 6f20 5374 6566 616e 2076 616e 2044   to Stefan van D
-0001a940: 6f6e 6765 6e20 666f 7220 7265 706f 7274  ongen for report
-0001a950: 696e 6720 7072 6f62 6c65 6d73 2e0d 0a0d  ing problems....
-0001a960: 0a56 342e 302e 303a 204d 432c 2056 6963  .V4.0.0: MC, Vic
-0001a970: 656e 7a61 2c20 3136 2041 7567 7573 7420  enza, 16 August 
-0001a980: 3230 3034 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2004..++++++++++
-0001a990: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a9a0: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2049  +++++++++....- I
-0001a9b0: 6e74 726f 6475 6365 6420 6f70 7469 6f6e  ntroduced option
-0001a9c0: 616c 2074 776f 2d73 6964 6564 2066 6974  al two-sided fit
-0001a9d0: 7469 6e67 2061 7373 756d 696e 6720 6120  ting assuming a 
-0001a9e0: 7265 666c 6563 7469 6f6e 0d0a 2020 7379  reflection..  sy
-0001a9f0: 6d6d 6574 7269 6320 4c4f 5356 4420 666f  mmetric LOSVD fo
-0001aa00: 7220 7477 6f20 696e 7075 7420 7370 6563  r two input spec
-0001aa10: 7472 612e 0d0a 0d0a 5633 2e37 2e33 3a20  tra.....V3.7.3: 
-0001aa20: 4d43 2c20 4c65 6964 656e 2c20 3720 4175  MC, Leiden, 7 Au
-0001aa30: 6775 7374 2032 3030 340d 0a2b 2b2b 2b2b  gust 2004..+++++
-0001aa40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001aa50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-0001aa60: 2d20 436f 7272 6563 7465 6420 6275 673a  - Corrected bug:
-0001aa70: 206b 6579 776f 7264 2045 5252 4f52 2077   keyword ERROR w
-0001aa80: 6173 2072 6574 7572 6e65 6420 696e 2070  as returned in p
-0001aa90: 6978 656c 7320 696e 7374 6561 6420 6f66  ixels instead of
-0001aaa0: 206b 6d2f 732e 0d0a 2d20 4465 6372 6561   km/s...- Decrea
-0001aab0: 7365 6420 6c6f 7765 7220 6c69 6d69 7420  sed lower limit 
-0001aac0: 6f6e 2066 6974 7465 6420 6469 7370 6572  on fitted disper
-0001aad0: 7369 6f6e 2e20 5468 616e 6b73 2074 6f20  sion. Thanks to 
-0001aae0: 4967 6f72 2056 2e20 4368 696c 696e 6761  Igor V. Chilinga
-0001aaf0: 7269 616e 2e0d 0a0d 0a56 332e 372e 323a  rian.....V3.7.2:
-0001ab00: 204d 432c 204c 6569 6465 6e2c 2032 3820   MC, Leiden, 28 
-0001ab10: 4170 7269 6c20 3230 3034 0d0a 2b2b 2b2b  April 2004..++++
-0001ab20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001ab30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-0001ab40: 0a2d 2043 6f72 7265 6374 6564 2070 726f  .- Corrected pro
-0001ab50: 6772 616d 2073 746f 7020 6166 7465 7220  gram stop after 
-0001ab60: 6669 7420 7768 656e 204d 4f4d 454e 5453  fit when MOMENTS
-0001ab70: 3d32 2e20 5468 6520 6275 6720 7761 7320  =2. The bug was 
-0001ab80: 696e 7472 6f64 7563 6564 2069 6e20 5633  introduced in V3
-0001ab90: 2e37 2e30 2e0d 0a0d 0a56 332e 372e 313a  .7.0.....V3.7.1:
-0001aba0: 204d 432c 204c 6569 6465 6e2c 2033 3120   MC, Leiden, 31 
-0001abb0: 4d61 7263 6820 3230 3034 0d0a 2b2b 2b2b  March 2004..++++
-0001abc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001abd0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-0001abe0: 0a2d 2055 7064 6174 6564 2064 6f63 756d  .- Updated docum
-0001abf0: 656e 7461 7469 6f6e 2e0d 0a0d 0a56 332e  entation.....V3.
-0001ac00: 372e 303a 204d 432c 204c 6569 6465 6e2c  7.0: MC, Leiden,
-0001ac10: 2032 3320 4d61 7263 6820 3230 3034 0d0a   23 March 2004..
-0001ac20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001ac30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001ac40: 2b0d 0a0d 0a2d 2052 6576 6973 6564 2069  +....- Revised i
-0001ac50: 6d70 6c65 6d65 6e74 6174 696f 6e20 6f66  mplementation of
-0001ac60: 204d 4445 4752 4545 206f 7074 696f 6e2e   MDEGREE option.
-0001ac70: 204e 6f6e 6c69 6e65 6172 2069 6d70 6c65   Nonlinear imple
-0001ac80: 6d65 6e74 6174 696f 6e3a 0d0a 2020 7374  mentation:..  st
-0001ac90: 7261 6967 6874 666f 7277 6172 642c 2072  raightforward, r
-0001aca0: 6f62 7573 742c 2062 7574 2073 6c6f 7765  obust, but slowe
-0001acb0: 722e 0d0a 0d0a 5633 2e36 2e30 3a20 4d43  r.....V3.6.0: MC
-0001acc0: 2c20 4c65 6964 656e 2c20 3139 204d 6172  , Leiden, 19 Mar
-0001acd0: 6368 2032 3030 340d 0a2b 2b2b 2b2b 2b2b  ch 2004..+++++++
-0001ace0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001acf0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-0001ad00: 4164 6465 6420 4d44 4547 5245 4520 6f70  Added MDEGREE op
-0001ad10: 7469 6f6e 2066 6f72 206d 756c 7469 706c  tion for multipl
-0001ad20: 6963 6174 6976 6520 706f 6c79 6e6f 6d69  icative polynomi
-0001ad30: 616c 732e 204c 696e 6561 7220 696d 706c  als. Linear impl
-0001ad40: 656d 656e 7461 7469 6f6e 3a0d 0a20 2066  ementation:..  f
-0001ad50: 6173 742c 2077 6f72 6b73 2077 656c 6c20  ast, works well 
-0001ad60: 696e 206d 6f73 7420 6361 7365 732c 2062  in most cases, b
-0001ad70: 7574 2063 616e 2066 6169 6c20 696e 2063  ut can fail in c
-0001ad80: 6572 7461 696e 2063 6173 6573 2e0d 0a0d  ertain cases....
-0001ad90: 0a56 332e 352e 303a 204d 432c 204c 6569  .V3.5.0: MC, Lei
-0001ada0: 6465 6e2c 2031 3120 4465 6365 6d62 6572  den, 11 December
-0001adb0: 2032 3030 330d 0a2b 2b2b 2b2b 2b2b 2b2b   2003..+++++++++
-0001adc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001add0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
-0001ade0: 2049 6e63 6c75 6465 6420 2f4f 5645 5253   Included /OVERS
-0001adf0: 414d 504c 4520 6f70 7469 6f6e 2e0d 0a0d  AMPLE option....
-0001ae00: 0a56 332e 342e 373a 204d 432c 204c 6569  .V3.4.7: MC, Lei
-0001ae10: 6465 6e2c 2038 2044 6563 656d 6265 7220  den, 8 December 
-0001ae20: 3230 3033 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2003..++++++++++
-0001ae30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001ae40: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2046  +++++++++....- F
-0001ae50: 6972 7374 2072 656c 6561 7365 6420 7665  irst released ve
-0001ae60: 7273 696f 6e2e 0d0a 0d0a 5631 2e30 2e30  rsion.....V1.0.0
-0001ae70: 3a20 4c65 6964 656e 2c20 3130 204f 6374  : Leiden, 10 Oct
-0001ae80: 6f62 6572 2032 3030 310d 0a2b 2b2b 2b2b  ober 2001..+++++
-0001ae90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001aea0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-0001aeb0: 4372 6561 7465 6420 6279 204d 6963 6865  Created by Miche
-0001aec0: 6c65 2043 6170 7065 6c6c 6172 692e 0d0a  le Cappellari...
-0001aed0: 0d0a                                     ..
+0001a7c0: 2b2b 0d0a 0d0a 2d20 5570 6461 7465 6420  ++....- Updated 
+0001a7d0: 646f 6375 6d65 6e74 6174 696f 6e20 7769  documentation wi
+0001a7e0: 7468 2061 6e20 696d 706f 7274 616e 7420  th an important 
+0001a7f0: 6e6f 7465 206f 6e20 7065 6e61 6c74 7920  note on penalty 
+0001a800: 6465 7465 726d 696e 6174 696f 6e2e 0d0a  determination...
+0001a810: 0d0a 5634 2e31 2e36 3a20 4d43 2c20 4c65  ..V4.1.6: MC, Le
+0001a820: 6964 656e 2c20 3230 204a 616e 7561 7279  iden, 20 January
+0001a830: 2032 3030 360d 0a2b 2b2b 2b2b 2b2b 2b2b   2006..+++++++++
+0001a840: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a850: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
+0001a860: 5072 696e 7420 7468 6520 6e75 6d62 6572  Print the number
+0001a870: 206f 6620 6e6f 6e7a 6572 6f20 7465 6d70   of nonzero temp
+0001a880: 6c61 7465 732e 2044 6f20 6e6f 7420 7072  lates. Do not pr
+0001a890: 696e 7420 6f75 746c 6965 7273 2069 6e20  int outliers in 
+0001a8a0: 2f51 5549 4554 206d 6f64 652e 0d0a 0d0a  /QUIET mode.....
+0001a8b0: 5634 2e31 2e35 3a20 4d43 2c20 4c65 6964  V4.1.5: MC, Leid
+0001a8c0: 656e 2c20 3130 2046 6562 7275 6172 7920  en, 10 February 
+0001a8d0: 3230 3035 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2005..++++++++++
+0001a8e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a8f0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
+0001a900: 5665 7269 6679 2074 6861 7420 474f 4f44  Verify that GOOD
+0001a910: 5049 5845 4c53 2069 7320 6d6f 6e6f 746f  PIXELS is monoto
+0001a920: 6e69 6320 616e 6420 646f 6573 206e 6f74  nic and does not
+0001a930: 2063 6f6e 7461 696e 2064 7570 6c69 6361   contain duplica
+0001a940: 7465 640d 0a20 2076 616c 7565 732e 2041  ted..  values. A
+0001a950: 6674 6572 2066 6565 6462 6163 6b20 6672  fter feedback fr
+0001a960: 6f6d 2052 6963 6861 7264 204d 6344 6572  om Richard McDer
+0001a970: 6d69 642e 0d0a 0d0a 5634 2e31 2e34 3a20  mid.....V4.1.4: 
+0001a980: 4d43 2c20 4c65 6964 656e 2c20 3132 204a  MC, Leiden, 12 J
+0001a990: 616e 7561 7279 2032 3030 350d 0a2b 2b2b  anuary 2005..+++
+0001a9a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a9b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a9c0: 0d0a 0d0a 2d20 4d61 6b65 2073 7572 6520  ....- Make sure 
+0001a9d0: 696e 7075 7420 4e4f 4953 4520 6973 2061  input NOISE is a
+0001a9e0: 2070 6f73 6974 6976 6520 7665 6374 6f72   positive vector
+0001a9f0: 2e0d 0a0d 0a56 342e 312e 333a 204d 432c  .....V4.1.3: MC,
+0001aa00: 2056 6963 656e 7a61 2c20 3330 2044 6563   Vicenza, 30 Dec
+0001aa10: 656d 6265 7220 3230 3034 0d0a 2b2b 2b2b  ember 2004..++++
+0001aa20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001aa30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001aa40: 2b0d 0a0d 0a2d 2055 7064 6174 6564 2064  +....- Updated d
+0001aa50: 6f63 756d 656e 7461 7469 6f6e 2e0d 0a0d  ocumentation....
+0001aa60: 0a56 342e 312e 323a 204d 432c 204c 6569  .V4.1.2: MC, Lei
+0001aa70: 6465 6e2c 2031 3120 4e6f 7665 6d62 6572  den, 11 November
+0001aa80: 2032 3030 340d 0a2b 2b2b 2b2b 2b2b 2b2b   2004..+++++++++
+0001aa90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001aaa0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+0001aab0: 2048 616e 646c 6520 7370 6563 6961 6c20   Handle special 
+0001aac0: 6361 7365 2077 6865 7265 2061 2073 696e  case where a sin
+0001aad0: 676c 6520 7465 6d70 6c61 7465 2077 6974  gle template wit
+0001aae0: 686f 7574 2061 6464 6974 6976 650d 0a20  hout additive.. 
+0001aaf0: 2070 6f6c 796e 6f6d 6961 6c73 2069 7320   polynomials is 
+0001ab00: 6669 7474 6564 2074 6f20 7468 6520 6761  fitted to the ga
+0001ab10: 6c61 7879 2e0d 0a0d 0a56 342e 312e 313a  laxy.....V4.1.1:
+0001ab20: 204d 432c 204c 6569 6465 6e2c 2032 3120   MC, Leiden, 21 
+0001ab30: 5365 7074 656d 6265 7220 3230 3034 0d0a  September 2004..
+0001ab40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001ab50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001ab60: 2b2b 2b2b 2b0d 0a0d 0a2d 2049 6e63 7265  +++++....- Incre
+0001ab70: 6173 6564 206d 6178 696d 756d 206e 756d  ased maximum num
+0001ab80: 6265 7220 6f66 2069 7465 7261 7469 6f6e  ber of iteration
+0001ab90: 7320 4954 4d41 5820 696e 2042 564c 532e  s ITMAX in BVLS.
+0001aba0: 2054 6861 6e6b 7320 746f 0d0a 2020 4a65   Thanks to..  Je
+0001abb0: 7375 7320 4661 6c63 6f6e 2d42 6172 726f  sus Falcon-Barro
+0001abc0: 736f 2066 6f72 2072 6570 6f72 7469 6e67  so for reporting
+0001abd0: 2070 726f 626c 656d 732e 0d0a 2d20 496e   problems...- In
+0001abe0: 7472 6f64 7563 6564 2065 7272 6f72 206d  troduced error m
+0001abf0: 6573 7361 6765 2077 6865 6e20 7665 6c6f  essage when velo
+0001ac00: 6369 7479 2073 6869 6674 2069 7320 746f  city shift is to
+0001ac10: 6f20 6269 672e 0d0a 2d20 436f 7272 6563  o big...- Correc
+0001ac20: 7465 6420 6f75 7470 7574 2077 6865 6e20  ted output when 
+0001ac30: 4d4f 4d45 4e54 533d 302e 0d0a 0d0a 5634  MOMENTS=0.....V4
+0001ac40: 2e31 2e30 3a20 4d43 2c20 4c65 6964 656e  .1.0: MC, Leiden
+0001ac50: 2c20 3320 5365 7074 656d 6265 7220 3230  , 3 September 20
+0001ac60: 3034 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  04..++++++++++++
+0001ac70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001ac80: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 436f  ++++++++....- Co
+0001ac90: 7272 6563 7465 6420 696d 706c 656d 656e  rrected implemen
+0001aca0: 7461 7469 6f6e 206f 6620 7477 6f2d 7369  tation of two-si
+0001acb0: 6465 6420 6669 7474 696e 6720 6f66 2074  ded fitting of t
+0001acc0: 6865 204c 4f53 5644 2e20 5468 616e 6b73  he LOSVD. Thanks
+0001acd0: 0d0a 2020 746f 2053 7465 6661 6e20 7661  ..  to Stefan va
+0001ace0: 6e20 446f 6e67 656e 2066 6f72 2072 6570  n Dongen for rep
+0001acf0: 6f72 7469 6e67 2070 726f 626c 656d 732e  orting problems.
+0001ad00: 0d0a 0d0a 5634 2e30 2e30 3a20 4d43 2c20  ....V4.0.0: MC, 
+0001ad10: 5669 6365 6e7a 612c 2031 3620 4175 6775  Vicenza, 16 Augu
+0001ad20: 7374 2032 3030 340d 0a2b 2b2b 2b2b 2b2b  st 2004..+++++++
+0001ad30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001ad40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+0001ad50: 2d20 496e 7472 6f64 7563 6564 206f 7074  - Introduced opt
+0001ad60: 696f 6e61 6c20 7477 6f2d 7369 6465 6420  ional two-sided 
+0001ad70: 6669 7474 696e 6720 6173 7375 6d69 6e67  fitting assuming
+0001ad80: 2061 2072 6566 6c65 6374 696f 6e0d 0a20   a reflection.. 
+0001ad90: 2073 796d 6d65 7472 6963 204c 4f53 5644   symmetric LOSVD
+0001ada0: 2066 6f72 2074 776f 2069 6e70 7574 2073   for two input s
+0001adb0: 7065 6374 7261 2e0d 0a0d 0a56 332e 372e  pectra.....V3.7.
+0001adc0: 333a 204d 432c 204c 6569 6465 6e2c 2037  3: MC, Leiden, 7
+0001add0: 2041 7567 7573 7420 3230 3034 0d0a 2b2b   August 2004..++
+0001ade0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001adf0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+0001ae00: 0a0d 0a2d 2043 6f72 7265 6374 6564 2062  ...- Corrected b
+0001ae10: 7567 3a20 6b65 7977 6f72 6420 4552 524f  ug: keyword ERRO
+0001ae20: 5220 7761 7320 7265 7475 726e 6564 2069  R was returned i
+0001ae30: 6e20 7069 7865 6c73 2069 6e73 7465 6164  n pixels instead
+0001ae40: 206f 6620 6b6d 2f73 2e0d 0a2d 2044 6563   of km/s...- Dec
+0001ae50: 7265 6173 6564 206c 6f77 6572 206c 696d  reased lower lim
+0001ae60: 6974 206f 6e20 6669 7474 6564 2064 6973  it on fitted dis
+0001ae70: 7065 7273 696f 6e2e 2054 6861 6e6b 7320  persion. Thanks 
+0001ae80: 746f 2049 676f 7220 562e 2043 6869 6c69  to Igor V. Chili
+0001ae90: 6e67 6172 6961 6e2e 0d0a 0d0a 5633 2e37  ngarian.....V3.7
+0001aea0: 2e32 3a20 4d43 2c20 4c65 6964 656e 2c20  .2: MC, Leiden, 
+0001aeb0: 3238 2041 7072 696c 2032 3030 340d 0a2b  28 April 2004..+
+0001aec0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001aed0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001aee0: 0d0a 0d0a 2d20 436f 7272 6563 7465 6420  ....- Corrected 
+0001aef0: 7072 6f67 7261 6d20 7374 6f70 2061 6674  program stop aft
+0001af00: 6572 2066 6974 2077 6865 6e20 4d4f 4d45  er fit when MOME
+0001af10: 4e54 533d 322e 2054 6865 2062 7567 2077  NTS=2. The bug w
+0001af20: 6173 2069 6e74 726f 6475 6365 6420 696e  as introduced in
+0001af30: 2056 332e 372e 302e 0d0a 0d0a 5633 2e37   V3.7.0.....V3.7
+0001af40: 2e31 3a20 4d43 2c20 4c65 6964 656e 2c20  .1: MC, Leiden, 
+0001af50: 3331 204d 6172 6368 2032 3030 340d 0a2b  31 March 2004..+
+0001af60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001af70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001af80: 0d0a 0d0a 2d20 5570 6461 7465 6420 646f  ....- Updated do
+0001af90: 6375 6d65 6e74 6174 696f 6e2e 0d0a 0d0a  cumentation.....
+0001afa0: 5633 2e37 2e30 3a20 4d43 2c20 4c65 6964  V3.7.0: MC, Leid
+0001afb0: 656e 2c20 3233 204d 6172 6368 2032 3030  en, 23 March 200
+0001afc0: 340d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  4..+++++++++++++
+0001afd0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001afe0: 2b2b 2b2b 0d0a 0d0a 2d20 5265 7669 7365  ++++....- Revise
+0001aff0: 6420 696d 706c 656d 656e 7461 7469 6f6e  d implementation
+0001b000: 206f 6620 4d44 4547 5245 4520 6f70 7469   of MDEGREE opti
+0001b010: 6f6e 2e20 4e6f 6e6c 696e 6561 7220 696d  on. Nonlinear im
+0001b020: 706c 656d 656e 7461 7469 6f6e 3a0d 0a20  plementation:.. 
+0001b030: 2073 7472 6169 6768 7466 6f72 7761 7264   straightforward
+0001b040: 2c20 726f 6275 7374 2c20 6275 7420 736c  , robust, but sl
+0001b050: 6f77 6572 2e0d 0a0d 0a56 332e 362e 303a  ower.....V3.6.0:
+0001b060: 204d 432c 204c 6569 6465 6e2c 2031 3920   MC, Leiden, 19 
+0001b070: 4d61 7263 6820 3230 3034 0d0a 2b2b 2b2b  March 2004..++++
+0001b080: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001b090: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+0001b0a0: 0a2d 2041 6464 6564 204d 4445 4752 4545  .- Added MDEGREE
+0001b0b0: 206f 7074 696f 6e20 666f 7220 6d75 6c74   option for mult
+0001b0c0: 6970 6c69 6361 7469 7665 2070 6f6c 796e  iplicative polyn
+0001b0d0: 6f6d 6961 6c73 2e20 4c69 6e65 6172 2069  omials. Linear i
+0001b0e0: 6d70 6c65 6d65 6e74 6174 696f 6e3a 0d0a  mplementation:..
+0001b0f0: 2020 6661 7374 2c20 776f 726b 7320 7765    fast, works we
+0001b100: 6c6c 2069 6e20 6d6f 7374 2063 6173 6573  ll in most cases
+0001b110: 2c20 6275 7420 6361 6e20 6661 696c 2069  , but can fail i
+0001b120: 6e20 6365 7274 6169 6e20 6361 7365 732e  n certain cases.
+0001b130: 0d0a 0d0a 5633 2e35 2e30 3a20 4d43 2c20  ....V3.5.0: MC, 
+0001b140: 4c65 6964 656e 2c20 3131 2044 6563 656d  Leiden, 11 Decem
+0001b150: 6265 7220 3230 3033 0d0a 2b2b 2b2b 2b2b  ber 2003..++++++
+0001b160: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001b170: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
+0001b180: 0d0a 2d20 496e 636c 7564 6564 202f 4f56  ..- Included /OV
+0001b190: 4552 5341 4d50 4c45 206f 7074 696f 6e2e  ERSAMPLE option.
+0001b1a0: 0d0a 0d0a 5633 2e34 2e37 3a20 4d43 2c20  ....V3.4.7: MC, 
+0001b1b0: 4c65 6964 656e 2c20 3820 4465 6365 6d62  Leiden, 8 Decemb
+0001b1c0: 6572 2032 3030 330d 0a2b 2b2b 2b2b 2b2b  er 2003..+++++++
+0001b1d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001b1e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+0001b1f0: 2d20 4669 7273 7420 7265 6c65 6173 6564  - First released
+0001b200: 2076 6572 7369 6f6e 2e0d 0a0d 0a56 312e   version.....V1.
+0001b210: 302e 303a 204c 6569 6465 6e2c 2031 3020  0.0: Leiden, 10 
+0001b220: 4f63 746f 6265 7220 3230 3031 0d0a 2b2b  October 2001..++
+0001b230: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001b240: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+0001b250: 0a2d 2043 7265 6174 6564 2062 7920 4d69  .- Created by Mi
+0001b260: 6368 656c 6520 4361 7070 656c 6c61 7269  chele Cappellari
+0001b270: 2e0d 0a0d 0a                             .....
```

### Comparing `ppxf-9.2.1/ppxf/CHANGELOG.rst` & `ppxf-9.2.2/ppxf/CHANGELOG.rst`

 * *Files 3% similar despite different names*

```diff
@@ -1,41 +1,63 @@
 
 Changelog
 ---------
 
+V9.2.2: MC, Oxford, 20 May 2024
++++++++++++++++++++++++++++++++
+
+- ``ppxf``: Fixed an issue where the absence of the ``reg_dim`` keyword could
+  halt the program (bug from V9.2.1). Thanks to Jesse van de Sande
+  (unsw.edu.au) and Luiz A. Silva-Lima (Univ. São Paulo, Brazil) for the
+  report.
+
+- ``ppxf``: Avoid possible program stop when ``templates`` are shorter than
+  ``galaxy`` (bug from V9.2.1).
+
+- ``ppxf``: Avoid truncating ``templates`` to ``goodpixels`` in the final plot,
+  when both ``lam`` and ``lam_temp`` parameters are supplied. Instead, show the
+  ``templates`` over the full ``galaxy`` spectral range.
+  
+- ``ppxf``: Corrected behaviour to only use the range between the first and
+  last ``goodpixels`` for determining the vertical plotting range.  Thanks to
+  David Gooding (chch.ox.ac.uk) for illustrating the problem.
+
+- ``ppxf_example_kinematics_sdss.py``: Modified the example to de-redshift the
+  spectrum by default, minimizing potential confusion.
+
 V9.2.1: MC, Oxford, 18 April 2024
 +++++++++++++++++++++++++++++++++
 
-- **Improved** ``sps_util.synthetic_photometry``: Accepts input wavelengths
-  that are not evenly spaced.
-- **Added** ``ppxf_util.mag_spectrum``: A new function to get the apparent
-  magnitude from a spectrum in any photometric band, at any redshift, in either
-  the AB or Vega magnitude system.
-- **Improved** ``ppxf``: Now considers the given ``goodpixels`` when checking
-  that the ``templates`` cover the full ``galaxy`` spectrum, if both ``lam``
-  and ``lam_temp`` are provided.
-- **Added** ``ppxf``: Allow for variable step size across intervals and
-  dimensions in the numerical derivatives used for regularization, with the new
-  keyword ``reg_step``.
-- **Fixed** ``ppxf``: Avoids new ``SyntaxWarning`` in Matplotlib LaTeX string
-  in the latest Python 3.12.
-- **Fixed** ``ppxf``: Avoid program stop when passing an input covariance
-  matrix while fitting for gas emission lines. Thanks to Jackson ODonnell
-  (ucsc.edu) for the report.
+- ``sps_util.synthetic_photometry``: Accepts input wavelengths that are not
+  evenly spaced.
+- ``ppxf_util.mag_spectrum``: A new function to get the apparent magnitude from
+  a spectrum in any photometric band, at any redshift, in either the AB or Vega
+  magnitude system.
+- ``ppxf``: Now considers the given ``goodpixels`` when checking that the
+  ``templates`` cover the full ``galaxy`` spectrum, if both ``lam`` and
+  ``lam_temp`` are provided.
+- ``ppxf``: Allow for variable step size across intervals and dimensions in the
+  numerical derivatives used for regularization, with the new keyword
+  ``reg_step``.
+- ``ppxf``: Avoids new ``SyntaxWarning`` in Matplotlib LaTeX string in the
+  latest Python 3.12.
+- ``ppxf``: Avoid program stop when passing an input covariance matrix while
+  fitting for gas emission lines. Thanks to Jackson ODonnell (ucsc.edu) for the
+  report.
 
 V9.1.1: MC, Oxford, 18 January 2024
 +++++++++++++++++++++++++++++++++++
 
-- **Improved** ``sps_util.mass_to_light``: Now it can calculate the stellar
-  mass-to-light ratio (``M*/L``) for any stellar population synthesis (SPS)
-  model, any filter, and any redshift, using the output weights from ``pPXF``.
-  No need for pre-computed tables anymore.
-- **Added** ``ppxf_util.mag_sun``: A new function to get the absolute solar
-  magnitude in any photometric band, at any redshift, in either the AB or Vega
-  magnitude system.
+- ``sps_util.mass_to_light``: Now it can calculate the stellar mass-to-light
+  ratio (``M*/L``) for any stellar population synthesis (SPS) model, any
+  filter, and any redshift, using the output weights from ``pPXF``. No need for
+  pre-computed tables anymore.
+- ``ppxf_util.mag_sun``: A new function to get the absolute solar magnitude in
+  any photometric band, at any redshift, in either the AB or Vega magnitude
+  system.
 
 V9.0.2: MC, Oxford, 30 November 2023
 ++++++++++++++++++++++++++++++++++++
 
 - ``ppxf``: Fixed bug in the automatic truncation of the template wavelength,
   when using ``bounds`` together with ``lam`` and ``lam_temp``.
```

#### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

### Comparing `ppxf-9.2.1/ppxf/README.rst` & `ppxf-9.2.2/ppxf/README.rst`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/capfit.py` & `ppxf-9.2.2/ppxf/capfit.py`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/examples/FILTER.RES.info.txt` & `ppxf-9.2.2/ppxf/examples/FILTER.RES.info.txt`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/examples/FILTER.RES.txt` & `ppxf-9.2.2/ppxf/examples/FILTER.RES.txt`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/examples/ppxf_example_gas_sdss_tied.py` & `ppxf-9.2.2/ppxf/examples/ppxf_example_gas_sdss_tied.py`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/examples/ppxf_example_kinematics_sauron.py` & `ppxf-9.2.2/ppxf/examples/ppxf_example_kinematics_sauron.py`

 * *Files 0% similar despite different names*

```diff
@@ -102,15 +102,15 @@
     gal_lin = hdu[0].data
     h1 = hdu[0].header
 
     lamRange1 = h1['CRVAL1'] + np.array([0., h1['CDELT1']*(h1['NAXIS1'] - 1)])
     fwhm_gal = 4.2  # SAURON has an instrumental resolution FWHM of 4.2A.
 
     # If high_redshift is True I create a mock high-redshift spectrum by
-    # artificially redshifting the local wavelength to redshift z0 ~ 1.23.
+    # artificially red-shifting the local wavelength to redshift z0 ~ 1.23.
     # I also have to broaden both the wavelength range and the instrumental
     # resolution (in wavelength units!).
     # You should comment/ignore the following four lines if you are using a
     # real high-redshift spectrum, and you did not already de-redshift it.
     #
     if high_redshift:           # Create mock high-redshift wavelength
         redshift_0 = 1.23
@@ -188,16 +188,16 @@
     # Compute a mask for gas emission lines
     goodPixels = util.determine_goodpixels(ln_lam1, lam_range_temp, redshift)
 
     # Here the actual fit starts. The best fit is plotted on the screen. Gas
     # emission lines are excluded from the pPXF fit using the GOODPIXELS
     # keyword.
     c = 299792.458
-    vel = c*np.log(1 + redshift)   # eq.(8) of Cappellari (2017, MNRAS)
-    start = [vel, 200.]  # (km/s), starting guess for [V, sigma]
+    vel = c*np.log(1 + redshift)    # eq.(8) of Cappellari (2017, MNRAS)
+    start = [vel, 200.]             # (km/s), starting guess for [V, sigma]
     t = clock()
 
     pp = ppxf(sps.templates, galaxy, noise, velscale, start,
               goodpixels=goodPixels, plot=True, moments=4, lam=np.exp(ln_lam1),
               lam_temp=sps.lam_temp, degree=4)
 
     # The updated best-fitting redshift is given by the following
```

### Comparing `ppxf-9.2.1/ppxf/examples/ppxf_example_kinematics_sdss.py` & `ppxf-9.2.2/ppxf/examples/ppxf_example_kinematics_sdss.py`

 * *Files 5% similar despite different names*

```diff
@@ -66,14 +66,15 @@
 #       MC, Oxford, 27 September 2018
 #   V3.2.0: Use E-Miles spectral library. MC, Oxford, 16 March 2022
 #   V3.2.1: Make `velscale` a scalar. MC, Oxford, 4 January 2023
 #   V3.3.0: Make single call of updated log_rebin and new varsmooth for all
 #       templates. MC, Oxford, 31 August 2023
 #   V3.4.0: Use the new `sps_util` instead of `miles_util`. 
 #       MC, Oxford, 12 November 2023
+#   V3.5.0: De-redshift the spectrum before the fit. MC, Oxford, 17 May 2024
 #
 ##############################################################################
 
 from time import perf_counter as clock
 from pathlib import Path
 from urllib import request
 
@@ -95,39 +96,35 @@
     filename = ppxf_dir / 'spectra' / 'NGC4636_SDSS_DR12.fits'
     hdu = fits.open(filename)
     t = hdu['COADD'].data
     redshift_0 = 0.003129   # SDSS redshift estimate
 
     galaxy = t['flux']/np.median(t['flux'])     # Normalize spectrum to avoid numerical issues
     ln_lam_gal = t['loglam']*np.log(10)         # Convert lg --> ln
-    lam_gal = np.exp(ln_lam_gal)
-    d_ln_lam_gal = np.diff(ln_lam_gal[[0, -1]])/(ln_lam_gal.size -1)  # Use full lam range for accuracy
+    lam_gal = np.exp(ln_lam_gal)                # Wavelength in Angstroms
+
     c = 299792.458                              # speed of light in km/s
+    d_ln_lam_gal = (ln_lam_gal[-1] - ln_lam_gal[0])/(ln_lam_gal.size - 1)  # Use full lam range for accuracy
     velscale = c*d_ln_lam_gal                   # Velocity scale in km/s per pixel (eq.8 of Cappellari 2017)
-    velscale = velscale.item()                  # velscale must be a scalar
     noise = np.full_like(galaxy, 0.0166)        # Assume constant noise per pixel here
 
-    # Compute instrumental FWHM for every pixel in Angstrom
-    dlam_gal = np.diff(lam_gal)                 # Size of every pixel in Angstrom
-    dlam_gal = np.append(dlam_gal, dlam_gal[-1])
+    # Compute instrumental FWHM for every pixel in Angstroms
+    dlam_gal = np.gradient(lam_gal)             # Size of every pixel in Angstroms
     wdisp = t['wdisp']                          # Intrinsic dispersion of every pixel, in pixels units
     fwhm_gal = 2.355*wdisp*dlam_gal             # Resolution FWHM of every pixel, in Angstroms
 
-    # If the galaxy is at significant redshift (z > 0.01), it is better to bring
-    # the galaxy spectrum roughly to the rest-frame wavelength, before calling
-    # pPXF (See Sec.2.4 of Cappellari 2017). In practice there is no need to
-    # modify the spectrum in any way, given that a red shift corresponds to a
-    # linear shift of the log-rebinned spectrum. One just needs to compute the
+    # In general, especially at significant redshift, it is easier to bring the
+    # galaxy spectrum roughly to the rest-frame wavelength, before calling pPXF
+    # (See Sec.2.4 of Cappellari 2017). In practice there is no need to modify
+    # the spectrum in any way, given that a red shift corresponds to a linear
+    # shift of the log-rebinned spectrum. One just needs to compute the
     # wavelength range in the rest-frame and adjust the instrumental resolution
-    # of the galaxy observations. This is done with the following three
-    # commented lines:
-    #
-    # lam_gal = lam_gal/(1 + z)     # Compute approximate restframe wavelength
-    # fwhm_gal = fwhm_gal/(1 + z)   # Adjust resolution in Angstroms
-    # z = 0                         # Spectrum is now in rest-frame
+    # of the galaxy observations.
+    lam_gal = lam_gal/(1 + redshift_0)      # Compute approximate restframe wavelength
+    fwhm_gal = fwhm_gal/(1 + redshift_0)    # Adjust resolution in Angstroms
 
     #------------------- Setup stellar templates -----------------------
 
     # pPXF can be used with any set of SPS population templates. However, I am
     # currently providing (with permission) ready-to-use template files for
     # three SPS. One can just uncomment one of the three models below. The
     # included files are only a subset of the SPS that can be produced with the
@@ -168,22 +165,22 @@
     # NB: only MILES has high resolution beyond 7500A. For the other libraries
     # one should restrict the fit to 7500A.
     lam_range_temp = [3500, 1e4]
     fwhm_gal = {"lam": lam_gal, "fwhm": fwhm_gal}
 
     sps = lib.sps_lib(filename, velscale, fwhm_gal, wave_range=lam_range_temp)
 
-    goodpixels = util.determine_goodpixels(np.log(lam_gal), lam_range_temp, redshift_0)
+    goodpixels = util.determine_goodpixels(np.log(lam_gal), lam_range_temp)
 
     # Here the actual fit starts. The best fit is plotted on the screen.
     # Gas emission lines are excluded from the pPXF fit using the GOODPIXELS keyword.
     #
-    c = 299792.458   # km/s
-    vel = c*np.log(1 + redshift_0)   # eq.(8) of Cappellari (2017)
-    start = [vel, 200.]  # (km/s), starting guess for [V, sigma]
+    c = 299792.458          # km/s
+    vel = 0                 # Spectrum is de-redshifted --> starting guess is zero
+    start = [vel, 200.]     # (km/s), starting guess for [V, sigma]
     t = clock()
 
     pp = ppxf(sps.templates, galaxy, noise, velscale, start,
               goodpixels=goodpixels, plot=True, moments=4, trig=1,
               degree=20, lam=lam_gal, lam_temp=sps.lam_temp)
 
     # The updated best-fitting redshift is given by the following
```

### Comparing `ppxf-9.2.1/ppxf/examples/ppxf_example_montecarlo_simulation.py` & `ppxf-9.2.2/ppxf/examples/ppxf_example_montecarlo_simulation.py`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/examples/ppxf_example_population_gas_sdss.py` & `ppxf-9.2.2/ppxf/examples/ppxf_example_population_gas_sdss.py`

 * *Files 0% similar despite different names*

```diff
@@ -173,15 +173,15 @@
     # The SPS model files are also available here https://github.com/micappe/ppxf_data
     basename = f"spectra_{sps_name}_9.0.npz"
     filename = ppxf_dir / 'sps_models' / basename
     if not filename.is_file():
         url = "https://raw.githubusercontent.com/micappe/ppxf_data/main/" + basename
         request.urlretrieve(url, filename)
 
-    sps = lib.sps_lib(filename, velscale, wave_range=lam_range_temp, norm_range=[5070, 5950])
+    sps = lib.sps_lib(filename, velscale, FWHM_gal, wave_range=lam_range_temp, norm_range=[5070, 5950])
 
     #------------------- Setup templates -----------------------
 
     # The stellar templates are reshaped below into a 2-dim array with each
     # spectrum as a column; however, we save the original array dimensions,
     # which are needed to specify the regularization dimensions
     #
```

### Comparing `ppxf-9.2.1/ppxf/examples/ppxf_example_population_photometry.py` & `ppxf-9.2.2/ppxf/examples/ppxf_example_population_photometry.py`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/examples/ppxf_example_sky_and_symmetric_losvd.py` & `ppxf-9.2.2/ppxf/examples/ppxf_example_sky_and_symmetric_losvd.py`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/examples/ppxf_example_two_components.py` & `ppxf-9.2.2/ppxf/examples/ppxf_example_two_components.py`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/examples/ppxf_python_reference_output.txt` & `ppxf-9.2.2/ppxf/examples/ppxf_python_reference_output.txt`

 * *Files 2% similar despite different names*

```diff
@@ -1,42 +1,42 @@
-# Reference expected output of the pPXF 9.2.1 examples (18 April 2024).
+# Reference expected output of the pPXF 9.2.2 examples (20 May 2024).
 # Python 3.12 using NumPy 1.26, SciPy 1.13, Matplotlib 3.8
 ###############################################################################
 
 
 >>> runfile('ppxf_example_kinematics_sauron.py')
 
-  Best Fit:       Vel     sigma        h3        h4
+ Best Fit:       Vel     sigma        h3        h4
  comp.  0:        33       111     0.028     0.066
 chi2/DOF: 1.026; DOF: 337; degree = 4; mdegree = 0
 method = capfit; Jac calls: 4; Func calls: 22; Status: 2
 linear_method = lsq_box; Nonzero Templates (>0.1%): 7/150
 Formal errors:
      dV    dsigma   dh3      dh4
      2.5     5.6   0.019   0.034
-Elapsed time in pPXF: 0.12 s
+Elapsed time in pPXF: 0.25 s
 Best-fitting redshift z = 1.233248 +/- 0.000019
 
 
 ###############################################################################
 
 
 >>> runfile('ppxf_example_kinematics_sdss.py')
 
 WARNING: the template's resolution dlam is larger than the galaxy's
  Best Fit:       Vel     sigma        h3        h4
- comp.  0:      1003       223    -0.023     0.084
-chi2/DOF: 0.8818; DOF: 3617; degree = 20; mdegree = 0
+ comp.  0:        67       223    -0.023     0.084
+chi2/DOF: 0.8812; DOF: 3617; degree = 20; mdegree = 0
 method = capfit; Jac calls: 3; Func calls: 17; Status: 2
 linear_method = lsq_box; Nonzero Templates (>0.1%): 3/150
 Formal errors:
      dV    dsigma   dh3      dh4
      2.4     3.2  0.0086    0.01
-Elapsed time in pPXF: 0.39 s
-Best-fitting redshift z = 0.0064913 +/- 0.0000080
+Elapsed time in pPXF: 0.70 s
+Best-fitting redshift z = 0.0033519 +/- 0.0000080
 
 
 ###############################################################################
 
 
 >>> runfile('ppxf_example_population_gas_sdss.py')
 
@@ -45,82 +45,82 @@
 ======================================================
 
 Emission lines included in gas templates:
 ['H10' 'H9' 'H8' 'Heps' 'Hdelta' 'Hgamma' 'Hbeta' 'Halpha' '[SII]6716'
  '[SII]6731' '[NeIII]3968' '[NeIII]3869' 'HeII4687' 'HeI5876'
  '[OIII]5007_d' '[OI]6300_d' '[NII]6583_d']
  Best Fit:       Vel     sigma        h3        h4
- comp.  0:      1213       106    -0.017     0.036
- comp.  1:      1206        94
- comp.  2:      1194        71
+ comp.  0:      1213       101    -0.019     0.039
+ comp.  1:      1206        93
+ comp.  2:      1194        72
 chi2/DOF: 1.003; DOF: 3829; degree = -1; mdegree = 10
-method = capfit; Jac calls: 6; Func calls: 120; Status: 2
-linear_method = lsq_box; Nonzero Templates (>0.1%): 39/167
+method = capfit; Jac calls: 6; Func calls: 116; Status: 2
+linear_method = lsq_box; Nonzero Templates (>0.1%): 38/167
 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 gas_component           name        flux       err      V     sig
 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
-Comp:  1                   H10     0.6694     0.043    1206    94
-Comp:  1                    H9      0.000     0.043    1206    94
-Comp:  1                    H8    0.03713     0.042    1206    94
-Comp:  1                  Heps     0.1981     0.048    1206    94
-Comp:  1                Hdelta     0.1718     0.042    1206    94
-Comp:  1                Hgamma     0.2544     0.041    1206    94
-Comp:  1                 Hbeta     0.4746     0.040    1206    94
-Comp:  1                Halpha      1.200     0.039    1206    94
-Comp:  1             [SII]6716     0.3206     0.039    1206    94
-Comp:  1             [SII]6731     0.2430     0.039    1206    94
-Comp:  2           [NeIII]3968    0.02577     0.045    1194    71
-Comp:  2           [NeIII]3869     0.2197     0.040    1194    71
-Comp:  2              HeII4687     0.1221     0.038    1194    71
-Comp:  2               HeI5876   0.006654     0.036    1194    71
-Comp:  2          [OIII]5007_d      1.255     0.047    1194    71
-Comp:  2            [OI]6300_d   0.009312     0.045    1194    71
-Comp:  2           [NII]6583_d     0.4349     0.045    1194    71
+Comp:  1                   H10     0.6625     0.043    1206    93
+Comp:  1                    H9      0.000     0.042    1206    93
+Comp:  1                    H8    0.03338     0.042    1206    93
+Comp:  1                  Heps     0.1956     0.048    1206    93
+Comp:  1                Hdelta     0.1666     0.042    1206    93
+Comp:  1                Hgamma     0.2500     0.041    1206    93
+Comp:  1                 Hbeta     0.4733     0.040    1206    93
+Comp:  1                Halpha      1.202     0.039    1206    93
+Comp:  1             [SII]6716     0.3208     0.039    1206    93
+Comp:  1             [SII]6731     0.2422     0.039    1206    93
+Comp:  2           [NeIII]3968    0.02460     0.045    1194    72
+Comp:  2           [NeIII]3869     0.2205     0.040    1194    72
+Comp:  2              HeII4687     0.1231     0.038    1194    72
+Comp:  2               HeI5876   0.005943     0.036    1194    72
+Comp:  2          [OIII]5007_d      1.256     0.047    1194    72
+Comp:  2            [OI]6300_d   0.009331     0.045    1194    72
+Comp:  2           [NII]6583_d     0.4339     0.045    1194    72
 -----------------------------------------------------------------
 Desired Delta Chi^2: 87.72
-Current Delta Chi^2: 12.22
-Elapsed time in pPXF: 2.68
+Current Delta Chi^2: 11.35
+Elapsed time in pPXF: 4.32
 Weighted <lg_age> [yr]: 9.87
 Weighted <[M/H]>: 0.0266
 (M*/L)=4.543 (SDSS/r at z=0.0040)
 
 ======================================================
  Fit with tied Balmer lines and limited [SII] doublet
 ======================================================
 
 Emission lines included in gas templates:
 ['Balmer' '[SII]6731_d1' '[SII]6731_d2' '[NeIII]3968' '[NeIII]3869'
  'HeII4687' 'HeI5876' '[OIII]5007_d' '[OI]6300_d' '[NII]6583_d']
  Best Fit:       Vel     sigma        h3        h4
- comp.  0:      1213       106    -0.021     0.043
+ comp.  0:      1213       101    -0.024     0.049
  comp.  1:      1208        84
  comp.  2:      1195        72
-  Gas Attenuation A_V: 0.278
-chi2/DOF: 1.055; DOF: 3828; degree = -1; mdegree = 10
-method = capfit; Jac calls: 6; Func calls: 126; Status: 3
+  Gas Attenuation A_V: 0.315
+chi2/DOF: 1.054; DOF: 3828; degree = -1; mdegree = 10
+method = capfit; Jac calls: 7; Func calls: 147; Status: 4
 linear_method = lsq_box; Nonzero Templates (>0.1%): 32/160
 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 gas_component           name        flux       err      V     sig
 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
-Comp:  1                Balmer      2.262     0.066    1208    84
-Comp:  1          [SII]6731_d1    0.04589     0.094    1208    84
-Comp:  1          [SII]6731_d2     0.4931      0.10    1208    84
-Comp:  2           [NeIII]3968    0.07869     0.040    1195    72
-Comp:  2           [NeIII]3869     0.2172     0.040    1195    72
-Comp:  2              HeII4687     0.1260     0.038    1195    72
-Comp:  2               HeI5876   0.007840     0.036    1195    72
-Comp:  2          [OIII]5007_d      1.263     0.047    1195    72
-Comp:  2            [OI]6300_d   0.009728     0.045    1195    72
-Comp:  2           [NII]6583_d     0.4341     0.045    1195    72
+Comp:  1                Balmer      2.252     0.066    1208    84
+Comp:  1          [SII]6731_d1    0.04365     0.094    1208    84
+Comp:  1          [SII]6731_d2     0.4954     0.099    1208    84
+Comp:  2           [NeIII]3968    0.07676     0.040    1195    72
+Comp:  2           [NeIII]3869     0.2176     0.040    1195    72
+Comp:  2              HeII4687     0.1265     0.038    1195    72
+Comp:  2               HeI5876   0.007354     0.036    1195    72
+Comp:  2          [OIII]5007_d      1.264     0.047    1195    72
+Comp:  2            [OI]6300_d    0.01120     0.045    1195    72
+Comp:  2           [NII]6583_d     0.4343     0.045    1195    72
 -----------------------------------------------------------------
 Desired Delta Chi^2: 87.72
-Current Delta Chi^2: 213.2
-Elapsed time in pPXF: 2.49
+Current Delta Chi^2: 209.5
+Elapsed time in pPXF: 5.91
 Weighted <lg_age> [yr]: 9.88
-Weighted <[M/H]>: 0.0301
+Weighted <[M/H]>: 0.0304
 (M*/L)=4.569 (SDSS/r at z=0.0040)
 
 
 ###############################################################################
 
 
 >>> runfile('ppxf_example_population_photometry.py')
@@ -155,15 +155,15 @@
  10: 2MASS/K
 
 Starting pPXF fit
  Best Fit:       Vel     sigma
  comp.  0:      1144        19
  comp.  1:      1152        48
 Stars Attenuation A_V: 0.002
-chi2/DOF: 0.7886; DOF: 2945; degree = -1; mdegree = 8
+chi2/DOF: 0.7885; DOF: 2945; degree = -1; mdegree = 8
 Photometry chi2/n_bands: 0.1685; n_bands: 10
 method = capfit; Jac calls: 8; Func calls: 116; Status: 2
 linear_method = lsq_box; Nonzero Templates (>0.1%): 43/232
 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 gas_component           name        flux       err      V     sig
 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 Comp:  1                   H10     0.1536     0.044    1152    48
@@ -180,15 +180,15 @@
 Comp:  1           [NeIII]3869      0.000     0.044    1152    48
 Comp:  1              HeII4687    0.07751     0.041    1152    48
 Comp:  1               HeI5876     0.1040     0.038    1152    48
 Comp:  1          [OIII]5007_d      1.363     0.051    1152    48
 Comp:  1            [OI]6300_d    0.08694     0.048    1152    48
 Comp:  1           [NII]6583_d      1.527     0.047    1152    48
 -----------------------------------------------------------------
-Elapsed time in pPXF: 4.97
+Elapsed time in pPXF: 7.67
 Weighted <lg_age> [yr]: 8.57
 Weighted <[M/H]>: 0.0119
 (M*/L)=1.036 (SDSS/r at z=0.0038)
 
 
 ###############################################################################
 
@@ -198,15 +198,15 @@
 The input values are: Vel=200, sigma=300, h3=0.1, h4=0.1
 
  Best Fit:       Vel     sigma        h3        h4
  comp.  0:       192       302     0.061     0.065
 chi2/DOF: 0.9764; DOF: 6316; degree = 4; mdegree = 4
 method = capfit; Jac calls: 3; Func calls: 41; Status: 2
 linear_method = lsq_box; Nonzero Templates (>0.1%): 7/154
-Elapsed time in pPXF: 1.26 s
+Elapsed time in pPXF: 2.18 s
 
 
 ###############################################################################
 
 
 >>> runfile('ppxf_example_two_components.py')
 
@@ -241,15 +241,15 @@
  comp.  0:       198       219
 chi2/DOF: 2.088; DOF: 5978; degree = 4; mdegree = 0
 method = capfit; Jac calls: 4; Func calls: 14; Status: 2
 linear_method = lsq_box; Nonzero Templates (>0.1%): 4/4
 Templates weights:
      0.485     0.512     0.485     0.512
 ==============================================
-Total elapsed time 0.27 s
+Total elapsed time 0.44 s
 
 
 ###############################################################################
 
 
 >>> runfile('ppxf_example_gas_sdss_tied.py')
 
@@ -295,12 +295,12 @@
 Comp:  3           [NeIII]3869      0.000     0.036    1155     1
 Comp:  4              HeII4687    0.03904     0.036    1155    57
 Comp:  5               HeI5876     0.1133     0.034    1155    57
 Comp:  6          [OIII]5007_d      1.224     0.040    1155     1
 Comp:  7            [OI]6300_d    0.08985     0.036    1155     1
 Comp:  8           [NII]6583_d      1.488     0.042    1155    56
 -----------------------------------------------------------------
-Elapsed time in pPXF: 3.24
+Elapsed time in pPXF: 5.67
 
 
 ###############################################################################
```

### Comparing `ppxf-9.2.1/ppxf/ppxf.py` & `ppxf-9.2.2/ppxf/ppxf.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 """
-    Copyright (C) 2001-2023, Michele Cappellari
+    Copyright (C) 2001-2024, Michele Cappellari
 
     E-mail: michele.cappellari_at_physics.ox.ac.uk
 
     Updated versions of the software are available from my web page
     https://purl.org/cappellari/software
 
     If you have found this software useful for your research,
@@ -206,15 +206,15 @@
                 losvd_rfft[:, j, k] *= poly
         p += mom
 
     return np.conj(losvd_rfft)
 
 ################################################################################
 
-def regularization(a, npoly, p, reg_dim, reg_ord, regul, reg_step):
+def regularization(a, npoly, p, reg_dim, reg_ord, reg_step, regul):
     """
     Add first or second order 1D, 2D or 3D linear regularization.
     With equal reg_step and reg_ord=2, this implements Equation (26) of 
     `Cappellari (2017) <https://ui.adsabs.harvard.edu/abs/2017MNRAS.466..798C>`_
     This function allows for non-uniform steps in the different dimensions.
 
     """
@@ -1121,28 +1121,29 @@
 
             Grad[w] @ Grad[w].
 
         * ``reg_ord=2``: minimizes the integral over the weights of the squared
           curvature::
 
             Laplacian[w]**2.
+
     reg_step: list of arrays, shape (len(reg_dim),)
         Defines the step sizes for numerical estimation of derivatives during
         regularization. Each array in the list corresponds to a dimension in
-        `reg_dim`, specifying the step size for each interval within that
-        dimension. By default, if `reg_step` is not provided, a step size of
+        ``reg_dim``, specifying the step size for each interval within that
+        dimension. By default, if ``reg_step`` is not provided, a step size of
         one is assumed for all dimensions, equivalent to 
-        `reg_step = [np.ones(rd - 1) for rd in reg_dim]`. To customize, provide
-        `reg_step` as a list containing arrays, where each array has a length
-        of `reg_dim[j] - 1`, allowing for variable step sizes across intervals
-        and dimensions.
-
-        NOTE 1: Multiplying each element in `reg_step` by a constant factor `k`
-        has the same effect as dividing the regularization parameter `regul` by
-        `k**reg_ord`.
+        ``reg_step = [np.ones(rd - 1) for rd in reg_dim]``. To customize,
+        provide ``reg_step`` as a list containing arrays, where each array has
+        a length of ``reg_dim[j] - 1``, allowing for variable step sizes across
+        intervals and dimensions.
+
+        NOTE 1: Multiplying each element in ``reg_step`` by a constant factor
+        ``k`` has the same effect as dividing the regularization parameter
+        ``regul`` by ``k**reg_ord``.
 
         NOTE 2: The standard approach consists of sampling the SPS template
         spectra logarithmically in age and adopt a constant unitary step,
         **without** using this keyword.
     regul: float, optional
         If this keyword is nonzero, the program applies first or second-order
         linear regularization to the ``weights`` during the ``pPXF`` fit.
@@ -1756,15 +1757,15 @@
             assert self.ncomp >= 2, "At least 2 COMPONENTs are needed with FRACTION keyword"
 
         if regul > 0:
             if reg_dim is None:
                 assert self.ncomp == 1, "REG_DIM must be specified with more than one kinematic component"
                 self.reg_dim = np.asarray(templates.shape[1:])
             if reg_step is None:
-                self.reg_step = [np.ones(rd - 1) for rd in reg_dim]
+                self.reg_step = [np.ones(rd - 1) for rd in self.reg_dim]
             else:
                 assert hasattr(reg_step, "__len__") and len(reg_step) == len(self.reg_dim), \
                     "Must be `len(reg_step) == len(reg_dim)`"
                 assert np.all([hasattr(a, "__len__") and len(a) == b - 1 
                                for (a, b) in zip(reg_step, self.reg_dim)]), \
                                 "Must be `len(reg_step[j]) == reg_dim[j] - 1` for all j"
                 self.reg_step = reg_step
@@ -1871,15 +1872,16 @@
         self.set_linear_constraints(constr_templ, constr_kinem, method)
 
         if galaxy.ndim == 2:
             # two-sided fitting of LOSVD
             assert vsyst != 0, "VSYST must be defined for two-sided fitting"
             self.goodpixels = np.append(self.goodpixels, self.npix + self.goodpixels)
 
-        self.npad = 2**int(np.ceil(np.log2(self.templates.shape[0])))
+        nmin = max(self.templates.shape[0], self.npix)
+        self.npad = 2**int(np.ceil(np.log2(nmin)))
         if templates_rfft is None:
             # Pre-compute FFT of real input of all templates
             self.templates_rfft = np.fft.rfft(self.templates, self.npad, axis=0)
         else:
             self.templates_rfft = templates_rfft
 
         # Convert velocity from km/s to pixels
@@ -1956,16 +1958,16 @@
                 self.gas_names = np.full(np.sum(gas_component), "Unknown")
             else:
                 assert self.gas_component.sum() == len(gas_names), \
                     "There must be one name per gas emission line template"
                 self.gas_names = gas_names
             self.gas_any = True
 
-        # The lines below deal with the possibility for the input
-        # gas templates to be identically zero in the fitted region
+        # The following lines handle cases where the input gas templates
+        # may be entirely zero within the region being fitted
         self.gas_any_zero = False
         if self.gas_any:
             vmed = np.median([a[0] for a in start1])/self.velscale
             dx = int(np.round(self.vsyst + vmed))  # Approximate velocity shift
             n = self.templates.shape[0]//self.velscale_ratio*self.velscale_ratio
             gas_templates = self.templates[:n, self.gas_component]
             tmp = rebin(gas_templates, self.velscale_ratio)
@@ -2013,23 +2015,24 @@
             else:
                 vlim = [np.array(b[0]) - s[0] for b, s in zip(bounds, start)]
                 vlim = np.array([np.max(vlim) + 900, np.min(vlim) - 900])
             lam_range = self.lam[self.goodpixels][[0, -1]]/np.exp(vlim/c)   # Use eq.(5c) of Cappellari (2023)
             assert (self.lam_temp[0] <= lam_range[0]) and (self.lam_temp[-1] >= lam_range[1]), \
                 "The `templates` must cover the full wavelength range of the " \
                 "`galaxy[goodpixels]` spectrum for the adopted velocity starting guess"
-            ok = (self.lam_temp > lam_range[0]) & (self.lam_temp < lam_range[1])
+            lam_range = self.lam[[0, -1]]/np.exp(vlim/c)   # Use eq.(5c) of Cappellari (2023)
+            ok = (self.lam_temp >= lam_range[0]) & (self.lam_temp <= lam_range[1])
             self.templates = self.templates[ok, :]
             self.lam_temp = self.lam_temp[ok]
             self.npix_temp = self.templates.shape[0]
             lam_temp_min = np.mean(self.lam_temp[:self.velscale_ratio])
             self.vsyst = c*np.log(lam_temp_min/self.lam[0])/self.velscale
         elif self.templates.shape[0]/self.velscale_ratio > 2*self.galaxy.shape[0]:
             print("WARNING: The template is > 2x longer than the galaxy. You may "
-                  "be able to save some computation time by truncating it or by "
+                  "be able to save some computation time by either truncating it or by "
                   "providing both `lam` and `lam_temp` for an automatic truncation")
 
 ################################################################################
 
     def set_dust_input(self, dust, gas_reddening, gas_reddening_func, reddening, reddening_func):
 
         if (dust is not None) or (reddening is not None) or (gas_reddening is not None):
@@ -2227,15 +2230,15 @@
             p += self.moments[j]
 
         if self.mdegree > 0:
             for q in range(self.mdegree*self.nspec):
                 bounds[p] = [-1, 1]  # Force <100% corrections
                 p += 1
 
-        # The dust dictionaries have the form
+        # Dust parameter dictionaries are structured as follow:
         # {'start':..., 'bounds':..., 'fixed':..., 'component':..., 'func':...}
         if self.dust is not None:
             for d in self.dust:
                 p1 = p + len(d["start"])
                 start[p:p1] = d["start"]
                 if "bounds" in d:
                     bounds[p:p1] = d["bounds"]
@@ -2408,15 +2411,15 @@
             b = self.noise @ self.galaxy
         else:
             # input NOISE is a 1sigma error vector
             a[: nrows_temp, :] = c/self.noise[:, None] # Weight columns with errors
             b = self.galaxy/self.noise
 
         if self.regul > 0:
-            regularization(a, npoly, nrows_temp, self.reg_dim, self.reg_ord, self.regul, self.reg_step)
+            regularization(a, npoly, nrows_temp, self.reg_dim, self.reg_ord, self.reg_step, self.regul)
 
         # Select the spectral region to fit and solve the over-conditioned system
         # using SVD/BVLS. Use unweighted array for estimating bestfit predictions.
         # Iterate to exclude pixels deviating >3*sigma if clean=True.
         m = 1
         while m > 0:
             if nreg > 0:
@@ -2534,14 +2537,15 @@
             stars_bestfit = bestfit
             bestfit_shown = bestfit
             if self.gas_any:
                 stars_bestfit = bestfit - gas_bestfit
                 if gas_clip:
                     bestfit_shown = stars_bestfit
             sig3 = np.percentile(abs(resid[self.goodpixels]), 99.73)
+            bestfit_shown = bestfit_shown[self.goodpixels[0] : self.goodpixels[-1] + 1]
             ref = np.min(bestfit_shown) - 2*sig3
             mx = np.max(bestfit_shown) + sig3
             resid += ref                           # Offset residuals to avoid overlap
             mn = np.min(resid[self.goodpixels])    # Plot all fitted residuals without clipping
             plt.plot(x, galaxy, 'black', linewidth=1.5)
             plt.plot(x[self.goodpixels], resid[self.goodpixels], 'd',
                      color='LimeGreen', mec='LimeGreen', ms=4)
```

### Comparing `ppxf-9.2.1/ppxf/ppxf_util.py` & `ppxf-9.2.2/ppxf/ppxf_util.py`

 * *Files 0% similar despite different names*

```diff
@@ -29,15 +29,14 @@
     13) varsmooth() to convolve a spectrum with a variable sigma using FFT
 
 """
 from pathlib import Path
 
 import numpy as np
 import matplotlib.pyplot as plt
-from scipy import interpolate
 
 from .ppxf import losvd_rfft, rebin
 
 ###############################################################################
 #
 # NAME:
 #   log_rebin
@@ -196,33 +195,33 @@
 #   V2.0.1: Updated line list. MC, Oxford, 8 January 2014
 #   V2.0.2: Use redshift instead of velocity as input for higher accuracy at large z.
 #       MC, Lexington, 31 March 2015
 #   V2.0.3: Includes `width` keyword after suggestion by George Privon (Univ. Florida).
 #       MC, Oxford, 2 July 2018
 #   V2.0.4: More exact determination of limits. MC, Oxford, 28 March 2022
 
-def determine_goodpixels(ln_lam, lam_range_temp, z, width=800):
+def determine_goodpixels(ln_lam, lam_range_temp, redshift=0, width=800):
     """
     Generates a list of goodpixels to mask a given set of gas emission
     lines. This is meant to be used as input for pPXF.
 
     :param ln_lam: Natural logarithm np.log(wave) of the wavelength in
         Angstrom of each pixel of the log rebinned *galaxy* spectrum.
     :param lam_range_temp: Two elements vectors [lam_min_temp, lam_max_temp]
         with the minimum and maximum wavelength in Angstrom in the stellar
         *template* used in pPXF.
     :param z: Estimate of the galaxy redshift.
     :return: vector of goodpixels to be used as input for pPXF
 
     """
-    return np.flatnonzero(determine_mask(ln_lam, lam_range_temp, z, width))
+    return np.flatnonzero(determine_mask(ln_lam, lam_range_temp, redshift, width))
 
 ###############################################################################
 
-def determine_mask(ln_lam, lam_range_temp, z, width=800):
+def determine_mask(ln_lam, lam_range_temp, redshift=0, width=800):
     """
     Generates a mask to avoid fitting the region possibly contaminated by a
     given set of gas emission lines. This is meant to be used as input for pPXF.
     Here ``mask = True`` for the pixels to include in the fit.
 
     :param ln_lam: Natural logarithm np.log(wave) of the wavelength in
         Angstrom of each pixel of the log rebinned *galaxy* spectrum.
@@ -236,20 +235,20 @@
 #                     -----[OII]-----    Hdelta   Hgamma   Hbeta   -----[OIII]-----   [OI]    -----[NII]-----   Halpha   -----[SII]-----
     lines = np.array([3726.03, 3728.82, 4101.76, 4340.47, 4861.33, 4958.92, 5006.84, 6300.30, 6548.03, 6583.41, 6562.80, 6716.47, 6730.85])
     dv = np.full_like(lines, width)  # width/2 of masked gas emission region in km/s
     c = 299792.458 # speed of light in km/s
 
     flag = False
     for line, dvj in zip(lines, dv):
-        flag |= (ln_lam > np.log(line*(1 + z)) - dvj/c) \
-              & (ln_lam < np.log(line*(1 + z)) + dvj/c)
+        flag |= (ln_lam > np.log(line*(1 + redshift)) - dvj/c) \
+              & (ln_lam < np.log(line*(1 + redshift)) + dvj/c)
 
     # Mask edges of stellar library
-    flag |= ln_lam > np.log(lam_range_temp[1]*(1 + z)) - 900/c
-    flag |= ln_lam < np.log(lam_range_temp[0]*(1 + z)) + 900/c
+    flag |= ln_lam > np.log(lam_range_temp[1]*(1 + redshift)) - 900/c
+    flag |= ln_lam < np.log(lam_range_temp[0]*(1 + redshift)) + 900/c
 
     return ~flag
 
 ###############################################################################
 
 def _wave_convert(lam):
     """
@@ -1050,28 +1049,46 @@
     p1 = synthetic_photometry(flux, lam, bands, redshift=redshift, quiet=quiet)
     mag = -2.5*np.log10(p2.flux/p1.flux)
 
     return mag
 
 ##############################################################################
 
+def interp(xout, xin, yin):
+    """Applies `numpy.interp` to the last dimension of `yin`"""    
+
+    yout = [np.interp(xout, xin, y) for y in yin.reshape(-1, xin.size)]
+    
+    return np.reshape(yout, (*yin.shape[:-1], -1))
+
+##############################################################################
+# NAME:
+#   varsmooth
+#
+# MODIFICATION HISTORY:
+#   V1.0.0: Michele Cappellari, Oxford, 3 September 2022
+#   V1.1.0: Faster convolution for a scalar sigma. MC, Oxford, 12 November 2023
+#   V1.1.1: Removed dependency on legacy scipy.interpolate.interp1d using 
+#       faster loop over np.interp. MC, Oxford, 26 April 2024
+
 def varsmooth(x, y, sig_x, xout=None, oversample=1):
     """    
     Fast and accurate convolution with a Gaussian of variable width.
 
-    This function performs an accurate Fourier convolution of a vector or the
-    columns of an array with a Gaussian kernel that has a varying or constant
+    This function performs an accurate Fourier convolution of a vector, or the
+    columns of an array, with a Gaussian kernel that has a varying or constant
     standard deviation (sigma) per pixel. The convolution is done using fast
     Fourier transform (FFT) and the analytic expression of the Fourier
     transform of the Gaussian function, like in the pPXF method. This allows
     for an accurate convolution even when the Gaussian is severely
     undersampled.
 
-    Even in the case of constant Gaussian width, this function is preferable to
-    standard Fourier convolution due to the treatment of undersampling.
+    This function is recommended over standard convolution even when dealing
+    with a constant Gaussian width, due to its more accurate handling of
+    undersampling issues.
 
     This function implements Algorithm 1 in `Cappellari (2023)
     <https://ui.adsabs.harvard.edu/abs/2023MNRAS.526.3273C>`_
 
     Input Parameters
     ----------------
 
@@ -1108,24 +1125,24 @@
         # Stretches spectrum to have equal sigma in the new coordinate
         sig = sig_x/np.gradient(x)
         sig = sig.clip(0.1)   # Clip to >=0.1 pixels
         sig_max = np.max(sig)*oversample
         xs = np.cumsum(sig_max/sig)
         n = int(np.ceil(xs[-1] - xs[0]))
         x_new = np.linspace(xs[0], xs[-1], n)
-        y_new = interpolate.interp1d(xs, y.T)(x_new)
+        y_new = interp(x_new, xs, y.T)
 
     # Convolve spectrum with a Gaussian using analytic FT like pPXF
     npad = 2**int(np.ceil(np.log2(n)))
     ft = np.fft.rfft(y_new, npad)
     w = np.linspace(0, np.pi*sig_max, ft.shape[-1])
     ft_gau = np.exp(-0.5*w**2)
     yout = np.fft.irfft(ft*ft_gau, npad).T[:n]
 
     if not np.isscalar(sig_x):
         if xout is not None:
-            xs = interpolate.interp1d(x, xs)(xout)
-        yout = interpolate.interp1d(x_new, yout.T)(xs).T
+            xs = np.interp(xout, x, xs)  # xs is 1-dim
+        yout = interp(xs, x_new, yout.T).T
 
     return yout
 
 ###############################################################################
```

### Comparing `ppxf-9.2.1/ppxf/spectra/NGC3073_SDSS_DR8.fits` & `ppxf-9.2.2/ppxf/spectra/NGC3073_SDSS_DR8.fits`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/spectra/NGC3522_SDSS_DR8.fits` & `ppxf-9.2.2/ppxf/spectra/NGC3522_SDSS_DR8.fits`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/spectra/NGC4550_SAURON.fits` & `ppxf-9.2.2/ppxf/spectra/NGC4550_SAURON.fits`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/spectra/NGC4636_SDSS_DR12.fits` & `ppxf-9.2.2/ppxf/spectra/NGC4636_SDSS_DR12.fits`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/spectra/legac_M19_56670_v3.0.fits` & `ppxf-9.2.2/ppxf/spectra/legac_M19_56670_v3.0.fits`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/sps_models/Vazdekis2012_ssp_mass_Padova00_UN_baseFe_v10.0.txt` & `ppxf-9.2.2/ppxf/sps_models/Vazdekis2012_ssp_mass_Padova00_UN_baseFe_v10.0.txt`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/sps_models/Vazdekis2012_ssp_phot_Padova00_UN_v10.0.txt` & `ppxf-9.2.2/ppxf/sps_models/Vazdekis2012_ssp_phot_Padova00_UN_v10.0.txt`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/sps_models/Vazdekis2012_ssp_sdss_miuscat_UN1.30_v9.txt` & `ppxf-9.2.2/ppxf/sps_models/Vazdekis2012_ssp_sdss_miuscat_UN1.30_v9.txt`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/sps_models/spectra_sun_vega.npz` & `ppxf-9.2.2/ppxf/sps_models/spectra_sun_vega.npz`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/ppxf/sps_util.py` & `ppxf-9.2.2/ppxf/sps_util.py`

 * *Files 1% similar despite different names*

```diff
@@ -10,16 +10,14 @@
 # at the beginning of the file. All other rights are reserved.
 #
 ###############################################################################
 
 from pathlib import Path
 import numpy as np
 
-from astropy import constants, units
-
 from ppxf import ppxf_util as util
 
 ###############################################################################
 
 class sps_lib:
     """
     This class is meant as an example that can be easily adapted by the users
@@ -288,27 +286,28 @@
         converted to mass weights using the .flux attribute of the class. The
         weights overall normalization does not affect the M*/L calculation.
         """
         assert self.templates_full.shape[1:] == weights.shape, "Input weight dimensions do not match"
 
         p1 = util.synthetic_photometry(self.templates_full, self.lam_temp_full, band, 
                                        redshift=redshift, quiet=True)
-        dist = (10*units.pc).to('cm').value        
-        p1.flux /= 4*np.pi*dist**2            # convert luminosity to observed flux/cm^2 at 10pc
-        p1.flux *= constants.L_sun.to('erg/s').value  # spectra are in units of Lsun
+        dist = 3.085677581491367e+19    # 10pc in cm
+        p1.flux /= 4*np.pi*dist**2      # convert luminosity to observed flux/cm^2 at 10pc
+        p1.flux *= 3.828e+33            # spectra are in units of Lsun (erg/s IAU 2015)
 
         ppxf_dir = Path(__file__).parent  # path of current file
         filename = ppxf_dir / 'sps_models' / 'spectra_sun_vega.npz'
-        a = np.load(filename)   # Spectrum in cgs/A at 10pc
+        a = np.load(filename)           # Spectrum in cgs/A at 10pc
         p2 = util.synthetic_photometry(a["flux_sun"], a["lam"], band, 
                                        redshift=redshift, quiet=True) 
 
         mass_weights = weights/self.flux    # Revert possible templates normalization
         lum = p1.flux/p2.flux               # Lum in solar luminosities
         mlpop = np.sum(mass_weights*self.mass_no_gas_grid)/np.sum(weights*lum)
 
         if not quiet:
             print(f'(M*/L)={mlpop:#.4g} ({band} at z={redshift:#.4f})')
 
         return mlpop
 
+
 ###############################################################################
```

### Comparing `ppxf-9.2.1/ppxf.egg-info/PKG-INFO` & `ppxf-9.2.2/ppxf.egg-info/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 00000000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00000010: 3a20 322e 310d 0a4e 616d 653a 2070 7078  : 2.1..Name: ppx
 00000020: 660d 0a56 6572 7369 6f6e 3a20 392e 322e  f..Version: 9.2.
-00000030: 310d 0a53 756d 6d61 7279 3a20 7050 5846  1..Summary: pPXF
+00000030: 320d 0a53 756d 6d61 7279 3a20 7050 5846  2..Summary: pPXF
 00000040: 3a20 4675 6c6c 2053 7065 6374 7275 6d20  : Full Spectrum 
 00000050: 616e 6420 5345 4420 4669 7474 696e 6720  and SED Fitting 
 00000060: 6f66 2047 616c 6163 7469 6320 616e 6420  of Galactic and 
 00000070: 5374 656c 6c61 7220 5370 6563 7472 610d  Stellar Spectra.
 00000080: 0a48 6f6d 652d 7061 6765 3a20 6874 7470  .Home-page: http
 00000090: 733a 2f2f 7075 726c 2e6f 7267 2f63 6170  s://purl.org/cap
 000000a0: 7065 6c6c 6172 692f 736f 6674 7761 7265  pellari/software
@@ -2906,3989 +2906,4047 @@
 0000b590: 0d0a 2020 2020 2a20 6060 7265 675f 6f72  ..    * ``reg_or
 0000b5a0: 643d 3260 603a 206d 696e 696d 697a 6573  d=2``: minimizes
 0000b5b0: 2074 6865 2069 6e74 6567 7261 6c20 6f76   the integral ov
 0000b5c0: 6572 2074 6865 2077 6569 6768 7473 206f  er the weights o
 0000b5d0: 6620 7468 6520 7371 7561 7265 640d 0a20  f the squared.. 
 0000b5e0: 2020 2020 2063 7572 7661 7475 7265 3a3a       curvature::
 0000b5f0: 0d0a 0d0a 2020 2020 2020 2020 4c61 706c  ....        Lapl
-0000b600: 6163 6961 6e5b 775d 2a2a 322e 0d0a 7265  acian[w]**2...re
-0000b610: 675f 7374 6570 3a20 6c69 7374 206f 6620  g_step: list of 
-0000b620: 6172 7261 7973 2c20 7368 6170 6520 286c  arrays, shape (l
-0000b630: 656e 2872 6567 5f64 696d 292c 290d 0a20  en(reg_dim),).. 
-0000b640: 2020 2044 6566 696e 6573 2074 6865 2073     Defines the s
-0000b650: 7465 7020 7369 7a65 7320 666f 7220 6e75  tep sizes for nu
-0000b660: 6d65 7269 6361 6c20 6573 7469 6d61 7469  merical estimati
-0000b670: 6f6e 206f 6620 6465 7269 7661 7469 7665  on of derivative
-0000b680: 7320 6475 7269 6e67 0d0a 2020 2020 7265  s during..    re
-0000b690: 6775 6c61 7269 7a61 7469 6f6e 2e20 4561  gularization. Ea
-0000b6a0: 6368 2061 7272 6179 2069 6e20 7468 6520  ch array in the 
-0000b6b0: 6c69 7374 2063 6f72 7265 7370 6f6e 6473  list corresponds
-0000b6c0: 2074 6f20 6120 6469 6d65 6e73 696f 6e20   to a dimension 
-0000b6d0: 696e 0d0a 2020 2020 6072 6567 5f64 696d  in..    `reg_dim
-0000b6e0: 602c 2073 7065 6369 6679 696e 6720 7468  `, specifying th
-0000b6f0: 6520 7374 6570 2073 697a 6520 666f 7220  e step size for 
-0000b700: 6561 6368 2069 6e74 6572 7661 6c20 7769  each interval wi
-0000b710: 7468 696e 2074 6861 740d 0a20 2020 2064  thin that..    d
-0000b720: 696d 656e 7369 6f6e 2e20 4279 2064 6566  imension. By def
-0000b730: 6175 6c74 2c20 6966 2060 7265 675f 7374  ault, if `reg_st
-0000b740: 6570 6020 6973 206e 6f74 2070 726f 7669  ep` is not provi
-0000b750: 6465 642c 2061 2073 7465 7020 7369 7a65  ded, a step size
-0000b760: 206f 660d 0a20 2020 206f 6e65 2069 7320   of..    one is 
-0000b770: 6173 7375 6d65 6420 666f 7220 616c 6c20  assumed for all 
-0000b780: 6469 6d65 6e73 696f 6e73 2c20 6571 7569  dimensions, equi
-0000b790: 7661 6c65 6e74 2074 6f20 0d0a 2020 2020  valent to ..    
-0000b7a0: 6072 6567 5f73 7465 7020 3d20 5b6e 702e  `reg_step = [np.
-0000b7b0: 6f6e 6573 2872 6420 2d20 3129 2066 6f72  ones(rd - 1) for
-0000b7c0: 2072 6420 696e 2072 6567 5f64 696d 5d60   rd in reg_dim]`
-0000b7d0: 2e20 546f 2063 7573 746f 6d69 7a65 2c20  . To customize, 
-0000b7e0: 7072 6f76 6964 650d 0a20 2020 2060 7265  provide..    `re
-0000b7f0: 675f 7374 6570 6020 6173 2061 206c 6973  g_step` as a lis
-0000b800: 7420 636f 6e74 6169 6e69 6e67 2061 7272  t containing arr
-0000b810: 6179 732c 2077 6865 7265 2065 6163 6820  ays, where each 
-0000b820: 6172 7261 7920 6861 7320 6120 6c65 6e67  array has a leng
-0000b830: 7468 0d0a 2020 2020 6f66 2060 7265 675f  th..    of `reg_
-0000b840: 6469 6d5b 6a5d 202d 2031 602c 2061 6c6c  dim[j] - 1`, all
-0000b850: 6f77 696e 6720 666f 7220 7661 7269 6162  owing for variab
-0000b860: 6c65 2073 7465 7020 7369 7a65 7320 6163  le step sizes ac
-0000b870: 726f 7373 2069 6e74 6572 7661 6c73 0d0a  ross intervals..
-0000b880: 2020 2020 616e 6420 6469 6d65 6e73 696f      and dimensio
-0000b890: 6e73 2e0d 0a0d 0a20 2020 204e 4f54 4520  ns.....    NOTE 
-0000b8a0: 313a 204d 756c 7469 706c 7969 6e67 2065  1: Multiplying e
-0000b8b0: 6163 6820 656c 656d 656e 7420 696e 2060  ach element in `
-0000b8c0: 7265 675f 7374 6570 6020 6279 2061 2063  reg_step` by a c
-0000b8d0: 6f6e 7374 616e 7420 6661 6374 6f72 2060  onstant factor `
-0000b8e0: 6b60 0d0a 2020 2020 6861 7320 7468 6520  k`..    has the 
-0000b8f0: 7361 6d65 2065 6666 6563 7420 6173 2064  same effect as d
-0000b900: 6976 6964 696e 6720 7468 6520 7265 6775  ividing the regu
-0000b910: 6c61 7269 7a61 7469 6f6e 2070 6172 616d  larization param
-0000b920: 6574 6572 2060 7265 6775 6c60 2062 790d  eter `regul` by.
-0000b930: 0a20 2020 2060 6b2a 2a72 6567 5f6f 7264  .    `k**reg_ord
-0000b940: 602e 0d0a 0d0a 2020 2020 4e4f 5445 2032  `.....    NOTE 2
-0000b950: 3a20 5468 6520 7374 616e 6461 7264 2061  : The standard a
-0000b960: 7070 726f 6163 6820 636f 6e73 6973 7473  pproach consists
-0000b970: 206f 6620 7361 6d70 6c69 6e67 2074 6865   of sampling the
-0000b980: 2053 5053 2074 656d 706c 6174 650d 0a20   SPS template.. 
-0000b990: 2020 2073 7065 6374 7261 206c 6f67 6172     spectra logar
-0000b9a0: 6974 686d 6963 616c 6c79 2069 6e20 6167  ithmically in ag
-0000b9b0: 6520 616e 6420 6164 6f70 7420 6120 636f  e and adopt a co
-0000b9c0: 6e73 7461 6e74 2075 6e69 7461 7279 2073  nstant unitary s
-0000b9d0: 7465 702c 0d0a 2020 2020 2a2a 7769 7468  tep,..    **with
-0000b9e0: 6f75 742a 2a20 7573 696e 6720 7468 6973  out** using this
-0000b9f0: 206b 6579 776f 7264 2e0d 0a72 6567 756c   keyword...regul
-0000ba00: 3a20 666c 6f61 742c 206f 7074 696f 6e61  : float, optiona
-0000ba10: 6c0d 0a20 2020 2049 6620 7468 6973 206b  l..    If this k
-0000ba20: 6579 776f 7264 2069 7320 6e6f 6e7a 6572  eyword is nonzer
-0000ba30: 6f2c 2074 6865 2070 726f 6772 616d 2061  o, the program a
-0000ba40: 7070 6c69 6573 2066 6972 7374 206f 7220  pplies first or 
-0000ba50: 7365 636f 6e64 2d6f 7264 6572 0d0a 2020  second-order..  
-0000ba60: 2020 6c69 6e65 6172 2072 6567 756c 6172    linear regular
-0000ba70: 697a 6174 696f 6e20 746f 2074 6865 2060  ization to the `
-0000ba80: 6077 6569 6768 7473 6060 2064 7572 696e  `weights`` durin
-0000ba90: 6720 7468 6520 6060 7050 5846 6060 2066  g the ``pPXF`` f
-0000baa0: 6974 2e0d 0a20 2020 2052 6567 756c 6172  it...    Regular
-0000bab0: 697a 6174 696f 6e20 6973 2064 6f6e 6520  ization is done 
-0000bac0: 696e 206f 6e65 2c20 7477 6f20 6f72 2074  in one, two or t
-0000bad0: 6872 6565 2064 696d 656e 7369 6f6e 7320  hree dimensions 
-0000bae0: 6465 7065 6e64 696e 6720 6f6e 0d0a 2020  depending on..  
-0000baf0: 2020 7768 6574 6865 7220 7468 6520 6172    whether the ar
-0000bb00: 7261 7920 6f66 2060 6074 656d 706c 6174  ray of ``templat
-0000bb10: 6573 6060 2068 6173 2074 776f 2c20 7468  es`` has two, th
-0000bb20: 7265 6520 6f72 2066 6f75 7220 6469 6d65  ree or four dime
-0000bb30: 6e73 696f 6e73 0d0a 2020 2020 7265 7370  nsions..    resp
-0000bb40: 6563 7469 7665 6c79 2e0d 0a20 2020 204c  ectively...    L
-0000bb50: 6172 6765 2060 6072 6567 756c 6060 2076  arge ``regul`` v
-0000bb60: 616c 7565 7320 636f 7272 6573 706f 6e64  alues correspond
-0000bb70: 2074 6f20 736d 6f6f 7468 6572 2060 6077   to smoother ``w
-0000bb80: 6569 6768 7473 6060 206f 7574 7075 742e  eights`` output.
-0000bb90: 2057 6865 6e0d 0a20 2020 2074 6869 7320   When..    this 
-0000bba0: 6b65 7977 6f72 6420 6973 206e 6f6e 7a65  keyword is nonze
-0000bbb0: 726f 2074 6865 2073 6f6c 7574 696f 6e20  ro the solution 
-0000bbc0: 7769 6c6c 2062 6520 6120 7472 6164 652d  will be a trade-
-0000bbd0: 6f66 6620 6265 7477 6565 6e20 7468 650d  off between the.
-0000bbe0: 0a20 2020 2073 6d6f 6f74 686e 6573 7320  .    smoothness 
-0000bbf0: 6f66 2060 6077 6569 6768 7473 6060 2061  of ``weights`` a
-0000bc00: 6e64 2067 6f6f 646e 6573 7320 6f66 2066  nd goodness of f
-0000bc10: 6974 2e0d 0a0d 0a20 2020 2053 6563 7469  it.....    Secti
-0000bc20: 6f6e 2033 2e35 206f 6620 6043 6170 7065  on 3.5 of `Cappe
-0000bc30: 6c6c 6172 6920 2832 3031 3729 605f 2064  llari (2017)`_ d
-0000bc40: 6573 6372 6962 6573 2072 6567 756c 6172  escribes regular
-0000bc50: 697a 6174 696f 6e2e 0d0a 0d0a 2020 2020  ization.....    
-0000bc60: 5768 656e 2066 6974 7469 6e67 206d 756c  When fitting mul
-0000bc70: 7469 706c 6520 6b69 6e65 6d61 7469 6320  tiple kinematic 
-0000bc80: 6060 636f 6d70 6f6e 656e 7460 6020 7468  ``component`` th
-0000bc90: 6520 7265 6775 6c61 7269 7a61 7469 6f6e  e regularization
-0000bca0: 2069 730d 0a20 2020 2061 7070 6c69 6564   is..    applied
-0000bcb0: 206f 6e6c 7920 746f 2074 6865 2066 6972   only to the fir
-0000bcc0: 7374 2060 6063 6f6d 706f 6e65 6e74 203d  st ``component =
-0000bcd0: 2030 6060 2c20 7768 696c 6520 6164 6469   0``, while addi
-0000bce0: 7469 6f6e 616c 0d0a 2020 2020 636f 6d70  tional..    comp
-0000bcf0: 6f6e 656e 7473 2061 7265 206e 6f74 2072  onents are not r
-0000bd00: 6567 756c 6172 697a 6564 2e20 5468 6973  egularized. This
-0000bd10: 2069 7320 7573 6566 756c 2077 6865 6e20   is useful when 
-0000bd20: 6669 7474 696e 6720 7374 656c 6c61 720d  fitting stellar.
-0000bd30: 0a20 2020 2070 6f70 756c 6174 696f 6e20  .    population 
-0000bd40: 746f 6765 7468 6572 2077 6974 6820 6761  together with ga
-0000bd50: 7320 656d 6973 7369 6f6e 206c 696e 6573  s emission lines
-0000bd60: 2e20 496e 2074 6861 7420 6361 7365 2c20  . In that case, 
-0000bd70: 7468 6520 5353 500d 0a20 2020 2073 7065  the SSP..    spe
-0000bd80: 6374 7261 6c20 7465 6d70 6c61 7465 7320  ctral templates 
-0000bd90: 6d75 7374 2062 6520 6769 7665 6e20 6669  must be given fi
-0000bda0: 7273 7420 616e 6420 7468 6520 6761 7320  rst and the gas 
-0000bdb0: 656d 6973 7369 6f6e 2074 656d 706c 6174  emission templat
-0000bdc0: 6573 0d0a 2020 2020 6172 6520 6769 7665  es..    are give
-0000bdd0: 6e20 6c61 7374 2e20 496e 2074 6869 7320  n last. In this 
-0000bde0: 7369 7475 6174 696f 6e2c 206f 6e65 2068  situation, one h
-0000bdf0: 6173 2074 6f20 7573 6520 7468 6520 6060  as to use the ``
-0000be00: 7265 675f 6469 6d60 600d 0a20 2020 206b  reg_dim``..    k
-0000be10: 6579 776f 7264 2028 6265 6c6f 7729 2c20  eyword (below), 
-0000be20: 746f 2067 6976 6520 6060 7050 5846 6060  to give ``pPXF``
-0000be30: 2074 6865 2064 696d 656e 7369 6f6e 7320   the dimensions 
-0000be40: 6f66 2074 6865 2070 6f70 756c 6174 696f  of the populatio
-0000be50: 6e0d 0a20 2020 2070 6172 616d 6574 6572  n..    parameter
-0000be60: 7320 2865 2e67 2e20 6060 6e5f 6167 6560  s (e.g. ``n_age`
-0000be70: 602c 2060 606e 5f6d 6574 616c 6060 2c20  `, ``n_metal``, 
-0000be80: 6060 6e5f 616c 7068 6160 6029 2e20 4120  ``n_alpha``). A 
-0000be90: 7573 6167 6520 6578 616d 706c 650d 0a20  usage example.. 
-0000bea0: 2020 2069 7320 6769 7665 6e20 696e 2074     is given in t
-0000beb0: 6865 2066 696c 6520 6060 7070 7866 5f65  he file ``ppxf_e
-0000bec0: 7861 6d70 6c65 5f70 6f70 756c 6174 696f  xample_populatio
-0000bed0: 6e5f 6761 735f 7364 7373 2e70 7960 602e  n_gas_sdss.py``.
-0000bee0: 0d0a 0d0a 2020 2020 5468 6520 6566 6665  ....    The effe
-0000bef0: 6374 206f 6620 7468 6520 7265 6775 6c61  ct of the regula
-0000bf00: 7269 7a61 7469 6f6e 2073 6368 656d 6520  rization scheme 
-0000bf10: 6973 2074 6865 2066 6f6c 6c6f 7769 6e67  is the following
-0000bf20: 3a0d 0a0d 0a20 2020 202a 2057 6974 6820  :....    * With 
-0000bf30: 6060 7265 675f 6f72 643d 3160 6020 6974  ``reg_ord=1`` it
-0000bf40: 2065 6e66 6f72 6365 7320 7468 6520 6e75   enforces the nu
-0000bf50: 6d65 7269 6361 6c20 6669 7273 7420 6465  merical first de
-0000bf60: 7269 7661 7469 7665 730d 0a20 2020 2020  rivatives..     
-0000bf70: 2062 6574 7765 656e 206e 6569 6768 626f   between neighbo
-0000bf80: 7572 696e 6720 7765 6967 6874 7320 2869  uring weights (i
-0000bf90: 6e20 7468 6520 312d 6469 6d20 6361 7365  n the 1-dim case
-0000bfa0: 2920 746f 2062 6520 6571 7561 6c20 746f  ) to be equal to
-0000bfb0: 0d0a 2020 2020 2020 6060 775b 6a5d 202d  ..      ``w[j] -
-0000bfc0: 2077 5b6a 2b31 5d20 3d20 3060 6020 7769   w[j+1] = 0`` wi
-0000bfd0: 7468 2061 6e20 6572 726f 7220 6060 4465  th an error ``De
-0000bfe0: 6c74 6120 3d20 312f 7265 6775 6c60 602e  lta = 1/regul``.
-0000bff0: 0d0a 0d0a 2020 2020 2a20 5769 7468 2060  ....    * With `
-0000c000: 6072 6567 5f6f 7264 3d32 6060 2069 7420  `reg_ord=2`` it 
-0000c010: 656e 666f 7263 6573 2074 6865 206e 756d  enforces the num
-0000c020: 6572 6963 616c 2073 6563 6f6e 6420 6465  erical second de
-0000c030: 7269 7661 7469 7665 730d 0a20 2020 2020  rivatives..     
-0000c040: 2062 6574 7765 656e 206e 6569 6768 626f   between neighbo
-0000c050: 7572 696e 6720 7765 6967 6874 7320 2869  uring weights (i
-0000c060: 6e20 7468 6520 312d 6469 6d20 6361 7365  n the 1-dim case
-0000c070: 2920 746f 2062 6520 6571 7561 6c20 746f  ) to be equal to
-0000c080: 0d0a 2020 2020 2020 6060 775b 6a2d 315d  ..      ``w[j-1]
-0000c090: 202d 2032 2a77 5b6a 5d20 2b20 775b 6a2b   - 2*w[j] + w[j+
-0000c0a0: 315d 203d 2030 6060 2077 6974 6820 616e  1] = 0`` with an
-0000c0b0: 2065 7272 6f72 2060 6044 656c 7461 203d   error ``Delta =
-0000c0c0: 2031 2f72 6567 756c 6060 2e0d 0a0d 0a20   1/regul``..... 
-0000c0d0: 2020 2049 7420 6d61 7920 6265 2068 656c     It may be hel
-0000c0e0: 7066 756c 2074 6f20 6465 6669 6e65 2060  pful to define `
-0000c0f0: 6072 6567 756c 203d 2031 2f44 656c 7461  `regul = 1/Delta
-0000c100: 6060 2061 6e64 2074 6869 6e6b 206f 6620  `` and think of 
-0000c110: 6060 4465 6c74 6160 600d 0a20 2020 2061  ``Delta``..    a
-0000c120: 7320 7468 6520 7265 6775 6c61 7269 7a61  s the regulariza
-0000c130: 7469 6f6e 2065 7272 6f72 2e0d 0a0d 0a20  tion error..... 
-0000c140: 2020 2049 4d50 4f52 5441 4e54 3a20 6060     IMPORTANT: ``
-0000c150: 4465 6c74 6160 6020 6e65 6564 7320 746f  Delta`` needs to
-0000c160: 2062 6520 736d 616c 6c65 7220 6275 7420   be smaller but 
-0000c170: 6f66 2074 6865 2073 616d 6520 6f72 6465  of the same orde
-0000c180: 7220 6f66 0d0a 2020 2020 6d61 676e 6974  r of..    magnit
-0000c190: 7564 6520 6f66 2074 6865 2074 7970 6963  ude of the typic
-0000c1a0: 616c 2060 6077 6569 6768 7473 6060 2074  al ``weights`` t
-0000c1b0: 6f20 706c 6179 2061 6e20 6566 6665 6374  o play an effect
-0000c1c0: 206f 6e20 7468 650d 0a20 2020 2072 6567   on the..    reg
-0000c1d0: 756c 6172 697a 6174 696f 6e2e 204f 6e65  ularization. One
-0000c1e0: 2071 7569 636b 2077 6179 2074 6f20 6163   quick way to ac
-0000c1f0: 6869 6576 6520 7468 6973 2069 733a 0d0a  hieve this is:..
-0000c200: 0d0a 2020 2020 312e 2044 6976 6964 6520  ..    1. Divide 
-0000c210: 7468 6520 6675 6c6c 2060 6074 656d 706c  the full ``templ
-0000c220: 6174 6573 6060 2061 7272 6179 2062 7920  ates`` array by 
-0000c230: 6120 7363 616c 6172 2069 6e20 7375 6368  a scalar in such
-0000c240: 2061 2077 6179 2074 6861 740d 0a20 2020   a way that..   
-0000c250: 2020 2020 7468 6520 7479 7069 6361 6c20      the typical 
-0000c260: 7465 6d70 6c61 7465 2068 6173 2061 206d  template has a m
-0000c270: 6564 6961 6e20 6f66 206f 6e65 3a3a 0d0a  edian of one::..
-0000c280: 0d0a 2020 2020 2020 2020 2020 2020 7465  ..            te
-0000c290: 6d70 6c61 7465 7320 2f3d 206e 702e 6d65  mplates /= np.me
-0000c2a0: 6469 616e 2874 656d 706c 6174 6573 290d  dian(templates).
-0000c2b0: 0a0d 0a20 2020 2032 2e20 446f 2074 6865  ...    2. Do the
-0000c2c0: 2073 616d 6520 666f 7220 7468 6520 696e   same for the in
-0000c2d0: 7075 7420 6761 6c61 7879 2073 7065 6374  put galaxy spect
-0000c2e0: 7275 6d3a 3a0d 0a0d 0a20 2020 2020 2020  rum::....       
-0000c2f0: 2020 2020 2067 616c 6178 7920 2f3d 206e       galaxy /= n
-0000c300: 702e 6d65 6469 616e 2867 616c 6178 7929  p.median(galaxy)
-0000c310: 0d0a 0d0a 2020 2020 332e 2049 6e20 7468  ....    3. In th
-0000c320: 6973 2073 6974 7561 7469 6f6e 2c20 6120  is situation, a 
-0000c330: 7365 6e73 6962 6c65 2067 7565 7373 2066  sensible guess f
-0000c340: 6f72 2060 6044 656c 7461 6060 2077 696c  or ``Delta`` wil
-0000c350: 6c20 6265 2061 2066 6577 0d0a 2020 2020  l be a few..    
-0000c360: 2020 2070 6572 6365 6e74 2028 652e 672e     percent (e.g.
-0000c370: 2060 6044 656c 7461 3d30 2e30 3120 2d2d   ``Delta=0.01 --
-0000c380: 3e20 7265 6775 6c3d 3130 3060 6029 2e0d  > regul=100``)..
-0000c390: 0a0d 0a20 2020 2041 6c74 6572 6e61 7469  ...    Alternati
-0000c3a0: 7665 6c79 2c20 666f 7220 6120 6d6f 7265  vely, for a more
-0000c3b0: 2072 6967 6f72 6f75 7320 6465 6669 6e69   rigorous defini
-0000c3c0: 7469 6f6e 206f 6620 7468 6520 7061 7261  tion of the para
-0000c3d0: 6d65 7465 720d 0a20 2020 2060 6072 6567  meter..    ``reg
-0000c3e0: 756c 6060 3a0d 0a0d 0a20 2020 2041 2e20  ul``:....    A. 
-0000c3f0: 5065 7266 6f72 6d20 616e 2075 6e72 6567  Perform an unreg
-0000c400: 756c 6172 697a 6564 2066 6974 2028 6060  ularized fit (``
-0000c410: 7265 6775 6c3d 3060 6029 2061 6e64 2074  regul=0``) and t
-0000c420: 6865 6e20 7265 7363 616c 6520 7468 650d  hen rescale the.
-0000c430: 0a20 2020 2020 2020 696e 7075 7420 6060  .       input ``
-0000c440: 6e6f 6973 6560 6020 7370 6563 7472 756d  noise`` spectrum
-0000c450: 2073 6f20 7468 6174 3a3a 0d0a 0d0a 2020   so that::....  
-0000c460: 2020 2020 2020 2020 2020 4368 695e 322f            Chi^2/
-0000c470: 444f 4620 3d20 4368 695e 322f 676f 6f64  DOF = Chi^2/good
-0000c480: 5069 7865 6c73 2e73 697a 6520 3d20 312e  Pixels.size = 1.
-0000c490: 0d0a 0d0a 2020 2020 2020 2054 6869 7320  ....       This 
-0000c4a0: 6973 2061 6368 6965 7665 6420 6279 2072  is achieved by r
-0000c4b0: 6573 6361 6c69 6e67 2074 6865 2069 6e70  escaling the inp
-0000c4c0: 7574 2060 606e 6f69 7365 6060 2073 7065  ut ``noise`` spe
-0000c4d0: 6374 7275 6d20 6173 3a3a 0d0a 0d0a 2020  ctrum as::....  
-0000c4e0: 2020 2020 2020 2020 2020 6e6f 6973 6520            noise 
-0000c4f0: 3d20 6e6f 6973 652a 6e70 2e73 7172 7428  = noise*np.sqrt(
-0000c500: 4368 692a 2a32 2f44 4f46 2920 3d20 6e6f  Chi**2/DOF) = no
-0000c510: 6973 652a 6e70 2e73 7172 7428 7070 2e63  ise*np.sqrt(pp.c
-0000c520: 6869 3229 3b0d 0a0d 0a20 2020 2042 2e20  hi2);....    B. 
-0000c530: 496e 6372 6561 7365 2060 6072 6567 756c  Increase ``regul
-0000c540: 6060 2061 6e64 2069 7465 7261 7469 7665  `` and iterative
-0000c550: 6c79 2072 6564 6f20 7468 6520 6060 7050  ly redo the ``pP
-0000c560: 5846 6060 2066 6974 2075 6e74 696c 2074  XF`` fit until t
-0000c570: 6865 0d0a 2020 2020 2020 2060 6043 6869  he..       ``Chi
-0000c580: 5e32 6060 2069 6e63 7265 6173 6573 2066  ^2`` increases f
-0000c590: 726f 6d20 7468 6520 756e 7265 6775 6c61  rom the unregula
-0000c5a0: 7269 7a65 6420 7661 6c75 650d 0a20 2020  rized value..   
-0000c5b0: 2020 2020 6060 4368 695e 3220 3d20 676f      ``Chi^2 = go
-0000c5c0: 6f64 5069 7865 6c73 2e73 697a 6560 6020  odPixels.size`` 
-0000c5d0: 6279 0d0a 2020 2020 2020 2060 6044 656c  by..       ``Del
-0000c5e0: 7461 4368 695e 3220 3d20 6e70 2e73 7172  taChi^2 = np.sqr
-0000c5f0: 7428 322a 676f 6f64 5069 7865 6c73 2e73  t(2*goodPixels.s
-0000c600: 697a 6529 6060 2e0d 0a0d 0a20 2020 2054  ize)``.....    T
-0000c610: 6865 2064 6572 6976 6564 2072 6567 756c  he derived regul
-0000c620: 6172 697a 6174 696f 6e20 636f 7272 6573  arization corres
-0000c630: 706f 6e64 7320 746f 2074 6865 206d 6178  ponds to the max
-0000c640: 696d 756d 206f 6e65 2073 7469 6c6c 0d0a  imum one still..
-0000c650: 2020 2020 636f 6e73 6973 7465 6e74 2077      consistent w
-0000c660: 6974 6820 7468 6520 6f62 7365 7276 6174  ith the observat
-0000c670: 696f 6e73 2061 6e64 2074 6865 2064 6572  ions and the der
-0000c680: 6976 6564 2073 7461 7220 666f 726d 6174  ived star format
-0000c690: 696f 6e20 6869 7374 6f72 790d 0a20 2020  ion history..   
-0000c6a0: 2077 696c 6c20 6265 2074 6865 2073 6d6f   will be the smo
-0000c6b0: 6f74 6865 7374 2028 6d69 6e69 6d75 6d20  othest (minimum 
-0000c6c0: 6375 7276 6174 7572 6520 6f72 206d 696e  curvature or min
-0000c6d0: 696d 756d 2076 6172 6961 7469 6f6e 2920  imum variation) 
-0000c6e0: 7468 6174 2069 730d 0a20 2020 2073 7469  that is..    sti
-0000c6f0: 6c6c 2063 6f6e 7369 7374 656e 7420 7769  ll consistent wi
-0000c700: 7468 2074 6865 206f 6273 6572 7661 7469  th the observati
-0000c710: 6f6e 732e 0d0a 7369 676d 615f 6469 6666  ons...sigma_diff
-0000c720: 3a20 666c 6f61 742c 206f 7074 696f 6e61  : float, optiona
-0000c730: 6c0d 0a20 2020 2051 7561 6472 6174 6963  l..    Quadratic
-0000c740: 2064 6966 6665 7265 6e63 6520 696e 206b   difference in k
-0000c750: 6d2f 7320 6465 6669 6e65 6420 6173 3a3a  m/s defined as::
-0000c760: 0d0a 0d0a 2020 2020 2020 2020 7369 676d  ....        sigm
-0000c770: 615f 6469 6666 2a2a 3220 3d20 7369 676d  a_diff**2 = sigm
-0000c780: 615f 696e 7374 2a2a 3220 2d20 7369 676d  a_inst**2 - sigm
-0000c790: 615f 7465 6d70 2a2a 320d 0a0d 0a20 2020  a_temp**2....   
-0000c7a0: 2062 6574 7765 656e 2074 6865 2069 6e73   between the ins
-0000c7b0: 7472 756d 656e 7461 6c20 6469 7370 6572  trumental disper
-0000c7c0: 7369 6f6e 206f 6620 7468 6520 6761 6c61  sion of the gala
-0000c7d0: 7879 2073 7065 6374 7275 6d20 616e 6420  xy spectrum and 
-0000c7e0: 7468 650d 0a20 2020 2069 6e73 7472 756d  the..    instrum
-0000c7f0: 656e 7461 6c20 6469 7370 6572 7369 6f6e  ental dispersion
-0000c800: 206f 6620 7468 6520 7465 6d70 6c61 7465   of the template
-0000c810: 2073 7065 6374 7261 2e0d 0a0d 0a20 2020   spectra.....   
-0000c820: 2054 6869 7320 6b65 7977 6f72 6420 6973   This keyword is
-0000c830: 2075 7365 6675 6c20 7768 656e 2074 6865   useful when the
-0000c840: 2074 656d 706c 6174 6573 2068 6176 6520   templates have 
-0000c850: 6869 6768 6572 2072 6573 6f6c 7574 696f  higher resolutio
-0000c860: 6e20 7468 616e 0d0a 2020 2020 7468 6520  n than..    the 
-0000c870: 6761 6c61 7879 2061 6e64 2074 6865 7920  galaxy and they 
-0000c880: 7765 7265 206e 6f74 2063 6f6e 766f 6c76  were not convolv
-0000c890: 6564 2074 6f20 6d61 7463 6820 7468 6520  ed to match the 
-0000c8a0: 696e 7374 7275 6d65 6e74 616c 0d0a 2020  instrumental..  
-0000c8b0: 2020 6469 7370 6572 7369 6f6e 206f 6620    dispersion of 
-0000c8c0: 7468 6520 6761 6c61 7879 2073 7065 6374  the galaxy spect
-0000c8d0: 7275 6d2e 2049 6e20 7468 6973 2073 6974  rum. In this sit
-0000c8e0: 7561 7469 6f6e 2c20 7468 6520 636f 6e76  uation, the conv
-0000c8f0: 6f6c 7574 696f 6e0d 0a20 2020 2069 7320  olution..    is 
-0000c900: 646f 6e65 2062 7920 6060 7050 5846 6060  done by ``pPXF``
-0000c910: 2077 6974 6820 696e 6372 6561 7365 6420   with increased 
-0000c920: 6163 6375 7261 6379 2c20 7573 696e 6720  accuracy, using 
-0000c930: 616e 2061 6e61 6c79 7469 6320 466f 7572  an analytic Four
-0000c940: 6965 720d 0a20 2020 2054 7261 6e73 666f  ier..    Transfo
-0000c950: 726d 2e0d 0a73 6b79 3a0d 0a20 2020 2076  rm...sky:..    v
-0000c960: 6563 746f 7220 636f 6e74 6169 6e69 6e67  ector containing
-0000c970: 2074 6865 2073 7065 6374 7275 6d20 6f66   the spectrum of
-0000c980: 2074 6865 2073 6b79 2074 6f20 6265 2069   the sky to be i
-0000c990: 6e63 6c75 6465 6420 696e 2074 6865 2066  ncluded in the f
-0000c9a0: 6974 2c20 6f72 0d0a 2020 2020 6172 7261  it, or..    arra
-0000c9b0: 7920 6f66 2064 696d 656e 7369 6f6e 7320  y of dimensions 
-0000c9c0: 6060 736b 795b 6e5f 7069 7865 6c73 2c20  ``sky[n_pixels, 
-0000c9d0: 6e53 6b79 5d60 6020 636f 6e74 6169 6e69  nSky]`` containi
-0000c9e0: 6e67 2064 6966 6665 7265 6e74 2073 6b79  ng different sky
-0000c9f0: 0d0a 2020 2020 7370 6563 7472 6120 746f  ..    spectra to
-0000ca00: 2061 6464 2074 6f20 7468 6520 6d6f 6465   add to the mode
-0000ca10: 6c20 6f66 2074 6865 206f 6273 6572 7665  l of the observe
-0000ca20: 6420 6060 6761 6c61 7879 6060 2073 7065  d ``galaxy`` spe
-0000ca30: 6374 7275 6d2e 2054 6865 0d0a 2020 2020  ctrum. The..    
-0000ca40: 6060 736b 7960 6020 6861 7320 746f 2062  ``sky`` has to b
-0000ca50: 6520 6c6f 672d 7265 6269 6e6e 6564 2061  e log-rebinned a
-0000ca60: 7320 7468 6520 6060 6761 6c61 7879 6060  s the ``galaxy``
-0000ca70: 2073 7065 6374 7275 6d20 616e 6420 6e65   spectrum and ne
-0000ca80: 6564 7320 746f 0d0a 2020 2020 6861 7665  eds to..    have
-0000ca90: 2074 6865 2073 616d 6520 6e75 6d62 6572   the same number
-0000caa0: 206f 6620 7069 7865 6c73 2e0d 0a0d 0a20   of pixels..... 
-0000cab0: 2020 2054 6865 2073 6b79 2069 7320 6765     The sky is ge
-0000cac0: 6e65 7261 6c6c 7920 7375 6274 7261 6374  nerally subtract
-0000cad0: 6564 2066 726f 6d20 7468 6520 6461 7461  ed from the data
-0000cae0: 2062 6566 6f72 6520 7468 6520 6060 7050   before the ``pP
-0000caf0: 5846 6060 2066 6974 2e0d 0a20 2020 2048  XF`` fit...    H
-0000cb00: 6f77 6576 6572 2c20 666f 7220 6f62 7365  owever, for obse
-0000cb10: 7276 6174 696f 6e73 2076 6572 7920 6865  rvations very he
-0000cb20: 6176 696c 7920 646f 6d69 6e61 7465 6420  avily dominated 
-0000cb30: 6279 2074 6865 2073 6b79 2073 7065 6374  by the sky spect
-0000cb40: 7275 6d2c 0d0a 2020 2020 7768 6572 6520  rum,..    where 
-0000cb50: 6120 7665 7279 2061 6363 7572 6174 6520  a very accurate 
-0000cb60: 736b 7920 7375 6274 7261 6374 696f 6e20  sky subtraction 
-0000cb70: 6973 2063 7269 7469 6361 6c2c 2069 7420  is critical, it 
-0000cb80: 6d61 7920 6265 2075 7365 6675 6c0d 0a20  may be useful.. 
-0000cb90: 2020 202a 6e6f 742a 2074 6f20 7375 6274     *not* to subt
-0000cba0: 7261 6374 2074 6865 2073 6b79 2066 726f  ract the sky fro
-0000cbb0: 6d20 7468 6520 7370 6563 7472 756d 2c20  m the spectrum, 
-0000cbc0: 6275 7420 746f 2069 6e63 6c75 6465 2069  but to include i
-0000cbd0: 7420 696e 2074 6865 0d0a 2020 2020 6669  t in the..    fi
-0000cbe0: 7420 7573 696e 6720 7468 6973 206b 6579  t using this key
-0000cbf0: 776f 7264 2e0d 0a74 656d 706c 6174 6573  word...templates
-0000cc00: 5f72 6666 743a 0d0a 2020 2020 5768 656e  _rfft:..    When
-0000cc10: 2063 616c 6c69 6e67 2060 6070 5058 4660   calling ``pPXF`
-0000cc20: 6020 6d61 6e79 2074 696d 6573 2077 6974  ` many times wit
-0000cc30: 6820 616e 2069 6465 6e74 6963 616c 2073  h an identical s
-0000cc40: 6574 206f 6620 7465 6d70 6c61 7465 732c  et of templates,
-0000cc50: 0d0a 2020 2020 6f6e 6520 6361 6e20 7573  ..    one can us
-0000cc60: 6520 7468 6973 206b 6579 776f 7264 2074  e this keyword t
-0000cc70: 6f20 7061 7373 2074 6865 2072 6561 6c20  o pass the real 
-0000cc80: 4646 5420 6f66 2074 6865 2074 656d 706c  FFT of the templ
-0000cc90: 6174 6573 2c0d 0a20 2020 2063 6f6d 7075  ates,..    compu
-0000cca0: 7465 6420 696e 2061 2070 7265 7669 6f75  ted in a previou
-0000ccb0: 7320 6060 7050 5846 6060 2063 616c 6c2c  s ``pPXF`` call,
-0000ccc0: 2073 746f 7265 6420 696e 2074 6865 0d0a   stored in the..
-0000ccd0: 2020 2020 6060 7070 2e74 656d 706c 6174      ``pp.templat
-0000cce0: 6573 5f72 6666 7460 6020 6174 7472 6962  es_rfft`` attrib
-0000ccf0: 7574 652e 2054 6869 7320 6b65 7977 6f72  ute. This keywor
-0000cd00: 6420 6d61 696e 6c79 2065 7869 7374 7320  d mainly exists 
-0000cd10: 746f 2073 686f 770d 0a20 2020 2074 6861  to show..    tha
-0000cd20: 7420 7468 6572 6520 6973 206e 6f20 6e65  t there is no ne
-0000cd30: 6564 2066 6f72 2069 742e 2e2e 0d0a 0d0a  ed for it.......
-0000cd40: 2020 2020 494d 504f 5254 414e 543a 2055      IMPORTANT: U
-0000cd50: 7365 2074 6869 7320 6b65 7977 6f72 6420  se this keyword 
-0000cd60: 6f6e 6c79 2069 6620 796f 7520 756e 6465  only if you unde
-0000cd70: 7273 7461 6e64 2077 6861 7420 796f 7520  rstand what you 
-0000cd80: 6172 6520 646f 696e 6721 0d0a 7469 6564  are doing!..tied
-0000cd90: 3a0d 0a20 2020 2041 206c 6973 7420 6f66  :..    A list of
-0000cda0: 2073 7472 696e 6720 6578 7072 6573 7369   string expressi
-0000cdb0: 6f6e 732e 2045 6163 6820 6578 7072 6573  ons. Each expres
-0000cdc0: 7369 6f6e 2022 7469 6573 2220 7468 6520  sion "ties" the 
-0000cdd0: 7061 7261 6d65 7465 7220 746f 0d0a 2020  parameter to..  
-0000cde0: 2020 6f74 6865 7220 6672 6565 206f 7220    other free or 
-0000cdf0: 6669 7865 6420 7061 7261 6d65 7465 7273  fixed parameters
-0000ce00: 2e20 2041 6e79 2065 7870 7265 7373 696f  .  Any expressio
-0000ce10: 6e20 696e 766f 6c76 696e 6720 636f 6e73  n involving cons
-0000ce20: 7461 6e74 7320 616e 640d 0a20 2020 2074  tants and..    t
-0000ce30: 6865 2070 6172 616d 6574 6572 2061 7272  he parameter arr
-0000ce40: 6179 2060 6070 5b6a 5d60 6020 6172 6520  ay ``p[j]`` are 
-0000ce50: 7065 726d 6974 7465 642e 2053 696e 6365  permitted. Since
-0000ce60: 2074 6865 7920 6172 6520 746f 7461 6c6c   they are totall
-0000ce70: 790d 0a20 2020 2063 6f6e 7374 7261 696e  y..    constrain
-0000ce80: 6564 2c20 7469 6564 2070 6172 616d 6574  ed, tied paramet
-0000ce90: 6572 7320 6172 6520 636f 6e73 6964 6572  ers are consider
-0000cea0: 6564 2074 6f20 6265 2066 6978 6564 3b20  ed to be fixed; 
-0000ceb0: 6e6f 2065 7272 6f72 7320 6172 650d 0a20  no errors are.. 
-0000cec0: 2020 2063 6f6d 7075 7465 6420 666f 7220     computed for 
-0000ced0: 7468 656d 2e0d 0a0d 0a20 2020 2054 6869  them.....    Thi
-0000cee0: 7320 6973 2061 6e20 6172 7261 792c 206f  s is an array, o
-0000cef0: 7220 6c69 7374 206f 6620 6172 7261 7973  r list of arrays
-0000cf00: 2c20 7769 7468 2074 6865 2073 616d 6520  , with the same 
-0000cf10: 6469 6d65 6e73 696f 6e73 2061 730d 0a20  dimensions as.. 
-0000cf20: 2020 2060 6073 7461 7274 6060 2e20 496e     ``start``. In
-0000cf30: 2070 7261 6374 6963 652c 2066 6f72 2065   practice, for e
-0000cf40: 7665 7279 2065 6c65 6d65 6e74 206f 6620  very element of 
-0000cf50: 6060 7374 6172 7460 6020 6f6e 6520 6e65  ``start`` one ne
-0000cf60: 6564 7320 746f 0d0a 2020 2020 7370 6563  eds to..    spec
-0000cf70: 6966 7920 6569 7468 6572 2061 6e20 656d  ify either an em
-0000cf80: 7074 7920 7374 7269 6e67 2060 6027 2760  pty string ``''`
-0000cf90: 6020 696d 706c 7969 6e67 2074 6861 7420  ` implying that 
-0000cfa0: 7468 6520 7061 7261 6d65 7465 7220 6973  the parameter is
-0000cfb0: 0d0a 2020 2020 6672 6565 2c20 6f72 2061  ..    free, or a
-0000cfc0: 2073 7472 696e 6720 6578 7072 6573 7369   string expressi
-0000cfd0: 6f6e 2069 6e76 6f6c 7669 6e67 2073 6f6d  on involving som
-0000cfe0: 6520 6f66 2074 6865 2076 6172 6961 626c  e of the variabl
-0000cff0: 6573 2060 6070 5b6a 5d60 602c 0d0a 2020  es ``p[j]``,..  
-0000d000: 2020 7768 6572 6520 6060 6a60 6020 7265    where ``j`` re
-0000d010: 7072 6573 656e 7473 2074 6865 2069 6e64  presents the ind
-0000d020: 6578 206f 6620 7468 6520 666c 6174 7465  ex of the flatte
-0000d030: 6e65 6420 6c69 7374 206f 6620 6b69 6e65  ned list of kine
-0000d040: 6d61 7469 630d 0a20 2020 2070 6172 616d  matic..    param
-0000d050: 6574 6572 732e 0d0a 0d0a 2020 2020 4558  eters.....    EX
-0000d060: 414d 504c 453a 2057 6520 7761 6e74 2074  AMPLE: We want t
-0000d070: 6f20 6669 7420 7468 7265 6520 6b69 6e65  o fit three kine
-0000d080: 6d61 7469 6320 636f 6d70 6f6e 656e 7473  matic components
-0000d090: 2c20 7769 7468 2034 206d 6f6d 656e 7473  , with 4 moments
-0000d0a0: 2066 6f72 0d0a 2020 2020 7468 6520 6669   for..    the fi
-0000d0b0: 7273 7420 636f 6d70 6f6e 656e 7420 616e  rst component an
-0000d0c0: 6420 3220 6d6f 6d65 6e74 7320 666f 7220  d 2 moments for 
-0000d0d0: 7468 6520 7365 636f 6e64 2061 6e64 2074  the second and t
-0000d0e0: 6869 7264 2028 652e 672e 2073 7461 7273  hird (e.g. stars
-0000d0f0: 0d0a 2020 2020 616e 6420 7477 6f20 6761  ..    and two ga
-0000d100: 7320 636f 6d70 6f6e 656e 7473 292e 2049  s components). I
-0000d110: 6e20 7468 6973 2063 6173 653a 3a0d 0a0d  n this case::...
-0000d120: 0a20 2020 2020 2020 206d 6f6d 656e 7473  .        moments
-0000d130: 203d 205b 342c 2032 2c20 325d 0d0a 2020   = [4, 2, 2]..  
-0000d140: 2020 2020 2020 7374 6172 7420 3d20 5b5b        start = [[
-0000d150: 5631 2c20 7369 676d 6131 2c20 302c 2030  V1, sigma1, 0, 0
-0000d160: 5d2c 205b 5632 2c20 7369 676d 6132 5d2c  ], [V2, sigma2],
-0000d170: 205b 5633 2c20 7369 676d 6133 5d5d 0d0a   [V3, sigma3]]..
-0000d180: 0d0a 2020 2020 7468 656e 2077 6520 6361  ..    then we ca
-0000d190: 6e20 666f 7263 6520 7468 6520 6571 7561  n force the equa
-0000d1a0: 6c69 7479 2063 6f6e 7374 7261 696e 7420  lity constraint 
-0000d1b0: 6060 5632 203d 2056 3360 6020 6173 2066  ``V2 = V3`` as f
-0000d1c0: 6f6c 6c6f 7773 3a3a 0d0a 0d0a 2020 2020  ollows::....    
-0000d1d0: 2020 2020 7469 6564 203d 205b 5b27 272c      tied = [['',
-0000d1e0: 2027 272c 2027 272c 2027 275d 2c20 5b27   '', '', ''], ['
-0000d1f0: 272c 2027 275d 2c20 5b27 705b 345d 272c  ', ''], ['p[4]',
-0000d200: 2027 275d 5d20 2023 2070 5b36 5d20 3d20   '']]  # p[6] = 
-0000d210: 705b 345d 0d0a 0d0a 2020 2020 6f72 2077  p[4]....    or w
-0000d220: 6520 6361 6e20 666f 7263 6520 7468 6520  e can force the 
-0000d230: 6571 7561 6c69 7479 2063 6f6e 7374 7261  equality constra
-0000d240: 696e 7420 6060 7369 676d 6132 203d 2073  int ``sigma2 = s
-0000d250: 6967 6d61 3360 6020 6173 0d0a 2020 2020  igma3`` as..    
-0000d260: 666f 6c6c 6f77 733a 3a0d 0a0d 0a20 2020  follows::....   
-0000d270: 2020 2020 2074 6965 6420 3d20 5b5b 2727       tied = [[''
-0000d280: 2c20 2727 2c20 2727 2c20 2727 5d2c 205b  , '', '', ''], [
-0000d290: 2727 2c20 2727 5d2c 205b 2727 2c20 2770  '', ''], ['', 'p
-0000d2a0: 5b35 5d27 5d5d 2020 2320 705b 375d 203d  [5]']]  # p[7] =
-0000d2b0: 2070 5b35 5d0d 0a0d 0a20 2020 204f 6e65   p[5]....    One
-0000d2c0: 2063 616e 2061 6c73 6f20 7573 6520 6d6f   can also use mo
-0000d2d0: 7265 2067 656e 6572 616c 2066 6f72 6d75  re general formu
-0000d2e0: 6c61 732e 2046 6f72 2065 7861 6d70 6c65  las. For example
-0000d2f0: 206f 6e65 2063 6f75 6c64 2063 6f6e 7374   one could const
-0000d300: 7261 696e 0d0a 2020 2020 6060 5633 203d  rain..    ``V3 =
-0000d310: 2028 5631 202b 2056 3229 2f32 6060 2061   (V1 + V2)/2`` a
-0000d320: 7320 7765 6c6c 2061 7320 6060 7369 676d  s well as ``sigm
-0000d330: 6131 203d 2073 6967 6d61 3260 6020 6173  a1 = sigma2`` as
-0000d340: 2066 6f6c 6c6f 7773 3a3a 0d0a 0d0a 2020   follows::....  
-0000d350: 2020 2020 2020 2320 705b 355d 203d 2070        # p[5] = p
-0000d360: 5b31 5d0d 0a20 2020 2020 2020 2023 2070  [1]..        # p
-0000d370: 5b36 5d20 3d20 2870 5b30 5d20 2b20 705b  [6] = (p[0] + p[
-0000d380: 345d 292f 320d 0a20 2020 2020 2020 2074  4])/2..        t
-0000d390: 6965 6420 3d20 5b5b 2727 2c20 2727 2c20  ied = [['', '', 
-0000d3a0: 2727 2c20 2727 5d2c 205b 2727 2c20 2770  '', ''], ['', 'p
-0000d3b0: 5b31 5d27 5d2c 205b 2728 705b 305d 202b  [1]'], ['(p[0] +
-0000d3c0: 2070 5b34 5d29 2f32 272c 2027 275d 5d0d   p[4])/2', '']].
-0000d3d0: 0a0d 0a20 2020 204e 4f54 453a 204f 6e65  ...    NOTE: One
-0000d3e0: 2063 6f75 6c64 2069 6e20 7072 696e 6369   could in princi
-0000d3f0: 706c 6520 7573 6520 7468 6520 6060 7469  ple use the ``ti
-0000d400: 6564 6060 206b 6579 776f 7264 2074 6f20  ed`` keyword to 
-0000d410: 636f 6d70 6c65 7465 6c79 2074 6965 0d0a  completely tie..
-0000d420: 2020 2020 7468 6520 4c4f 5356 4420 6f66      the LOSVD of
-0000d430: 2074 776f 206b 696e 656d 6174 6963 2063   two kinematic c
-0000d440: 6f6d 706f 6e65 6e74 732e 2048 6f77 6576  omponents. Howev
-0000d450: 6572 2c20 7468 6973 2073 616d 6520 6566  er, this same ef
-0000d460: 6665 6374 2069 730d 0a20 2020 206d 6f72  fect is..    mor
-0000d470: 6520 6566 6669 6369 656e 7420 6163 6869  e efficient achi
-0000d480: 6576 6564 2062 7920 6173 7369 676e 696e  eved by assignin
-0000d490: 6720 7468 656d 2074 6f20 7468 6520 7361  g them to the sa
-0000d4a0: 6d65 206b 696e 656d 6174 6963 0d0a 2020  me kinematic..  
-0000d4b0: 2020 636f 6d70 6f6e 656e 7420 7573 696e    component usin
-0000d4c0: 6720 7468 6520 6060 636f 6d70 6f6e 656e  g the ``componen
-0000d4d0: 7460 6020 6b65 7977 6f72 642e 0d0a 7472  t`` keyword...tr
-0000d4e0: 6967 3a0d 0a20 2020 2053 6574 2060 6074  ig:..    Set ``t
-0000d4f0: 7269 673d 5472 7565 6060 2074 6f20 7573  rig=True`` to us
-0000d500: 6520 7472 6967 6f6e 6f6d 6574 7269 6320  e trigonometric 
-0000d510: 7365 7269 6573 2061 7320 616e 2061 6c74  series as an alt
-0000d520: 6572 6e61 7469 7665 2074 6f0d 0a20 2020  ernative to..   
-0000d530: 204c 6567 656e 6472 6520 706f 6c79 6e6f   Legendre polyno
-0000d540: 6d69 616c 732c 2066 6f72 2062 6f74 6820  mials, for both 
-0000d550: 7468 6520 6164 6469 7469 7665 2061 6e64  the additive and
-0000d560: 206d 756c 7469 706c 6963 6174 6976 650d   multiplicative.
-0000d570: 0a20 2020 2070 6f6c 796e 6f6d 6961 6c73  .    polynomials
-0000d580: 2e20 5768 656e 2060 6074 7269 673d 5472  . When ``trig=Tr
-0000d590: 7565 6060 2074 6865 2066 6974 7465 6420  ue`` the fitted 
-0000d5a0: 7365 7269 6573 2062 656c 6f77 2068 6173  series below has
-0000d5b0: 0d0a 2020 2020 6060 4e20 3d20 6465 6772  ..    ``N = degr
-0000d5c0: 6565 2f32 6060 206f 7220 6060 4e20 3d20  ee/2`` or ``N = 
-0000d5d0: 6d64 6567 7265 652f 3260 603a 3a0d 0a0d  mdegree/2``::...
-0000d5e0: 0a20 2020 2020 2020 2070 6f6c 7920 3d20  .        poly = 
-0000d5f0: 415f 3020 2b20 7375 6d5f 7b6e 3d31 7d5e  A_0 + sum_{n=1}^
-0000d600: 7b4e 7d20 5b41 5f6e 2a63 6f73 286e 2a74  {N} [A_n*cos(n*t
-0000d610: 6829 202b 2042 5f6e 2a73 696e 286e 2a74  h) + B_n*sin(n*t
-0000d620: 6829 5d0d 0a0d 0a20 2020 2049 4d50 4f52  h)]....    IMPOR
-0000d630: 5441 4e54 3a20 5468 6520 7472 6967 6f6e  TANT: The trigon
-0000d640: 6f6d 6574 7269 6320 7365 7269 6573 2068  ometric series h
-0000d650: 6173 2070 6572 696f 6469 6320 626f 756e  as periodic boun
-0000d660: 6461 7279 2063 6f6e 6469 7469 6f6e 732e  dary conditions.
-0000d670: 0d0a 2020 2020 5468 6973 2069 7320 736f  ..    This is so
-0000d680: 6d65 7469 6d65 7320 6120 6465 7369 7261  metimes a desira
-0000d690: 626c 6520 7072 6f70 6572 7479 2c20 6275  ble property, bu
-0000d6a0: 7420 7468 6973 2065 7870 616e 7369 6f6e  t this expansion
-0000d6b0: 2069 7320 6e6f 7420 6173 0d0a 2020 2020   is not as..    
-0000d6c0: 666c 6578 6962 6c65 2061 7320 7468 6520  flexible as the 
-0000d6d0: 4c65 6765 6e64 7265 2070 6f6c 796e 6f6d  Legendre polynom
-0000d6e0: 6961 6c73 2e0d 0a76 656c 7363 616c 655f  ials...velscale_
-0000d6f0: 7261 7469 6f3a 2069 6e74 2c20 6f70 7469  ratio: int, opti
-0000d700: 6f6e 616c 0d0a 2020 2020 496e 7465 6765  onal..    Intege
-0000d710: 722e 2047 6976 6573 2074 6865 2069 6e74  r. Gives the int
-0000d720: 6567 6572 2060 6072 6174 696f 203e 3d20  eger ``ratio >= 
-0000d730: 3160 6020 6265 7477 6565 6e20 7468 6520  1`` between the 
-0000d740: 6060 7665 6c73 6361 6c65 6060 206f 660d  ``velscale`` of.
-0000d750: 0a20 2020 2074 6865 2060 6067 616c 6178  .    the ``galax
-0000d760: 7960 6020 616e 6420 7468 6520 6060 7465  y`` and the ``te
-0000d770: 6d70 6c61 7465 7360 602e 2057 6865 6e20  mplates``. When 
-0000d780: 7468 6973 206b 6579 776f 7264 2069 7320  this keyword is 
-0000d790: 7573 6564 2c20 7468 650d 0a20 2020 2074  used, the..    t
-0000d7a0: 656d 706c 6174 6573 2061 7265 2063 6f6e  emplates are con
-0000d7b0: 766f 6c76 6564 2062 7920 7468 6520 4c4f  volved by the LO
-0000d7c0: 5356 4420 6174 2074 6865 6972 206e 6174  SVD at their nat
-0000d7d0: 6976 6520 7265 736f 6c75 7469 6f6e 2c20  ive resolution, 
-0000d7e0: 616e 640d 0a20 2020 206f 6e6c 7920 7375  and..    only su
-0000d7f0: 6273 6571 7565 6e74 6c79 2061 7265 2069  bsequently are i
-0000d800: 6e74 6567 7261 7465 6420 6f76 6572 2074  ntegrated over t
-0000d810: 6865 2070 6978 656c 7320 616e 6420 6669  he pixels and fi
-0000d820: 7474 6564 2074 6f0d 0a20 2020 2060 6067  tted to..    ``g
-0000d830: 616c 6178 7960 602e 2054 6869 7320 6b65  alaxy``. This ke
-0000d840: 7977 6f72 6420 6973 2067 656e 6572 616c  yword is general
-0000d850: 6c79 2075 6e6e 6563 6573 7361 7279 2061  ly unnecessary a
-0000d860: 6e64 206d 6f73 746c 7920 7573 6566 756c  nd mostly useful
-0000d870: 2066 6f72 0d0a 2020 2020 7465 7374 696e   for..    testin
-0000d880: 672e 0d0a 0d0a 2020 2020 4e6f 7465 2074  g.....    Note t
-0000d890: 6861 7420 696e 2072 6561 6c69 7374 6963  hat in realistic
-0000d8a0: 2073 6974 7561 7469 6f6e 7320 7468 6520   situations the 
-0000d8b0: 756e 6365 7274 6169 6e74 7920 696e 2074  uncertainty in t
-0000d8c0: 6865 206b 6e6f 776c 6564 6765 2061 6e64  he knowledge and
-0000d8d0: 0d0a 2020 2020 7661 7269 6174 696f 6e73  ..    variations
-0000d8e0: 206f 6620 7468 6520 696e 7472 696e 7369   of the intrinsi
-0000d8f0: 6320 6c69 6e65 2d73 7072 6561 6420 6675  c line-spread fu
-0000d900: 6e63 7469 6f6e 2062 6563 6f6d 6573 2074  nction becomes t
-0000d910: 6865 206c 696d 6974 696e 670d 0a20 2020  he limiting..   
-0000d920: 2066 6163 746f 7220 696e 2072 6563 6f76   factor in recov
-0000d930: 6572 696e 6720 7468 6520 4c4f 5356 4420  ering the LOSVD 
-0000d940: 7765 6c6c 2062 656c 6f77 2060 6076 656c  well below ``vel
-0000d950: 7363 616c 6560 602e 0d0a 7673 7973 743a  scale``...vsyst:
-0000d960: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
-0000d970: 0d0a 2020 2020 5265 6665 7265 6e63 6520  ..    Reference 
-0000d980: 7665 6c6f 6369 7479 2069 6e20 6060 6b6d  velocity in ``km
-0000d990: 2f73 6060 2028 6465 6661 756c 7420 3029  /s`` (default 0)
-0000d9a0: 2e20 5468 6520 696e 7075 7420 696e 6974  . The input init
-0000d9b0: 6961 6c20 6775 6573 7320 616e 640d 0a20  ial guess and.. 
-0000d9c0: 2020 2074 6865 206f 7574 7075 7420 7665     the output ve
-0000d9d0: 6c6f 6369 7469 6573 2061 7265 206d 6561  locities are mea
-0000d9e0: 7375 7265 6420 7769 7468 2072 6573 7065  sured with respe
-0000d9f0: 6374 2074 6f20 7468 6973 2076 656c 6f63  ct to this veloc
-0000da00: 6974 792e 2054 6869 730d 0a20 2020 206b  ity. This..    k
-0000da10: 6579 776f 7264 2063 616e 2062 6520 7573  eyword can be us
-0000da20: 6564 2074 6f20 6163 636f 756e 7420 666f  ed to account fo
-0000da30: 7220 7468 6520 6469 6666 6572 656e 6365  r the difference
-0000da40: 2069 6e20 7468 6520 7374 6172 7469 6e67   in the starting
-0000da50: 0d0a 2020 2020 7761 7665 6c65 6e67 7468  ..    wavelength
-0000da60: 206f 6620 7468 6520 7465 6d70 6c61 7465   of the template
-0000da70: 7320 616e 6420 7468 6520 6761 6c61 7879  s and the galaxy
-0000da80: 2073 7065 6374 7275 6d20 6173 2066 6f6c   spectrum as fol
-0000da90: 6c6f 7773 3a3a 0d0a 0d0a 2020 2020 2020  lows::....      
-0000daa0: 2020 7673 7973 7420 3d20 632a 6e70 2e6c    vsyst = c*np.l
-0000dab0: 6f67 2877 6176 655f 7465 6d70 5b30 5d2f  og(wave_temp[0]/
-0000dac0: 7761 7665 5f67 616c 5b30 5d29 0d0a 0d0a  wave_gal[0])....
-0000dad0: 2020 2020 4173 2061 6c74 6572 6e61 7469      As alternati
-0000dae0: 7665 2074 6f20 7573 696e 6720 7468 6973  ve to using this
-0000daf0: 206b 6579 776f 7264 2c20 6f6e 6520 6361   keyword, one ca
-0000db00: 6e20 7061 7373 2074 6865 2077 6176 656c  n pass the wavel
-0000db10: 656e 6774 6873 0d0a 2020 2020 6060 6c61  engths..    ``la
-0000db20: 6d60 6020 616e 6420 6060 6c61 6d5f 7465  m`` and ``lam_te
-0000db30: 6d70 6060 206f 6620 626f 7468 2074 6865  mp`` of both the
-0000db40: 2060 6067 616c 6178 7960 6020 616e 6420   ``galaxy`` and 
-0000db50: 6060 7465 6d70 6c61 7465 7360 600d 0a20  ``templates``.. 
-0000db60: 2020 2073 7065 6374 7261 2e20 496e 2074     spectra. In t
-0000db70: 6861 7420 6361 7365 2020 6060 7673 7973  hat case  ``vsys
-0000db80: 7460 6020 6973 2063 6f6d 7075 7465 6420  t`` is computed 
-0000db90: 6175 746f 6d61 7469 6361 6c6c 7920 616e  automatically an
-0000dba0: 6420 7368 6f75 6c64 0d0a 2020 2020 6e6f  d should..    no
-0000dbb0: 7420 6265 2067 6976 656e 2e0d 0a0d 0a20  t be given..... 
-0000dbc0: 2020 2054 6865 2076 616c 7565 2061 7373     The value ass
-0000dbd0: 6967 6e65 6420 746f 2074 6869 7320 6b65  igned to this ke
-0000dbe0: 7977 6f72 6420 6973 202a 6372 7563 6961  yword is *crucia
-0000dbf0: 6c2a 2066 6f72 2074 6865 2074 776f 2d73  l* for the two-s
-0000dc00: 6964 6564 0d0a 2020 2020 6669 7474 696e  ided..    fittin
-0000dc10: 672e 2049 6e20 7468 6973 2063 6173 6520  g. In this case 
-0000dc20: 6060 7673 7973 7460 6020 6361 6e20 6265  ``vsyst`` can be
-0000dc30: 2064 6574 6572 6d69 6e65 6420 6672 6f6d   determined from
-0000dc40: 2061 2070 7265 7669 6f75 730d 0a20 2020   a previous..   
-0000dc50: 206e 6f72 6d61 6c20 6f6e 652d 7369 6465   normal one-side
-0000dc60: 6420 6669 7420 746f 2074 6865 2067 616c  d fit to the gal
-0000dc70: 6178 7920 7665 6c6f 6369 7479 2070 726f  axy velocity pro
-0000dc80: 6669 6c65 2e20 4166 7465 7220 7468 6174  file. After that
-0000dc90: 2069 6e69 7469 616c 0d0a 2020 2020 6669   initial..    fi
-0000dca0: 742c 2060 6076 7379 7374 6060 2063 616e  t, ``vsyst`` can
-0000dcb0: 2062 6520 6465 6669 6e65 6420 6173 2074   be defined as t
-0000dcc0: 6865 206d 6561 7375 7265 6420 7665 6c6f  he measured velo
-0000dcd0: 6369 7479 2061 7420 7468 6520 6761 6c61  city at the gala
-0000dce0: 7879 0d0a 2020 2020 6365 6e74 6572 2e20  xy..    center. 
-0000dcf0: 4d6f 7265 2061 6363 7572 6174 656c 7920  More accurately 
-0000dd00: 6060 7673 7973 7460 6020 6973 2074 6865  ``vsyst`` is the
-0000dd10: 2076 616c 7565 2077 6869 6368 2068 6173   value which has
-0000dd20: 2074 6f20 6265 0d0a 2020 2020 7375 6274   to be..    subt
-0000dd30: 7261 6374 6564 2074 6f20 6f62 7461 696e  racted to obtain
-0000dd40: 2061 206e 6561 726c 7920 616e 7469 2d73   a nearly anti-s
-0000dd50: 796d 6d65 7472 6963 2076 656c 6f63 6974  ymmetric velocit
-0000dd60: 7920 7072 6f66 696c 6520 6174 2074 6865  y profile at the
-0000dd70: 0d0a 2020 2020 7477 6f20 6f70 706f 7369  ..    two opposi
-0000dd80: 7465 2073 6964 6573 206f 6620 7468 6520  te sides of the 
-0000dd90: 6761 6c61 7879 206e 7563 6c65 7573 2e0d  galaxy nucleus..
-0000dda0: 0a0d 0a20 2020 2049 4d50 4f52 5441 4e54  ...    IMPORTANT
-0000ddb0: 3a20 7468 6973 2076 616c 7565 2069 7320  : this value is 
-0000ddc0: 6765 6e65 7261 6c6c 7920 2a64 6966 6665  generally *diffe
-0000ddd0: 7265 6e74 2a20 6672 6f6d 2074 6865 2073  rent* from the s
-0000dde0: 7973 7465 6d69 630d 0a20 2020 2076 656c  ystemic..    vel
-0000ddf0: 6f63 6974 7920 6f6e 6520 6361 6e20 6765  ocity one can ge
-0000de00: 7420 6672 6f6d 2074 6865 206c 6974 6572  t from the liter
-0000de10: 6174 7572 652e 2044 6f20 6e6f 7420 7472  ature. Do not tr
-0000de20: 7920 746f 2075 7365 2074 6861 7421 0d0a  y to use that!..
-0000de30: 0d0a 4f75 7470 7574 2050 6172 616d 6574  ..Output Paramet
-0000de40: 6572 730d 0a2d 2d2d 2d2d 2d2d 2d2d 2d2d  ers..-----------
-0000de50: 2d2d 2d2d 2d2d 0d0a 0d0a 5374 6f72 6564  ------....Stored
-0000de60: 2061 7320 6174 7472 6962 7574 6573 206f   as attributes o
-0000de70: 6620 7468 6520 6060 7050 5846 6060 2063  f the ``pPXF`` c
-0000de80: 6c61 7373 3a0d 0a0d 0a2e 6170 6f6c 793a  lass:.....apoly:
-0000de90: 0d0a 2020 2020 5665 6374 6f72 2077 6974  ..    Vector wit
-0000dea0: 6820 7468 6520 6265 7374 2066 6974 7469  h the best fitti
-0000deb0: 6e67 2061 6464 6974 6976 6520 706f 6c79  ng additive poly
-0000dec0: 6e6f 6d69 616c 2e0d 0a2e 6265 7374 6669  nomial....bestfi
-0000ded0: 743a 0d0a 2020 2020 5665 6374 6f72 2077  t:..    Vector w
-0000dee0: 6974 6820 7468 6520 6265 7374 2066 6974  ith the best fit
-0000def0: 7469 6e67 206d 6f64 656c 2066 6f72 2074  ting model for t
-0000df00: 6865 2067 616c 6178 7920 7370 6563 7472  he galaxy spectr
-0000df10: 756d 2e0d 0a20 2020 2054 6869 7320 6973  um...    This is
-0000df20: 2061 206c 696e 6561 7220 636f 6d62 696e   a linear combin
-0000df30: 6174 696f 6e20 6f66 2074 6865 2074 656d  ation of the tem
-0000df40: 706c 6174 6573 2c20 636f 6e76 6f6c 7665  plates, convolve
-0000df50: 6420 7769 7468 2074 6865 2062 6573 740d  d with the best.
-0000df60: 0a20 2020 2066 6974 7469 6e67 204c 4f53  .    fitting LOS
-0000df70: 5644 2c20 6d75 6c74 6970 6c69 6564 2062  VD, multiplied b
-0000df80: 7920 7468 6520 6d75 6c74 6970 6c69 6361  y the multiplica
-0000df90: 7469 7665 2070 6f6c 796e 6f6d 6961 6c73  tive polynomials
-0000dfa0: 2061 6e64 0d0a 2020 2020 7769 7468 2073   and..    with s
-0000dfb0: 7562 7365 7175 656e 746c 7920 6164 6465  ubsequently adde
-0000dfc0: 6420 706f 6c79 6e6f 6d69 616c 2063 6f6e  d polynomial con
-0000dfd0: 7469 6e75 756d 2074 6572 6d73 206f 7220  tinuum terms or 
-0000dfe0: 736b 7920 636f 6d70 6f6e 656e 7473 2e0d  sky components..
-0000dff0: 0a2e 6368 6932 3a0d 0a20 2020 2054 6865  ..chi2:..    The
-0000e000: 2072 6564 7563 6564 2060 6063 6869 5e32   reduced ``chi^2
-0000e010: 6060 2028 6e61 6d65 6c79 2060 6063 6869  `` (namely ``chi
-0000e020: 5e32 2f44 4f46 6060 2920 6f66 2074 6865  ^2/DOF``) of the
-0000e030: 2066 6974 2c20 7768 6572 650d 0a20 2020   fit, where..   
-0000e040: 2060 6044 4f46 203d 2070 702e 646f 6660   ``DOF = pp.dof`
-0000e050: 6020 2028 6170 7072 6f78 696d 6174 656c  `  (approximatel
-0000e060: 7920 6060 444f 4620 7e20 7070 2e67 6f6f  y ``DOF ~ pp.goo
-0000e070: 6470 6978 656c 732e 7369 7a65 6060 292e  dpixels.size``).
-0000e080: 0d0a 0d0a 2020 2020 494d 504f 5254 414e  ....    IMPORTAN
-0000e090: 543a 2069 6620 6060 4368 695e 322f 444f  T: if ``Chi^2/DO
-0000e0a0: 4660 6020 6973 206e 6f74 207e 3120 6974  F`` is not ~1 it
-0000e0b0: 206d 6561 6e73 2074 6861 7420 7468 6520   means that the 
-0000e0c0: 6572 726f 7273 2061 7265 206e 6f74 0d0a  errors are not..
-0000e0d0: 2020 2020 7072 6f70 6572 6c79 2065 7374      properly est
-0000e0e0: 696d 6174 6564 2c20 6f72 2074 6861 7420  imated, or that 
-0000e0f0: 7468 6520 7465 6d70 6c61 7465 2069 7320  the template is 
-0000e100: 6261 6420 616e 6420 6974 2069 7320 2a6e  bad and it is *n
-0000e110: 6f74 2a20 7361 6665 2074 6f0d 0a20 2020  ot* safe to..   
-0000e120: 2073 6574 2074 6865 2060 6063 6c65 616e   set the ``clean
-0000e130: 6060 206b 6579 776f 7264 2e0d 0a2e 6475  `` keyword....du
-0000e140: 7374 3a0d 0a20 2020 204c 6973 7420 6f66  st:..    List of
-0000e150: 2064 6963 7469 6f6e 6172 6965 732c 206f   dictionaries, o
-0000e160: 6e65 2066 6f72 2065 6163 6820 6669 7474  ne for each fitt
-0000e170: 6564 206a 2d74 6820 6475 7374 2063 6f6d  ed j-th dust com
-0000e180: 706f 6e65 6e74 2e20 466f 720d 0a20 2020  ponent. For..   
-0000e190: 2065 6163 6820 6469 6374 696f 6e61 7279   each dictionary
-0000e1a0: 2c20 6060 6475 7374 5f6a 5b22 736f 6c22  , ``dust_j["sol"
-0000e1b0: 5d60 6020 636f 6e74 6169 6e73 2074 6865  ]`` contains the
-0000e1c0: 2062 6573 742d 6669 7474 696e 670d 0a20   best-fitting.. 
-0000e1d0: 2020 2070 6172 616d 6574 6572 206f 6620     parameter of 
-0000e1e0: 7468 6520 6174 7465 6e75 6174 696f 6e20  the attenuation 
-0000e1f0: 6375 7276 6520 6f66 2074 6861 7420 6475  curve of that du
-0000e200: 7374 2063 6f6d 706f 6e65 6e74 2e20 5468  st component. Th
-0000e210: 6520 6f74 6865 720d 0a20 2020 2066 6965  e other..    fie
-0000e220: 6c64 206f 6620 7468 6520 6469 6374 696f  ld of the dictio
-0000e230: 6e61 7279 2061 7265 2063 6f70 6965 6420  nary are copied 
-0000e240: 6672 6f6d 2074 6865 2069 6e70 7574 2074  from the input t
-0000e250: 6f20 7468 6520 6b65 7977 6f72 640d 0a20  o the keyword.. 
-0000e260: 2020 2060 6064 7573 7460 602e 0d0a 2e65     ``dust``....e
-0000e270: 7272 6f72 3a0d 0a20 2020 2054 6869 7320  rror:..    This 
-0000e280: 7661 7269 6162 6c65 2063 6f6e 7461 696e  variable contain
-0000e290: 7320 6120 7665 6374 6f72 206f 6620 2a66  s a vector of *f
-0000e2a0: 6f72 6d61 6c2a 2075 6e63 6572 7461 696e  ormal* uncertain
-0000e2b0: 7479 2028 6060 312a 7369 676d 6160 6029  ty (``1*sigma``)
-0000e2c0: 0d0a 2020 2020 666f 7220 7468 6520 6669  ..    for the fi
-0000e2d0: 7474 6564 2070 6172 616d 6574 6572 7320  tted parameters 
-0000e2e0: 696e 2074 6865 206f 7574 7075 7420 7665  in the output ve
-0000e2f0: 6374 6f72 2060 6073 6f6c 6060 2e0d 0a20  ctor ``sol``... 
-0000e300: 2020 2054 6865 7920 6172 6520 636f 6d70     They are comp
-0000e310: 7574 6564 2066 726f 6d20 7468 6520 6573  uted from the es
-0000e320: 7469 6d61 7465 6420 636f 7661 7269 616e  timated covarian
-0000e330: 6365 206d 6174 7269 7820 6f66 2074 6865  ce matrix of the
-0000e340: 2073 7461 6e64 6172 640d 0a20 2020 2065   standard..    e
-0000e350: 7272 6f72 7320 696e 2074 6865 2066 6974  rrors in the fit
-0000e360: 7465 6420 7061 7261 6d65 7465 7273 2061  ted parameters a
-0000e370: 7373 756d 696e 6720 6974 2069 7320 6469  ssuming it is di
-0000e380: 6167 6f6e 616c 2061 7420 7468 6520 6d69  agonal at the mi
-0000e390: 6e69 6d75 6d2e 0d0a 2020 2020 5468 6973  nimum...    This
-0000e3a0: 206f 7074 696f 6e20 6361 6e20 6265 2075   option can be u
-0000e3b0: 7365 6420 7768 656e 2073 7065 6564 2069  sed when speed i
-0000e3c0: 7320 6573 7365 6e74 6961 6c2c 2074 6f20  s essential, to 
-0000e3d0: 6f62 7461 696e 2061 6e20 6f72 6465 7220  obtain an order 
-0000e3e0: 6f66 0d0a 2020 2020 6d61 676e 6974 7564  of..    magnitud
-0000e3f0: 6520 6573 7469 6d61 7465 206f 6620 7468  e estimate of th
-0000e400: 6520 756e 6365 7274 6169 6e74 6965 732c  e uncertainties,
-0000e410: 2062 7574 2077 6520 2a73 7472 6f6e 676c   but we *strongl
-0000e420: 792a 2072 6563 6f6d 6d65 6e64 2074 6f0d  y* recommend to.
-0000e430: 0a20 2020 2072 756e 2062 6f6f 7473 7472  .    run bootstr
-0000e440: 6170 7069 6e67 2073 696d 756c 6174 696f  apping simulatio
-0000e450: 6e73 2074 6f20 6f62 7461 696e 206d 6f72  ns to obtain mor
-0000e460: 6520 7265 6c69 6162 6c65 2065 7272 6f72  e reliable error
-0000e470: 732e 2049 6e20 6661 6374 2c0d 0a20 2020  s. In fact,..   
-0000e480: 2074 6865 7365 2065 7272 6f72 7320 6361   these errors ca
-0000e490: 6e20 6265 2073 6576 6572 656c 7920 756e  n be severely un
-0000e4a0: 6465 7265 7374 696d 6174 6564 2069 6e20  derestimated in 
-0000e4b0: 7468 6520 7265 6769 6f6e 2077 6865 7265  the region where
-0000e4c0: 2074 6865 0d0a 2020 2020 7065 6e61 6c74   the..    penalt
-0000e4d0: 7920 6566 6665 6374 2069 7320 6d6f 7374  y effect is most
-0000e4e0: 2069 6d70 6f72 7461 6e74 2028 6060 7369   important (``si
-0000e4f0: 676d 6120 3c20 322a 7665 6c73 6361 6c65  gma < 2*velscale
-0000e500: 6060 292e 0d0a 0d0a 2020 2020 5468 6573  ``).....    Thes
-0000e510: 6520 6572 726f 7273 2061 7265 206d 6561  e errors are mea
-0000e520: 6e69 6e67 6c65 7373 2075 6e6c 6573 7320  ningless unless 
-0000e530: 6060 4368 695e 322f 444f 4620 7e20 3160  ``Chi^2/DOF ~ 1`
-0000e540: 602e 2048 6f77 6576 6572 2069 6620 6f6e  `. However if on
-0000e550: 650d 0a20 2020 202a 6173 7375 6d65 732a  e..    *assumes*
-0000e560: 2074 6861 7420 7468 6520 6669 7420 6973   that the fit is
-0000e570: 2067 6f6f 642c 2061 2063 6f72 7265 6374   good, a correct
-0000e580: 6564 2065 7374 696d 6174 6520 6f66 2074  ed estimate of t
-0000e590: 6865 2065 7272 6f72 7320 6973 3a3a 0d0a  he errors is::..
-0000e5a0: 0d0a 2020 2020 2020 2020 6572 726f 725f  ..        error_
-0000e5b0: 636f 7272 203d 2065 7272 6f72 2a73 7172  corr = error*sqr
-0000e5c0: 7428 6368 695e 322f 444f 4629 203d 2070  t(chi^2/DOF) = p
-0000e5d0: 702e 6572 726f 722a 7371 7274 2870 702e  p.error*sqrt(pp.
-0000e5e0: 6368 6932 292e 0d0a 0d0a 2020 2020 494d  chi2).....    IM
-0000e5f0: 504f 5254 414e 543a 2077 6865 6e20 7275  PORTANT: when ru
-0000e600: 6e6e 696e 6720 4d6f 6e74 6520 4361 726c  nning Monte Carl
-0000e610: 6f20 7369 6d75 6c61 7469 6f6e 7320 746f  o simulations to
-0000e620: 2064 6574 6572 6d69 6e65 2074 6865 2065   determine the e
-0000e630: 7272 6f72 2c0d 0a20 2020 2074 6865 2070  rror,..    the p
-0000e640: 656e 616c 7479 2028 6060 6269 6173 6060  enalty (``bias``
-0000e650: 2920 7368 6f75 6c64 2062 6520 7365 7420  ) should be set 
-0000e660: 746f 207a 6572 6f2c 206f 7220 6265 7474  to zero, or bett
-0000e670: 6572 2074 6f20 6120 7665 7279 2073 6d61  er to a very sma
-0000e680: 6c6c 0d0a 2020 2020 7661 6c75 652e 2053  ll..    value. S
-0000e690: 6565 2053 6563 7469 6f6e 2033 2e34 206f  ee Section 3.4 o
-0000e6a0: 6620 6043 6170 7065 6c6c 6172 6920 2620  f `Cappellari & 
-0000e6b0: 456d 7365 6c6c 656d 2028 3230 3034 2960  Emsellem (2004)`
-0000e6c0: 5f20 666f 7220 616e 0d0a 2020 2020 6578  _ for an..    ex
-0000e6d0: 706c 616e 6174 696f 6e2e 0d0a 2e67 6173  planation....gas
-0000e6e0: 5f62 6573 7466 6974 3a0d 0a20 2020 2049  _bestfit:..    I
-0000e6f0: 6620 6060 6761 735f 636f 6d70 6f6e 656e  f ``gas_componen
-0000e700: 7420 6973 206e 6f74 204e 6f6e 6560 602c  t is not None``,
-0000e710: 2074 6869 7320 6174 7472 6962 7574 6520   this attribute 
-0000e720: 7265 7475 726e 7320 7468 650d 0a20 2020  returns the..   
-0000e730: 2062 6573 742d 6669 7474 696e 6720 6761   best-fitting ga
-0000e740: 7320 656d 6973 7369 6f6e 2d6c 696e 6573  s emission-lines
-0000e750: 2073 7065 6374 7275 6d20 616c 6f6e 652e   spectrum alone.
-0000e760: 0d0a 2020 2020 5468 6520 6265 7374 2d66  ..    The best-f
-0000e770: 6974 7469 6e67 2073 7465 6c6c 6172 2073  itting stellar s
-0000e780: 7065 6374 7275 6d20 616c 6f6e 6520 6361  pectrum alone ca
-0000e790: 6e20 6265 2063 6f6d 7075 7465 6420 6173  n be computed as
-0000e7a0: 0d0a 2020 2020 6060 7374 6172 735f 6265  ..    ``stars_be
-0000e7b0: 7374 6669 7420 3d20 7070 2e62 6573 7466  stfit = pp.bestf
-0000e7c0: 6974 202d 2070 702e 6761 735f 6265 7374  it - pp.gas_best
-0000e7d0: 6669 7460 600d 0a2e 6761 735f 6265 7374  fit``...gas_best
-0000e7e0: 6669 745f 7465 6d70 6c61 7465 733a 0d0a  fit_templates:..
-0000e7f0: 2020 2020 4966 2060 6067 6173 5f63 6f6d      If ``gas_com
-0000e800: 706f 6e65 6e74 2069 7320 6e6f 7420 4e6f  ponent is not No
-0000e810: 6e65 6060 2c20 7468 6973 2061 7474 7269  ne``, this attri
-0000e820: 6275 7465 2072 6574 7572 6e73 2074 6865  bute returns the
-0000e830: 2069 6e64 6976 6964 7561 6c0d 0a20 2020   individual..   
-0000e840: 2062 6573 742d 6669 7474 696e 6720 6761   best-fitting ga
-0000e850: 7320 656d 6973 7369 6f6e 2d6c 696e 6573  s emission-lines
-0000e860: 2074 656d 706c 6174 6573 2061 7320 636f   templates as co
-0000e870: 6c75 6d6e 7320 6f66 2061 6e20 6172 7261  lumns of an arra
-0000e880: 792e 0d0a 2020 2020 4e6f 7465 2074 6861  y...    Note tha
-0000e890: 7420 6060 7070 2e67 6173 5f62 6573 7466  t ``pp.gas_bestf
-0000e8a0: 6974 203d 2070 702e 6761 735f 6265 7374  it = pp.gas_best
-0000e8b0: 6669 745f 7465 6d70 6c61 7465 732e 7375  fit_templates.su
-0000e8c0: 6d28 3129 6060 0d0a 2e67 6173 5f66 6c75  m(1)``...gas_flu
-0000e8d0: 783a 0d0a 2020 2020 5665 6374 6f72 2077  x:..    Vector w
-0000e8e0: 6974 6820 7468 6520 696e 7465 6772 6174  ith the integrat
-0000e8f0: 6564 2066 6c75 7820 2869 6e20 636f 756e  ed flux (in coun
-0000e900: 7473 2920 6f66 2061 6c6c 206c 696e 6573  ts) of all lines
-0000e910: 2073 6574 2061 730d 0a20 2020 2060 6054   set as..    ``T
-0000e920: 7275 6560 6020 696e 2074 6865 2069 6e70  rue`` in the inp
-0000e930: 7574 2060 6067 6173 5f63 6f6d 706f 6e65  ut ``gas_compone
-0000e940: 6e74 6060 206b 6579 776f 7264 2e20 5468  nt`` keyword. Th
-0000e950: 6973 2069 7320 7468 6520 666c 7578 206f  is is the flux o
-0000e960: 660d 0a20 2020 2069 6e64 6976 6964 7561  f..    individua
-0000e970: 6c20 6761 7320 7465 6d70 6c61 7465 732c  l gas templates,
-0000e980: 2077 6869 6368 206d 6179 2069 6e63 6c75   which may inclu
-0000e990: 6465 206d 756c 7469 706c 6520 6c69 6e65  de multiple line
-0000e9a0: 732e 0d0a 2020 2020 5468 6973 2069 6d70  s...    This imp
-0000e9b0: 6c69 6573 2074 6861 742c 2069 6620 6120  lies that, if a 
-0000e9c0: 6761 7320 7465 6d70 6c61 7465 2064 6573  gas template des
-0000e9d0: 6372 6962 6573 2061 2064 6f75 626c 6574  cribes a doublet
-0000e9e0: 2c20 7468 6520 666c 7578 2069 730d 0a20  , the flux is.. 
-0000e9f0: 2020 2074 6861 7420 6f66 2062 6f74 6820     that of both 
-0000ea00: 6c69 6e65 732e 2049 6620 7468 6520 4261  lines. If the Ba
-0000ea10: 6c6d 6572 2073 6572 6965 7320 6973 2069  lmer series is i
-0000ea20: 6e70 7574 2061 7320 6120 7369 6e67 6c65  nput as a single
-0000ea30: 2074 656d 706c 6174 652c 0d0a 2020 2020   template,..    
-0000ea40: 7468 6973 2069 7320 7468 6520 666c 7578  this is the flux
-0000ea50: 206f 6620 7468 6520 656e 7469 7265 2073   of the entire s
-0000ea60: 6572 6965 732e 0d0a 0d0a 2020 2020 5468  eries.....    Th
-0000ea70: 6520 7265 7475 726e 6564 2066 6c75 7865  e returned fluxe
-0000ea80: 7320 6172 6520 6e6f 7420 636f 7272 6563  s are not correc
-0000ea90: 7465 6420 696e 2061 6e79 2077 6179 2061  ted in any way a
-0000eaa0: 6e64 2069 6e20 7061 7274 6963 756c 6172  nd in particular
-0000eab0: 2c20 6e6f 0d0a 2020 2020 7265 6464 656e  , no..    redden
-0000eac0: 696e 6720 636f 7272 6563 7469 6f6e 2069  ing correction i
-0000ead0: 7320 6170 706c 6965 642e 2049 6e20 6f74  s applied. In ot
-0000eae0: 6865 7220 776f 7264 732c 2074 6865 2072  her words, the r
-0000eaf0: 6574 7572 6e65 640d 0a20 2020 2060 602e  eturned..    ``.
-0000eb00: 6761 735f 666c 7578 6060 2073 686f 756c  gas_flux`` shoul
-0000eb10: 6420 6265 2075 6e63 6861 6e67 6564 2c20  d be unchanged, 
-0000eb20: 7769 7468 696e 2074 6865 2065 7272 6f72  within the error
-0000eb30: 732c 2072 6567 6172 646c 6573 7320 6f66  s, regardless of
-0000eb40: 0d0a 2020 2020 7768 6574 6865 7220 7265  ..    whether re
-0000eb50: 6464 656e 696e 6720 6f72 206d 756c 7469  ddening or multi
-0000eb60: 706c 6963 6174 6976 6520 706f 6c79 6e6f  plicative polyno
-0000eb70: 6d69 616c 7320 7765 7265 2066 6974 7465  mials were fitte
-0000eb80: 6420 6279 2060 6070 5058 4660 600d 0a20  d by ``pPXF``.. 
-0000eb90: 2020 206f 7220 6e6f 742e 0d0a 0d0a 2020     or not.....  
-0000eba0: 2020 494d 504f 5254 414e 543a 2060 6070    IMPORTANT: ``p
-0000ebb0: 5058 4660 6020 6d61 6b65 7320 6e6f 2061  PXF`` makes no a
-0000ebc0: 7373 756d 7074 696f 6e73 2061 626f 7574  ssumptions about
-0000ebd0: 2074 6865 2069 6e70 7574 2066 6c75 7820   the input flux 
-0000ebe0: 756e 6974 733a 0d0a 2020 2020 5468 6520  units:..    The 
-0000ebf0: 7265 7475 726e 6564 2060 602e 6761 735f  returned ``.gas_
-0000ec00: 666c 7578 6060 2068 6173 2074 6865 2073  flux`` has the s
-0000ec10: 616d 6520 756e 6974 7320 616e 6420 7661  ame units and va
-0000ec20: 6c75 6573 206f 6e65 2077 6f75 6c64 0d0a  lues one would..
-0000ec30: 2020 2020 6d65 6173 7572 6520 2877 6974      measure (wit
-0000ec40: 6820 6c6f 7765 7220 6163 6375 7261 6379  h lower accuracy
-0000ec50: 2920 6279 2073 756d 6d69 6e67 2074 6865  ) by summing the
-0000ec60: 2070 6978 656c 7320 7661 6c75 6573 2c20   pixels values, 
-0000ec70: 7769 7468 696e 2074 6865 0d0a 2020 2020  within the..    
-0000ec80: 6769 7665 6e20 6761 7320 6c69 6e65 732c  given gas lines,
-0000ec90: 206f 6e20 7468 6520 636f 6e74 696e 7575   on the continuu
-0000eca0: 6d2d 7375 6274 7261 6374 6564 2069 6e70  m-subtracted inp
-0000ecb0: 7574 2067 616c 6178 7920 7370 6563 7472  ut galaxy spectr
-0000ecc0: 756d 2e0d 0a20 2020 2054 6869 7320 696d  um...    This im
-0000ecd0: 706c 6965 7320 7468 6174 2c20 6966 2074  plies that, if t
-0000ece0: 6865 2073 7065 6374 7275 6d20 6973 2069  he spectrum is i
-0000ecf0: 6e20 756e 6974 7320 6f66 2060 6065 7267  n units of ``erg
-0000ed00: 2f28 7320 636d 5e32 2041 2960 602c 0d0a  /(s cm^2 A)``,..
-0000ed10: 2020 2020 7468 6520 6060 2e67 6173 5f66      the ``.gas_f
-0000ed20: 6c75 7860 6020 7265 7475 726e 6564 2062  lux`` returned b
-0000ed30: 7920 6060 7050 5846 6060 2073 686f 756c  y ``pPXF`` shoul
-0000ed40: 6420 6265 206d 756c 7469 706c 6965 6420  d be multiplied 
-0000ed50: 6279 2074 6865 0d0a 2020 2020 7069 7865  by the..    pixe
-0000ed60: 6c20 7369 7a65 2069 6e20 416e 6773 7472  l size in Angstr
-0000ed70: 6f6d 2061 7420 7468 6520 6c69 6e65 2077  om at the line w
-0000ed80: 6176 656c 656e 6774 6820 746f 206f 6274  avelength to obt
-0000ed90: 6169 6e20 7468 6520 696e 7465 6772 6174  ain the integrat
-0000eda0: 6564 0d0a 2020 2020 6c69 6e65 2066 6c75  ed..    line flu
-0000edb0: 7820 696e 2075 6e69 7473 206f 6620 6060  x in units of ``
-0000edc0: 6572 672f 2873 2063 6d5e 3229 6060 2e0d  erg/(s cm^2)``..
-0000edd0: 0a0d 0a20 2020 204e 4f54 453a 2049 6620  ...    NOTE: If 
-0000ede0: 7468 6572 6520 6973 206e 6f20 6761 7320  there is no gas 
-0000edf0: 7265 6464 656e 696e 6720 616e 6420 6561  reddening and ea
-0000ee00: 6368 2069 6e70 7574 2067 6173 2074 656d  ch input gas tem
-0000ee10: 706c 6174 6520 7761 730d 0a20 2020 206e  plate was..    n
-0000ee20: 6f72 6d61 6c69 7a65 6420 746f 2060 6073  ormalized to ``s
-0000ee30: 756d 203d 2031 6060 2c20 7468 656e 0d0a  um = 1``, then..
-0000ee40: 2020 2020 6060 7070 2e67 6173 5f66 6c75      ``pp.gas_flu
-0000ee50: 7820 3d20 7070 2e77 6569 6768 7473 5b70  x = pp.weights[p
-0000ee60: 702e 6761 735f 636f 6d70 6f6e 656e 745d  p.gas_component]
-0000ee70: 6060 2e0d 0a0d 0a20 2020 2057 6865 6e20  ``.....    When 
-0000ee80: 6120 6761 7320 7465 6d70 6c61 7465 2069  a gas template i
-0000ee90: 7320 6964 656e 7469 6361 6c6c 7920 7a65  s identically ze
-0000eea0: 726f 2077 6974 6869 6e20 7468 6520 6669  ro within the fi
-0000eeb0: 7474 6564 2072 6567 696f 6e2c 2074 6865  tted region, the
-0000eec0: 6e0d 0a20 2020 2060 6070 702e 6761 735f  n..    ``pp.gas_
-0000eed0: 666c 7578 203d 2070 702e 6761 735f 666c  flux = pp.gas_fl
-0000eee0: 7578 5f65 7272 6f72 203d 206e 702e 6e61  ux_error = np.na
-0000eef0: 6e60 602e 2054 6865 2063 6f72 7265 7370  n``. The corresp
-0000ef00: 6f6e 6469 6e67 0d0a 2020 2020 636f 6d70  onding..    comp
-0000ef10: 6f6e 656e 7473 206f 6620 6060 7070 2e67  onents of ``pp.g
-0000ef20: 6173 5f7a 6572 6f5f 7465 6d70 6c61 7465  as_zero_template
-0000ef30: 6060 2061 7265 2073 6574 2074 6f20 6060  `` are set to ``
-0000ef40: 5472 7565 6060 2e20 5468 6573 650d 0a20  True``. These.. 
-0000ef50: 2020 2060 606e 702e 6e61 6e60 6020 7661     ``np.nan`` va
-0000ef60: 6c75 6573 2061 7265 2073 6574 2061 7420  lues are set at 
-0000ef70: 7468 6520 656e 6420 6f66 2074 6865 2063  the end of the c
-0000ef80: 616c 6375 6c61 7469 6f6e 2074 6f20 666c  alculation to fl
-0000ef90: 6167 2074 6865 0d0a 2020 2020 756e 6465  ag the..    unde
-0000efa0: 6669 6e65 6420 7661 6c75 6573 2e20 5468  fined values. Th
-0000efb0: 6573 6520 666c 6167 7320 6765 6e65 7261  ese flags genera
-0000efc0: 6c6c 7920 696e 6469 6361 7465 2074 6861  lly indicate tha
-0000efd0: 7420 736f 6d65 206f 6620 7468 6520 6761  t some of the ga
-0000efe0: 730d 0a20 2020 2074 656d 706c 6174 6573  s..    templates
-0000eff0: 2070 6173 7365 6420 746f 2060 6070 5058   passed to ``pPX
-0000f000: 4660 6020 636f 6e73 6973 7420 6f66 2067  F`` consist of g
-0000f010: 6173 2065 6d69 7373 696f 6e20 6c69 6e65  as emission line
-0000f020: 7320 7468 6174 2066 616c 6c0d 0a20 2020  s that fall..   
-0000f030: 206f 7574 7369 6465 2074 6865 2066 6974   outside the fit
-0000f040: 7465 6420 7761 7665 6c65 6e67 7468 2072  ted wavelength r
-0000f050: 616e 6765 206f 7220 7769 7468 696e 2061  ange or within a
-0000f060: 206d 6173 6b65 6420 7370 6563 7472 616c   masked spectral
-0000f070: 2072 6567 696f 6e2e 0d0a 2020 2020 5468   region...    Th
-0000f080: 6573 6520 6060 6e70 2e6e 616e 6060 2064  ese ``np.nan`` d
-0000f090: 6f20 2a6e 6f74 2a20 696e 6469 6361 7465  o *not* indicate
-0000f0a0: 206e 756d 6572 6963 616c 2069 7373 7565   numerical issue
-0000f0b0: 7320 7769 7468 2074 6865 2061 6374 7561  s with the actua
-0000f0c0: 6c0d 0a20 2020 2060 6070 5058 4660 6020  l..    ``pPXF`` 
-0000f0d0: 6361 6c63 756c 6174 696f 6e20 616e 6420  calculation and 
-0000f0e0: 7468 6520 7265 7374 206f 6620 7468 6520  the rest of the 
-0000f0f0: 6060 7050 5846 6060 206f 7574 7075 7420  ``pPXF`` output 
-0000f100: 6973 2072 656c 6961 626c 652e 0d0a 2e67  is reliable....g
-0000f110: 6173 5f66 6c75 785f 6572 726f 723a 0d0a  as_flux_error:..
-0000f120: 2020 2020 2a46 6f72 6d61 6c2a 2075 6e63      *Formal* unc
-0000f130: 6572 7461 696e 7479 2028 6060 312a 7369  ertainty (``1*si
-0000f140: 676d 6160 6029 2066 6f72 2074 6865 2071  gma``) for the q
-0000f150: 7561 6e74 6974 7920 6060 7070 2e67 6173  uantity ``pp.gas
-0000f160: 5f66 6c75 7860 602c 2069 6e0d 0a20 2020  _flux``, in..   
-0000f170: 2074 6865 2073 616d 6520 756e 6974 7320   the same units 
-0000f180: 6173 2074 6865 2067 6173 2066 6c75 7865  as the gas fluxe
-0000f190: 732e 0d0a 0d0a 2020 2020 5468 6973 2065  s.....    This e
-0000f1a0: 7272 6f72 2069 7320 6170 7072 6f78 696d  rror is approxim
-0000f1b0: 6174 6520 6173 2069 7420 6967 6e6f 7265  ate as it ignore
-0000f1c0: 7320 7468 6520 636f 7661 7269 616e 6365  s the covariance
-0000f1d0: 2062 6574 7765 656e 2074 6865 2067 6173   between the gas
-0000f1e0: 0d0a 2020 2020 666c 7578 2061 6e64 2061  ..    flux and a
-0000f1f0: 6e79 206e 6f6e 2d6c 696e 6561 7220 7061  ny non-linear pa
-0000f200: 7261 6d65 7465 722e 2042 6f6f 7473 7472  rameter. Bootstr
-0000f210: 6170 7069 6e67 2063 616e 2062 6520 7573  apping can be us
-0000f220: 6564 2066 6f72 206d 6f72 650d 0a20 2020  ed for more..   
-0000f230: 2061 6363 7572 6174 6520 6572 726f 7273   accurate errors
-0000f240: 2e0d 0a0d 0a20 2020 2054 6865 7365 2065  .....    These e
-0000f250: 7272 6f72 7320 6172 6520 6d65 616e 696e  rrors are meanin
-0000f260: 676c 6573 7320 756e 6c65 7373 2060 6043  gless unless ``C
-0000f270: 6869 5e32 2f44 4f46 207e 2031 6060 2e20  hi^2/DOF ~ 1``. 
-0000f280: 486f 7765 7665 7220 6966 206f 6e65 0d0a  However if one..
-0000f290: 2020 2020 2a61 7373 756d 6573 2a20 7468      *assumes* th
-0000f2a0: 6174 2074 6865 2066 6974 2069 7320 676f  at the fit is go
-0000f2b0: 6f64 2c20 6120 636f 7272 6563 7465 6420  od, a corrected 
-0000f2c0: 6573 7469 6d61 7465 206f 6620 7468 6520  estimate of the 
-0000f2d0: 6572 726f 7273 2069 733a 3a0d 0a0d 0a20  errors is::.... 
-0000f2e0: 2020 2020 2020 2067 6173 5f66 6c75 785f         gas_flux_
-0000f2f0: 6572 726f 725f 636f 7272 203d 2067 6173  error_corr = gas
-0000f300: 5f66 6c75 785f 6572 726f 722a 7371 7274  _flux_error*sqrt
-0000f310: 2863 6869 5e32 2f44 4f46 290d 0a20 2020  (chi^2/DOF)..   
-0000f320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f330: 2020 2020 2020 2020 203d 2070 702e 6761           = pp.ga
-0000f340: 735f 666c 7578 5f65 7272 6f72 2a73 7172  s_flux_error*sqr
-0000f350: 7428 7070 2e63 6869 3229 2e0d 0a0d 0a2e  t(pp.chi2)......
-0000f360: 6761 735f 6d70 6f6c 793a 0d0a 2020 2020  gas_mpoly:..    
-0000f370: 7665 6374 6f72 2077 6974 6820 7468 6520  vector with the 
-0000f380: 6265 7374 2d66 6974 7469 6e67 2067 6173  best-fitting gas
-0000f390: 2072 6564 6465 6e69 6e67 2063 7572 7665   reddening curve
-0000f3a0: 2e0d 0a2e 6761 735f 7265 6464 656e 696e  ....gas_reddenin
-0000f3b0: 673a 0d0a 2020 2020 4265 7374 2066 6974  g:..    Best fit
-0000f3c0: 7469 6e67 2060 6041 5f56 6060 2076 616c  ting ``A_V`` val
-0000f3d0: 7565 2069 6620 7468 6520 6060 6761 735f  ue if the ``gas_
-0000f3e0: 7265 6464 656e 696e 6760 6020 6b65 7977  reddening`` keyw
-0000f3f0: 6f72 6420 6973 2073 6574 2e0d 0a20 2020  ord is set...   
-0000f400: 2054 6869 7320 6973 2065 7370 6563 6961   This is especia
-0000f410: 6c6c 7920 7573 6566 756c 2077 6865 6e20  lly useful when 
-0000f420: 7468 6520 4261 6c6d 6572 2073 6572 6965  the Balmer serie
-0000f430: 7320 6973 2069 6e70 7574 2061 7320 6120  s is input as a 
-0000f440: 7369 6e67 6c65 0d0a 2020 2020 7465 6d70  single..    temp
-0000f450: 6c61 7465 2077 6974 6820 616e 2061 7373  late with an ass
-0000f460: 756d 6564 2074 6865 6f72 6574 6963 616c  umed theoretical
-0000f470: 6c79 2070 7265 6469 6374 6564 2064 6563  ly predicted dec
-0000f480: 7265 6d65 6e74 2065 2e67 2e20 7573 696e  rement e.g. usin
-0000f490: 670d 0a20 2020 2060 6065 6d69 7373 696f  g..    ``emissio
-0000f4a0: 6e5f 6c69 6e65 7328 2e2e 2e2c 2074 6965  n_lines(..., tie
-0000f4b0: 5f62 616c 6d65 723d 5472 7565 2960 6020  _balmer=True)`` 
-0000f4c0: 696e 2060 6070 7078 662e 7070 7866 5f75  in ``ppxf.ppxf_u
-0000f4d0: 7469 6c60 6020 746f 0d0a 2020 2020 636f  til`` to..    co
-0000f4e0: 6d70 7574 6520 7468 6520 6761 7320 7465  mpute the gas te
-0000f4f0: 6d70 6c61 7465 732e 0d0a 2e67 6173 5f7a  mplates....gas_z
-0000f500: 6572 6f5f 7465 6d70 6c61 7465 3a0d 0a20  ero_template:.. 
-0000f510: 2020 2076 6563 746f 7220 6f66 2073 697a     vector of siz
-0000f520: 6520 6060 6761 735f 636f 6d70 6f6e 656e  e ``gas_componen
-0000f530: 742e 7375 6d28 2960 6020 7365 7420 746f  t.sum()`` set to
-0000f540: 2060 6054 7275 6560 6020 7768 6572 650d   ``True`` where.
-0000f550: 0a20 2020 2074 6865 2067 6173 2074 656d  .    the gas tem
-0000f560: 706c 6174 6520 7761 7320 6964 656e 7469  plate was identi
-0000f570: 6361 6c6c 7920 7a65 726f 2077 6974 6869  cally zero withi
-0000f580: 6e20 7468 6520 6669 7474 6564 2072 6567  n the fitted reg
-0000f590: 696f 6e2e 0d0a 2020 2020 466f 7220 7468  ion...    For th
-0000f5a0: 6f73 6520 6761 7320 636f 6d70 6f6e 656e  ose gas componen
-0000f5b0: 7473 2060 6070 702e 6761 735f 666c 7578  ts ``pp.gas_flux
-0000f5c0: 203d 2070 702e 6761 735f 666c 7578 5f65   = pp.gas_flux_e
-0000f5d0: 7272 6f72 203d 206e 702e 6e61 6e60 602e  rror = np.nan``.
-0000f5e0: 0d0a 2020 2020 5468 6573 6520 666c 6167  ..    These flag
-0000f5f0: 7320 6765 6e65 7261 6c6c 7920 696e 6469  s generally indi
-0000f600: 6361 7465 2074 6861 7420 736f 6d65 206f  cate that some o
-0000f610: 6620 7468 6520 6761 7320 7465 6d70 6c61  f the gas templa
-0000f620: 7465 7320 7061 7373 6564 2074 6f0d 0a20  tes passed to.. 
-0000f630: 2020 2060 6070 5058 4660 6020 636f 6e73     ``pPXF`` cons
-0000f640: 6973 7420 6f66 2067 6173 2065 6d69 7373  ist of gas emiss
-0000f650: 696f 6e20 6c69 6e65 7320 7468 6174 2066  ion lines that f
-0000f660: 616c 6c20 6f75 7473 6964 6520 7468 6520  all outside the 
-0000f670: 6669 7474 6564 0d0a 2020 2020 7761 7665  fitted..    wave
-0000f680: 6c65 6e67 7468 2072 616e 6765 206f 7220  length range or 
-0000f690: 7769 7468 696e 2061 206d 6173 6b65 6420  within a masked 
-0000f6a0: 7370 6563 7472 616c 2072 6567 696f 6e2e  spectral region.
-0000f6b0: 0d0a 2e67 6f6f 6470 6978 656c 733a 0d0a  ...goodpixels:..
-0000f6c0: 2020 2020 496e 7465 6765 7220 7665 6374      Integer vect
-0000f6d0: 6f72 2063 6f6e 7461 696e 696e 6720 7468  or containing th
-0000f6e0: 6520 696e 6469 6365 7320 6f66 2074 6865  e indices of the
-0000f6f0: 2067 6f6f 6420 7069 7865 6c73 2069 6e20   good pixels in 
-0000f700: 7468 6520 6669 742e 0d0a 2020 2020 5468  the fit...    Th
-0000f710: 6973 2076 6563 746f 7220 6973 2061 2063  is vector is a c
-0000f720: 6f70 7920 6f66 2074 6865 2069 6e70 7574  opy of the input
-0000f730: 2060 6067 6f6f 6470 6978 656c 7360 6020   ``goodpixels`` 
-0000f740: 6966 2060 6063 6c65 616e 203d 2046 616c  if ``clean = Fal
-0000f750: 7365 6060 0d0a 2020 2020 6f74 6865 7277  se``..    otherw
-0000f760: 6973 6520 6974 2077 696c 6c20 6265 2075  ise it will be u
-0000f770: 7064 6174 6564 2062 7920 7265 6d6f 7669  pdated by removi
-0000f780: 6e67 2074 6865 2064 6574 6563 7465 6420  ng the detected 
-0000f790: 6f75 746c 6965 7273 2e0d 0a2e 6d61 7472  outliers....matr
-0000f7a0: 6978 3a0d 0a20 2020 2050 7265 6469 6374  ix:..    Predict
-0000f7b0: 696f 6e20 6060 6d61 7472 6978 5b6e 5f70  ion ``matrix[n_p
-0000f7c0: 6978 656c 732c 2064 6567 7265 6520 2b20  ixels, degree + 
-0000f7d0: 6e5f 7465 6d70 6c61 7465 7320 2b20 6e5f  n_templates + n_
-0000f7e0: 736b 795d 6060 206f 6620 7468 650d 0a20  sky]`` of the.. 
-0000f7f0: 2020 206c 696e 6561 7220 7379 7374 656d     linear system
-0000f800: 2e0d 0a0d 0a20 2020 2060 6070 702e 6d61  .....    ``pp.ma
-0000f810: 7472 6978 5b6e 5f70 6978 656c 732c 203a  trix[n_pixels, :
-0000f820: 2064 6567 7265 655d 6060 2063 6f6e 7461   degree]`` conta
-0000f830: 696e 7320 7468 6520 6164 6469 7469 7665  ins the additive
-0000f840: 2070 6f6c 796e 6f6d 6961 6c73 2069 660d   polynomials if.
-0000f850: 0a20 2020 2060 6064 6567 7265 6520 3e3d  .    ``degree >=
-0000f860: 2030 6060 2e0d 0a0d 0a20 2020 2060 6070   0``.....    ``p
-0000f870: 702e 6d61 7472 6978 5b6e 5f70 6978 656c  p.matrix[n_pixel
-0000f880: 732c 2064 6567 7265 6520 3a20 6465 6772  s, degree : degr
-0000f890: 6565 202b 206e 5f74 656d 706c 6174 6573  ee + n_templates
-0000f8a0: 5d60 6020 636f 6e74 6169 6e73 2074 6865  ]`` contains the
-0000f8b0: 0d0a 2020 2020 7374 656c 6c61 722f 6761  ..    stellar/ga
-0000f8c0: 7320 7465 6d70 6c61 7465 7320 636f 6e76  s templates conv
-0000f8d0: 6f6c 7665 6420 6279 2074 6865 204c 4f53  olved by the LOS
-0000f8e0: 5644 2c20 616e 6420 6d75 6c74 6970 6c69  VD, and multipli
-0000f8f0: 6564 2062 7920 7468 650d 0a20 2020 206d  ed by the..    m
-0000f900: 756c 7469 706c 6963 6174 6976 6520 706f  ultiplicative po
-0000f910: 6c79 6e6f 6d69 616c 7320 6966 2060 606d  lynomials if ``m
-0000f920: 6465 6772 6565 203e 2030 6060 2e0d 0a2e  degree > 0``....
-0000f930: 6d70 6f6c 793a 0d0a 2020 2020 4265 7374  mpoly:..    Best
-0000f940: 2066 6974 7469 6e67 206d 756c 7469 706c   fitting multipl
-0000f950: 6963 6174 6976 6520 706f 6c79 6e6f 6d69  icative polynomi
-0000f960: 616c 2028 6f72 2072 6564 6465 6e69 6e67  al (or reddening
-0000f970: 2063 7572 7665 2077 6865 6e0d 0a20 2020   curve when..   
-0000f980: 2060 6072 6564 6465 6e69 6e67 6060 2069   ``reddening`` i
-0000f990: 7320 7365 7429 2e0d 0a2e 6d70 6f6c 7977  s set)....mpolyw
-0000f9a0: 6569 6768 7473 3a0d 0a20 2020 2054 6869  eights:..    Thi
-0000f9b0: 7320 6973 206c 6172 6765 6c79 2073 7570  s is largely sup
-0000f9c0: 6572 7365 6465 6420 6279 2074 6865 2060  erseded by the `
-0000f9d0: 602e 6d70 6f6c 7960 6020 6174 7472 6962  `.mpoly`` attrib
-0000f9e0: 7574 6520 6162 6f76 652e 0d0a 0d0a 2020  ute above.....  
-0000f9f0: 2020 5768 656e 2060 606d 6465 6772 6565    When ``mdegree
-0000fa00: 203e 2030 6060 2074 6869 7320 636f 6e74   > 0`` this cont
-0000fa10: 6169 6e73 2069 6e20 6f75 7470 7574 2074  ains in output t
-0000fa20: 6865 2063 6f65 6666 6963 6965 6e74 7320  he coefficients 
-0000fa30: 6f66 2074 6865 0d0a 2020 2020 6d75 6c74  of the..    mult
-0000fa40: 6970 6c69 6361 7469 7665 204c 6567 656e  iplicative Legen
-0000fa50: 6472 6520 706f 6c79 6e6f 6d69 616c 7320  dre polynomials 
-0000fa60: 6f66 206f 7264 6572 2060 6031 2c20 322c  of order ``1, 2,
-0000fa70: 2e2e 2e20 6d64 6567 7265 6560 602e 0d0a  ... mdegree``...
-0000fa80: 2020 2020 5468 6520 706f 6c79 6e6f 6d69      The polynomi
-0000fa90: 616c 2063 616e 2062 6520 6578 706c 6963  al can be explic
-0000faa0: 6974 6c79 2065 7661 6c75 6174 6564 2061  itly evaluated a
-0000fab0: 733a 3a0d 0a0d 0a20 2020 2020 2020 2066  s::....        f
-0000fac0: 726f 6d20 6e75 6d70 792e 706f 6c79 6e6f  rom numpy.polyno
-0000fad0: 6d69 616c 2069 6d70 6f72 7420 6c65 6765  mial import lege
-0000fae0: 6e64 7265 0d0a 2020 2020 2020 2020 7820  ndre..        x 
-0000faf0: 3d20 6e70 2e6c 696e 7370 6163 6528 2d31  = np.linspace(-1
-0000fb00: 2c20 312c 206c 656e 2867 616c 6178 7929  , 1, len(galaxy)
-0000fb10: 290d 0a20 2020 2020 2020 206d 706f 6c79  )..        mpoly
-0000fb20: 203d 206c 6567 656e 6472 652e 6c65 6776   = legendre.legv
-0000fb30: 616c 2878 2c20 6e70 2e61 7070 656e 6428  al(x, np.append(
-0000fb40: 312c 2070 702e 6d70 6f6c 7977 6569 6768  1, pp.mpolyweigh
-0000fb50: 7473 2929 0d0a 0d0a 2020 2020 5768 656e  ts))....    When
-0000fb60: 2060 6074 7269 6720 3d20 5472 7565 6060   ``trig = True``
-0000fb70: 2074 6865 2070 6f6c 796e 6f6d 6961 6c20   the polynomial 
-0000fb80: 6973 2065 7661 6c75 6174 6564 2061 733a  is evaluated as:
-0000fb90: 3a0d 0a0d 0a20 2020 2020 2020 206d 706f  :....        mpo
-0000fba0: 6c79 203d 2070 702e 7472 6967 7661 6c28  ly = pp.trigval(
-0000fbb0: 782c 206e 702e 6170 7065 6e64 2831 2c20  x, np.append(1, 
-0000fbc0: 7070 2e6d 706f 6c79 7765 6967 6874 7329  pp.mpolyweights)
-0000fbd0: 290d 0a0d 0a2e 7068 6f74 5f62 6573 7466  ).....phot_bestf
-0000fbe0: 6974 3a20 6172 7261 795f 6c69 6b65 2077  it: array_like w
-0000fbf0: 6974 6820 7368 6170 6520 286e 5f70 686f  ith shape (n_pho
-0000fc00: 7429 0d0a 2020 2020 5768 656e 2060 6070  t)..    When ``p
-0000fc10: 686f 7460 6020 6973 2067 6976 656e 2c20  hot`` is given, 
-0000fc20: 7468 656e 2074 6869 7320 6174 7472 6962  then this attrib
-0000fc30: 7574 6520 636f 6e74 6169 6e73 2074 6865  ute contains the
-0000fc40: 2062 6573 7420 6669 7474 696e 670d 0a20   best fitting.. 
-0000fc50: 2020 2066 6c75 7865 7320 696e 2074 6865     fluxes in the
-0000fc60: 2070 686f 746f 6d65 7472 6963 2062 616e   photometric ban
-0000fc70: 6473 2067 6976 656e 2061 7320 696e 7075  ds given as inpu
-0000fc80: 7420 696e 2060 6070 686f 745f 6761 6c61  t in ``phot_gala
-0000fc90: 7879 6060 2e0d 0a2e 706c 6f74 3a20 6675  xy``....plot: fu
-0000fca0: 6e63 7469 6f6e 0d0a 2020 2020 4361 6c6c  nction..    Call
-0000fcb0: 2074 6865 206d 6574 686f 6420 6675 6e63   the method func
-0000fcc0: 7469 6f6e 2060 6070 702e 706c 6f74 2829  tion ``pp.plot()
-0000fcd0: 6060 2061 6674 6572 2074 6865 2063 616c  `` after the cal
-0000fce0: 6c20 746f 0d0a 2020 2020 6060 7070 203d  l to..    ``pp =
-0000fcf0: 2070 7078 6628 2e2e 2e29 6060 2074 6f20   ppxf(...)`` to 
-0000fd00: 7072 6f64 7563 6520 6120 706c 6f74 206f  produce a plot o
-0000fd10: 6620 7468 6520 6265 7374 2066 6974 2e20  f the best fit. 
-0000fd20: 5468 6973 2069 7320 616e 0d0a 2020 2020  This is an..    
-0000fd30: 616c 7465 726e 6174 6976 6520 746f 2063  alternative to c
-0000fd40: 616c 6c69 6e67 2060 6070 7020 3d20 7070  alling ``pp = pp
-0000fd50: 7866 282e 2e2e 2c20 706c 6f74 3d54 7275  xf(..., plot=Tru
-0000fd60: 6529 6060 2e0d 0a0d 0a20 2020 2055 7365  e)``.....    Use
-0000fd70: 2074 6865 2063 6f6d 6d61 6e64 2060 6070   the command ``p
-0000fd80: 702e 706c 6f74 2867 6173 5f63 6c69 703d  p.plot(gas_clip=
-0000fd90: 5472 7565 2960 6020 746f 2073 6361 6c65  True)`` to scale
-0000fda0: 2074 6865 2070 6c6f 7420 6261 7365 6420   the plot based 
-0000fdb0: 6f6e 0d0a 2020 2020 7468 6520 7374 656c  on..    the stel
-0000fdc0: 6c61 7220 636f 6e74 696e 7575 6d20 616c  lar continuum al
-0000fdd0: 6f6e 652c 2077 6869 6c65 2061 6c6c 6f77  one, while allow
-0000fde0: 696e 6720 666f 7220 7468 6520 6761 7320  ing for the gas 
-0000fdf0: 656d 6973 7369 6f6e 206c 696e 6573 0d0a  emission lines..
-0000fe00: 2020 2020 746f 2067 6f20 6f75 7473 6964      to go outsid
-0000fe10: 6520 7468 6520 706c 6f74 7469 6e67 2072  e the plotting r
-0000fe20: 6567 696f 6e2e 2054 6869 7320 6973 2075  egion. This is u
-0000fe30: 7365 6675 6c20 746f 2069 6e73 7065 6374  seful to inspect
-0000fe40: 2074 6865 2066 6974 0d0a 2020 2020 746f   the fit..    to
-0000fe50: 2074 6865 2073 7465 6c6c 6172 2063 6f6e   the stellar con
-0000fe60: 7469 6e75 756d 2c20 696e 2074 6865 2070  tinuum, in the p
-0000fe70: 7265 7365 6e63 6520 6f66 2073 7472 6f6e  resence of stron
-0000fe80: 6720 6761 7320 656d 6973 7369 6f6e 206c  g gas emission l
-0000fe90: 696e 6573 2e0d 0a20 2020 2054 6869 7320  ines...    This 
-0000fea0: 6861 7320 6566 6665 6374 206f 6e6c 7920  has effect only 
-0000feb0: 6966 2060 6067 6173 5f63 6f6d 706f 6e65  if ``gas_compone
-0000fec0: 6e74 2069 7320 6e6f 7420 4e6f 6e65 6060  nt is not None``
-0000fed0: 2e0d 0a0d 0a20 2020 2055 7365 2074 6865  .....    Use the
-0000fee0: 2063 6f6d 6d61 6e64 2060 6070 702e 706c   command ``pp.pl
-0000fef0: 6f74 282e 2e2e 2c20 7370 6563 3d54 7275  ot(..., spec=Tru
-0000ff00: 6529 6060 2074 6f20 696e 636c 7564 6520  e)`` to include 
-0000ff10: 7468 6520 6761 6c61 7879 0d0a 2020 2020  the galaxy..    
-0000ff20: 7370 6563 7472 756d 2069 6e20 7468 6520  spectrum in the 
-0000ff30: 706c 6f74 2061 6e64 2060 6070 702e 706c  plot and ``pp.pl
-0000ff40: 6f74 282e 2e2e 2c20 7068 6f74 3d54 7275  ot(..., phot=Tru
-0000ff50: 6529 6060 2074 6f20 696e 636c 7564 6520  e)`` to include 
-0000ff60: 7468 650d 0a20 2020 2070 686f 746f 6d65  the..    photome
-0000ff70: 7472 6963 206d 6561 7375 7265 6d65 6e74  tric measurement
-0000ff80: 732e 2046 6f72 2065 7861 6d70 6c65 2c20  s. For example, 
-0000ff90: 7768 656e 2066 6974 7469 6e67 2073 7065  when fitting spe
-0000ffa0: 6374 7261 2061 6e64 0d0a 2020 2020 7068  ctra and..    ph
-0000ffb0: 6f74 6f6d 6574 7279 2074 6f67 6574 6865  otometry togethe
-0000ffc0: 722c 206f 6e65 2063 616e 2075 7365 2060  r, one can use `
-0000ffd0: 6070 702e 706c 6f74 2870 686f 743d 5472  `pp.plot(phot=Tr
-0000ffe0: 7565 2c20 7370 6563 3d46 616c 7365 2960  ue, spec=False)`
-0000fff0: 600d 0a20 2020 2074 6f20 706c 6f74 2074  `..    to plot t
-00010000: 6865 2070 686f 746f 6d65 7472 7920 616c  he photometry al
-00010010: 6f6e 6520 616e 6420 6060 7070 2e70 6c6f  one and ``pp.plo
-00010020: 7428 7068 6f74 3d46 616c 7365 2c20 7370  t(phot=False, sp
-00010030: 6563 3d54 7275 6529 6060 0d0a 2020 2020  ec=True)``..    
-00010040: 746f 2070 6c6f 7420 7468 6520 7370 6563  to plot the spec
-00010050: 7472 756d 2061 6c6f 6e65 2e20 4279 2064  trum alone. By d
-00010060: 6566 6175 6c74 2062 6f74 6820 7468 6520  efault both the 
-00010070: 7370 6563 7472 756d 2061 6e64 2070 686f  spectrum and pho
-00010080: 746f 6d65 7472 790d 0a20 2020 2061 7265  tometry..    are
-00010090: 2069 6e63 6c75 6465 6420 696e 2061 2073   included in a s
-000100a0: 696e 676c 6520 706c 6f74 2e0d 0a2e 706f  ingle plot....po
-000100b0: 6c79 7765 6967 6874 733a 0d0a 2020 2020  lyweights:..    
-000100c0: 5468 6973 2069 7320 6c61 7267 656c 7920  This is largely 
-000100d0: 7375 7065 7273 6564 6564 2062 7920 7468  superseded by th
-000100e0: 6520 6060 2e61 706f 6c79 6060 2061 7474  e ``.apoly`` att
-000100f0: 7269 6275 7465 2061 626f 7665 2e0d 0a0d  ribute above....
-00010100: 0a20 2020 2057 6865 6e20 6060 6465 6772  .    When ``degr
-00010110: 6565 203e 3d20 3060 6020 636f 6e74 6169  ee >= 0`` contai
-00010120: 6e73 2074 6865 2077 6569 6768 7473 206f  ns the weights o
-00010130: 6620 7468 6520 6164 6469 7469 7665 204c  f the additive L
-00010140: 6567 656e 6472 650d 0a20 2020 2070 6f6c  egendre..    pol
-00010150: 796e 6f6d 6961 6c73 206f 6620 6f72 6465  ynomials of orde
-00010160: 7220 6060 302c 2031 2c2e 2e2e 2064 6567  r ``0, 1,... deg
-00010170: 7265 6560 602e 2054 6865 2062 6573 742d  ree``. The best-
-00010180: 6669 7474 696e 6720 6164 6469 7469 7665  fitting additive
-00010190: 0d0a 2020 2020 706f 6c79 6e6f 6d69 616c  ..    polynomial
-000101a0: 2063 616e 2062 6520 6578 706c 6963 6974   can be explicit
-000101b0: 6c79 2065 7661 6c75 6174 6564 2061 733a  ly evaluated as:
-000101c0: 3a0d 0a0d 0a20 2020 2020 2020 2066 726f  :....        fro
-000101d0: 6d20 6e75 6d70 792e 706f 6c79 6e6f 6d69  m numpy.polynomi
-000101e0: 616c 2069 6d70 6f72 7420 6c65 6765 6e64  al import legend
-000101f0: 7265 0d0a 2020 2020 2020 2020 7820 3d20  re..        x = 
-00010200: 6e70 2e6c 696e 7370 6163 6528 2d31 2c20  np.linspace(-1, 
-00010210: 312c 206c 656e 2867 616c 6178 7929 290d  1, len(galaxy)).
-00010220: 0a20 2020 2020 2020 2061 706f 6c79 203d  .        apoly =
-00010230: 206c 6567 656e 6472 652e 6c65 6776 616c   legendre.legval
-00010240: 2878 2c20 7070 2e70 6f6c 7977 6569 6768  (x, pp.polyweigh
-00010250: 7473 290d 0a0d 0a20 2020 2057 6865 6e20  ts)....    When 
-00010260: 6060 7472 6967 3d54 7275 6560 6020 7468  ``trig=True`` th
-00010270: 6520 706f 6c79 6e6f 6d69 616c 2069 7320  e polynomial is 
-00010280: 6576 616c 7561 7465 6420 6173 3a3a 0d0a  evaluated as::..
-00010290: 0d0a 2020 2020 2020 2020 6170 6f6c 7920  ..        apoly 
-000102a0: 3d20 7070 2e74 7269 6776 616c 2878 2c20  = pp.trigval(x, 
-000102b0: 7070 2e70 6f6c 7977 6569 6768 7473 290d  pp.polyweights).
-000102c0: 0a0d 0a20 2020 2057 6865 6e20 646f 696e  ...    When doin
-000102d0: 6720 6120 7477 6f2d 7369 6465 6420 6669  g a two-sided fi
-000102e0: 7474 696e 6720 2873 6565 2068 656c 7020  tting (see help 
-000102f0: 666f 7220 6060 6761 6c61 7879 6060 2070  for ``galaxy`` p
-00010300: 6172 616d 6574 6572 292c 2074 6865 0d0a  arameter), the..
-00010310: 2020 2020 6164 6469 7469 7665 2070 6f6c      additive pol
-00010320: 796e 6f6d 6961 6c73 2061 7265 2061 6c6c  ynomials are all
-00010330: 6f77 6564 2074 6f20 6265 2064 6966 6665  owed to be diffe
-00010340: 7265 6e74 2066 6f72 2074 6865 206c 6566  rent for the lef
-00010350: 7420 616e 6420 7269 6768 740d 0a20 2020  t and right..   
-00010360: 2073 7065 6374 7275 6d2e 2049 6e20 7468   spectrum. In th
-00010370: 6174 2063 6173 652c 2074 6865 206f 7574  at case, the out
-00010380: 7075 7420 7765 6967 6874 7320 6f66 2074  put weights of t
-00010390: 6865 2061 6464 6974 6976 6520 706f 6c79  he additive poly
-000103a0: 6e6f 6d69 616c 730d 0a20 2020 2061 6c74  nomials..    alt
-000103b0: 6572 6e61 7465 2062 6574 7765 656e 2074  ernate between t
-000103c0: 6865 2066 6972 7374 2028 6c65 6674 2920  he first (left) 
-000103d0: 7370 6563 7472 756d 2061 6e64 2074 6865  spectrum and the
-000103e0: 2073 6563 6f6e 6420 2872 6967 6874 290d   second (right).
-000103f0: 0a20 2020 2073 7065 6374 7275 6d2e 0d0a  .    spectrum...
-00010400: 2e72 6564 6465 6e69 6e67 3a0d 0a20 2020  .reddening:..   
-00010410: 2042 6573 7420 6669 7474 696e 6720 6060   Best fitting ``
-00010420: 415f 5660 6020 7661 6c75 6520 6966 2074  A_V`` value if t
-00010430: 6865 2060 6072 6564 6465 6e69 6e67 6060  he ``reddening``
-00010440: 206b 6579 776f 7264 2069 7320 7365 742e   keyword is set.
-00010450: 0d0a 2e73 6f6c 3a0d 0a20 2020 2056 6563  ...sol:..    Vec
-00010460: 746f 7220 636f 6e74 6169 6e69 6e67 2069  tor containing i
-00010470: 6e20 6f75 7470 7574 2074 6865 2070 6172  n output the par
-00010480: 616d 6574 6572 7320 6f66 2074 6865 206b  ameters of the k
-00010490: 696e 656d 6174 6963 732e 0d0a 0d0a 2020  inematics.....  
-000104a0: 2020 2a20 4966 2060 606d 6f6d 656e 7473    * If ``moments
-000104b0: 3d32 6060 2074 6869 7320 636f 6e74 6169  =2`` this contai
-000104c0: 6e73 2060 605b 5665 6c2c 2053 6967 6d61  ns ``[Vel, Sigma
-000104d0: 5d60 600d 0a20 2020 202a 2049 6620 6060  ]``..    * If ``
-000104e0: 6d6f 6d65 6e74 733d 3460 6020 7468 6973  moments=4`` this
-000104f0: 2063 6f6e 7461 696e 7320 6060 5b56 656c   contains ``[Vel
-00010500: 2c20 5369 676d 612c 2068 332c 2068 345d  , Sigma, h3, h4]
-00010510: 6060 0d0a 2020 2020 2a20 4966 2060 606d  ``..    * If ``m
-00010520: 6f6d 656e 7473 3d4e 6060 2074 6869 7320  oments=N`` this 
-00010530: 636f 6e74 6169 6e73 2060 605b 5665 6c2c  contains ``[Vel,
-00010540: 2053 6967 6d61 2c20 6833 2c2e 2e2e 2068   Sigma, h3,... h
-00010550: 4e5d 6060 0d0a 0d0a 2020 2020 5768 656e  N]``....    When
-00010560: 2066 6974 7469 6e67 206d 756c 7469 706c   fitting multipl
-00010570: 6520 6b69 6e65 6d61 7469 6320 6060 636f  e kinematic ``co
-00010580: 6d70 6f6e 656e 7460 602c 2060 6070 702e  mponent``, ``pp.
-00010590: 736f 6c60 6020 636f 6e74 6169 6e73 2061  sol`` contains a
-000105a0: 0d0a 2020 2020 6c69 7374 2077 6974 6820  ..    list with 
-000105b0: 7468 6520 736f 6c75 7469 6f6e 2066 6f72  the solution for
-000105c0: 2061 6c6c 2064 6966 6665 7265 6e74 2063   all different c
-000105d0: 6f6d 706f 6e65 6e74 732c 206f 6e65 2061  omponents, one a
-000105e0: 6674 6572 2074 6865 0d0a 2020 2020 6f74  fter the..    ot
-000105f0: 6865 722c 2073 6f72 7465 6420 6279 2060  her, sorted by `
-00010600: 6063 6f6d 706f 6e65 6e74 6060 3a20 6060  `component``: ``
-00010610: 7070 2e73 6f6c 203d 205b 736f 6c31 2c20  pp.sol = [sol1, 
-00010620: 736f 6c32 2c2e 2e2e 5d60 602e 0d0a 0d0a  sol2,...]``.....
-00010630: 2020 2020 6060 5665 6c60 6020 6973 2074      ``Vel`` is t
-00010640: 6865 2076 656c 6f63 6974 792c 2060 6053  he velocity, ``S
-00010650: 6967 6d61 6060 2069 7320 7468 6520 7665  igma`` is the ve
-00010660: 6c6f 6369 7479 2064 6973 7065 7273 696f  locity dispersio
-00010670: 6e2c 0d0a 2020 2020 6060 6833 202d 2068  n,..    ``h3 - h
-00010680: 3660 6020 6172 6520 7468 6520 4761 7573  6`` are the Gaus
-00010690: 732d 4865 726d 6974 6520 636f 6566 6669  s-Hermite coeffi
-000106a0: 6369 656e 7473 2e20 5468 6520 6d6f 6465  cients. The mode
-000106b0: 6c20 7061 7261 6d65 7465 7273 0d0a 2020  l parameters..  
-000106c0: 2020 6172 6520 6669 7474 6564 2073 696d    are fitted sim
-000106d0: 756c 7461 6e65 6f75 736c 792e 0d0a 0d0a  ultaneously.....
-000106e0: 2020 2020 494d 504f 5254 414e 543a 2054      IMPORTANT: T
-000106f0: 6865 2070 7265 6369 7365 2072 656c 6174  he precise relat
-00010700: 696f 6e20 6265 7477 6565 6e20 7468 6520  ion between the 
-00010710: 6f75 7470 7574 2060 6070 5058 4660 6020  output ``pPXF`` 
-00010720: 7665 6c6f 6369 7479 0d0a 2020 2020 616e  velocity..    an
-00010730: 6420 7265 6473 6869 6674 2069 7320 6060  d redshift is ``
-00010740: 5665 6c20 3d20 632a 6e70 2e6c 6f67 2831  Vel = c*np.log(1
-00010750: 202b 207a 2960 602e 2053 6565 2053 6563   + z)``. See Sec
-00010760: 7469 6f6e 2032 2e33 206f 660d 0a20 2020  tion 2.3 of..   
-00010770: 2060 4361 7070 656c 6c61 7269 2028 3230   `Cappellari (20
-00010780: 3137 2960 5f20 666f 7220 6120 6465 7461  17)`_ for a deta
-00010790: 696c 6564 2065 7870 6c61 6e61 7469 6f6e  iled explanation
-000107a0: 2e0d 0a0d 0a20 2020 2054 6865 7365 2061  .....    These a
-000107b0: 7265 2074 6865 2064 6566 6175 6c74 2073  re the default s
-000107c0: 6166 6574 7920 6c69 6d69 7473 206f 6e20  afety limits on 
-000107d0: 7468 6520 6669 7474 696e 6720 7061 7261  the fitting para
-000107e0: 6d65 7465 7273 0d0a 2020 2020 2874 6865  meters..    (the
-000107f0: 7920 6361 6e20 6265 2063 6861 6e67 6564  y can be changed
-00010800: 2075 7369 6e67 2074 6865 2060 6062 6f75   using the ``bou
-00010810: 6e64 7360 6020 6b65 7977 6f72 6429 3a0d  nds`` keyword):.
-00010820: 0a0d 0a20 2020 202a 2060 6056 656c 6060  ...    * ``Vel``
-00010830: 2069 7320 636f 6e73 7472 6169 6e65 6420   is constrained 
-00010840: 746f 2062 6520 6060 2b2f 2d32 3030 3060  to be ``+/-2000`
-00010850: 6020 6b6d 2f73 2066 726f 6d20 7468 6520  ` km/s from the 
-00010860: 696e 7075 7420 6775 6573 730d 0a20 2020  input guess..   
-00010870: 202a 2060 6076 656c 7363 616c 652f 3130   * ``velscale/10
-00010880: 3020 3c20 5369 676d 6120 3c20 3130 3030  0 < Sigma < 1000
-00010890: 6060 206b 6d2f 730d 0a20 2020 202a 2060  `` km/s..    * `
-000108a0: 602d 302e 3320 3c20 5b68 332c 2068 342c  `-0.3 < [h3, h4,
-000108b0: 202e 2e2e 5d20 3c20 302e 3360 6020 2028   ...] < 0.3``  (
-000108c0: 6578 7472 656d 6520 7661 6c75 6520 666f  extreme value fo
-000108d0: 7220 7265 616c 2067 616c 6178 6965 7329  r real galaxies)
-000108e0: 0d0a 0d0a 2020 2020 496e 2074 6865 2063  ....    In the c
-000108f0: 6173 6520 6f66 2074 776f 2d73 6964 6564  ase of two-sided
-00010900: 204c 4f53 5644 2066 6974 7469 6e67 2074   LOSVD fitting t
-00010910: 6865 206f 7574 7075 7420 7661 6c75 6573  he output values
-00010920: 2072 6566 6572 2074 6f20 7468 650d 0a20   refer to the.. 
-00010930: 2020 2066 6972 7374 2069 6e70 7574 2067     first input g
-00010940: 616c 6178 7920 7370 6563 7472 756d 2c20  alaxy spectrum, 
-00010950: 7768 696c 6520 7468 6520 7365 636f 6e64  while the second
-00010960: 2073 7065 6374 7275 6d20 7769 6c6c 2068   spectrum will h
-00010970: 6176 6520 6279 0d0a 2020 2020 636f 6e73  ave by..    cons
-00010980: 7472 7563 7469 6f6e 206b 696e 656d 6174  truction kinemat
-00010990: 6963 7320 7061 7261 6d65 7465 7273 2060  ics parameters `
-000109a0: 605b 2d56 656c 2c20 5369 676d 612c 202d  `[-Vel, Sigma, -
-000109b0: 6833 2c20 6834 2c20 2d68 352c 2068 365d  h3, h4, -h5, h6]
-000109c0: 6060 2e0d 0a20 2020 2049 6620 6060 7673  ``...    If ``vs
-000109d0: 7973 7460 6020 6973 206e 6f6e 7a65 726f  yst`` is nonzero
-000109e0: 2028 6173 2072 6571 7569 7265 6420 666f   (as required fo
-000109f0: 7220 7477 6f2d 7369 6465 6420 6669 7474  r two-sided fitt
-00010a00: 696e 6729 2c20 7468 656e 2074 6865 0d0a  ing), then the..
-00010a10: 2020 2020 6f75 7470 7574 2076 656c 6f63      output veloc
-00010a20: 6974 7920 6973 206d 6561 7375 7265 6420  ity is measured 
-00010a30: 7769 7468 2072 6573 7065 6374 2074 6f20  with respect to 
-00010a40: 6060 7673 7973 7460 602e 0d0a 2e73 7461  ``vsyst``....sta
-00010a50: 7475 733a 0d0a 2020 2020 436f 6e74 6169  tus:..    Contai
-00010a60: 6e73 2074 6865 206f 7574 7075 7420 7374  ns the output st
-00010a70: 6174 7573 206f 6620 7468 6520 6f70 7469  atus of the opti
-00010a80: 6d69 7a61 7469 6f6e 2e20 506f 7369 7469  mization. Positi
-00010a90: 7665 2076 616c 7565 730d 0a20 2020 2067  ve values..    g
-00010aa0: 656e 6572 616c 6c79 2072 6570 7265 7365  enerally represe
-00010ab0: 6e74 2073 7563 6365 7373 2028 7468 6520  nt success (the 
-00010ac0: 6d65 616e 696e 6720 6f66 2060 6073 7461  meaning of ``sta
-00010ad0: 7475 7360 6020 6973 2064 6566 696e 6564  tus`` is defined
-00010ae0: 2061 7320 696e 0d0a 2020 2020 6073 6369   as in..    `sci
-00010af0: 7079 2e6f 7074 696d 697a 652e 6c65 6173  py.optimize.leas
-00010b00: 745f 7371 7561 7265 7360 5f29 2e0d 0a2e  t_squares`_)....
-00010b10: 7765 6967 6874 733a 0d0a 2020 2020 5265  weights:..    Re
-00010b20: 6365 6976 6573 2074 6865 2076 616c 7565  ceives the value
-00010b30: 206f 6620 7468 6520 7765 6967 6874 7320   of the weights 
-00010b40: 6279 2077 6869 6368 2065 6163 6820 7465  by which each te
-00010b50: 6d70 6c61 7465 2077 6173 0d0a 2020 2020  mplate was..    
-00010b60: 6d75 6c74 6970 6c69 6564 2074 6f20 6265  multiplied to be
-00010b70: 7374 2066 6974 2074 6865 2067 616c 6178  st fit the galax
-00010b80: 7920 7370 6563 7472 756d 2e20 5468 6520  y spectrum. The 
-00010b90: 6f70 7469 6d61 6c20 7465 6d70 6c61 7465  optimal template
-00010ba0: 2063 616e 2062 650d 0a20 2020 2063 6f6d   can be..    com
-00010bb0: 7075 7465 6420 7769 7468 2061 6e20 6172  puted with an ar
-00010bc0: 7261 792d 7665 6374 6f72 206d 756c 7469  ray-vector multi
-00010bd0: 706c 6963 6174 696f 6e3a 3a0d 0a0d 0a20  plication::.... 
-00010be0: 2020 2020 2020 2062 6573 7465 6d70 203d         bestemp =
-00010bf0: 2074 656d 706c 6174 6573 2040 2077 6569   templates @ wei
-00010c00: 6768 7473 0d0a 0d0a 2020 2020 5468 6573  ghts....    Thes
-00010c10: 6520 6060 2e77 6569 6768 7473 6060 2064  e ``.weights`` d
-00010c20: 6f20 6e6f 7420 696e 636c 7564 6520 7468  o not include th
-00010c30: 6520 7765 6967 6874 7320 6f66 2074 6865  e weights of the
-00010c40: 2061 6464 6974 6976 650d 0a20 2020 2070   additive..    p
-00010c50: 6f6c 796e 6f6d 6961 6c73 2077 6869 6368  olynomials which
-00010c60: 2061 7265 2073 6570 6172 6174 656c 7920   are separately 
-00010c70: 7374 6f72 6564 2069 6e20 6060 7070 2e70  stored in ``pp.p
-00010c80: 6f6c 7977 6569 6768 7473 6060 2e0d 0a0d  olyweights``....
-00010c90: 0a20 2020 2057 6865 6e20 7468 6520 6060  .    When the ``
-00010ca0: 736b 7960 6020 6b65 7977 6f72 6420 6973  sky`` keyword is
-00010cb0: 2075 7365 6420 6060 7765 6967 6874 735b   used ``weights[
-00010cc0: 3a6e 5f74 656d 706c 6174 6573 5d60 6020  :n_templates]`` 
-00010cd0: 636f 6e74 6169 6e73 2074 6865 0d0a 2020  contains the..  
-00010ce0: 2020 7765 6967 6874 7320 666f 7220 7468    weights for th
-00010cf0: 6520 7465 6d70 6c61 7465 732c 2077 6869  e templates, whi
-00010d00: 6c65 2060 6077 6569 6768 7473 5b6e 5f74  le ``weights[n_t
-00010d10: 656d 706c 6174 6573 3a5d 6060 2067 6976  emplates:]`` giv
-00010d20: 6573 2074 6865 0d0a 2020 2020 6f6e 6573  es the..    ones
-00010d30: 2066 6f72 2074 6865 2073 6b79 2e20 496e   for the sky. In
-00010d40: 2074 6861 7420 6361 7365 2074 6865 2062   that case the b
-00010d50: 6573 742d 6669 7474 696e 6720 6761 6c61  est-fitting gala
-00010d60: 7879 2074 656d 706c 6174 6520 616e 6420  xy template and 
-00010d70: 736b 790d 0a20 2020 2061 7265 2067 6976  sky..    are giv
-00010d80: 656e 2062 793a 3a0d 0a0d 0a20 2020 2020  en by::....     
-00010d90: 2020 2062 6573 7465 6d70 203d 2074 656d     bestemp = tem
-00010da0: 706c 6174 6573 2040 2077 6569 6768 7473  plates @ weights
-00010db0: 5b3a 6e5f 7465 6d70 6c61 7465 735d 0d0a  [:n_templates]..
-00010dc0: 2020 2020 2020 2020 6265 7374 736b 7920          bestsky 
-00010dd0: 3d20 736b 7920 4020 7765 6967 6874 735b  = sky @ weights[
-00010de0: 6e5f 7465 6d70 6c61 7465 733a 5d0d 0a0d  n_templates:]...
-00010df0: 0a20 2020 2057 6865 6e20 646f 696e 6720  .    When doing 
-00010e00: 6120 7477 6f2d 7369 6465 6420 6669 7474  a two-sided fitt
-00010e10: 696e 6720 2873 6565 2068 656c 7020 666f  ing (see help fo
-00010e20: 7220 6060 6761 6c61 7879 6060 2070 6172  r ``galaxy`` par
-00010e30: 616d 6574 6572 290d 0a20 2020 202a 746f  ameter)..    *to
-00010e40: 6765 7468 6572 2a20 7769 7468 2074 6865  gether* with the
-00010e50: 2060 6073 6b79 6060 206b 6579 776f 7264   ``sky`` keyword
-00010e60: 2c20 7468 6520 736b 7920 7765 6967 6874  , the sky weight
-00010e70: 7320 6172 6520 616c 6c6f 7765 6420 746f  s are allowed to
-00010e80: 2062 650d 0a20 2020 2064 6966 6665 7265   be..    differe
-00010e90: 6e74 2066 6f72 2074 6865 206c 6566 7420  nt for the left 
-00010ea0: 616e 6420 7269 6768 7420 7370 6563 7472  and right spectr
-00010eb0: 756d 2e20 496e 2074 6861 7420 6361 7365  um. In that case
-00010ec0: 2074 6865 206f 7574 7075 7420 736b 790d   the output sky.
-00010ed0: 0a20 2020 2077 6569 6768 7473 2061 6c74  .    weights alt
-00010ee0: 6572 6e61 7465 2062 6574 7765 656e 2074  ernate between t
-00010ef0: 6865 2066 6972 7374 2028 6c65 6674 2920  he first (left) 
-00010f00: 7370 6563 7472 756d 2061 6e64 2074 6865  spectrum and the
-00010f10: 2073 6563 6f6e 640d 0a20 2020 2028 7269   second..    (ri
-00010f20: 6768 7429 2073 7065 6374 7275 6d2e 0d0a  ght) spectrum...
-00010f30: 0d0a 486f 7720 746f 2053 6574 2074 6865  ..How to Set the
-00010f40: 204b 696e 656d 6174 6963 2050 656e 616c   Kinematic Penal
-00010f50: 7479 204b 6579 776f 7264 0d0a 2d2d 2d2d  ty Keyword..----
-00010f60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000b600: 6163 6961 6e5b 775d 2a2a 322e 0d0a 0d0a  acian[w]**2.....
+0000b610: 7265 675f 7374 6570 3a20 6c69 7374 206f  reg_step: list o
+0000b620: 6620 6172 7261 7973 2c20 7368 6170 6520  f arrays, shape 
+0000b630: 286c 656e 2872 6567 5f64 696d 292c 290d  (len(reg_dim),).
+0000b640: 0a20 2020 2044 6566 696e 6573 2074 6865  .    Defines the
+0000b650: 2073 7465 7020 7369 7a65 7320 666f 7220   step sizes for 
+0000b660: 6e75 6d65 7269 6361 6c20 6573 7469 6d61  numerical estima
+0000b670: 7469 6f6e 206f 6620 6465 7269 7661 7469  tion of derivati
+0000b680: 7665 7320 6475 7269 6e67 0d0a 2020 2020  ves during..    
+0000b690: 7265 6775 6c61 7269 7a61 7469 6f6e 2e20  regularization. 
+0000b6a0: 4561 6368 2061 7272 6179 2069 6e20 7468  Each array in th
+0000b6b0: 6520 6c69 7374 2063 6f72 7265 7370 6f6e  e list correspon
+0000b6c0: 6473 2074 6f20 6120 6469 6d65 6e73 696f  ds to a dimensio
+0000b6d0: 6e20 696e 0d0a 2020 2020 6060 7265 675f  n in..    ``reg_
+0000b6e0: 6469 6d60 602c 2073 7065 6369 6679 696e  dim``, specifyin
+0000b6f0: 6720 7468 6520 7374 6570 2073 697a 6520  g the step size 
+0000b700: 666f 7220 6561 6368 2069 6e74 6572 7661  for each interva
+0000b710: 6c20 7769 7468 696e 2074 6861 740d 0a20  l within that.. 
+0000b720: 2020 2064 696d 656e 7369 6f6e 2e20 4279     dimension. By
+0000b730: 2064 6566 6175 6c74 2c20 6966 2060 6072   default, if ``r
+0000b740: 6567 5f73 7465 7060 6020 6973 206e 6f74  eg_step`` is not
+0000b750: 2070 726f 7669 6465 642c 2061 2073 7465   provided, a ste
+0000b760: 7020 7369 7a65 206f 660d 0a20 2020 206f  p size of..    o
+0000b770: 6e65 2069 7320 6173 7375 6d65 6420 666f  ne is assumed fo
+0000b780: 7220 616c 6c20 6469 6d65 6e73 696f 6e73  r all dimensions
+0000b790: 2c20 6571 7569 7661 6c65 6e74 2074 6f20  , equivalent to 
+0000b7a0: 0d0a 2020 2020 6060 7265 675f 7374 6570  ..    ``reg_step
+0000b7b0: 203d 205b 6e70 2e6f 6e65 7328 7264 202d   = [np.ones(rd -
+0000b7c0: 2031 2920 666f 7220 7264 2069 6e20 7265   1) for rd in re
+0000b7d0: 675f 6469 6d5d 6060 2e20 546f 2063 7573  g_dim]``. To cus
+0000b7e0: 746f 6d69 7a65 2c0d 0a20 2020 2070 726f  tomize,..    pro
+0000b7f0: 7669 6465 2060 6072 6567 5f73 7465 7060  vide ``reg_step`
+0000b800: 6020 6173 2061 206c 6973 7420 636f 6e74  ` as a list cont
+0000b810: 6169 6e69 6e67 2061 7272 6179 732c 2077  aining arrays, w
+0000b820: 6865 7265 2065 6163 6820 6172 7261 7920  here each array 
+0000b830: 6861 730d 0a20 2020 2061 206c 656e 6774  has..    a lengt
+0000b840: 6820 6f66 2060 6072 6567 5f64 696d 5b6a  h of ``reg_dim[j
+0000b850: 5d20 2d20 3160 602c 2061 6c6c 6f77 696e  ] - 1``, allowin
+0000b860: 6720 666f 7220 7661 7269 6162 6c65 2073  g for variable s
+0000b870: 7465 7020 7369 7a65 7320 6163 726f 7373  tep sizes across
+0000b880: 0d0a 2020 2020 696e 7465 7276 616c 7320  ..    intervals 
+0000b890: 616e 6420 6469 6d65 6e73 696f 6e73 2e0d  and dimensions..
+0000b8a0: 0a0d 0a20 2020 204e 4f54 4520 313a 204d  ...    NOTE 1: M
+0000b8b0: 756c 7469 706c 7969 6e67 2065 6163 6820  ultiplying each 
+0000b8c0: 656c 656d 656e 7420 696e 2060 6072 6567  element in ``reg
+0000b8d0: 5f73 7465 7060 6020 6279 2061 2063 6f6e  _step`` by a con
+0000b8e0: 7374 616e 7420 6661 6374 6f72 0d0a 2020  stant factor..  
+0000b8f0: 2020 6060 6b60 6020 6861 7320 7468 6520    ``k`` has the 
+0000b900: 7361 6d65 2065 6666 6563 7420 6173 2064  same effect as d
+0000b910: 6976 6964 696e 6720 7468 6520 7265 6775  ividing the regu
+0000b920: 6c61 7269 7a61 7469 6f6e 2070 6172 616d  larization param
+0000b930: 6574 6572 0d0a 2020 2020 6060 7265 6775  eter..    ``regu
+0000b940: 6c60 6020 6279 2060 606b 2a2a 7265 675f  l`` by ``k**reg_
+0000b950: 6f72 6460 602e 0d0a 0d0a 2020 2020 4e4f  ord``.....    NO
+0000b960: 5445 2032 3a20 5468 6520 7374 616e 6461  TE 2: The standa
+0000b970: 7264 2061 7070 726f 6163 6820 636f 6e73  rd approach cons
+0000b980: 6973 7473 206f 6620 7361 6d70 6c69 6e67  ists of sampling
+0000b990: 2074 6865 2053 5053 2074 656d 706c 6174   the SPS templat
+0000b9a0: 650d 0a20 2020 2073 7065 6374 7261 206c  e..    spectra l
+0000b9b0: 6f67 6172 6974 686d 6963 616c 6c79 2069  ogarithmically i
+0000b9c0: 6e20 6167 6520 616e 6420 6164 6f70 7420  n age and adopt 
+0000b9d0: 6120 636f 6e73 7461 6e74 2075 6e69 7461  a constant unita
+0000b9e0: 7279 2073 7465 702c 0d0a 2020 2020 2a2a  ry step,..    **
+0000b9f0: 7769 7468 6f75 742a 2a20 7573 696e 6720  without** using 
+0000ba00: 7468 6973 206b 6579 776f 7264 2e0d 0a72  this keyword...r
+0000ba10: 6567 756c 3a20 666c 6f61 742c 206f 7074  egul: float, opt
+0000ba20: 696f 6e61 6c0d 0a20 2020 2049 6620 7468  ional..    If th
+0000ba30: 6973 206b 6579 776f 7264 2069 7320 6e6f  is keyword is no
+0000ba40: 6e7a 6572 6f2c 2074 6865 2070 726f 6772  nzero, the progr
+0000ba50: 616d 2061 7070 6c69 6573 2066 6972 7374  am applies first
+0000ba60: 206f 7220 7365 636f 6e64 2d6f 7264 6572   or second-order
+0000ba70: 0d0a 2020 2020 6c69 6e65 6172 2072 6567  ..    linear reg
+0000ba80: 756c 6172 697a 6174 696f 6e20 746f 2074  ularization to t
+0000ba90: 6865 2060 6077 6569 6768 7473 6060 2064  he ``weights`` d
+0000baa0: 7572 696e 6720 7468 6520 6060 7050 5846  uring the ``pPXF
+0000bab0: 6060 2066 6974 2e0d 0a20 2020 2052 6567  `` fit...    Reg
+0000bac0: 756c 6172 697a 6174 696f 6e20 6973 2064  ularization is d
+0000bad0: 6f6e 6520 696e 206f 6e65 2c20 7477 6f20  one in one, two 
+0000bae0: 6f72 2074 6872 6565 2064 696d 656e 7369  or three dimensi
+0000baf0: 6f6e 7320 6465 7065 6e64 696e 6720 6f6e  ons depending on
+0000bb00: 0d0a 2020 2020 7768 6574 6865 7220 7468  ..    whether th
+0000bb10: 6520 6172 7261 7920 6f66 2060 6074 656d  e array of ``tem
+0000bb20: 706c 6174 6573 6060 2068 6173 2074 776f  plates`` has two
+0000bb30: 2c20 7468 7265 6520 6f72 2066 6f75 7220  , three or four 
+0000bb40: 6469 6d65 6e73 696f 6e73 0d0a 2020 2020  dimensions..    
+0000bb50: 7265 7370 6563 7469 7665 6c79 2e0d 0a20  respectively... 
+0000bb60: 2020 204c 6172 6765 2060 6072 6567 756c     Large ``regul
+0000bb70: 6060 2076 616c 7565 7320 636f 7272 6573  `` values corres
+0000bb80: 706f 6e64 2074 6f20 736d 6f6f 7468 6572  pond to smoother
+0000bb90: 2060 6077 6569 6768 7473 6060 206f 7574   ``weights`` out
+0000bba0: 7075 742e 2057 6865 6e0d 0a20 2020 2074  put. When..    t
+0000bbb0: 6869 7320 6b65 7977 6f72 6420 6973 206e  his keyword is n
+0000bbc0: 6f6e 7a65 726f 2074 6865 2073 6f6c 7574  onzero the solut
+0000bbd0: 696f 6e20 7769 6c6c 2062 6520 6120 7472  ion will be a tr
+0000bbe0: 6164 652d 6f66 6620 6265 7477 6565 6e20  ade-off between 
+0000bbf0: 7468 650d 0a20 2020 2073 6d6f 6f74 686e  the..    smoothn
+0000bc00: 6573 7320 6f66 2060 6077 6569 6768 7473  ess of ``weights
+0000bc10: 6060 2061 6e64 2067 6f6f 646e 6573 7320  `` and goodness 
+0000bc20: 6f66 2066 6974 2e0d 0a0d 0a20 2020 2053  of fit.....    S
+0000bc30: 6563 7469 6f6e 2033 2e35 206f 6620 6043  ection 3.5 of `C
+0000bc40: 6170 7065 6c6c 6172 6920 2832 3031 3729  appellari (2017)
+0000bc50: 605f 2064 6573 6372 6962 6573 2072 6567  `_ describes reg
+0000bc60: 756c 6172 697a 6174 696f 6e2e 0d0a 0d0a  ularization.....
+0000bc70: 2020 2020 5768 656e 2066 6974 7469 6e67      When fitting
+0000bc80: 206d 756c 7469 706c 6520 6b69 6e65 6d61   multiple kinema
+0000bc90: 7469 6320 6060 636f 6d70 6f6e 656e 7460  tic ``component`
+0000bca0: 6020 7468 6520 7265 6775 6c61 7269 7a61  ` the regulariza
+0000bcb0: 7469 6f6e 2069 730d 0a20 2020 2061 7070  tion is..    app
+0000bcc0: 6c69 6564 206f 6e6c 7920 746f 2074 6865  lied only to the
+0000bcd0: 2066 6972 7374 2060 6063 6f6d 706f 6e65   first ``compone
+0000bce0: 6e74 203d 2030 6060 2c20 7768 696c 6520  nt = 0``, while 
+0000bcf0: 6164 6469 7469 6f6e 616c 0d0a 2020 2020  additional..    
+0000bd00: 636f 6d70 6f6e 656e 7473 2061 7265 206e  components are n
+0000bd10: 6f74 2072 6567 756c 6172 697a 6564 2e20  ot regularized. 
+0000bd20: 5468 6973 2069 7320 7573 6566 756c 2077  This is useful w
+0000bd30: 6865 6e20 6669 7474 696e 6720 7374 656c  hen fitting stel
+0000bd40: 6c61 720d 0a20 2020 2070 6f70 756c 6174  lar..    populat
+0000bd50: 696f 6e20 746f 6765 7468 6572 2077 6974  ion together wit
+0000bd60: 6820 6761 7320 656d 6973 7369 6f6e 206c  h gas emission l
+0000bd70: 696e 6573 2e20 496e 2074 6861 7420 6361  ines. In that ca
+0000bd80: 7365 2c20 7468 6520 5353 500d 0a20 2020  se, the SSP..   
+0000bd90: 2073 7065 6374 7261 6c20 7465 6d70 6c61   spectral templa
+0000bda0: 7465 7320 6d75 7374 2062 6520 6769 7665  tes must be give
+0000bdb0: 6e20 6669 7273 7420 616e 6420 7468 6520  n first and the 
+0000bdc0: 6761 7320 656d 6973 7369 6f6e 2074 656d  gas emission tem
+0000bdd0: 706c 6174 6573 0d0a 2020 2020 6172 6520  plates..    are 
+0000bde0: 6769 7665 6e20 6c61 7374 2e20 496e 2074  given last. In t
+0000bdf0: 6869 7320 7369 7475 6174 696f 6e2c 206f  his situation, o
+0000be00: 6e65 2068 6173 2074 6f20 7573 6520 7468  ne has to use th
+0000be10: 6520 6060 7265 675f 6469 6d60 600d 0a20  e ``reg_dim``.. 
+0000be20: 2020 206b 6579 776f 7264 2028 6265 6c6f     keyword (belo
+0000be30: 7729 2c20 746f 2067 6976 6520 6060 7050  w), to give ``pP
+0000be40: 5846 6060 2074 6865 2064 696d 656e 7369  XF`` the dimensi
+0000be50: 6f6e 7320 6f66 2074 6865 2070 6f70 756c  ons of the popul
+0000be60: 6174 696f 6e0d 0a20 2020 2070 6172 616d  ation..    param
+0000be70: 6574 6572 7320 2865 2e67 2e20 6060 6e5f  eters (e.g. ``n_
+0000be80: 6167 6560 602c 2060 606e 5f6d 6574 616c  age``, ``n_metal
+0000be90: 6060 2c20 6060 6e5f 616c 7068 6160 6029  ``, ``n_alpha``)
+0000bea0: 2e20 4120 7573 6167 6520 6578 616d 706c  . A usage exampl
+0000beb0: 650d 0a20 2020 2069 7320 6769 7665 6e20  e..    is given 
+0000bec0: 696e 2074 6865 2066 696c 6520 6060 7070  in the file ``pp
+0000bed0: 7866 5f65 7861 6d70 6c65 5f70 6f70 756c  xf_example_popul
+0000bee0: 6174 696f 6e5f 6761 735f 7364 7373 2e70  ation_gas_sdss.p
+0000bef0: 7960 602e 0d0a 0d0a 2020 2020 5468 6520  y``.....    The 
+0000bf00: 6566 6665 6374 206f 6620 7468 6520 7265  effect of the re
+0000bf10: 6775 6c61 7269 7a61 7469 6f6e 2073 6368  gularization sch
+0000bf20: 656d 6520 6973 2074 6865 2066 6f6c 6c6f  eme is the follo
+0000bf30: 7769 6e67 3a0d 0a0d 0a20 2020 202a 2057  wing:....    * W
+0000bf40: 6974 6820 6060 7265 675f 6f72 643d 3160  ith ``reg_ord=1`
+0000bf50: 6020 6974 2065 6e66 6f72 6365 7320 7468  ` it enforces th
+0000bf60: 6520 6e75 6d65 7269 6361 6c20 6669 7273  e numerical firs
+0000bf70: 7420 6465 7269 7661 7469 7665 730d 0a20  t derivatives.. 
+0000bf80: 2020 2020 2062 6574 7765 656e 206e 6569       between nei
+0000bf90: 6768 626f 7572 696e 6720 7765 6967 6874  ghbouring weight
+0000bfa0: 7320 2869 6e20 7468 6520 312d 6469 6d20  s (in the 1-dim 
+0000bfb0: 6361 7365 2920 746f 2062 6520 6571 7561  case) to be equa
+0000bfc0: 6c20 746f 0d0a 2020 2020 2020 6060 775b  l to..      ``w[
+0000bfd0: 6a5d 202d 2077 5b6a 2b31 5d20 3d20 3060  j] - w[j+1] = 0`
+0000bfe0: 6020 7769 7468 2061 6e20 6572 726f 7220  ` with an error 
+0000bff0: 6060 4465 6c74 6120 3d20 312f 7265 6775  ``Delta = 1/regu
+0000c000: 6c60 602e 0d0a 0d0a 2020 2020 2a20 5769  l``.....    * Wi
+0000c010: 7468 2060 6072 6567 5f6f 7264 3d32 6060  th ``reg_ord=2``
+0000c020: 2069 7420 656e 666f 7263 6573 2074 6865   it enforces the
+0000c030: 206e 756d 6572 6963 616c 2073 6563 6f6e   numerical secon
+0000c040: 6420 6465 7269 7661 7469 7665 730d 0a20  d derivatives.. 
+0000c050: 2020 2020 2062 6574 7765 656e 206e 6569       between nei
+0000c060: 6768 626f 7572 696e 6720 7765 6967 6874  ghbouring weight
+0000c070: 7320 2869 6e20 7468 6520 312d 6469 6d20  s (in the 1-dim 
+0000c080: 6361 7365 2920 746f 2062 6520 6571 7561  case) to be equa
+0000c090: 6c20 746f 0d0a 2020 2020 2020 6060 775b  l to..      ``w[
+0000c0a0: 6a2d 315d 202d 2032 2a77 5b6a 5d20 2b20  j-1] - 2*w[j] + 
+0000c0b0: 775b 6a2b 315d 203d 2030 6060 2077 6974  w[j+1] = 0`` wit
+0000c0c0: 6820 616e 2065 7272 6f72 2060 6044 656c  h an error ``Del
+0000c0d0: 7461 203d 2031 2f72 6567 756c 6060 2e0d  ta = 1/regul``..
+0000c0e0: 0a0d 0a20 2020 2049 7420 6d61 7920 6265  ...    It may be
+0000c0f0: 2068 656c 7066 756c 2074 6f20 6465 6669   helpful to defi
+0000c100: 6e65 2060 6072 6567 756c 203d 2031 2f44  ne ``regul = 1/D
+0000c110: 656c 7461 6060 2061 6e64 2074 6869 6e6b  elta`` and think
+0000c120: 206f 6620 6060 4465 6c74 6160 600d 0a20   of ``Delta``.. 
+0000c130: 2020 2061 7320 7468 6520 7265 6775 6c61     as the regula
+0000c140: 7269 7a61 7469 6f6e 2065 7272 6f72 2e0d  rization error..
+0000c150: 0a0d 0a20 2020 2049 4d50 4f52 5441 4e54  ...    IMPORTANT
+0000c160: 3a20 6060 4465 6c74 6160 6020 6e65 6564  : ``Delta`` need
+0000c170: 7320 746f 2062 6520 736d 616c 6c65 7220  s to be smaller 
+0000c180: 6275 7420 6f66 2074 6865 2073 616d 6520  but of the same 
+0000c190: 6f72 6465 7220 6f66 0d0a 2020 2020 6d61  order of..    ma
+0000c1a0: 676e 6974 7564 6520 6f66 2074 6865 2074  gnitude of the t
+0000c1b0: 7970 6963 616c 2060 6077 6569 6768 7473  ypical ``weights
+0000c1c0: 6060 2074 6f20 706c 6179 2061 6e20 6566  `` to play an ef
+0000c1d0: 6665 6374 206f 6e20 7468 650d 0a20 2020  fect on the..   
+0000c1e0: 2072 6567 756c 6172 697a 6174 696f 6e2e   regularization.
+0000c1f0: 204f 6e65 2071 7569 636b 2077 6179 2074   One quick way t
+0000c200: 6f20 6163 6869 6576 6520 7468 6973 2069  o achieve this i
+0000c210: 733a 0d0a 0d0a 2020 2020 312e 2044 6976  s:....    1. Div
+0000c220: 6964 6520 7468 6520 6675 6c6c 2060 6074  ide the full ``t
+0000c230: 656d 706c 6174 6573 6060 2061 7272 6179  emplates`` array
+0000c240: 2062 7920 6120 7363 616c 6172 2069 6e20   by a scalar in 
+0000c250: 7375 6368 2061 2077 6179 2074 6861 740d  such a way that.
+0000c260: 0a20 2020 2020 2020 7468 6520 7479 7069  .       the typi
+0000c270: 6361 6c20 7465 6d70 6c61 7465 2068 6173  cal template has
+0000c280: 2061 206d 6564 6961 6e20 6f66 206f 6e65   a median of one
+0000c290: 3a3a 0d0a 0d0a 2020 2020 2020 2020 2020  ::....          
+0000c2a0: 2020 7465 6d70 6c61 7465 7320 2f3d 206e    templates /= n
+0000c2b0: 702e 6d65 6469 616e 2874 656d 706c 6174  p.median(templat
+0000c2c0: 6573 290d 0a0d 0a20 2020 2032 2e20 446f  es)....    2. Do
+0000c2d0: 2074 6865 2073 616d 6520 666f 7220 7468   the same for th
+0000c2e0: 6520 696e 7075 7420 6761 6c61 7879 2073  e input galaxy s
+0000c2f0: 7065 6374 7275 6d3a 3a0d 0a0d 0a20 2020  pectrum::....   
+0000c300: 2020 2020 2020 2020 2067 616c 6178 7920           galaxy 
+0000c310: 2f3d 206e 702e 6d65 6469 616e 2867 616c  /= np.median(gal
+0000c320: 6178 7929 0d0a 0d0a 2020 2020 332e 2049  axy)....    3. I
+0000c330: 6e20 7468 6973 2073 6974 7561 7469 6f6e  n this situation
+0000c340: 2c20 6120 7365 6e73 6962 6c65 2067 7565  , a sensible gue
+0000c350: 7373 2066 6f72 2060 6044 656c 7461 6060  ss for ``Delta``
+0000c360: 2077 696c 6c20 6265 2061 2066 6577 0d0a   will be a few..
+0000c370: 2020 2020 2020 2070 6572 6365 6e74 2028         percent (
+0000c380: 652e 672e 2060 6044 656c 7461 3d30 2e30  e.g. ``Delta=0.0
+0000c390: 3120 2d2d 3e20 7265 6775 6c3d 3130 3060  1 --> regul=100`
+0000c3a0: 6029 2e0d 0a0d 0a20 2020 2041 6c74 6572  `).....    Alter
+0000c3b0: 6e61 7469 7665 6c79 2c20 666f 7220 6120  natively, for a 
+0000c3c0: 6d6f 7265 2072 6967 6f72 6f75 7320 6465  more rigorous de
+0000c3d0: 6669 6e69 7469 6f6e 206f 6620 7468 6520  finition of the 
+0000c3e0: 7061 7261 6d65 7465 720d 0a20 2020 2060  parameter..    `
+0000c3f0: 6072 6567 756c 6060 3a0d 0a0d 0a20 2020  `regul``:....   
+0000c400: 2041 2e20 5065 7266 6f72 6d20 616e 2075   A. Perform an u
+0000c410: 6e72 6567 756c 6172 697a 6564 2066 6974  nregularized fit
+0000c420: 2028 6060 7265 6775 6c3d 3060 6029 2061   (``regul=0``) a
+0000c430: 6e64 2074 6865 6e20 7265 7363 616c 6520  nd then rescale 
+0000c440: 7468 650d 0a20 2020 2020 2020 696e 7075  the..       inpu
+0000c450: 7420 6060 6e6f 6973 6560 6020 7370 6563  t ``noise`` spec
+0000c460: 7472 756d 2073 6f20 7468 6174 3a3a 0d0a  trum so that::..
+0000c470: 0d0a 2020 2020 2020 2020 2020 2020 4368  ..            Ch
+0000c480: 695e 322f 444f 4620 3d20 4368 695e 322f  i^2/DOF = Chi^2/
+0000c490: 676f 6f64 5069 7865 6c73 2e73 697a 6520  goodPixels.size 
+0000c4a0: 3d20 312e 0d0a 0d0a 2020 2020 2020 2054  = 1.....       T
+0000c4b0: 6869 7320 6973 2061 6368 6965 7665 6420  his is achieved 
+0000c4c0: 6279 2072 6573 6361 6c69 6e67 2074 6865  by rescaling the
+0000c4d0: 2069 6e70 7574 2060 606e 6f69 7365 6060   input ``noise``
+0000c4e0: 2073 7065 6374 7275 6d20 6173 3a3a 0d0a   spectrum as::..
+0000c4f0: 0d0a 2020 2020 2020 2020 2020 2020 6e6f  ..            no
+0000c500: 6973 6520 3d20 6e6f 6973 652a 6e70 2e73  ise = noise*np.s
+0000c510: 7172 7428 4368 692a 2a32 2f44 4f46 2920  qrt(Chi**2/DOF) 
+0000c520: 3d20 6e6f 6973 652a 6e70 2e73 7172 7428  = noise*np.sqrt(
+0000c530: 7070 2e63 6869 3229 3b0d 0a0d 0a20 2020  pp.chi2);....   
+0000c540: 2042 2e20 496e 6372 6561 7365 2060 6072   B. Increase ``r
+0000c550: 6567 756c 6060 2061 6e64 2069 7465 7261  egul`` and itera
+0000c560: 7469 7665 6c79 2072 6564 6f20 7468 6520  tively redo the 
+0000c570: 6060 7050 5846 6060 2066 6974 2075 6e74  ``pPXF`` fit unt
+0000c580: 696c 2074 6865 0d0a 2020 2020 2020 2060  il the..       `
+0000c590: 6043 6869 5e32 6060 2069 6e63 7265 6173  `Chi^2`` increas
+0000c5a0: 6573 2066 726f 6d20 7468 6520 756e 7265  es from the unre
+0000c5b0: 6775 6c61 7269 7a65 6420 7661 6c75 650d  gularized value.
+0000c5c0: 0a20 2020 2020 2020 6060 4368 695e 3220  .       ``Chi^2 
+0000c5d0: 3d20 676f 6f64 5069 7865 6c73 2e73 697a  = goodPixels.siz
+0000c5e0: 6560 6020 6279 0d0a 2020 2020 2020 2060  e`` by..       `
+0000c5f0: 6044 656c 7461 4368 695e 3220 3d20 6e70  `DeltaChi^2 = np
+0000c600: 2e73 7172 7428 322a 676f 6f64 5069 7865  .sqrt(2*goodPixe
+0000c610: 6c73 2e73 697a 6529 6060 2e0d 0a0d 0a20  ls.size)``..... 
+0000c620: 2020 2054 6865 2064 6572 6976 6564 2072     The derived r
+0000c630: 6567 756c 6172 697a 6174 696f 6e20 636f  egularization co
+0000c640: 7272 6573 706f 6e64 7320 746f 2074 6865  rresponds to the
+0000c650: 206d 6178 696d 756d 206f 6e65 2073 7469   maximum one sti
+0000c660: 6c6c 0d0a 2020 2020 636f 6e73 6973 7465  ll..    consiste
+0000c670: 6e74 2077 6974 6820 7468 6520 6f62 7365  nt with the obse
+0000c680: 7276 6174 696f 6e73 2061 6e64 2074 6865  rvations and the
+0000c690: 2064 6572 6976 6564 2073 7461 7220 666f   derived star fo
+0000c6a0: 726d 6174 696f 6e20 6869 7374 6f72 790d  rmation history.
+0000c6b0: 0a20 2020 2077 696c 6c20 6265 2074 6865  .    will be the
+0000c6c0: 2073 6d6f 6f74 6865 7374 2028 6d69 6e69   smoothest (mini
+0000c6d0: 6d75 6d20 6375 7276 6174 7572 6520 6f72  mum curvature or
+0000c6e0: 206d 696e 696d 756d 2076 6172 6961 7469   minimum variati
+0000c6f0: 6f6e 2920 7468 6174 2069 730d 0a20 2020  on) that is..   
+0000c700: 2073 7469 6c6c 2063 6f6e 7369 7374 656e   still consisten
+0000c710: 7420 7769 7468 2074 6865 206f 6273 6572  t with the obser
+0000c720: 7661 7469 6f6e 732e 0d0a 7369 676d 615f  vations...sigma_
+0000c730: 6469 6666 3a20 666c 6f61 742c 206f 7074  diff: float, opt
+0000c740: 696f 6e61 6c0d 0a20 2020 2051 7561 6472  ional..    Quadr
+0000c750: 6174 6963 2064 6966 6665 7265 6e63 6520  atic difference 
+0000c760: 696e 206b 6d2f 7320 6465 6669 6e65 6420  in km/s defined 
+0000c770: 6173 3a3a 0d0a 0d0a 2020 2020 2020 2020  as::....        
+0000c780: 7369 676d 615f 6469 6666 2a2a 3220 3d20  sigma_diff**2 = 
+0000c790: 7369 676d 615f 696e 7374 2a2a 3220 2d20  sigma_inst**2 - 
+0000c7a0: 7369 676d 615f 7465 6d70 2a2a 320d 0a0d  sigma_temp**2...
+0000c7b0: 0a20 2020 2062 6574 7765 656e 2074 6865  .    between the
+0000c7c0: 2069 6e73 7472 756d 656e 7461 6c20 6469   instrumental di
+0000c7d0: 7370 6572 7369 6f6e 206f 6620 7468 6520  spersion of the 
+0000c7e0: 6761 6c61 7879 2073 7065 6374 7275 6d20  galaxy spectrum 
+0000c7f0: 616e 6420 7468 650d 0a20 2020 2069 6e73  and the..    ins
+0000c800: 7472 756d 656e 7461 6c20 6469 7370 6572  trumental disper
+0000c810: 7369 6f6e 206f 6620 7468 6520 7465 6d70  sion of the temp
+0000c820: 6c61 7465 2073 7065 6374 7261 2e0d 0a0d  late spectra....
+0000c830: 0a20 2020 2054 6869 7320 6b65 7977 6f72  .    This keywor
+0000c840: 6420 6973 2075 7365 6675 6c20 7768 656e  d is useful when
+0000c850: 2074 6865 2074 656d 706c 6174 6573 2068   the templates h
+0000c860: 6176 6520 6869 6768 6572 2072 6573 6f6c  ave higher resol
+0000c870: 7574 696f 6e20 7468 616e 0d0a 2020 2020  ution than..    
+0000c880: 7468 6520 6761 6c61 7879 2061 6e64 2074  the galaxy and t
+0000c890: 6865 7920 7765 7265 206e 6f74 2063 6f6e  hey were not con
+0000c8a0: 766f 6c76 6564 2074 6f20 6d61 7463 6820  volved to match 
+0000c8b0: 7468 6520 696e 7374 7275 6d65 6e74 616c  the instrumental
+0000c8c0: 0d0a 2020 2020 6469 7370 6572 7369 6f6e  ..    dispersion
+0000c8d0: 206f 6620 7468 6520 6761 6c61 7879 2073   of the galaxy s
+0000c8e0: 7065 6374 7275 6d2e 2049 6e20 7468 6973  pectrum. In this
+0000c8f0: 2073 6974 7561 7469 6f6e 2c20 7468 6520   situation, the 
+0000c900: 636f 6e76 6f6c 7574 696f 6e0d 0a20 2020  convolution..   
+0000c910: 2069 7320 646f 6e65 2062 7920 6060 7050   is done by ``pP
+0000c920: 5846 6060 2077 6974 6820 696e 6372 6561  XF`` with increa
+0000c930: 7365 6420 6163 6375 7261 6379 2c20 7573  sed accuracy, us
+0000c940: 696e 6720 616e 2061 6e61 6c79 7469 6320  ing an analytic 
+0000c950: 466f 7572 6965 720d 0a20 2020 2054 7261  Fourier..    Tra
+0000c960: 6e73 666f 726d 2e0d 0a73 6b79 3a0d 0a20  nsform...sky:.. 
+0000c970: 2020 2076 6563 746f 7220 636f 6e74 6169     vector contai
+0000c980: 6e69 6e67 2074 6865 2073 7065 6374 7275  ning the spectru
+0000c990: 6d20 6f66 2074 6865 2073 6b79 2074 6f20  m of the sky to 
+0000c9a0: 6265 2069 6e63 6c75 6465 6420 696e 2074  be included in t
+0000c9b0: 6865 2066 6974 2c20 6f72 0d0a 2020 2020  he fit, or..    
+0000c9c0: 6172 7261 7920 6f66 2064 696d 656e 7369  array of dimensi
+0000c9d0: 6f6e 7320 6060 736b 795b 6e5f 7069 7865  ons ``sky[n_pixe
+0000c9e0: 6c73 2c20 6e53 6b79 5d60 6020 636f 6e74  ls, nSky]`` cont
+0000c9f0: 6169 6e69 6e67 2064 6966 6665 7265 6e74  aining different
+0000ca00: 2073 6b79 0d0a 2020 2020 7370 6563 7472   sky..    spectr
+0000ca10: 6120 746f 2061 6464 2074 6f20 7468 6520  a to add to the 
+0000ca20: 6d6f 6465 6c20 6f66 2074 6865 206f 6273  model of the obs
+0000ca30: 6572 7665 6420 6060 6761 6c61 7879 6060  erved ``galaxy``
+0000ca40: 2073 7065 6374 7275 6d2e 2054 6865 0d0a   spectrum. The..
+0000ca50: 2020 2020 6060 736b 7960 6020 6861 7320      ``sky`` has 
+0000ca60: 746f 2062 6520 6c6f 672d 7265 6269 6e6e  to be log-rebinn
+0000ca70: 6564 2061 7320 7468 6520 6060 6761 6c61  ed as the ``gala
+0000ca80: 7879 6060 2073 7065 6374 7275 6d20 616e  xy`` spectrum an
+0000ca90: 6420 6e65 6564 7320 746f 0d0a 2020 2020  d needs to..    
+0000caa0: 6861 7665 2074 6865 2073 616d 6520 6e75  have the same nu
+0000cab0: 6d62 6572 206f 6620 7069 7865 6c73 2e0d  mber of pixels..
+0000cac0: 0a0d 0a20 2020 2054 6865 2073 6b79 2069  ...    The sky i
+0000cad0: 7320 6765 6e65 7261 6c6c 7920 7375 6274  s generally subt
+0000cae0: 7261 6374 6564 2066 726f 6d20 7468 6520  racted from the 
+0000caf0: 6461 7461 2062 6566 6f72 6520 7468 6520  data before the 
+0000cb00: 6060 7050 5846 6060 2066 6974 2e0d 0a20  ``pPXF`` fit... 
+0000cb10: 2020 2048 6f77 6576 6572 2c20 666f 7220     However, for 
+0000cb20: 6f62 7365 7276 6174 696f 6e73 2076 6572  observations ver
+0000cb30: 7920 6865 6176 696c 7920 646f 6d69 6e61  y heavily domina
+0000cb40: 7465 6420 6279 2074 6865 2073 6b79 2073  ted by the sky s
+0000cb50: 7065 6374 7275 6d2c 0d0a 2020 2020 7768  pectrum,..    wh
+0000cb60: 6572 6520 6120 7665 7279 2061 6363 7572  ere a very accur
+0000cb70: 6174 6520 736b 7920 7375 6274 7261 6374  ate sky subtract
+0000cb80: 696f 6e20 6973 2063 7269 7469 6361 6c2c  ion is critical,
+0000cb90: 2069 7420 6d61 7920 6265 2075 7365 6675   it may be usefu
+0000cba0: 6c0d 0a20 2020 202a 6e6f 742a 2074 6f20  l..    *not* to 
+0000cbb0: 7375 6274 7261 6374 2074 6865 2073 6b79  subtract the sky
+0000cbc0: 2066 726f 6d20 7468 6520 7370 6563 7472   from the spectr
+0000cbd0: 756d 2c20 6275 7420 746f 2069 6e63 6c75  um, but to inclu
+0000cbe0: 6465 2069 7420 696e 2074 6865 0d0a 2020  de it in the..  
+0000cbf0: 2020 6669 7420 7573 696e 6720 7468 6973    fit using this
+0000cc00: 206b 6579 776f 7264 2e0d 0a74 656d 706c   keyword...templ
+0000cc10: 6174 6573 5f72 6666 743a 0d0a 2020 2020  ates_rfft:..    
+0000cc20: 5768 656e 2063 616c 6c69 6e67 2060 6070  When calling ``p
+0000cc30: 5058 4660 6020 6d61 6e79 2074 696d 6573  PXF`` many times
+0000cc40: 2077 6974 6820 616e 2069 6465 6e74 6963   with an identic
+0000cc50: 616c 2073 6574 206f 6620 7465 6d70 6c61  al set of templa
+0000cc60: 7465 732c 0d0a 2020 2020 6f6e 6520 6361  tes,..    one ca
+0000cc70: 6e20 7573 6520 7468 6973 206b 6579 776f  n use this keywo
+0000cc80: 7264 2074 6f20 7061 7373 2074 6865 2072  rd to pass the r
+0000cc90: 6561 6c20 4646 5420 6f66 2074 6865 2074  eal FFT of the t
+0000cca0: 656d 706c 6174 6573 2c0d 0a20 2020 2063  emplates,..    c
+0000ccb0: 6f6d 7075 7465 6420 696e 2061 2070 7265  omputed in a pre
+0000ccc0: 7669 6f75 7320 6060 7050 5846 6060 2063  vious ``pPXF`` c
+0000ccd0: 616c 6c2c 2073 746f 7265 6420 696e 2074  all, stored in t
+0000cce0: 6865 0d0a 2020 2020 6060 7070 2e74 656d  he..    ``pp.tem
+0000ccf0: 706c 6174 6573 5f72 6666 7460 6020 6174  plates_rfft`` at
+0000cd00: 7472 6962 7574 652e 2054 6869 7320 6b65  tribute. This ke
+0000cd10: 7977 6f72 6420 6d61 696e 6c79 2065 7869  yword mainly exi
+0000cd20: 7374 7320 746f 2073 686f 770d 0a20 2020  sts to show..   
+0000cd30: 2074 6861 7420 7468 6572 6520 6973 206e   that there is n
+0000cd40: 6f20 6e65 6564 2066 6f72 2069 742e 2e2e  o need for it...
+0000cd50: 0d0a 0d0a 2020 2020 494d 504f 5254 414e  ....    IMPORTAN
+0000cd60: 543a 2055 7365 2074 6869 7320 6b65 7977  T: Use this keyw
+0000cd70: 6f72 6420 6f6e 6c79 2069 6620 796f 7520  ord only if you 
+0000cd80: 756e 6465 7273 7461 6e64 2077 6861 7420  understand what 
+0000cd90: 796f 7520 6172 6520 646f 696e 6721 0d0a  you are doing!..
+0000cda0: 7469 6564 3a0d 0a20 2020 2041 206c 6973  tied:..    A lis
+0000cdb0: 7420 6f66 2073 7472 696e 6720 6578 7072  t of string expr
+0000cdc0: 6573 7369 6f6e 732e 2045 6163 6820 6578  essions. Each ex
+0000cdd0: 7072 6573 7369 6f6e 2022 7469 6573 2220  pression "ties" 
+0000cde0: 7468 6520 7061 7261 6d65 7465 7220 746f  the parameter to
+0000cdf0: 0d0a 2020 2020 6f74 6865 7220 6672 6565  ..    other free
+0000ce00: 206f 7220 6669 7865 6420 7061 7261 6d65   or fixed parame
+0000ce10: 7465 7273 2e20 2041 6e79 2065 7870 7265  ters.  Any expre
+0000ce20: 7373 696f 6e20 696e 766f 6c76 696e 6720  ssion involving 
+0000ce30: 636f 6e73 7461 6e74 7320 616e 640d 0a20  constants and.. 
+0000ce40: 2020 2074 6865 2070 6172 616d 6574 6572     the parameter
+0000ce50: 2061 7272 6179 2060 6070 5b6a 5d60 6020   array ``p[j]`` 
+0000ce60: 6172 6520 7065 726d 6974 7465 642e 2053  are permitted. S
+0000ce70: 696e 6365 2074 6865 7920 6172 6520 746f  ince they are to
+0000ce80: 7461 6c6c 790d 0a20 2020 2063 6f6e 7374  tally..    const
+0000ce90: 7261 696e 6564 2c20 7469 6564 2070 6172  rained, tied par
+0000cea0: 616d 6574 6572 7320 6172 6520 636f 6e73  ameters are cons
+0000ceb0: 6964 6572 6564 2074 6f20 6265 2066 6978  idered to be fix
+0000cec0: 6564 3b20 6e6f 2065 7272 6f72 7320 6172  ed; no errors ar
+0000ced0: 650d 0a20 2020 2063 6f6d 7075 7465 6420  e..    computed 
+0000cee0: 666f 7220 7468 656d 2e0d 0a0d 0a20 2020  for them.....   
+0000cef0: 2054 6869 7320 6973 2061 6e20 6172 7261   This is an arra
+0000cf00: 792c 206f 7220 6c69 7374 206f 6620 6172  y, or list of ar
+0000cf10: 7261 7973 2c20 7769 7468 2074 6865 2073  rays, with the s
+0000cf20: 616d 6520 6469 6d65 6e73 696f 6e73 2061  ame dimensions a
+0000cf30: 730d 0a20 2020 2060 6073 7461 7274 6060  s..    ``start``
+0000cf40: 2e20 496e 2070 7261 6374 6963 652c 2066  . In practice, f
+0000cf50: 6f72 2065 7665 7279 2065 6c65 6d65 6e74  or every element
+0000cf60: 206f 6620 6060 7374 6172 7460 6020 6f6e   of ``start`` on
+0000cf70: 6520 6e65 6564 7320 746f 0d0a 2020 2020  e needs to..    
+0000cf80: 7370 6563 6966 7920 6569 7468 6572 2061  specify either a
+0000cf90: 6e20 656d 7074 7920 7374 7269 6e67 2060  n empty string `
+0000cfa0: 6027 2760 6020 696d 706c 7969 6e67 2074  `''`` implying t
+0000cfb0: 6861 7420 7468 6520 7061 7261 6d65 7465  hat the paramete
+0000cfc0: 7220 6973 0d0a 2020 2020 6672 6565 2c20  r is..    free, 
+0000cfd0: 6f72 2061 2073 7472 696e 6720 6578 7072  or a string expr
+0000cfe0: 6573 7369 6f6e 2069 6e76 6f6c 7669 6e67  ession involving
+0000cff0: 2073 6f6d 6520 6f66 2074 6865 2076 6172   some of the var
+0000d000: 6961 626c 6573 2060 6070 5b6a 5d60 602c  iables ``p[j]``,
+0000d010: 0d0a 2020 2020 7768 6572 6520 6060 6a60  ..    where ``j`
+0000d020: 6020 7265 7072 6573 656e 7473 2074 6865  ` represents the
+0000d030: 2069 6e64 6578 206f 6620 7468 6520 666c   index of the fl
+0000d040: 6174 7465 6e65 6420 6c69 7374 206f 6620  attened list of 
+0000d050: 6b69 6e65 6d61 7469 630d 0a20 2020 2070  kinematic..    p
+0000d060: 6172 616d 6574 6572 732e 0d0a 0d0a 2020  arameters.....  
+0000d070: 2020 4558 414d 504c 453a 2057 6520 7761    EXAMPLE: We wa
+0000d080: 6e74 2074 6f20 6669 7420 7468 7265 6520  nt to fit three 
+0000d090: 6b69 6e65 6d61 7469 6320 636f 6d70 6f6e  kinematic compon
+0000d0a0: 656e 7473 2c20 7769 7468 2034 206d 6f6d  ents, with 4 mom
+0000d0b0: 656e 7473 2066 6f72 0d0a 2020 2020 7468  ents for..    th
+0000d0c0: 6520 6669 7273 7420 636f 6d70 6f6e 656e  e first componen
+0000d0d0: 7420 616e 6420 3220 6d6f 6d65 6e74 7320  t and 2 moments 
+0000d0e0: 666f 7220 7468 6520 7365 636f 6e64 2061  for the second a
+0000d0f0: 6e64 2074 6869 7264 2028 652e 672e 2073  nd third (e.g. s
+0000d100: 7461 7273 0d0a 2020 2020 616e 6420 7477  tars..    and tw
+0000d110: 6f20 6761 7320 636f 6d70 6f6e 656e 7473  o gas components
+0000d120: 292e 2049 6e20 7468 6973 2063 6173 653a  ). In this case:
+0000d130: 3a0d 0a0d 0a20 2020 2020 2020 206d 6f6d  :....        mom
+0000d140: 656e 7473 203d 205b 342c 2032 2c20 325d  ents = [4, 2, 2]
+0000d150: 0d0a 2020 2020 2020 2020 7374 6172 7420  ..        start 
+0000d160: 3d20 5b5b 5631 2c20 7369 676d 6131 2c20  = [[V1, sigma1, 
+0000d170: 302c 2030 5d2c 205b 5632 2c20 7369 676d  0, 0], [V2, sigm
+0000d180: 6132 5d2c 205b 5633 2c20 7369 676d 6133  a2], [V3, sigma3
+0000d190: 5d5d 0d0a 0d0a 2020 2020 7468 656e 2077  ]]....    then w
+0000d1a0: 6520 6361 6e20 666f 7263 6520 7468 6520  e can force the 
+0000d1b0: 6571 7561 6c69 7479 2063 6f6e 7374 7261  equality constra
+0000d1c0: 696e 7420 6060 5632 203d 2056 3360 6020  int ``V2 = V3`` 
+0000d1d0: 6173 2066 6f6c 6c6f 7773 3a3a 0d0a 0d0a  as follows::....
+0000d1e0: 2020 2020 2020 2020 7469 6564 203d 205b          tied = [
+0000d1f0: 5b27 272c 2027 272c 2027 272c 2027 275d  ['', '', '', '']
+0000d200: 2c20 5b27 272c 2027 275d 2c20 5b27 705b  , ['', ''], ['p[
+0000d210: 345d 272c 2027 275d 5d20 2023 2070 5b36  4]', '']]  # p[6
+0000d220: 5d20 3d20 705b 345d 0d0a 0d0a 2020 2020  ] = p[4]....    
+0000d230: 6f72 2077 6520 6361 6e20 666f 7263 6520  or we can force 
+0000d240: 7468 6520 6571 7561 6c69 7479 2063 6f6e  the equality con
+0000d250: 7374 7261 696e 7420 6060 7369 676d 6132  straint ``sigma2
+0000d260: 203d 2073 6967 6d61 3360 6020 6173 0d0a   = sigma3`` as..
+0000d270: 2020 2020 666f 6c6c 6f77 733a 3a0d 0a0d      follows::...
+0000d280: 0a20 2020 2020 2020 2074 6965 6420 3d20  .        tied = 
+0000d290: 5b5b 2727 2c20 2727 2c20 2727 2c20 2727  [['', '', '', ''
+0000d2a0: 5d2c 205b 2727 2c20 2727 5d2c 205b 2727  ], ['', ''], [''
+0000d2b0: 2c20 2770 5b35 5d27 5d5d 2020 2320 705b  , 'p[5]']]  # p[
+0000d2c0: 375d 203d 2070 5b35 5d0d 0a0d 0a20 2020  7] = p[5]....   
+0000d2d0: 204f 6e65 2063 616e 2061 6c73 6f20 7573   One can also us
+0000d2e0: 6520 6d6f 7265 2067 656e 6572 616c 2066  e more general f
+0000d2f0: 6f72 6d75 6c61 732e 2046 6f72 2065 7861  ormulas. For exa
+0000d300: 6d70 6c65 206f 6e65 2063 6f75 6c64 2063  mple one could c
+0000d310: 6f6e 7374 7261 696e 0d0a 2020 2020 6060  onstrain..    ``
+0000d320: 5633 203d 2028 5631 202b 2056 3229 2f32  V3 = (V1 + V2)/2
+0000d330: 6060 2061 7320 7765 6c6c 2061 7320 6060  `` as well as ``
+0000d340: 7369 676d 6131 203d 2073 6967 6d61 3260  sigma1 = sigma2`
+0000d350: 6020 6173 2066 6f6c 6c6f 7773 3a3a 0d0a  ` as follows::..
+0000d360: 0d0a 2020 2020 2020 2020 2320 705b 355d  ..        # p[5]
+0000d370: 203d 2070 5b31 5d0d 0a20 2020 2020 2020   = p[1]..       
+0000d380: 2023 2070 5b36 5d20 3d20 2870 5b30 5d20   # p[6] = (p[0] 
+0000d390: 2b20 705b 345d 292f 320d 0a20 2020 2020  + p[4])/2..     
+0000d3a0: 2020 2074 6965 6420 3d20 5b5b 2727 2c20     tied = [['', 
+0000d3b0: 2727 2c20 2727 2c20 2727 5d2c 205b 2727  '', '', ''], [''
+0000d3c0: 2c20 2770 5b31 5d27 5d2c 205b 2728 705b  , 'p[1]'], ['(p[
+0000d3d0: 305d 202b 2070 5b34 5d29 2f32 272c 2027  0] + p[4])/2', '
+0000d3e0: 275d 5d0d 0a0d 0a20 2020 204e 4f54 453a  ']]....    NOTE:
+0000d3f0: 204f 6e65 2063 6f75 6c64 2069 6e20 7072   One could in pr
+0000d400: 696e 6369 706c 6520 7573 6520 7468 6520  inciple use the 
+0000d410: 6060 7469 6564 6060 206b 6579 776f 7264  ``tied`` keyword
+0000d420: 2074 6f20 636f 6d70 6c65 7465 6c79 2074   to completely t
+0000d430: 6965 0d0a 2020 2020 7468 6520 4c4f 5356  ie..    the LOSV
+0000d440: 4420 6f66 2074 776f 206b 696e 656d 6174  D of two kinemat
+0000d450: 6963 2063 6f6d 706f 6e65 6e74 732e 2048  ic components. H
+0000d460: 6f77 6576 6572 2c20 7468 6973 2073 616d  owever, this sam
+0000d470: 6520 6566 6665 6374 2069 730d 0a20 2020  e effect is..   
+0000d480: 206d 6f72 6520 6566 6669 6369 656e 7420   more efficient 
+0000d490: 6163 6869 6576 6564 2062 7920 6173 7369  achieved by assi
+0000d4a0: 676e 696e 6720 7468 656d 2074 6f20 7468  gning them to th
+0000d4b0: 6520 7361 6d65 206b 696e 656d 6174 6963  e same kinematic
+0000d4c0: 0d0a 2020 2020 636f 6d70 6f6e 656e 7420  ..    component 
+0000d4d0: 7573 696e 6720 7468 6520 6060 636f 6d70  using the ``comp
+0000d4e0: 6f6e 656e 7460 6020 6b65 7977 6f72 642e  onent`` keyword.
+0000d4f0: 0d0a 7472 6967 3a0d 0a20 2020 2053 6574  ..trig:..    Set
+0000d500: 2060 6074 7269 673d 5472 7565 6060 2074   ``trig=True`` t
+0000d510: 6f20 7573 6520 7472 6967 6f6e 6f6d 6574  o use trigonomet
+0000d520: 7269 6320 7365 7269 6573 2061 7320 616e  ric series as an
+0000d530: 2061 6c74 6572 6e61 7469 7665 2074 6f0d   alternative to.
+0000d540: 0a20 2020 204c 6567 656e 6472 6520 706f  .    Legendre po
+0000d550: 6c79 6e6f 6d69 616c 732c 2066 6f72 2062  lynomials, for b
+0000d560: 6f74 6820 7468 6520 6164 6469 7469 7665  oth the additive
+0000d570: 2061 6e64 206d 756c 7469 706c 6963 6174   and multiplicat
+0000d580: 6976 650d 0a20 2020 2070 6f6c 796e 6f6d  ive..    polynom
+0000d590: 6961 6c73 2e20 5768 656e 2060 6074 7269  ials. When ``tri
+0000d5a0: 673d 5472 7565 6060 2074 6865 2066 6974  g=True`` the fit
+0000d5b0: 7465 6420 7365 7269 6573 2062 656c 6f77  ted series below
+0000d5c0: 2068 6173 0d0a 2020 2020 6060 4e20 3d20   has..    ``N = 
+0000d5d0: 6465 6772 6565 2f32 6060 206f 7220 6060  degree/2`` or ``
+0000d5e0: 4e20 3d20 6d64 6567 7265 652f 3260 603a  N = mdegree/2``:
+0000d5f0: 3a0d 0a0d 0a20 2020 2020 2020 2070 6f6c  :....        pol
+0000d600: 7920 3d20 415f 3020 2b20 7375 6d5f 7b6e  y = A_0 + sum_{n
+0000d610: 3d31 7d5e 7b4e 7d20 5b41 5f6e 2a63 6f73  =1}^{N} [A_n*cos
+0000d620: 286e 2a74 6829 202b 2042 5f6e 2a73 696e  (n*th) + B_n*sin
+0000d630: 286e 2a74 6829 5d0d 0a0d 0a20 2020 2049  (n*th)]....    I
+0000d640: 4d50 4f52 5441 4e54 3a20 5468 6520 7472  MPORTANT: The tr
+0000d650: 6967 6f6e 6f6d 6574 7269 6320 7365 7269  igonometric seri
+0000d660: 6573 2068 6173 2070 6572 696f 6469 6320  es has periodic 
+0000d670: 626f 756e 6461 7279 2063 6f6e 6469 7469  boundary conditi
+0000d680: 6f6e 732e 0d0a 2020 2020 5468 6973 2069  ons...    This i
+0000d690: 7320 736f 6d65 7469 6d65 7320 6120 6465  s sometimes a de
+0000d6a0: 7369 7261 626c 6520 7072 6f70 6572 7479  sirable property
+0000d6b0: 2c20 6275 7420 7468 6973 2065 7870 616e  , but this expan
+0000d6c0: 7369 6f6e 2069 7320 6e6f 7420 6173 0d0a  sion is not as..
+0000d6d0: 2020 2020 666c 6578 6962 6c65 2061 7320      flexible as 
+0000d6e0: 7468 6520 4c65 6765 6e64 7265 2070 6f6c  the Legendre pol
+0000d6f0: 796e 6f6d 6961 6c73 2e0d 0a76 656c 7363  ynomials...velsc
+0000d700: 616c 655f 7261 7469 6f3a 2069 6e74 2c20  ale_ratio: int, 
+0000d710: 6f70 7469 6f6e 616c 0d0a 2020 2020 496e  optional..    In
+0000d720: 7465 6765 722e 2047 6976 6573 2074 6865  teger. Gives the
+0000d730: 2069 6e74 6567 6572 2060 6072 6174 696f   integer ``ratio
+0000d740: 203e 3d20 3160 6020 6265 7477 6565 6e20   >= 1`` between 
+0000d750: 7468 6520 6060 7665 6c73 6361 6c65 6060  the ``velscale``
+0000d760: 206f 660d 0a20 2020 2074 6865 2060 6067   of..    the ``g
+0000d770: 616c 6178 7960 6020 616e 6420 7468 6520  alaxy`` and the 
+0000d780: 6060 7465 6d70 6c61 7465 7360 602e 2057  ``templates``. W
+0000d790: 6865 6e20 7468 6973 206b 6579 776f 7264  hen this keyword
+0000d7a0: 2069 7320 7573 6564 2c20 7468 650d 0a20   is used, the.. 
+0000d7b0: 2020 2074 656d 706c 6174 6573 2061 7265     templates are
+0000d7c0: 2063 6f6e 766f 6c76 6564 2062 7920 7468   convolved by th
+0000d7d0: 6520 4c4f 5356 4420 6174 2074 6865 6972  e LOSVD at their
+0000d7e0: 206e 6174 6976 6520 7265 736f 6c75 7469   native resoluti
+0000d7f0: 6f6e 2c20 616e 640d 0a20 2020 206f 6e6c  on, and..    onl
+0000d800: 7920 7375 6273 6571 7565 6e74 6c79 2061  y subsequently a
+0000d810: 7265 2069 6e74 6567 7261 7465 6420 6f76  re integrated ov
+0000d820: 6572 2074 6865 2070 6978 656c 7320 616e  er the pixels an
+0000d830: 6420 6669 7474 6564 2074 6f0d 0a20 2020  d fitted to..   
+0000d840: 2060 6067 616c 6178 7960 602e 2054 6869   ``galaxy``. Thi
+0000d850: 7320 6b65 7977 6f72 6420 6973 2067 656e  s keyword is gen
+0000d860: 6572 616c 6c79 2075 6e6e 6563 6573 7361  erally unnecessa
+0000d870: 7279 2061 6e64 206d 6f73 746c 7920 7573  ry and mostly us
+0000d880: 6566 756c 2066 6f72 0d0a 2020 2020 7465  eful for..    te
+0000d890: 7374 696e 672e 0d0a 0d0a 2020 2020 4e6f  sting.....    No
+0000d8a0: 7465 2074 6861 7420 696e 2072 6561 6c69  te that in reali
+0000d8b0: 7374 6963 2073 6974 7561 7469 6f6e 7320  stic situations 
+0000d8c0: 7468 6520 756e 6365 7274 6169 6e74 7920  the uncertainty 
+0000d8d0: 696e 2074 6865 206b 6e6f 776c 6564 6765  in the knowledge
+0000d8e0: 2061 6e64 0d0a 2020 2020 7661 7269 6174   and..    variat
+0000d8f0: 696f 6e73 206f 6620 7468 6520 696e 7472  ions of the intr
+0000d900: 696e 7369 6320 6c69 6e65 2d73 7072 6561  insic line-sprea
+0000d910: 6420 6675 6e63 7469 6f6e 2062 6563 6f6d  d function becom
+0000d920: 6573 2074 6865 206c 696d 6974 696e 670d  es the limiting.
+0000d930: 0a20 2020 2066 6163 746f 7220 696e 2072  .    factor in r
+0000d940: 6563 6f76 6572 696e 6720 7468 6520 4c4f  ecovering the LO
+0000d950: 5356 4420 7765 6c6c 2062 656c 6f77 2060  SVD well below `
+0000d960: 6076 656c 7363 616c 6560 602e 0d0a 7673  `velscale``...vs
+0000d970: 7973 743a 2066 6c6f 6174 2c20 6f70 7469  yst: float, opti
+0000d980: 6f6e 616c 0d0a 2020 2020 5265 6665 7265  onal..    Refere
+0000d990: 6e63 6520 7665 6c6f 6369 7479 2069 6e20  nce velocity in 
+0000d9a0: 6060 6b6d 2f73 6060 2028 6465 6661 756c  ``km/s`` (defaul
+0000d9b0: 7420 3029 2e20 5468 6520 696e 7075 7420  t 0). The input 
+0000d9c0: 696e 6974 6961 6c20 6775 6573 7320 616e  initial guess an
+0000d9d0: 640d 0a20 2020 2074 6865 206f 7574 7075  d..    the outpu
+0000d9e0: 7420 7665 6c6f 6369 7469 6573 2061 7265  t velocities are
+0000d9f0: 206d 6561 7375 7265 6420 7769 7468 2072   measured with r
+0000da00: 6573 7065 6374 2074 6f20 7468 6973 2076  espect to this v
+0000da10: 656c 6f63 6974 792e 2054 6869 730d 0a20  elocity. This.. 
+0000da20: 2020 206b 6579 776f 7264 2063 616e 2062     keyword can b
+0000da30: 6520 7573 6564 2074 6f20 6163 636f 756e  e used to accoun
+0000da40: 7420 666f 7220 7468 6520 6469 6666 6572  t for the differ
+0000da50: 656e 6365 2069 6e20 7468 6520 7374 6172  ence in the star
+0000da60: 7469 6e67 0d0a 2020 2020 7761 7665 6c65  ting..    wavele
+0000da70: 6e67 7468 206f 6620 7468 6520 7465 6d70  ngth of the temp
+0000da80: 6c61 7465 7320 616e 6420 7468 6520 6761  lates and the ga
+0000da90: 6c61 7879 2073 7065 6374 7275 6d20 6173  laxy spectrum as
+0000daa0: 2066 6f6c 6c6f 7773 3a3a 0d0a 0d0a 2020   follows::....  
+0000dab0: 2020 2020 2020 7673 7973 7420 3d20 632a        vsyst = c*
+0000dac0: 6e70 2e6c 6f67 2877 6176 655f 7465 6d70  np.log(wave_temp
+0000dad0: 5b30 5d2f 7761 7665 5f67 616c 5b30 5d29  [0]/wave_gal[0])
+0000dae0: 0d0a 0d0a 2020 2020 4173 2061 6c74 6572  ....    As alter
+0000daf0: 6e61 7469 7665 2074 6f20 7573 696e 6720  native to using 
+0000db00: 7468 6973 206b 6579 776f 7264 2c20 6f6e  this keyword, on
+0000db10: 6520 6361 6e20 7061 7373 2074 6865 2077  e can pass the w
+0000db20: 6176 656c 656e 6774 6873 0d0a 2020 2020  avelengths..    
+0000db30: 6060 6c61 6d60 6020 616e 6420 6060 6c61  ``lam`` and ``la
+0000db40: 6d5f 7465 6d70 6060 206f 6620 626f 7468  m_temp`` of both
+0000db50: 2074 6865 2060 6067 616c 6178 7960 6020   the ``galaxy`` 
+0000db60: 616e 6420 6060 7465 6d70 6c61 7465 7360  and ``templates`
+0000db70: 600d 0a20 2020 2073 7065 6374 7261 2e20  `..    spectra. 
+0000db80: 496e 2074 6861 7420 6361 7365 2020 6060  In that case  ``
+0000db90: 7673 7973 7460 6020 6973 2063 6f6d 7075  vsyst`` is compu
+0000dba0: 7465 6420 6175 746f 6d61 7469 6361 6c6c  ted automaticall
+0000dbb0: 7920 616e 6420 7368 6f75 6c64 0d0a 2020  y and should..  
+0000dbc0: 2020 6e6f 7420 6265 2067 6976 656e 2e0d    not be given..
+0000dbd0: 0a0d 0a20 2020 2054 6865 2076 616c 7565  ...    The value
+0000dbe0: 2061 7373 6967 6e65 6420 746f 2074 6869   assigned to thi
+0000dbf0: 7320 6b65 7977 6f72 6420 6973 202a 6372  s keyword is *cr
+0000dc00: 7563 6961 6c2a 2066 6f72 2074 6865 2074  ucial* for the t
+0000dc10: 776f 2d73 6964 6564 0d0a 2020 2020 6669  wo-sided..    fi
+0000dc20: 7474 696e 672e 2049 6e20 7468 6973 2063  tting. In this c
+0000dc30: 6173 6520 6060 7673 7973 7460 6020 6361  ase ``vsyst`` ca
+0000dc40: 6e20 6265 2064 6574 6572 6d69 6e65 6420  n be determined 
+0000dc50: 6672 6f6d 2061 2070 7265 7669 6f75 730d  from a previous.
+0000dc60: 0a20 2020 206e 6f72 6d61 6c20 6f6e 652d  .    normal one-
+0000dc70: 7369 6465 6420 6669 7420 746f 2074 6865  sided fit to the
+0000dc80: 2067 616c 6178 7920 7665 6c6f 6369 7479   galaxy velocity
+0000dc90: 2070 726f 6669 6c65 2e20 4166 7465 7220   profile. After 
+0000dca0: 7468 6174 2069 6e69 7469 616c 0d0a 2020  that initial..  
+0000dcb0: 2020 6669 742c 2060 6076 7379 7374 6060    fit, ``vsyst``
+0000dcc0: 2063 616e 2062 6520 6465 6669 6e65 6420   can be defined 
+0000dcd0: 6173 2074 6865 206d 6561 7375 7265 6420  as the measured 
+0000dce0: 7665 6c6f 6369 7479 2061 7420 7468 6520  velocity at the 
+0000dcf0: 6761 6c61 7879 0d0a 2020 2020 6365 6e74  galaxy..    cent
+0000dd00: 6572 2e20 4d6f 7265 2061 6363 7572 6174  er. More accurat
+0000dd10: 656c 7920 6060 7673 7973 7460 6020 6973  ely ``vsyst`` is
+0000dd20: 2074 6865 2076 616c 7565 2077 6869 6368   the value which
+0000dd30: 2068 6173 2074 6f20 6265 0d0a 2020 2020   has to be..    
+0000dd40: 7375 6274 7261 6374 6564 2074 6f20 6f62  subtracted to ob
+0000dd50: 7461 696e 2061 206e 6561 726c 7920 616e  tain a nearly an
+0000dd60: 7469 2d73 796d 6d65 7472 6963 2076 656c  ti-symmetric vel
+0000dd70: 6f63 6974 7920 7072 6f66 696c 6520 6174  ocity profile at
+0000dd80: 2074 6865 0d0a 2020 2020 7477 6f20 6f70   the..    two op
+0000dd90: 706f 7369 7465 2073 6964 6573 206f 6620  posite sides of 
+0000dda0: 7468 6520 6761 6c61 7879 206e 7563 6c65  the galaxy nucle
+0000ddb0: 7573 2e0d 0a0d 0a20 2020 2049 4d50 4f52  us.....    IMPOR
+0000ddc0: 5441 4e54 3a20 7468 6973 2076 616c 7565  TANT: this value
+0000ddd0: 2069 7320 6765 6e65 7261 6c6c 7920 2a64   is generally *d
+0000dde0: 6966 6665 7265 6e74 2a20 6672 6f6d 2074  ifferent* from t
+0000ddf0: 6865 2073 7973 7465 6d69 630d 0a20 2020  he systemic..   
+0000de00: 2076 656c 6f63 6974 7920 6f6e 6520 6361   velocity one ca
+0000de10: 6e20 6765 7420 6672 6f6d 2074 6865 206c  n get from the l
+0000de20: 6974 6572 6174 7572 652e 2044 6f20 6e6f  iterature. Do no
+0000de30: 7420 7472 7920 746f 2075 7365 2074 6861  t try to use tha
+0000de40: 7421 0d0a 0d0a 4f75 7470 7574 2050 6172  t!....Output Par
+0000de50: 616d 6574 6572 730d 0a2d 2d2d 2d2d 2d2d  ameters..-------
+0000de60: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a 5374  ----------....St
+0000de70: 6f72 6564 2061 7320 6174 7472 6962 7574  ored as attribut
+0000de80: 6573 206f 6620 7468 6520 6060 7050 5846  es of the ``pPXF
+0000de90: 6060 2063 6c61 7373 3a0d 0a0d 0a2e 6170  `` class:.....ap
+0000dea0: 6f6c 793a 0d0a 2020 2020 5665 6374 6f72  oly:..    Vector
+0000deb0: 2077 6974 6820 7468 6520 6265 7374 2066   with the best f
+0000dec0: 6974 7469 6e67 2061 6464 6974 6976 6520  itting additive 
+0000ded0: 706f 6c79 6e6f 6d69 616c 2e0d 0a2e 6265  polynomial....be
+0000dee0: 7374 6669 743a 0d0a 2020 2020 5665 6374  stfit:..    Vect
+0000def0: 6f72 2077 6974 6820 7468 6520 6265 7374  or with the best
+0000df00: 2066 6974 7469 6e67 206d 6f64 656c 2066   fitting model f
+0000df10: 6f72 2074 6865 2067 616c 6178 7920 7370  or the galaxy sp
+0000df20: 6563 7472 756d 2e0d 0a20 2020 2054 6869  ectrum...    Thi
+0000df30: 7320 6973 2061 206c 696e 6561 7220 636f  s is a linear co
+0000df40: 6d62 696e 6174 696f 6e20 6f66 2074 6865  mbination of the
+0000df50: 2074 656d 706c 6174 6573 2c20 636f 6e76   templates, conv
+0000df60: 6f6c 7665 6420 7769 7468 2074 6865 2062  olved with the b
+0000df70: 6573 740d 0a20 2020 2066 6974 7469 6e67  est..    fitting
+0000df80: 204c 4f53 5644 2c20 6d75 6c74 6970 6c69   LOSVD, multipli
+0000df90: 6564 2062 7920 7468 6520 6d75 6c74 6970  ed by the multip
+0000dfa0: 6c69 6361 7469 7665 2070 6f6c 796e 6f6d  licative polynom
+0000dfb0: 6961 6c73 2061 6e64 0d0a 2020 2020 7769  ials and..    wi
+0000dfc0: 7468 2073 7562 7365 7175 656e 746c 7920  th subsequently 
+0000dfd0: 6164 6465 6420 706f 6c79 6e6f 6d69 616c  added polynomial
+0000dfe0: 2063 6f6e 7469 6e75 756d 2074 6572 6d73   continuum terms
+0000dff0: 206f 7220 736b 7920 636f 6d70 6f6e 656e   or sky componen
+0000e000: 7473 2e0d 0a2e 6368 6932 3a0d 0a20 2020  ts....chi2:..   
+0000e010: 2054 6865 2072 6564 7563 6564 2060 6063   The reduced ``c
+0000e020: 6869 5e32 6060 2028 6e61 6d65 6c79 2060  hi^2`` (namely `
+0000e030: 6063 6869 5e32 2f44 4f46 6060 2920 6f66  `chi^2/DOF``) of
+0000e040: 2074 6865 2066 6974 2c20 7768 6572 650d   the fit, where.
+0000e050: 0a20 2020 2060 6044 4f46 203d 2070 702e  .    ``DOF = pp.
+0000e060: 646f 6660 6020 2028 6170 7072 6f78 696d  dof``  (approxim
+0000e070: 6174 656c 7920 6060 444f 4620 7e20 7070  ately ``DOF ~ pp
+0000e080: 2e67 6f6f 6470 6978 656c 732e 7369 7a65  .goodpixels.size
+0000e090: 6060 292e 0d0a 0d0a 2020 2020 494d 504f  ``).....    IMPO
+0000e0a0: 5254 414e 543a 2069 6620 6060 4368 695e  RTANT: if ``Chi^
+0000e0b0: 322f 444f 4660 6020 6973 206e 6f74 207e  2/DOF`` is not ~
+0000e0c0: 3120 6974 206d 6561 6e73 2074 6861 7420  1 it means that 
+0000e0d0: 7468 6520 6572 726f 7273 2061 7265 206e  the errors are n
+0000e0e0: 6f74 0d0a 2020 2020 7072 6f70 6572 6c79  ot..    properly
+0000e0f0: 2065 7374 696d 6174 6564 2c20 6f72 2074   estimated, or t
+0000e100: 6861 7420 7468 6520 7465 6d70 6c61 7465  hat the template
+0000e110: 2069 7320 6261 6420 616e 6420 6974 2069   is bad and it i
+0000e120: 7320 2a6e 6f74 2a20 7361 6665 2074 6f0d  s *not* safe to.
+0000e130: 0a20 2020 2073 6574 2074 6865 2060 6063  .    set the ``c
+0000e140: 6c65 616e 6060 206b 6579 776f 7264 2e0d  lean`` keyword..
+0000e150: 0a2e 6475 7374 3a0d 0a20 2020 204c 6973  ..dust:..    Lis
+0000e160: 7420 6f66 2064 6963 7469 6f6e 6172 6965  t of dictionarie
+0000e170: 732c 206f 6e65 2066 6f72 2065 6163 6820  s, one for each 
+0000e180: 6669 7474 6564 206a 2d74 6820 6475 7374  fitted j-th dust
+0000e190: 2063 6f6d 706f 6e65 6e74 2e20 466f 720d   component. For.
+0000e1a0: 0a20 2020 2065 6163 6820 6469 6374 696f  .    each dictio
+0000e1b0: 6e61 7279 2c20 6060 6475 7374 5f6a 5b22  nary, ``dust_j["
+0000e1c0: 736f 6c22 5d60 6020 636f 6e74 6169 6e73  sol"]`` contains
+0000e1d0: 2074 6865 2062 6573 742d 6669 7474 696e   the best-fittin
+0000e1e0: 670d 0a20 2020 2070 6172 616d 6574 6572  g..    parameter
+0000e1f0: 206f 6620 7468 6520 6174 7465 6e75 6174   of the attenuat
+0000e200: 696f 6e20 6375 7276 6520 6f66 2074 6861  ion curve of tha
+0000e210: 7420 6475 7374 2063 6f6d 706f 6e65 6e74  t dust component
+0000e220: 2e20 5468 6520 6f74 6865 720d 0a20 2020  . The other..   
+0000e230: 2066 6965 6c64 206f 6620 7468 6520 6469   field of the di
+0000e240: 6374 696f 6e61 7279 2061 7265 2063 6f70  ctionary are cop
+0000e250: 6965 6420 6672 6f6d 2074 6865 2069 6e70  ied from the inp
+0000e260: 7574 2074 6f20 7468 6520 6b65 7977 6f72  ut to the keywor
+0000e270: 640d 0a20 2020 2060 6064 7573 7460 602e  d..    ``dust``.
+0000e280: 0d0a 2e65 7272 6f72 3a0d 0a20 2020 2054  ...error:..    T
+0000e290: 6869 7320 7661 7269 6162 6c65 2063 6f6e  his variable con
+0000e2a0: 7461 696e 7320 6120 7665 6374 6f72 206f  tains a vector o
+0000e2b0: 6620 2a66 6f72 6d61 6c2a 2075 6e63 6572  f *formal* uncer
+0000e2c0: 7461 696e 7479 2028 6060 312a 7369 676d  tainty (``1*sigm
+0000e2d0: 6160 6029 0d0a 2020 2020 666f 7220 7468  a``)..    for th
+0000e2e0: 6520 6669 7474 6564 2070 6172 616d 6574  e fitted paramet
+0000e2f0: 6572 7320 696e 2074 6865 206f 7574 7075  ers in the outpu
+0000e300: 7420 7665 6374 6f72 2060 6073 6f6c 6060  t vector ``sol``
+0000e310: 2e0d 0a20 2020 2054 6865 7920 6172 6520  ...    They are 
+0000e320: 636f 6d70 7574 6564 2066 726f 6d20 7468  computed from th
+0000e330: 6520 6573 7469 6d61 7465 6420 636f 7661  e estimated cova
+0000e340: 7269 616e 6365 206d 6174 7269 7820 6f66  riance matrix of
+0000e350: 2074 6865 2073 7461 6e64 6172 640d 0a20   the standard.. 
+0000e360: 2020 2065 7272 6f72 7320 696e 2074 6865     errors in the
+0000e370: 2066 6974 7465 6420 7061 7261 6d65 7465   fitted paramete
+0000e380: 7273 2061 7373 756d 696e 6720 6974 2069  rs assuming it i
+0000e390: 7320 6469 6167 6f6e 616c 2061 7420 7468  s diagonal at th
+0000e3a0: 6520 6d69 6e69 6d75 6d2e 0d0a 2020 2020  e minimum...    
+0000e3b0: 5468 6973 206f 7074 696f 6e20 6361 6e20  This option can 
+0000e3c0: 6265 2075 7365 6420 7768 656e 2073 7065  be used when spe
+0000e3d0: 6564 2069 7320 6573 7365 6e74 6961 6c2c  ed is essential,
+0000e3e0: 2074 6f20 6f62 7461 696e 2061 6e20 6f72   to obtain an or
+0000e3f0: 6465 7220 6f66 0d0a 2020 2020 6d61 676e  der of..    magn
+0000e400: 6974 7564 6520 6573 7469 6d61 7465 206f  itude estimate o
+0000e410: 6620 7468 6520 756e 6365 7274 6169 6e74  f the uncertaint
+0000e420: 6965 732c 2062 7574 2077 6520 2a73 7472  ies, but we *str
+0000e430: 6f6e 676c 792a 2072 6563 6f6d 6d65 6e64  ongly* recommend
+0000e440: 2074 6f0d 0a20 2020 2072 756e 2062 6f6f   to..    run boo
+0000e450: 7473 7472 6170 7069 6e67 2073 696d 756c  tstrapping simul
+0000e460: 6174 696f 6e73 2074 6f20 6f62 7461 696e  ations to obtain
+0000e470: 206d 6f72 6520 7265 6c69 6162 6c65 2065   more reliable e
+0000e480: 7272 6f72 732e 2049 6e20 6661 6374 2c0d  rrors. In fact,.
+0000e490: 0a20 2020 2074 6865 7365 2065 7272 6f72  .    these error
+0000e4a0: 7320 6361 6e20 6265 2073 6576 6572 656c  s can be severel
+0000e4b0: 7920 756e 6465 7265 7374 696d 6174 6564  y underestimated
+0000e4c0: 2069 6e20 7468 6520 7265 6769 6f6e 2077   in the region w
+0000e4d0: 6865 7265 2074 6865 0d0a 2020 2020 7065  here the..    pe
+0000e4e0: 6e61 6c74 7920 6566 6665 6374 2069 7320  nalty effect is 
+0000e4f0: 6d6f 7374 2069 6d70 6f72 7461 6e74 2028  most important (
+0000e500: 6060 7369 676d 6120 3c20 322a 7665 6c73  ``sigma < 2*vels
+0000e510: 6361 6c65 6060 292e 0d0a 0d0a 2020 2020  cale``).....    
+0000e520: 5468 6573 6520 6572 726f 7273 2061 7265  These errors are
+0000e530: 206d 6561 6e69 6e67 6c65 7373 2075 6e6c   meaningless unl
+0000e540: 6573 7320 6060 4368 695e 322f 444f 4620  ess ``Chi^2/DOF 
+0000e550: 7e20 3160 602e 2048 6f77 6576 6572 2069  ~ 1``. However i
+0000e560: 6620 6f6e 650d 0a20 2020 202a 6173 7375  f one..    *assu
+0000e570: 6d65 732a 2074 6861 7420 7468 6520 6669  mes* that the fi
+0000e580: 7420 6973 2067 6f6f 642c 2061 2063 6f72  t is good, a cor
+0000e590: 7265 6374 6564 2065 7374 696d 6174 6520  rected estimate 
+0000e5a0: 6f66 2074 6865 2065 7272 6f72 7320 6973  of the errors is
+0000e5b0: 3a3a 0d0a 0d0a 2020 2020 2020 2020 6572  ::....        er
+0000e5c0: 726f 725f 636f 7272 203d 2065 7272 6f72  ror_corr = error
+0000e5d0: 2a73 7172 7428 6368 695e 322f 444f 4629  *sqrt(chi^2/DOF)
+0000e5e0: 203d 2070 702e 6572 726f 722a 7371 7274   = pp.error*sqrt
+0000e5f0: 2870 702e 6368 6932 292e 0d0a 0d0a 2020  (pp.chi2).....  
+0000e600: 2020 494d 504f 5254 414e 543a 2077 6865    IMPORTANT: whe
+0000e610: 6e20 7275 6e6e 696e 6720 4d6f 6e74 6520  n running Monte 
+0000e620: 4361 726c 6f20 7369 6d75 6c61 7469 6f6e  Carlo simulation
+0000e630: 7320 746f 2064 6574 6572 6d69 6e65 2074  s to determine t
+0000e640: 6865 2065 7272 6f72 2c0d 0a20 2020 2074  he error,..    t
+0000e650: 6865 2070 656e 616c 7479 2028 6060 6269  he penalty (``bi
+0000e660: 6173 6060 2920 7368 6f75 6c64 2062 6520  as``) should be 
+0000e670: 7365 7420 746f 207a 6572 6f2c 206f 7220  set to zero, or 
+0000e680: 6265 7474 6572 2074 6f20 6120 7665 7279  better to a very
+0000e690: 2073 6d61 6c6c 0d0a 2020 2020 7661 6c75   small..    valu
+0000e6a0: 652e 2053 6565 2053 6563 7469 6f6e 2033  e. See Section 3
+0000e6b0: 2e34 206f 6620 6043 6170 7065 6c6c 6172  .4 of `Cappellar
+0000e6c0: 6920 2620 456d 7365 6c6c 656d 2028 3230  i & Emsellem (20
+0000e6d0: 3034 2960 5f20 666f 7220 616e 0d0a 2020  04)`_ for an..  
+0000e6e0: 2020 6578 706c 616e 6174 696f 6e2e 0d0a    explanation...
+0000e6f0: 2e67 6173 5f62 6573 7466 6974 3a0d 0a20  .gas_bestfit:.. 
+0000e700: 2020 2049 6620 6060 6761 735f 636f 6d70     If ``gas_comp
+0000e710: 6f6e 656e 7420 6973 206e 6f74 204e 6f6e  onent is not Non
+0000e720: 6560 602c 2074 6869 7320 6174 7472 6962  e``, this attrib
+0000e730: 7574 6520 7265 7475 726e 7320 7468 650d  ute returns the.
+0000e740: 0a20 2020 2062 6573 742d 6669 7474 696e  .    best-fittin
+0000e750: 6720 6761 7320 656d 6973 7369 6f6e 2d6c  g gas emission-l
+0000e760: 696e 6573 2073 7065 6374 7275 6d20 616c  ines spectrum al
+0000e770: 6f6e 652e 0d0a 2020 2020 5468 6520 6265  one...    The be
+0000e780: 7374 2d66 6974 7469 6e67 2073 7465 6c6c  st-fitting stell
+0000e790: 6172 2073 7065 6374 7275 6d20 616c 6f6e  ar spectrum alon
+0000e7a0: 6520 6361 6e20 6265 2063 6f6d 7075 7465  e can be compute
+0000e7b0: 6420 6173 0d0a 2020 2020 6060 7374 6172  d as..    ``star
+0000e7c0: 735f 6265 7374 6669 7420 3d20 7070 2e62  s_bestfit = pp.b
+0000e7d0: 6573 7466 6974 202d 2070 702e 6761 735f  estfit - pp.gas_
+0000e7e0: 6265 7374 6669 7460 600d 0a2e 6761 735f  bestfit``...gas_
+0000e7f0: 6265 7374 6669 745f 7465 6d70 6c61 7465  bestfit_template
+0000e800: 733a 0d0a 2020 2020 4966 2060 6067 6173  s:..    If ``gas
+0000e810: 5f63 6f6d 706f 6e65 6e74 2069 7320 6e6f  _component is no
+0000e820: 7420 4e6f 6e65 6060 2c20 7468 6973 2061  t None``, this a
+0000e830: 7474 7269 6275 7465 2072 6574 7572 6e73  ttribute returns
+0000e840: 2074 6865 2069 6e64 6976 6964 7561 6c0d   the individual.
+0000e850: 0a20 2020 2062 6573 742d 6669 7474 696e  .    best-fittin
+0000e860: 6720 6761 7320 656d 6973 7369 6f6e 2d6c  g gas emission-l
+0000e870: 696e 6573 2074 656d 706c 6174 6573 2061  ines templates a
+0000e880: 7320 636f 6c75 6d6e 7320 6f66 2061 6e20  s columns of an 
+0000e890: 6172 7261 792e 0d0a 2020 2020 4e6f 7465  array...    Note
+0000e8a0: 2074 6861 7420 6060 7070 2e67 6173 5f62   that ``pp.gas_b
+0000e8b0: 6573 7466 6974 203d 2070 702e 6761 735f  estfit = pp.gas_
+0000e8c0: 6265 7374 6669 745f 7465 6d70 6c61 7465  bestfit_template
+0000e8d0: 732e 7375 6d28 3129 6060 0d0a 2e67 6173  s.sum(1)``...gas
+0000e8e0: 5f66 6c75 783a 0d0a 2020 2020 5665 6374  _flux:..    Vect
+0000e8f0: 6f72 2077 6974 6820 7468 6520 696e 7465  or with the inte
+0000e900: 6772 6174 6564 2066 6c75 7820 2869 6e20  grated flux (in 
+0000e910: 636f 756e 7473 2920 6f66 2061 6c6c 206c  counts) of all l
+0000e920: 696e 6573 2073 6574 2061 730d 0a20 2020  ines set as..   
+0000e930: 2060 6054 7275 6560 6020 696e 2074 6865   ``True`` in the
+0000e940: 2069 6e70 7574 2060 6067 6173 5f63 6f6d   input ``gas_com
+0000e950: 706f 6e65 6e74 6060 206b 6579 776f 7264  ponent`` keyword
+0000e960: 2e20 5468 6973 2069 7320 7468 6520 666c  . This is the fl
+0000e970: 7578 206f 660d 0a20 2020 2069 6e64 6976  ux of..    indiv
+0000e980: 6964 7561 6c20 6761 7320 7465 6d70 6c61  idual gas templa
+0000e990: 7465 732c 2077 6869 6368 206d 6179 2069  tes, which may i
+0000e9a0: 6e63 6c75 6465 206d 756c 7469 706c 6520  nclude multiple 
+0000e9b0: 6c69 6e65 732e 0d0a 2020 2020 5468 6973  lines...    This
+0000e9c0: 2069 6d70 6c69 6573 2074 6861 742c 2069   implies that, i
+0000e9d0: 6620 6120 6761 7320 7465 6d70 6c61 7465  f a gas template
+0000e9e0: 2064 6573 6372 6962 6573 2061 2064 6f75   describes a dou
+0000e9f0: 626c 6574 2c20 7468 6520 666c 7578 2069  blet, the flux i
+0000ea00: 730d 0a20 2020 2074 6861 7420 6f66 2062  s..    that of b
+0000ea10: 6f74 6820 6c69 6e65 732e 2049 6620 7468  oth lines. If th
+0000ea20: 6520 4261 6c6d 6572 2073 6572 6965 7320  e Balmer series 
+0000ea30: 6973 2069 6e70 7574 2061 7320 6120 7369  is input as a si
+0000ea40: 6e67 6c65 2074 656d 706c 6174 652c 0d0a  ngle template,..
+0000ea50: 2020 2020 7468 6973 2069 7320 7468 6520      this is the 
+0000ea60: 666c 7578 206f 6620 7468 6520 656e 7469  flux of the enti
+0000ea70: 7265 2073 6572 6965 732e 0d0a 0d0a 2020  re series.....  
+0000ea80: 2020 5468 6520 7265 7475 726e 6564 2066    The returned f
+0000ea90: 6c75 7865 7320 6172 6520 6e6f 7420 636f  luxes are not co
+0000eaa0: 7272 6563 7465 6420 696e 2061 6e79 2077  rrected in any w
+0000eab0: 6179 2061 6e64 2069 6e20 7061 7274 6963  ay and in partic
+0000eac0: 756c 6172 2c20 6e6f 0d0a 2020 2020 7265  ular, no..    re
+0000ead0: 6464 656e 696e 6720 636f 7272 6563 7469  ddening correcti
+0000eae0: 6f6e 2069 7320 6170 706c 6965 642e 2049  on is applied. I
+0000eaf0: 6e20 6f74 6865 7220 776f 7264 732c 2074  n other words, t
+0000eb00: 6865 2072 6574 7572 6e65 640d 0a20 2020  he returned..   
+0000eb10: 2060 602e 6761 735f 666c 7578 6060 2073   ``.gas_flux`` s
+0000eb20: 686f 756c 6420 6265 2075 6e63 6861 6e67  hould be unchang
+0000eb30: 6564 2c20 7769 7468 696e 2074 6865 2065  ed, within the e
+0000eb40: 7272 6f72 732c 2072 6567 6172 646c 6573  rrors, regardles
+0000eb50: 7320 6f66 0d0a 2020 2020 7768 6574 6865  s of..    whethe
+0000eb60: 7220 7265 6464 656e 696e 6720 6f72 206d  r reddening or m
+0000eb70: 756c 7469 706c 6963 6174 6976 6520 706f  ultiplicative po
+0000eb80: 6c79 6e6f 6d69 616c 7320 7765 7265 2066  lynomials were f
+0000eb90: 6974 7465 6420 6279 2060 6070 5058 4660  itted by ``pPXF`
+0000eba0: 600d 0a20 2020 206f 7220 6e6f 742e 0d0a  `..    or not...
+0000ebb0: 0d0a 2020 2020 494d 504f 5254 414e 543a  ..    IMPORTANT:
+0000ebc0: 2060 6070 5058 4660 6020 6d61 6b65 7320   ``pPXF`` makes 
+0000ebd0: 6e6f 2061 7373 756d 7074 696f 6e73 2061  no assumptions a
+0000ebe0: 626f 7574 2074 6865 2069 6e70 7574 2066  bout the input f
+0000ebf0: 6c75 7820 756e 6974 733a 0d0a 2020 2020  lux units:..    
+0000ec00: 5468 6520 7265 7475 726e 6564 2060 602e  The returned ``.
+0000ec10: 6761 735f 666c 7578 6060 2068 6173 2074  gas_flux`` has t
+0000ec20: 6865 2073 616d 6520 756e 6974 7320 616e  he same units an
+0000ec30: 6420 7661 6c75 6573 206f 6e65 2077 6f75  d values one wou
+0000ec40: 6c64 0d0a 2020 2020 6d65 6173 7572 6520  ld..    measure 
+0000ec50: 2877 6974 6820 6c6f 7765 7220 6163 6375  (with lower accu
+0000ec60: 7261 6379 2920 6279 2073 756d 6d69 6e67  racy) by summing
+0000ec70: 2074 6865 2070 6978 656c 7320 7661 6c75   the pixels valu
+0000ec80: 6573 2c20 7769 7468 696e 2074 6865 0d0a  es, within the..
+0000ec90: 2020 2020 6769 7665 6e20 6761 7320 6c69      given gas li
+0000eca0: 6e65 732c 206f 6e20 7468 6520 636f 6e74  nes, on the cont
+0000ecb0: 696e 7575 6d2d 7375 6274 7261 6374 6564  inuum-subtracted
+0000ecc0: 2069 6e70 7574 2067 616c 6178 7920 7370   input galaxy sp
+0000ecd0: 6563 7472 756d 2e0d 0a20 2020 2054 6869  ectrum...    Thi
+0000ece0: 7320 696d 706c 6965 7320 7468 6174 2c20  s implies that, 
+0000ecf0: 6966 2074 6865 2073 7065 6374 7275 6d20  if the spectrum 
+0000ed00: 6973 2069 6e20 756e 6974 7320 6f66 2060  is in units of `
+0000ed10: 6065 7267 2f28 7320 636d 5e32 2041 2960  `erg/(s cm^2 A)`
+0000ed20: 602c 0d0a 2020 2020 7468 6520 6060 2e67  `,..    the ``.g
+0000ed30: 6173 5f66 6c75 7860 6020 7265 7475 726e  as_flux`` return
+0000ed40: 6564 2062 7920 6060 7050 5846 6060 2073  ed by ``pPXF`` s
+0000ed50: 686f 756c 6420 6265 206d 756c 7469 706c  hould be multipl
+0000ed60: 6965 6420 6279 2074 6865 0d0a 2020 2020  ied by the..    
+0000ed70: 7069 7865 6c20 7369 7a65 2069 6e20 416e  pixel size in An
+0000ed80: 6773 7472 6f6d 2061 7420 7468 6520 6c69  gstrom at the li
+0000ed90: 6e65 2077 6176 656c 656e 6774 6820 746f  ne wavelength to
+0000eda0: 206f 6274 6169 6e20 7468 6520 696e 7465   obtain the inte
+0000edb0: 6772 6174 6564 0d0a 2020 2020 6c69 6e65  grated..    line
+0000edc0: 2066 6c75 7820 696e 2075 6e69 7473 206f   flux in units o
+0000edd0: 6620 6060 6572 672f 2873 2063 6d5e 3229  f ``erg/(s cm^2)
+0000ede0: 6060 2e0d 0a0d 0a20 2020 204e 4f54 453a  ``.....    NOTE:
+0000edf0: 2049 6620 7468 6572 6520 6973 206e 6f20   If there is no 
+0000ee00: 6761 7320 7265 6464 656e 696e 6720 616e  gas reddening an
+0000ee10: 6420 6561 6368 2069 6e70 7574 2067 6173  d each input gas
+0000ee20: 2074 656d 706c 6174 6520 7761 730d 0a20   template was.. 
+0000ee30: 2020 206e 6f72 6d61 6c69 7a65 6420 746f     normalized to
+0000ee40: 2060 6073 756d 203d 2031 6060 2c20 7468   ``sum = 1``, th
+0000ee50: 656e 0d0a 2020 2020 6060 7070 2e67 6173  en..    ``pp.gas
+0000ee60: 5f66 6c75 7820 3d20 7070 2e77 6569 6768  _flux = pp.weigh
+0000ee70: 7473 5b70 702e 6761 735f 636f 6d70 6f6e  ts[pp.gas_compon
+0000ee80: 656e 745d 6060 2e0d 0a0d 0a20 2020 2057  ent]``.....    W
+0000ee90: 6865 6e20 6120 6761 7320 7465 6d70 6c61  hen a gas templa
+0000eea0: 7465 2069 7320 6964 656e 7469 6361 6c6c  te is identicall
+0000eeb0: 7920 7a65 726f 2077 6974 6869 6e20 7468  y zero within th
+0000eec0: 6520 6669 7474 6564 2072 6567 696f 6e2c  e fitted region,
+0000eed0: 2074 6865 6e0d 0a20 2020 2060 6070 702e   then..    ``pp.
+0000eee0: 6761 735f 666c 7578 203d 2070 702e 6761  gas_flux = pp.ga
+0000eef0: 735f 666c 7578 5f65 7272 6f72 203d 206e  s_flux_error = n
+0000ef00: 702e 6e61 6e60 602e 2054 6865 2063 6f72  p.nan``. The cor
+0000ef10: 7265 7370 6f6e 6469 6e67 0d0a 2020 2020  responding..    
+0000ef20: 636f 6d70 6f6e 656e 7473 206f 6620 6060  components of ``
+0000ef30: 7070 2e67 6173 5f7a 6572 6f5f 7465 6d70  pp.gas_zero_temp
+0000ef40: 6c61 7465 6060 2061 7265 2073 6574 2074  late`` are set t
+0000ef50: 6f20 6060 5472 7565 6060 2e20 5468 6573  o ``True``. Thes
+0000ef60: 650d 0a20 2020 2060 606e 702e 6e61 6e60  e..    ``np.nan`
+0000ef70: 6020 7661 6c75 6573 2061 7265 2073 6574  ` values are set
+0000ef80: 2061 7420 7468 6520 656e 6420 6f66 2074   at the end of t
+0000ef90: 6865 2063 616c 6375 6c61 7469 6f6e 2074  he calculation t
+0000efa0: 6f20 666c 6167 2074 6865 0d0a 2020 2020  o flag the..    
+0000efb0: 756e 6465 6669 6e65 6420 7661 6c75 6573  undefined values
+0000efc0: 2e20 5468 6573 6520 666c 6167 7320 6765  . These flags ge
+0000efd0: 6e65 7261 6c6c 7920 696e 6469 6361 7465  nerally indicate
+0000efe0: 2074 6861 7420 736f 6d65 206f 6620 7468   that some of th
+0000eff0: 6520 6761 730d 0a20 2020 2074 656d 706c  e gas..    templ
+0000f000: 6174 6573 2070 6173 7365 6420 746f 2060  ates passed to `
+0000f010: 6070 5058 4660 6020 636f 6e73 6973 7420  `pPXF`` consist 
+0000f020: 6f66 2067 6173 2065 6d69 7373 696f 6e20  of gas emission 
+0000f030: 6c69 6e65 7320 7468 6174 2066 616c 6c0d  lines that fall.
+0000f040: 0a20 2020 206f 7574 7369 6465 2074 6865  .    outside the
+0000f050: 2066 6974 7465 6420 7761 7665 6c65 6e67   fitted waveleng
+0000f060: 7468 2072 616e 6765 206f 7220 7769 7468  th range or with
+0000f070: 696e 2061 206d 6173 6b65 6420 7370 6563  in a masked spec
+0000f080: 7472 616c 2072 6567 696f 6e2e 0d0a 2020  tral region...  
+0000f090: 2020 5468 6573 6520 6060 6e70 2e6e 616e    These ``np.nan
+0000f0a0: 6060 2064 6f20 2a6e 6f74 2a20 696e 6469  `` do *not* indi
+0000f0b0: 6361 7465 206e 756d 6572 6963 616c 2069  cate numerical i
+0000f0c0: 7373 7565 7320 7769 7468 2074 6865 2061  ssues with the a
+0000f0d0: 6374 7561 6c0d 0a20 2020 2060 6070 5058  ctual..    ``pPX
+0000f0e0: 4660 6020 6361 6c63 756c 6174 696f 6e20  F`` calculation 
+0000f0f0: 616e 6420 7468 6520 7265 7374 206f 6620  and the rest of 
+0000f100: 7468 6520 6060 7050 5846 6060 206f 7574  the ``pPXF`` out
+0000f110: 7075 7420 6973 2072 656c 6961 626c 652e  put is reliable.
+0000f120: 0d0a 2e67 6173 5f66 6c75 785f 6572 726f  ...gas_flux_erro
+0000f130: 723a 0d0a 2020 2020 2a46 6f72 6d61 6c2a  r:..    *Formal*
+0000f140: 2075 6e63 6572 7461 696e 7479 2028 6060   uncertainty (``
+0000f150: 312a 7369 676d 6160 6029 2066 6f72 2074  1*sigma``) for t
+0000f160: 6865 2071 7561 6e74 6974 7920 6060 7070  he quantity ``pp
+0000f170: 2e67 6173 5f66 6c75 7860 602c 2069 6e0d  .gas_flux``, in.
+0000f180: 0a20 2020 2074 6865 2073 616d 6520 756e  .    the same un
+0000f190: 6974 7320 6173 2074 6865 2067 6173 2066  its as the gas f
+0000f1a0: 6c75 7865 732e 0d0a 0d0a 2020 2020 5468  luxes.....    Th
+0000f1b0: 6973 2065 7272 6f72 2069 7320 6170 7072  is error is appr
+0000f1c0: 6f78 696d 6174 6520 6173 2069 7420 6967  oximate as it ig
+0000f1d0: 6e6f 7265 7320 7468 6520 636f 7661 7269  nores the covari
+0000f1e0: 616e 6365 2062 6574 7765 656e 2074 6865  ance between the
+0000f1f0: 2067 6173 0d0a 2020 2020 666c 7578 2061   gas..    flux a
+0000f200: 6e64 2061 6e79 206e 6f6e 2d6c 696e 6561  nd any non-linea
+0000f210: 7220 7061 7261 6d65 7465 722e 2042 6f6f  r parameter. Boo
+0000f220: 7473 7472 6170 7069 6e67 2063 616e 2062  tstrapping can b
+0000f230: 6520 7573 6564 2066 6f72 206d 6f72 650d  e used for more.
+0000f240: 0a20 2020 2061 6363 7572 6174 6520 6572  .    accurate er
+0000f250: 726f 7273 2e0d 0a0d 0a20 2020 2054 6865  rors.....    The
+0000f260: 7365 2065 7272 6f72 7320 6172 6520 6d65  se errors are me
+0000f270: 616e 696e 676c 6573 7320 756e 6c65 7373  aningless unless
+0000f280: 2060 6043 6869 5e32 2f44 4f46 207e 2031   ``Chi^2/DOF ~ 1
+0000f290: 6060 2e20 486f 7765 7665 7220 6966 206f  ``. However if o
+0000f2a0: 6e65 0d0a 2020 2020 2a61 7373 756d 6573  ne..    *assumes
+0000f2b0: 2a20 7468 6174 2074 6865 2066 6974 2069  * that the fit i
+0000f2c0: 7320 676f 6f64 2c20 6120 636f 7272 6563  s good, a correc
+0000f2d0: 7465 6420 6573 7469 6d61 7465 206f 6620  ted estimate of 
+0000f2e0: 7468 6520 6572 726f 7273 2069 733a 3a0d  the errors is::.
+0000f2f0: 0a0d 0a20 2020 2020 2020 2067 6173 5f66  ...        gas_f
+0000f300: 6c75 785f 6572 726f 725f 636f 7272 203d  lux_error_corr =
+0000f310: 2067 6173 5f66 6c75 785f 6572 726f 722a   gas_flux_error*
+0000f320: 7371 7274 2863 6869 5e32 2f44 4f46 290d  sqrt(chi^2/DOF).
+0000f330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f340: 2020 2020 2020 2020 2020 2020 203d 2070               = p
+0000f350: 702e 6761 735f 666c 7578 5f65 7272 6f72  p.gas_flux_error
+0000f360: 2a73 7172 7428 7070 2e63 6869 3229 2e0d  *sqrt(pp.chi2)..
+0000f370: 0a0d 0a2e 6761 735f 6d70 6f6c 793a 0d0a  ....gas_mpoly:..
+0000f380: 2020 2020 7665 6374 6f72 2077 6974 6820      vector with 
+0000f390: 7468 6520 6265 7374 2d66 6974 7469 6e67  the best-fitting
+0000f3a0: 2067 6173 2072 6564 6465 6e69 6e67 2063   gas reddening c
+0000f3b0: 7572 7665 2e0d 0a2e 6761 735f 7265 6464  urve....gas_redd
+0000f3c0: 656e 696e 673a 0d0a 2020 2020 4265 7374  ening:..    Best
+0000f3d0: 2066 6974 7469 6e67 2060 6041 5f56 6060   fitting ``A_V``
+0000f3e0: 2076 616c 7565 2069 6620 7468 6520 6060   value if the ``
+0000f3f0: 6761 735f 7265 6464 656e 696e 6760 6020  gas_reddening`` 
+0000f400: 6b65 7977 6f72 6420 6973 2073 6574 2e0d  keyword is set..
+0000f410: 0a20 2020 2054 6869 7320 6973 2065 7370  .    This is esp
+0000f420: 6563 6961 6c6c 7920 7573 6566 756c 2077  ecially useful w
+0000f430: 6865 6e20 7468 6520 4261 6c6d 6572 2073  hen the Balmer s
+0000f440: 6572 6965 7320 6973 2069 6e70 7574 2061  eries is input a
+0000f450: 7320 6120 7369 6e67 6c65 0d0a 2020 2020  s a single..    
+0000f460: 7465 6d70 6c61 7465 2077 6974 6820 616e  template with an
+0000f470: 2061 7373 756d 6564 2074 6865 6f72 6574   assumed theoret
+0000f480: 6963 616c 6c79 2070 7265 6469 6374 6564  ically predicted
+0000f490: 2064 6563 7265 6d65 6e74 2065 2e67 2e20   decrement e.g. 
+0000f4a0: 7573 696e 670d 0a20 2020 2060 6065 6d69  using..    ``emi
+0000f4b0: 7373 696f 6e5f 6c69 6e65 7328 2e2e 2e2c  ssion_lines(...,
+0000f4c0: 2074 6965 5f62 616c 6d65 723d 5472 7565   tie_balmer=True
+0000f4d0: 2960 6020 696e 2060 6070 7078 662e 7070  )`` in ``ppxf.pp
+0000f4e0: 7866 5f75 7469 6c60 6020 746f 0d0a 2020  xf_util`` to..  
+0000f4f0: 2020 636f 6d70 7574 6520 7468 6520 6761    compute the ga
+0000f500: 7320 7465 6d70 6c61 7465 732e 0d0a 2e67  s templates....g
+0000f510: 6173 5f7a 6572 6f5f 7465 6d70 6c61 7465  as_zero_template
+0000f520: 3a0d 0a20 2020 2076 6563 746f 7220 6f66  :..    vector of
+0000f530: 2073 697a 6520 6060 6761 735f 636f 6d70   size ``gas_comp
+0000f540: 6f6e 656e 742e 7375 6d28 2960 6020 7365  onent.sum()`` se
+0000f550: 7420 746f 2060 6054 7275 6560 6020 7768  t to ``True`` wh
+0000f560: 6572 650d 0a20 2020 2074 6865 2067 6173  ere..    the gas
+0000f570: 2074 656d 706c 6174 6520 7761 7320 6964   template was id
+0000f580: 656e 7469 6361 6c6c 7920 7a65 726f 2077  entically zero w
+0000f590: 6974 6869 6e20 7468 6520 6669 7474 6564  ithin the fitted
+0000f5a0: 2072 6567 696f 6e2e 0d0a 2020 2020 466f   region...    Fo
+0000f5b0: 7220 7468 6f73 6520 6761 7320 636f 6d70  r those gas comp
+0000f5c0: 6f6e 656e 7473 2060 6070 702e 6761 735f  onents ``pp.gas_
+0000f5d0: 666c 7578 203d 2070 702e 6761 735f 666c  flux = pp.gas_fl
+0000f5e0: 7578 5f65 7272 6f72 203d 206e 702e 6e61  ux_error = np.na
+0000f5f0: 6e60 602e 0d0a 2020 2020 5468 6573 6520  n``...    These 
+0000f600: 666c 6167 7320 6765 6e65 7261 6c6c 7920  flags generally 
+0000f610: 696e 6469 6361 7465 2074 6861 7420 736f  indicate that so
+0000f620: 6d65 206f 6620 7468 6520 6761 7320 7465  me of the gas te
+0000f630: 6d70 6c61 7465 7320 7061 7373 6564 2074  mplates passed t
+0000f640: 6f0d 0a20 2020 2060 6070 5058 4660 6020  o..    ``pPXF`` 
+0000f650: 636f 6e73 6973 7420 6f66 2067 6173 2065  consist of gas e
+0000f660: 6d69 7373 696f 6e20 6c69 6e65 7320 7468  mission lines th
+0000f670: 6174 2066 616c 6c20 6f75 7473 6964 6520  at fall outside 
+0000f680: 7468 6520 6669 7474 6564 0d0a 2020 2020  the fitted..    
+0000f690: 7761 7665 6c65 6e67 7468 2072 616e 6765  wavelength range
+0000f6a0: 206f 7220 7769 7468 696e 2061 206d 6173   or within a mas
+0000f6b0: 6b65 6420 7370 6563 7472 616c 2072 6567  ked spectral reg
+0000f6c0: 696f 6e2e 0d0a 2e67 6f6f 6470 6978 656c  ion....goodpixel
+0000f6d0: 733a 0d0a 2020 2020 496e 7465 6765 7220  s:..    Integer 
+0000f6e0: 7665 6374 6f72 2063 6f6e 7461 696e 696e  vector containin
+0000f6f0: 6720 7468 6520 696e 6469 6365 7320 6f66  g the indices of
+0000f700: 2074 6865 2067 6f6f 6420 7069 7865 6c73   the good pixels
+0000f710: 2069 6e20 7468 6520 6669 742e 0d0a 2020   in the fit...  
+0000f720: 2020 5468 6973 2076 6563 746f 7220 6973    This vector is
+0000f730: 2061 2063 6f70 7920 6f66 2074 6865 2069   a copy of the i
+0000f740: 6e70 7574 2060 6067 6f6f 6470 6978 656c  nput ``goodpixel
+0000f750: 7360 6020 6966 2060 6063 6c65 616e 203d  s`` if ``clean =
+0000f760: 2046 616c 7365 6060 0d0a 2020 2020 6f74   False``..    ot
+0000f770: 6865 7277 6973 6520 6974 2077 696c 6c20  herwise it will 
+0000f780: 6265 2075 7064 6174 6564 2062 7920 7265  be updated by re
+0000f790: 6d6f 7669 6e67 2074 6865 2064 6574 6563  moving the detec
+0000f7a0: 7465 6420 6f75 746c 6965 7273 2e0d 0a2e  ted outliers....
+0000f7b0: 6d61 7472 6978 3a0d 0a20 2020 2050 7265  matrix:..    Pre
+0000f7c0: 6469 6374 696f 6e20 6060 6d61 7472 6978  diction ``matrix
+0000f7d0: 5b6e 5f70 6978 656c 732c 2064 6567 7265  [n_pixels, degre
+0000f7e0: 6520 2b20 6e5f 7465 6d70 6c61 7465 7320  e + n_templates 
+0000f7f0: 2b20 6e5f 736b 795d 6060 206f 6620 7468  + n_sky]`` of th
+0000f800: 650d 0a20 2020 206c 696e 6561 7220 7379  e..    linear sy
+0000f810: 7374 656d 2e0d 0a0d 0a20 2020 2060 6070  stem.....    ``p
+0000f820: 702e 6d61 7472 6978 5b6e 5f70 6978 656c  p.matrix[n_pixel
+0000f830: 732c 203a 2064 6567 7265 655d 6060 2063  s, : degree]`` c
+0000f840: 6f6e 7461 696e 7320 7468 6520 6164 6469  ontains the addi
+0000f850: 7469 7665 2070 6f6c 796e 6f6d 6961 6c73  tive polynomials
+0000f860: 2069 660d 0a20 2020 2060 6064 6567 7265   if..    ``degre
+0000f870: 6520 3e3d 2030 6060 2e0d 0a0d 0a20 2020  e >= 0``.....   
+0000f880: 2060 6070 702e 6d61 7472 6978 5b6e 5f70   ``pp.matrix[n_p
+0000f890: 6978 656c 732c 2064 6567 7265 6520 3a20  ixels, degree : 
+0000f8a0: 6465 6772 6565 202b 206e 5f74 656d 706c  degree + n_templ
+0000f8b0: 6174 6573 5d60 6020 636f 6e74 6169 6e73  ates]`` contains
+0000f8c0: 2074 6865 0d0a 2020 2020 7374 656c 6c61   the..    stella
+0000f8d0: 722f 6761 7320 7465 6d70 6c61 7465 7320  r/gas templates 
+0000f8e0: 636f 6e76 6f6c 7665 6420 6279 2074 6865  convolved by the
+0000f8f0: 204c 4f53 5644 2c20 616e 6420 6d75 6c74   LOSVD, and mult
+0000f900: 6970 6c69 6564 2062 7920 7468 650d 0a20  iplied by the.. 
+0000f910: 2020 206d 756c 7469 706c 6963 6174 6976     multiplicativ
+0000f920: 6520 706f 6c79 6e6f 6d69 616c 7320 6966  e polynomials if
+0000f930: 2060 606d 6465 6772 6565 203e 2030 6060   ``mdegree > 0``
+0000f940: 2e0d 0a2e 6d70 6f6c 793a 0d0a 2020 2020  ....mpoly:..    
+0000f950: 4265 7374 2066 6974 7469 6e67 206d 756c  Best fitting mul
+0000f960: 7469 706c 6963 6174 6976 6520 706f 6c79  tiplicative poly
+0000f970: 6e6f 6d69 616c 2028 6f72 2072 6564 6465  nomial (or redde
+0000f980: 6e69 6e67 2063 7572 7665 2077 6865 6e0d  ning curve when.
+0000f990: 0a20 2020 2060 6072 6564 6465 6e69 6e67  .    ``reddening
+0000f9a0: 6060 2069 7320 7365 7429 2e0d 0a2e 6d70  `` is set)....mp
+0000f9b0: 6f6c 7977 6569 6768 7473 3a0d 0a20 2020  olyweights:..   
+0000f9c0: 2054 6869 7320 6973 206c 6172 6765 6c79   This is largely
+0000f9d0: 2073 7570 6572 7365 6465 6420 6279 2074   superseded by t
+0000f9e0: 6865 2060 602e 6d70 6f6c 7960 6020 6174  he ``.mpoly`` at
+0000f9f0: 7472 6962 7574 6520 6162 6f76 652e 0d0a  tribute above...
+0000fa00: 0d0a 2020 2020 5768 656e 2060 606d 6465  ..    When ``mde
+0000fa10: 6772 6565 203e 2030 6060 2074 6869 7320  gree > 0`` this 
+0000fa20: 636f 6e74 6169 6e73 2069 6e20 6f75 7470  contains in outp
+0000fa30: 7574 2074 6865 2063 6f65 6666 6963 6965  ut the coefficie
+0000fa40: 6e74 7320 6f66 2074 6865 0d0a 2020 2020  nts of the..    
+0000fa50: 6d75 6c74 6970 6c69 6361 7469 7665 204c  multiplicative L
+0000fa60: 6567 656e 6472 6520 706f 6c79 6e6f 6d69  egendre polynomi
+0000fa70: 616c 7320 6f66 206f 7264 6572 2060 6031  als of order ``1
+0000fa80: 2c20 322c 2e2e 2e20 6d64 6567 7265 6560  , 2,... mdegree`
+0000fa90: 602e 0d0a 2020 2020 5468 6520 706f 6c79  `...    The poly
+0000faa0: 6e6f 6d69 616c 2063 616e 2062 6520 6578  nomial can be ex
+0000fab0: 706c 6963 6974 6c79 2065 7661 6c75 6174  plicitly evaluat
+0000fac0: 6564 2061 733a 3a0d 0a0d 0a20 2020 2020  ed as::....     
+0000fad0: 2020 2066 726f 6d20 6e75 6d70 792e 706f     from numpy.po
+0000fae0: 6c79 6e6f 6d69 616c 2069 6d70 6f72 7420  lynomial import 
+0000faf0: 6c65 6765 6e64 7265 0d0a 2020 2020 2020  legendre..      
+0000fb00: 2020 7820 3d20 6e70 2e6c 696e 7370 6163    x = np.linspac
+0000fb10: 6528 2d31 2c20 312c 206c 656e 2867 616c  e(-1, 1, len(gal
+0000fb20: 6178 7929 290d 0a20 2020 2020 2020 206d  axy))..        m
+0000fb30: 706f 6c79 203d 206c 6567 656e 6472 652e  poly = legendre.
+0000fb40: 6c65 6776 616c 2878 2c20 6e70 2e61 7070  legval(x, np.app
+0000fb50: 656e 6428 312c 2070 702e 6d70 6f6c 7977  end(1, pp.mpolyw
+0000fb60: 6569 6768 7473 2929 0d0a 0d0a 2020 2020  eights))....    
+0000fb70: 5768 656e 2060 6074 7269 6720 3d20 5472  When ``trig = Tr
+0000fb80: 7565 6060 2074 6865 2070 6f6c 796e 6f6d  ue`` the polynom
+0000fb90: 6961 6c20 6973 2065 7661 6c75 6174 6564  ial is evaluated
+0000fba0: 2061 733a 3a0d 0a0d 0a20 2020 2020 2020   as::....       
+0000fbb0: 206d 706f 6c79 203d 2070 702e 7472 6967   mpoly = pp.trig
+0000fbc0: 7661 6c28 782c 206e 702e 6170 7065 6e64  val(x, np.append
+0000fbd0: 2831 2c20 7070 2e6d 706f 6c79 7765 6967  (1, pp.mpolyweig
+0000fbe0: 6874 7329 290d 0a0d 0a2e 7068 6f74 5f62  hts)).....phot_b
+0000fbf0: 6573 7466 6974 3a20 6172 7261 795f 6c69  estfit: array_li
+0000fc00: 6b65 2077 6974 6820 7368 6170 6520 286e  ke with shape (n
+0000fc10: 5f70 686f 7429 0d0a 2020 2020 5768 656e  _phot)..    When
+0000fc20: 2060 6070 686f 7460 6020 6973 2067 6976   ``phot`` is giv
+0000fc30: 656e 2c20 7468 656e 2074 6869 7320 6174  en, then this at
+0000fc40: 7472 6962 7574 6520 636f 6e74 6169 6e73  tribute contains
+0000fc50: 2074 6865 2062 6573 7420 6669 7474 696e   the best fittin
+0000fc60: 670d 0a20 2020 2066 6c75 7865 7320 696e  g..    fluxes in
+0000fc70: 2074 6865 2070 686f 746f 6d65 7472 6963   the photometric
+0000fc80: 2062 616e 6473 2067 6976 656e 2061 7320   bands given as 
+0000fc90: 696e 7075 7420 696e 2060 6070 686f 745f  input in ``phot_
+0000fca0: 6761 6c61 7879 6060 2e0d 0a2e 706c 6f74  galaxy``....plot
+0000fcb0: 3a20 6675 6e63 7469 6f6e 0d0a 2020 2020  : function..    
+0000fcc0: 4361 6c6c 2074 6865 206d 6574 686f 6420  Call the method 
+0000fcd0: 6675 6e63 7469 6f6e 2060 6070 702e 706c  function ``pp.pl
+0000fce0: 6f74 2829 6060 2061 6674 6572 2074 6865  ot()`` after the
+0000fcf0: 2063 616c 6c20 746f 0d0a 2020 2020 6060   call to..    ``
+0000fd00: 7070 203d 2070 7078 6628 2e2e 2e29 6060  pp = ppxf(...)``
+0000fd10: 2074 6f20 7072 6f64 7563 6520 6120 706c   to produce a pl
+0000fd20: 6f74 206f 6620 7468 6520 6265 7374 2066  ot of the best f
+0000fd30: 6974 2e20 5468 6973 2069 7320 616e 0d0a  it. This is an..
+0000fd40: 2020 2020 616c 7465 726e 6174 6976 6520      alternative 
+0000fd50: 746f 2063 616c 6c69 6e67 2060 6070 7020  to calling ``pp 
+0000fd60: 3d20 7070 7866 282e 2e2e 2c20 706c 6f74  = ppxf(..., plot
+0000fd70: 3d54 7275 6529 6060 2e0d 0a0d 0a20 2020  =True)``.....   
+0000fd80: 2055 7365 2074 6865 2063 6f6d 6d61 6e64   Use the command
+0000fd90: 2060 6070 702e 706c 6f74 2867 6173 5f63   ``pp.plot(gas_c
+0000fda0: 6c69 703d 5472 7565 2960 6020 746f 2073  lip=True)`` to s
+0000fdb0: 6361 6c65 2074 6865 2070 6c6f 7420 6261  cale the plot ba
+0000fdc0: 7365 6420 6f6e 0d0a 2020 2020 7468 6520  sed on..    the 
+0000fdd0: 7374 656c 6c61 7220 636f 6e74 696e 7575  stellar continuu
+0000fde0: 6d20 616c 6f6e 652c 2077 6869 6c65 2061  m alone, while a
+0000fdf0: 6c6c 6f77 696e 6720 666f 7220 7468 6520  llowing for the 
+0000fe00: 6761 7320 656d 6973 7369 6f6e 206c 696e  gas emission lin
+0000fe10: 6573 0d0a 2020 2020 746f 2067 6f20 6f75  es..    to go ou
+0000fe20: 7473 6964 6520 7468 6520 706c 6f74 7469  tside the plotti
+0000fe30: 6e67 2072 6567 696f 6e2e 2054 6869 7320  ng region. This 
+0000fe40: 6973 2075 7365 6675 6c20 746f 2069 6e73  is useful to ins
+0000fe50: 7065 6374 2074 6865 2066 6974 0d0a 2020  pect the fit..  
+0000fe60: 2020 746f 2074 6865 2073 7465 6c6c 6172    to the stellar
+0000fe70: 2063 6f6e 7469 6e75 756d 2c20 696e 2074   continuum, in t
+0000fe80: 6865 2070 7265 7365 6e63 6520 6f66 2073  he presence of s
+0000fe90: 7472 6f6e 6720 6761 7320 656d 6973 7369  trong gas emissi
+0000fea0: 6f6e 206c 696e 6573 2e0d 0a20 2020 2054  on lines...    T
+0000feb0: 6869 7320 6861 7320 6566 6665 6374 206f  his has effect o
+0000fec0: 6e6c 7920 6966 2060 6067 6173 5f63 6f6d  nly if ``gas_com
+0000fed0: 706f 6e65 6e74 2069 7320 6e6f 7420 4e6f  ponent is not No
+0000fee0: 6e65 6060 2e0d 0a0d 0a20 2020 2055 7365  ne``.....    Use
+0000fef0: 2074 6865 2063 6f6d 6d61 6e64 2060 6070   the command ``p
+0000ff00: 702e 706c 6f74 282e 2e2e 2c20 7370 6563  p.plot(..., spec
+0000ff10: 3d54 7275 6529 6060 2074 6f20 696e 636c  =True)`` to incl
+0000ff20: 7564 6520 7468 6520 6761 6c61 7879 0d0a  ude the galaxy..
+0000ff30: 2020 2020 7370 6563 7472 756d 2069 6e20      spectrum in 
+0000ff40: 7468 6520 706c 6f74 2061 6e64 2060 6070  the plot and ``p
+0000ff50: 702e 706c 6f74 282e 2e2e 2c20 7068 6f74  p.plot(..., phot
+0000ff60: 3d54 7275 6529 6060 2074 6f20 696e 636c  =True)`` to incl
+0000ff70: 7564 6520 7468 650d 0a20 2020 2070 686f  ude the..    pho
+0000ff80: 746f 6d65 7472 6963 206d 6561 7375 7265  tometric measure
+0000ff90: 6d65 6e74 732e 2046 6f72 2065 7861 6d70  ments. For examp
+0000ffa0: 6c65 2c20 7768 656e 2066 6974 7469 6e67  le, when fitting
+0000ffb0: 2073 7065 6374 7261 2061 6e64 0d0a 2020   spectra and..  
+0000ffc0: 2020 7068 6f74 6f6d 6574 7279 2074 6f67    photometry tog
+0000ffd0: 6574 6865 722c 206f 6e65 2063 616e 2075  ether, one can u
+0000ffe0: 7365 2060 6070 702e 706c 6f74 2870 686f  se ``pp.plot(pho
+0000fff0: 743d 5472 7565 2c20 7370 6563 3d46 616c  t=True, spec=Fal
+00010000: 7365 2960 600d 0a20 2020 2074 6f20 706c  se)``..    to pl
+00010010: 6f74 2074 6865 2070 686f 746f 6d65 7472  ot the photometr
+00010020: 7920 616c 6f6e 6520 616e 6420 6060 7070  y alone and ``pp
+00010030: 2e70 6c6f 7428 7068 6f74 3d46 616c 7365  .plot(phot=False
+00010040: 2c20 7370 6563 3d54 7275 6529 6060 0d0a  , spec=True)``..
+00010050: 2020 2020 746f 2070 6c6f 7420 7468 6520      to plot the 
+00010060: 7370 6563 7472 756d 2061 6c6f 6e65 2e20  spectrum alone. 
+00010070: 4279 2064 6566 6175 6c74 2062 6f74 6820  By default both 
+00010080: 7468 6520 7370 6563 7472 756d 2061 6e64  the spectrum and
+00010090: 2070 686f 746f 6d65 7472 790d 0a20 2020   photometry..   
+000100a0: 2061 7265 2069 6e63 6c75 6465 6420 696e   are included in
+000100b0: 2061 2073 696e 676c 6520 706c 6f74 2e0d   a single plot..
+000100c0: 0a2e 706f 6c79 7765 6967 6874 733a 0d0a  ..polyweights:..
+000100d0: 2020 2020 5468 6973 2069 7320 6c61 7267      This is larg
+000100e0: 656c 7920 7375 7065 7273 6564 6564 2062  ely superseded b
+000100f0: 7920 7468 6520 6060 2e61 706f 6c79 6060  y the ``.apoly``
+00010100: 2061 7474 7269 6275 7465 2061 626f 7665   attribute above
+00010110: 2e0d 0a0d 0a20 2020 2057 6865 6e20 6060  .....    When ``
+00010120: 6465 6772 6565 203e 3d20 3060 6020 636f  degree >= 0`` co
+00010130: 6e74 6169 6e73 2074 6865 2077 6569 6768  ntains the weigh
+00010140: 7473 206f 6620 7468 6520 6164 6469 7469  ts of the additi
+00010150: 7665 204c 6567 656e 6472 650d 0a20 2020  ve Legendre..   
+00010160: 2070 6f6c 796e 6f6d 6961 6c73 206f 6620   polynomials of 
+00010170: 6f72 6465 7220 6060 302c 2031 2c2e 2e2e  order ``0, 1,...
+00010180: 2064 6567 7265 6560 602e 2054 6865 2062   degree``. The b
+00010190: 6573 742d 6669 7474 696e 6720 6164 6469  est-fitting addi
+000101a0: 7469 7665 0d0a 2020 2020 706f 6c79 6e6f  tive..    polyno
+000101b0: 6d69 616c 2063 616e 2062 6520 6578 706c  mial can be expl
+000101c0: 6963 6974 6c79 2065 7661 6c75 6174 6564  icitly evaluated
+000101d0: 2061 733a 3a0d 0a0d 0a20 2020 2020 2020   as::....       
+000101e0: 2066 726f 6d20 6e75 6d70 792e 706f 6c79   from numpy.poly
+000101f0: 6e6f 6d69 616c 2069 6d70 6f72 7420 6c65  nomial import le
+00010200: 6765 6e64 7265 0d0a 2020 2020 2020 2020  gendre..        
+00010210: 7820 3d20 6e70 2e6c 696e 7370 6163 6528  x = np.linspace(
+00010220: 2d31 2c20 312c 206c 656e 2867 616c 6178  -1, 1, len(galax
+00010230: 7929 290d 0a20 2020 2020 2020 2061 706f  y))..        apo
+00010240: 6c79 203d 206c 6567 656e 6472 652e 6c65  ly = legendre.le
+00010250: 6776 616c 2878 2c20 7070 2e70 6f6c 7977  gval(x, pp.polyw
+00010260: 6569 6768 7473 290d 0a0d 0a20 2020 2057  eights)....    W
+00010270: 6865 6e20 6060 7472 6967 3d54 7275 6560  hen ``trig=True`
+00010280: 6020 7468 6520 706f 6c79 6e6f 6d69 616c  ` the polynomial
+00010290: 2069 7320 6576 616c 7561 7465 6420 6173   is evaluated as
+000102a0: 3a3a 0d0a 0d0a 2020 2020 2020 2020 6170  ::....        ap
+000102b0: 6f6c 7920 3d20 7070 2e74 7269 6776 616c  oly = pp.trigval
+000102c0: 2878 2c20 7070 2e70 6f6c 7977 6569 6768  (x, pp.polyweigh
+000102d0: 7473 290d 0a0d 0a20 2020 2057 6865 6e20  ts)....    When 
+000102e0: 646f 696e 6720 6120 7477 6f2d 7369 6465  doing a two-side
+000102f0: 6420 6669 7474 696e 6720 2873 6565 2068  d fitting (see h
+00010300: 656c 7020 666f 7220 6060 6761 6c61 7879  elp for ``galaxy
+00010310: 6060 2070 6172 616d 6574 6572 292c 2074  `` parameter), t
+00010320: 6865 0d0a 2020 2020 6164 6469 7469 7665  he..    additive
+00010330: 2070 6f6c 796e 6f6d 6961 6c73 2061 7265   polynomials are
+00010340: 2061 6c6c 6f77 6564 2074 6f20 6265 2064   allowed to be d
+00010350: 6966 6665 7265 6e74 2066 6f72 2074 6865  ifferent for the
+00010360: 206c 6566 7420 616e 6420 7269 6768 740d   left and right.
+00010370: 0a20 2020 2073 7065 6374 7275 6d2e 2049  .    spectrum. I
+00010380: 6e20 7468 6174 2063 6173 652c 2074 6865  n that case, the
+00010390: 206f 7574 7075 7420 7765 6967 6874 7320   output weights 
+000103a0: 6f66 2074 6865 2061 6464 6974 6976 6520  of the additive 
+000103b0: 706f 6c79 6e6f 6d69 616c 730d 0a20 2020  polynomials..   
+000103c0: 2061 6c74 6572 6e61 7465 2062 6574 7765   alternate betwe
+000103d0: 656e 2074 6865 2066 6972 7374 2028 6c65  en the first (le
+000103e0: 6674 2920 7370 6563 7472 756d 2061 6e64  ft) spectrum and
+000103f0: 2074 6865 2073 6563 6f6e 6420 2872 6967   the second (rig
+00010400: 6874 290d 0a20 2020 2073 7065 6374 7275  ht)..    spectru
+00010410: 6d2e 0d0a 2e72 6564 6465 6e69 6e67 3a0d  m....reddening:.
+00010420: 0a20 2020 2042 6573 7420 6669 7474 696e  .    Best fittin
+00010430: 6720 6060 415f 5660 6020 7661 6c75 6520  g ``A_V`` value 
+00010440: 6966 2074 6865 2060 6072 6564 6465 6e69  if the ``reddeni
+00010450: 6e67 6060 206b 6579 776f 7264 2069 7320  ng`` keyword is 
+00010460: 7365 742e 0d0a 2e73 6f6c 3a0d 0a20 2020  set....sol:..   
+00010470: 2056 6563 746f 7220 636f 6e74 6169 6e69   Vector containi
+00010480: 6e67 2069 6e20 6f75 7470 7574 2074 6865  ng in output the
+00010490: 2070 6172 616d 6574 6572 7320 6f66 2074   parameters of t
+000104a0: 6865 206b 696e 656d 6174 6963 732e 0d0a  he kinematics...
+000104b0: 0d0a 2020 2020 2a20 4966 2060 606d 6f6d  ..    * If ``mom
+000104c0: 656e 7473 3d32 6060 2074 6869 7320 636f  ents=2`` this co
+000104d0: 6e74 6169 6e73 2060 605b 5665 6c2c 2053  ntains ``[Vel, S
+000104e0: 6967 6d61 5d60 600d 0a20 2020 202a 2049  igma]``..    * I
+000104f0: 6620 6060 6d6f 6d65 6e74 733d 3460 6020  f ``moments=4`` 
+00010500: 7468 6973 2063 6f6e 7461 696e 7320 6060  this contains ``
+00010510: 5b56 656c 2c20 5369 676d 612c 2068 332c  [Vel, Sigma, h3,
+00010520: 2068 345d 6060 0d0a 2020 2020 2a20 4966   h4]``..    * If
+00010530: 2060 606d 6f6d 656e 7473 3d4e 6060 2074   ``moments=N`` t
+00010540: 6869 7320 636f 6e74 6169 6e73 2060 605b  his contains ``[
+00010550: 5665 6c2c 2053 6967 6d61 2c20 6833 2c2e  Vel, Sigma, h3,.
+00010560: 2e2e 2068 4e5d 6060 0d0a 0d0a 2020 2020  .. hN]``....    
+00010570: 5768 656e 2066 6974 7469 6e67 206d 756c  When fitting mul
+00010580: 7469 706c 6520 6b69 6e65 6d61 7469 6320  tiple kinematic 
+00010590: 6060 636f 6d70 6f6e 656e 7460 602c 2060  ``component``, `
+000105a0: 6070 702e 736f 6c60 6020 636f 6e74 6169  `pp.sol`` contai
+000105b0: 6e73 2061 0d0a 2020 2020 6c69 7374 2077  ns a..    list w
+000105c0: 6974 6820 7468 6520 736f 6c75 7469 6f6e  ith the solution
+000105d0: 2066 6f72 2061 6c6c 2064 6966 6665 7265   for all differe
+000105e0: 6e74 2063 6f6d 706f 6e65 6e74 732c 206f  nt components, o
+000105f0: 6e65 2061 6674 6572 2074 6865 0d0a 2020  ne after the..  
+00010600: 2020 6f74 6865 722c 2073 6f72 7465 6420    other, sorted 
+00010610: 6279 2060 6063 6f6d 706f 6e65 6e74 6060  by ``component``
+00010620: 3a20 6060 7070 2e73 6f6c 203d 205b 736f  : ``pp.sol = [so
+00010630: 6c31 2c20 736f 6c32 2c2e 2e2e 5d60 602e  l1, sol2,...]``.
+00010640: 0d0a 0d0a 2020 2020 6060 5665 6c60 6020  ....    ``Vel`` 
+00010650: 6973 2074 6865 2076 656c 6f63 6974 792c  is the velocity,
+00010660: 2060 6053 6967 6d61 6060 2069 7320 7468   ``Sigma`` is th
+00010670: 6520 7665 6c6f 6369 7479 2064 6973 7065  e velocity dispe
+00010680: 7273 696f 6e2c 0d0a 2020 2020 6060 6833  rsion,..    ``h3
+00010690: 202d 2068 3660 6020 6172 6520 7468 6520   - h6`` are the 
+000106a0: 4761 7573 732d 4865 726d 6974 6520 636f  Gauss-Hermite co
+000106b0: 6566 6669 6369 656e 7473 2e20 5468 6520  efficients. The 
+000106c0: 6d6f 6465 6c20 7061 7261 6d65 7465 7273  model parameters
+000106d0: 0d0a 2020 2020 6172 6520 6669 7474 6564  ..    are fitted
+000106e0: 2073 696d 756c 7461 6e65 6f75 736c 792e   simultaneously.
+000106f0: 0d0a 0d0a 2020 2020 494d 504f 5254 414e  ....    IMPORTAN
+00010700: 543a 2054 6865 2070 7265 6369 7365 2072  T: The precise r
+00010710: 656c 6174 696f 6e20 6265 7477 6565 6e20  elation between 
+00010720: 7468 6520 6f75 7470 7574 2060 6070 5058  the output ``pPX
+00010730: 4660 6020 7665 6c6f 6369 7479 0d0a 2020  F`` velocity..  
+00010740: 2020 616e 6420 7265 6473 6869 6674 2069    and redshift i
+00010750: 7320 6060 5665 6c20 3d20 632a 6e70 2e6c  s ``Vel = c*np.l
+00010760: 6f67 2831 202b 207a 2960 602e 2053 6565  og(1 + z)``. See
+00010770: 2053 6563 7469 6f6e 2032 2e33 206f 660d   Section 2.3 of.
+00010780: 0a20 2020 2060 4361 7070 656c 6c61 7269  .    `Cappellari
+00010790: 2028 3230 3137 2960 5f20 666f 7220 6120   (2017)`_ for a 
+000107a0: 6465 7461 696c 6564 2065 7870 6c61 6e61  detailed explana
+000107b0: 7469 6f6e 2e0d 0a0d 0a20 2020 2054 6865  tion.....    The
+000107c0: 7365 2061 7265 2074 6865 2064 6566 6175  se are the defau
+000107d0: 6c74 2073 6166 6574 7920 6c69 6d69 7473  lt safety limits
+000107e0: 206f 6e20 7468 6520 6669 7474 696e 6720   on the fitting 
+000107f0: 7061 7261 6d65 7465 7273 0d0a 2020 2020  parameters..    
+00010800: 2874 6865 7920 6361 6e20 6265 2063 6861  (they can be cha
+00010810: 6e67 6564 2075 7369 6e67 2074 6865 2060  nged using the `
+00010820: 6062 6f75 6e64 7360 6020 6b65 7977 6f72  `bounds`` keywor
+00010830: 6429 3a0d 0a0d 0a20 2020 202a 2060 6056  d):....    * ``V
+00010840: 656c 6060 2069 7320 636f 6e73 7472 6169  el`` is constrai
+00010850: 6e65 6420 746f 2062 6520 6060 2b2f 2d32  ned to be ``+/-2
+00010860: 3030 3060 6020 6b6d 2f73 2066 726f 6d20  000`` km/s from 
+00010870: 7468 6520 696e 7075 7420 6775 6573 730d  the input guess.
+00010880: 0a20 2020 202a 2060 6076 656c 7363 616c  .    * ``velscal
+00010890: 652f 3130 3020 3c20 5369 676d 6120 3c20  e/100 < Sigma < 
+000108a0: 3130 3030 6060 206b 6d2f 730d 0a20 2020  1000`` km/s..   
+000108b0: 202a 2060 602d 302e 3320 3c20 5b68 332c   * ``-0.3 < [h3,
+000108c0: 2068 342c 202e 2e2e 5d20 3c20 302e 3360   h4, ...] < 0.3`
+000108d0: 6020 2028 6578 7472 656d 6520 7661 6c75  `  (extreme valu
+000108e0: 6520 666f 7220 7265 616c 2067 616c 6178  e for real galax
+000108f0: 6965 7329 0d0a 0d0a 2020 2020 496e 2074  ies)....    In t
+00010900: 6865 2063 6173 6520 6f66 2074 776f 2d73  he case of two-s
+00010910: 6964 6564 204c 4f53 5644 2066 6974 7469  ided LOSVD fitti
+00010920: 6e67 2074 6865 206f 7574 7075 7420 7661  ng the output va
+00010930: 6c75 6573 2072 6566 6572 2074 6f20 7468  lues refer to th
+00010940: 650d 0a20 2020 2066 6972 7374 2069 6e70  e..    first inp
+00010950: 7574 2067 616c 6178 7920 7370 6563 7472  ut galaxy spectr
+00010960: 756d 2c20 7768 696c 6520 7468 6520 7365  um, while the se
+00010970: 636f 6e64 2073 7065 6374 7275 6d20 7769  cond spectrum wi
+00010980: 6c6c 2068 6176 6520 6279 0d0a 2020 2020  ll have by..    
+00010990: 636f 6e73 7472 7563 7469 6f6e 206b 696e  construction kin
+000109a0: 656d 6174 6963 7320 7061 7261 6d65 7465  ematics paramete
+000109b0: 7273 2060 605b 2d56 656c 2c20 5369 676d  rs ``[-Vel, Sigm
+000109c0: 612c 202d 6833 2c20 6834 2c20 2d68 352c  a, -h3, h4, -h5,
+000109d0: 2068 365d 6060 2e0d 0a20 2020 2049 6620   h6]``...    If 
+000109e0: 6060 7673 7973 7460 6020 6973 206e 6f6e  ``vsyst`` is non
+000109f0: 7a65 726f 2028 6173 2072 6571 7569 7265  zero (as require
+00010a00: 6420 666f 7220 7477 6f2d 7369 6465 6420  d for two-sided 
+00010a10: 6669 7474 696e 6729 2c20 7468 656e 2074  fitting), then t
+00010a20: 6865 0d0a 2020 2020 6f75 7470 7574 2076  he..    output v
+00010a30: 656c 6f63 6974 7920 6973 206d 6561 7375  elocity is measu
+00010a40: 7265 6420 7769 7468 2072 6573 7065 6374  red with respect
+00010a50: 2074 6f20 6060 7673 7973 7460 602e 0d0a   to ``vsyst``...
+00010a60: 2e73 7461 7475 733a 0d0a 2020 2020 436f  .status:..    Co
+00010a70: 6e74 6169 6e73 2074 6865 206f 7574 7075  ntains the outpu
+00010a80: 7420 7374 6174 7573 206f 6620 7468 6520  t status of the 
+00010a90: 6f70 7469 6d69 7a61 7469 6f6e 2e20 506f  optimization. Po
+00010aa0: 7369 7469 7665 2076 616c 7565 730d 0a20  sitive values.. 
+00010ab0: 2020 2067 656e 6572 616c 6c79 2072 6570     generally rep
+00010ac0: 7265 7365 6e74 2073 7563 6365 7373 2028  resent success (
+00010ad0: 7468 6520 6d65 616e 696e 6720 6f66 2060  the meaning of `
+00010ae0: 6073 7461 7475 7360 6020 6973 2064 6566  `status`` is def
+00010af0: 696e 6564 2061 7320 696e 0d0a 2020 2020  ined as in..    
+00010b00: 6073 6369 7079 2e6f 7074 696d 697a 652e  `scipy.optimize.
+00010b10: 6c65 6173 745f 7371 7561 7265 7360 5f29  least_squares`_)
+00010b20: 2e0d 0a2e 7765 6967 6874 733a 0d0a 2020  ....weights:..  
+00010b30: 2020 5265 6365 6976 6573 2074 6865 2076    Receives the v
+00010b40: 616c 7565 206f 6620 7468 6520 7765 6967  alue of the weig
+00010b50: 6874 7320 6279 2077 6869 6368 2065 6163  hts by which eac
+00010b60: 6820 7465 6d70 6c61 7465 2077 6173 0d0a  h template was..
+00010b70: 2020 2020 6d75 6c74 6970 6c69 6564 2074      multiplied t
+00010b80: 6f20 6265 7374 2066 6974 2074 6865 2067  o best fit the g
+00010b90: 616c 6178 7920 7370 6563 7472 756d 2e20  alaxy spectrum. 
+00010ba0: 5468 6520 6f70 7469 6d61 6c20 7465 6d70  The optimal temp
+00010bb0: 6c61 7465 2063 616e 2062 650d 0a20 2020  late can be..   
+00010bc0: 2063 6f6d 7075 7465 6420 7769 7468 2061   computed with a
+00010bd0: 6e20 6172 7261 792d 7665 6374 6f72 206d  n array-vector m
+00010be0: 756c 7469 706c 6963 6174 696f 6e3a 3a0d  ultiplication::.
+00010bf0: 0a0d 0a20 2020 2020 2020 2062 6573 7465  ...        beste
+00010c00: 6d70 203d 2074 656d 706c 6174 6573 2040  mp = templates @
+00010c10: 2077 6569 6768 7473 0d0a 0d0a 2020 2020   weights....    
+00010c20: 5468 6573 6520 6060 2e77 6569 6768 7473  These ``.weights
+00010c30: 6060 2064 6f20 6e6f 7420 696e 636c 7564  `` do not includ
+00010c40: 6520 7468 6520 7765 6967 6874 7320 6f66  e the weights of
+00010c50: 2074 6865 2061 6464 6974 6976 650d 0a20   the additive.. 
+00010c60: 2020 2070 6f6c 796e 6f6d 6961 6c73 2077     polynomials w
+00010c70: 6869 6368 2061 7265 2073 6570 6172 6174  hich are separat
+00010c80: 656c 7920 7374 6f72 6564 2069 6e20 6060  ely stored in ``
+00010c90: 7070 2e70 6f6c 7977 6569 6768 7473 6060  pp.polyweights``
+00010ca0: 2e0d 0a0d 0a20 2020 2057 6865 6e20 7468  .....    When th
+00010cb0: 6520 6060 736b 7960 6020 6b65 7977 6f72  e ``sky`` keywor
+00010cc0: 6420 6973 2075 7365 6420 6060 7765 6967  d is used ``weig
+00010cd0: 6874 735b 3a6e 5f74 656d 706c 6174 6573  hts[:n_templates
+00010ce0: 5d60 6020 636f 6e74 6169 6e73 2074 6865  ]`` contains the
+00010cf0: 0d0a 2020 2020 7765 6967 6874 7320 666f  ..    weights fo
+00010d00: 7220 7468 6520 7465 6d70 6c61 7465 732c  r the templates,
+00010d10: 2077 6869 6c65 2060 6077 6569 6768 7473   while ``weights
+00010d20: 5b6e 5f74 656d 706c 6174 6573 3a5d 6060  [n_templates:]``
+00010d30: 2067 6976 6573 2074 6865 0d0a 2020 2020   gives the..    
+00010d40: 6f6e 6573 2066 6f72 2074 6865 2073 6b79  ones for the sky
+00010d50: 2e20 496e 2074 6861 7420 6361 7365 2074  . In that case t
+00010d60: 6865 2062 6573 742d 6669 7474 696e 6720  he best-fitting 
+00010d70: 6761 6c61 7879 2074 656d 706c 6174 6520  galaxy template 
+00010d80: 616e 6420 736b 790d 0a20 2020 2061 7265  and sky..    are
+00010d90: 2067 6976 656e 2062 793a 3a0d 0a0d 0a20   given by::.... 
+00010da0: 2020 2020 2020 2062 6573 7465 6d70 203d         bestemp =
+00010db0: 2074 656d 706c 6174 6573 2040 2077 6569   templates @ wei
+00010dc0: 6768 7473 5b3a 6e5f 7465 6d70 6c61 7465  ghts[:n_template
+00010dd0: 735d 0d0a 2020 2020 2020 2020 6265 7374  s]..        best
+00010de0: 736b 7920 3d20 736b 7920 4020 7765 6967  sky = sky @ weig
+00010df0: 6874 735b 6e5f 7465 6d70 6c61 7465 733a  hts[n_templates:
+00010e00: 5d0d 0a0d 0a20 2020 2057 6865 6e20 646f  ]....    When do
+00010e10: 696e 6720 6120 7477 6f2d 7369 6465 6420  ing a two-sided 
+00010e20: 6669 7474 696e 6720 2873 6565 2068 656c  fitting (see hel
+00010e30: 7020 666f 7220 6060 6761 6c61 7879 6060  p for ``galaxy``
+00010e40: 2070 6172 616d 6574 6572 290d 0a20 2020   parameter)..   
+00010e50: 202a 746f 6765 7468 6572 2a20 7769 7468   *together* with
+00010e60: 2074 6865 2060 6073 6b79 6060 206b 6579   the ``sky`` key
+00010e70: 776f 7264 2c20 7468 6520 736b 7920 7765  word, the sky we
+00010e80: 6967 6874 7320 6172 6520 616c 6c6f 7765  ights are allowe
+00010e90: 6420 746f 2062 650d 0a20 2020 2064 6966  d to be..    dif
+00010ea0: 6665 7265 6e74 2066 6f72 2074 6865 206c  ferent for the l
+00010eb0: 6566 7420 616e 6420 7269 6768 7420 7370  eft and right sp
+00010ec0: 6563 7472 756d 2e20 496e 2074 6861 7420  ectrum. In that 
+00010ed0: 6361 7365 2074 6865 206f 7574 7075 7420  case the output 
+00010ee0: 736b 790d 0a20 2020 2077 6569 6768 7473  sky..    weights
+00010ef0: 2061 6c74 6572 6e61 7465 2062 6574 7765   alternate betwe
+00010f00: 656e 2074 6865 2066 6972 7374 2028 6c65  en the first (le
+00010f10: 6674 2920 7370 6563 7472 756d 2061 6e64  ft) spectrum and
+00010f20: 2074 6865 2073 6563 6f6e 640d 0a20 2020   the second..   
+00010f30: 2028 7269 6768 7429 2073 7065 6374 7275   (right) spectru
+00010f40: 6d2e 0d0a 0d0a 486f 7720 746f 2053 6574  m.....How to Set
+00010f50: 2074 6865 204b 696e 656d 6174 6963 2050   the Kinematic P
+00010f60: 656e 616c 7479 204b 6579 776f 7264 0d0a  enalty Keyword..
 00010f70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00010f80: 2d2d 2d2d 0d0a 0d0a 5468 6520 6060 6269  ----....The ``bi
-00010f90: 6173 6060 206b 6579 776f 7264 2069 7320  as`` keyword is 
-00010fa0: 6f6e 6c79 2075 7365 6420 6966 2060 606d  only used if ``m
-00010fb0: 6f6d 656e 7473 203e 2032 6060 2c20 6f74  oments > 2``, ot
-00010fc0: 6865 7277 6973 6520 6974 2069 7320 6967  herwise it is ig
-00010fd0: 6e6f 7265 642e 0d0a 0d0a 5468 6520 6060  nored.....The ``
-00010fe0: 7050 5846 6060 2072 6f75 7469 6e65 2063  pPXF`` routine c
-00010ff0: 616e 2067 6976 6520 7365 6e73 6962 6c65  an give sensible
-00011000: 2071 7569 636b 2072 6573 756c 7473 2077   quick results w
-00011010: 6974 6820 7468 6520 6465 6661 756c 740d  ith the default.
-00011020: 0a60 6062 6961 7360 6020 7061 7261 6d65  .``bias`` parame
-00011030: 7465 722c 2068 6f77 6576 6572 2c20 6c69  ter, however, li
-00011040: 6b65 2069 6e20 616e 7920 7065 6e61 6c69  ke in any penali
-00011050: 7a65 642f 6669 6c74 6572 6564 2f72 6567  zed/filtered/reg
-00011060: 756c 6172 697a 6564 0d0a 6d65 7468 6f64  ularized..method
-00011070: 2c20 7468 6520 6f70 7469 6d61 6c20 616d  , the optimal am
-00011080: 6f75 6e74 206f 6620 7065 6e61 6c69 7a61  ount of penaliza
-00011090: 7469 6f6e 2067 656e 6572 616c 6c79 2064  tion generally d
-000110a0: 6570 656e 6473 206f 6e20 7468 6520 7072  epends on the pr
-000110b0: 6f62 6c65 6d0d 0a75 6e64 6572 2073 7475  oblem..under stu
-000110c0: 6479 2e0d 0a0d 0a54 6865 2067 656e 6572  dy.....The gener
-000110d0: 616c 2072 756c 6520 6865 7265 2069 7320  al rule here is 
-000110e0: 7468 6174 2074 6865 2070 656e 616c 7479  that the penalty
-000110f0: 2073 686f 756c 6420 6c65 6176 6520 7468   should leave th
-00011100: 6520 6c69 6e65 2d6f 662d 7369 6768 740d  e line-of-sight.
-00011110: 0a76 656c 6f63 6974 792d 6469 7374 7269  .velocity-distri
-00011120: 6275 7469 6f6e 2028 4c4f 5356 4429 2076  bution (LOSVD) v
-00011130: 6972 7475 616c 6c79 2075 6e61 6666 6563  irtually unaffec
-00011140: 7465 642c 2077 6865 6e20 6974 2069 7320  ted, when it is 
-00011150: 7765 6c6c 2073 616d 706c 6564 0d0a 616e  well sampled..an
-00011160: 6420 7468 6520 7369 676e 616c 2d74 6f2d  d the signal-to-
-00011170: 6e6f 6973 6520 7261 7469 6f20 2860 6053  noise ratio (``S
-00011180: 2f4e 6060 2920 6973 2073 7566 6669 6369  /N``) is suffici
-00011190: 656e 746c 7920 6869 6768 2e0d 0a0d 0a45  ently high.....E
-000111a0: 5841 4d50 4c45 3a20 4966 2079 6f75 2065  XAMPLE: If you e
-000111b0: 7870 6563 7420 6120 4c4f 5356 4420 7769  xpect a LOSVD wi
-000111c0: 7468 2075 7020 746f 2061 2068 6967 6820  th up to a high 
-000111d0: 6060 6834 207e 2030 2e32 6060 2061 6e64  ``h4 ~ 0.2`` and
-000111e0: 2079 6f75 720d 0a61 646f 7074 6564 2070   your..adopted p
-000111f0: 656e 616c 7479 2028 6060 6269 6173 6060  enalty (``bias``
-00011200: 2920 6269 6173 6573 2074 6865 2073 6f6c  ) biases the sol
-00011210: 7574 696f 6e20 746f 7761 7264 7320 6120  ution towards a 
-00011220: 6d75 6368 206c 6f77 6572 0d0a 6060 6834  much lower..``h4
-00011230: 207e 2030 2e31 6060 2c20 6576 656e 2077   ~ 0.1``, even w
-00011240: 6865 6e20 7468 6520 6d65 6173 7572 6564  hen the measured
-00011250: 2060 6073 6967 6d61 203e 2033 2a76 656c   ``sigma > 3*vel
-00011260: 7363 616c 6560 6020 616e 6420 7468 6520  scale`` and the 
-00011270: 532f 4e20 6973 0d0a 6869 6768 2c20 7468  S/N is..high, th
-00011280: 656e 2079 6f75 2061 7265 202a 6d69 7375  en you are *misu
-00011290: 7369 6e67 2a20 7468 6520 6060 7050 5846  sing* the ``pPXF
-000112a0: 6060 206d 6574 686f 6421 0d0a 0d0a 5448  `` method!....TH
-000112b0: 4520 5245 4349 5045 3a20 5468 6520 666f  E RECIPE: The fo
-000112c0: 6c6c 6f77 696e 6720 6973 2061 2073 696d  llowing is a sim
-000112d0: 706c 6520 7072 6163 7469 6361 6c20 7265  ple practical re
-000112e0: 6369 7065 2066 6f72 2061 2073 656e 7369  cipe for a sensi
-000112f0: 626c 650d 0a64 6574 6572 6d69 6e61 7469  ble..determinati
-00011300: 6f6e 206f 6620 7468 6520 7065 6e61 6c74  on of the penalt
-00011310: 7920 696e 2060 6070 5058 4660 603a 0d0a  y in ``pPXF``:..
-00011320: 0d0a 312e 2043 686f 6f73 6520 6120 6d69  ..1. Choose a mi
-00011330: 6e69 6d75 6d20 6060 2853 2f4e 295f 6d69  nimum ``(S/N)_mi
-00011340: 6e60 6020 6c65 7665 6c20 666f 7220 796f  n`` level for yo
-00011350: 7572 206b 696e 656d 6174 6963 7320 6578  ur kinematics ex
-00011360: 7472 6163 7469 6f6e 2061 6e64 0d0a 2020  traction and..  
-00011370: 2073 7061 7469 616c 6c79 2062 696e 2079   spatially bin y
-00011380: 6f75 7220 6461 7461 2073 6f20 7468 6174  our data so that
-00011390: 2074 6865 7265 2061 7265 206e 6f20 7370   there are no sp
-000113a0: 6563 7472 6120 6265 6c6f 7720 6060 2853  ectra below ``(S
-000113b0: 2f4e 295f 6d69 6e60 603b 0d0a 322e 2050  /N)_min``;..2. P
-000113c0: 6572 666f 726d 2061 2066 6974 206f 6620  erform a fit of 
-000113d0: 796f 7572 206b 696e 656d 6174 6963 7320  your kinematics 
-000113e0: 2a77 6974 686f 7574 2a20 7065 6e61 6c74  *without* penalt
-000113f0: 7920 286b 6579 776f 7264 2060 6062 6961  y (keyword ``bia
-00011400: 733d 3060 6029 2e0d 0a20 2020 5468 6520  s=0``)...   The 
-00011410: 736f 6c75 7469 6f6e 2077 696c 6c20 6265  solution will be
-00011420: 206e 6f69 7379 2061 6e64 206d 6179 2062   noisy and may b
-00011430: 6520 6166 6665 6374 6564 2062 7920 7370  e affected by sp
-00011440: 7572 696f 7573 2073 6f6c 7574 696f 6e73  urious solutions
-00011450: 2c0d 0a20 2020 686f 7765 7665 722c 2074  ,..   however, t
-00011460: 6869 7320 7374 6570 2077 696c 6c20 616c  his step will al
-00011470: 6c6f 7720 796f 7520 746f 2063 6865 636b  low you to check
-00011480: 2074 6865 2065 7870 6563 7465 6420 6176   the expected av
-00011490: 6572 6167 6520 7261 6e67 6573 0d0a 2020  erage ranges..  
-000114a0: 2069 6e20 7468 6520 4761 7573 732d 4865   in the Gauss-He
-000114b0: 726d 6974 6520 7061 7261 6d65 7465 7273  rmite parameters
-000114c0: 2060 605b 6833 2c20 6834 5d60 6020 666f   ``[h3, h4]`` fo
-000114d0: 7220 7468 6520 6761 6c61 7879 2075 6e64  r the galaxy und
-000114e0: 6572 2073 7475 6479 3b0d 0a33 2e20 5065  er study;..3. Pe
-000114f0: 7266 6f72 6d20 6120 4d6f 6e74 6520 4361  rform a Monte Ca
-00011500: 726c 6f20 7369 6d75 6c61 7469 6f6e 206f  rlo simulation o
-00011510: 6620 796f 7572 2073 7065 6374 7261 2c20  f your spectra, 
-00011520: 666f 6c6c 6f77 696e 6720 652e 672e 2074  following e.g. t
-00011530: 6865 0d0a 2020 2069 6e63 6c75 6465 6420  he..   included 
-00011540: 6060 7070 7866 5f65 7861 6d70 6c65 5f6d  ``ppxf_example_m
-00011550: 6f6e 7465 6361 726c 6f5f 7369 6d75 6c61  ontecarlo_simula
-00011560: 7469 6f6e 2e70 7960 6020 726f 7574 696e  tion.py`` routin
-00011570: 652e 2041 646f 7074 2061 730d 0a20 2020  e. Adopt as..   
-00011580: 6060 532f 4e60 6020 696e 2074 6865 2073  ``S/N`` in the s
-00011590: 696d 756c 6174 696f 6e20 7468 6520 6368  imulation the ch
-000115a0: 6f73 656e 2076 616c 7565 2060 6028 532f  osen value ``(S/
-000115b0: 4e29 5f6d 696e 6060 2061 6e64 2061 7320  N)_min`` and as 
-000115c0: 696e 7075 740d 0a20 2020 6060 5b68 332c  input..   ``[h3,
-000115d0: 2068 345d 6060 2074 6865 206d 6178 696d   h4]`` the maxim
-000115e0: 756d 2072 6570 7265 7365 6e74 6174 6976  um representativ
-000115f0: 6520 7661 6c75 6573 206d 6561 7375 7265  e values measure
-00011600: 6420 696e 2074 6865 0d0a 2020 206e 6f6e  d in the..   non
-00011610: 2d70 656e 616c 697a 6564 2060 6070 5058  -penalized ``pPX
-00011620: 4660 6020 6669 7420 6f66 2074 6865 2070  F`` fit of the p
-00011630: 7265 7669 6f75 7320 7374 6570 3b0d 0a34  revious step;..4
-00011640: 2e20 4368 6f6f 7365 2061 7320 7468 6520  . Choose as the 
-00011650: 7065 6e61 6c74 7920 2860 6062 6961 7360  penalty (``bias`
-00011660: 6029 2074 6865 202a 6c61 7267 6573 742a  `) the *largest*
-00011670: 2076 616c 7565 2073 7563 6820 7468 6174   value such that
-00011680: 2c20 666f 720d 0a20 2020 6060 7369 676d  , for..   ``sigm
-00011690: 6120 3e20 332a 7665 6c73 6361 6c65 6060  a > 3*velscale``
-000116a0: 2c20 7468 6520 6176 6572 6167 6520 6469  , the average di
-000116b0: 6666 6572 656e 6365 2064 656c 7461 2062  fference delta b
-000116c0: 6574 7765 656e 2074 6865 206f 7574 7075  etween the outpu
-000116d0: 740d 0a20 2020 6060 5b68 332c 2068 345d  t..   ``[h3, h4]
-000116e0: 6060 2061 6e64 2074 6865 2069 6e70 7574  `` and the input
-000116f0: 2060 605b 6833 2c20 6834 5d60 6020 6973   ``[h3, h4]`` is
-00011700: 2077 656c 6c20 7769 7468 696e 2028 652e   well within (e.
-00011710: 672e 0d0a 2020 2060 6064 656c 7461 207e  g...   ``delta ~
-00011720: 2072 6d73 2f33 6060 2920 7468 6520 726d   rms/3``) the rm
-00011730: 7320 7363 6174 7465 7220 6f66 2074 6865  s scatter of the
-00011740: 2073 696d 756c 6174 6564 2076 616c 7565   simulated value
-00011750: 7320 2873 6565 2061 6e0d 0a20 2020 6578  s (see an..   ex
-00011760: 616d 706c 6520 696e 2046 6967 2e20 3220  ample in Fig. 2 
-00011770: 6f66 2060 456d 7365 6c6c 656d 2065 7420  of `Emsellem et 
-00011780: 616c 2e20 3230 3034 0d0a 2020 203c 6874  al. 2004..   <ht
-00011790: 7470 3a2f 2f75 692e 6164 7361 6273 2e68  tp://ui.adsabs.h
-000117a0: 6172 7661 7264 2e65 6475 2f61 6273 2f32  arvard.edu/abs/2
-000117b0: 3030 344d 4e52 4153 2e33 3532 2e2e 3732  004MNRAS.352..72
-000117c0: 3145 3e60 5f29 2e0d 0a0d 0a50 726f 626c  1E>`_).....Probl
-000117d0: 656d 7320 7769 7468 2059 6f75 7220 4669  ems with Your Fi
-000117e0: 7273 7420 4669 743f 0d0a 2d2d 2d2d 2d2d  rst Fit?..------
-000117f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00011800: 2d2d 2d2d 2d2d 2d0d 0a0d 0a43 6f6d 6d6f  -------....Commo
-00011810: 6e20 7072 6f62 6c65 6d73 2077 6974 6820  n problems with 
-00011820: 796f 7572 2066 6972 7374 2060 6070 5058  your first ``pPX
-00011830: 4660 6020 6669 7420 6172 6520 6361 7573  F`` fit are caus
-00011840: 6564 2062 7920 696e 636f 7272 6563 740d  ed by incorrect.
-00011850: 0a77 6176 656c 656e 6774 6820 7261 6e67  .wavelength rang
-00011860: 6573 206f 7220 6469 6666 6572 656e 7420  es or different 
-00011870: 7665 6c6f 6369 7479 2073 6361 6c65 7320  velocity scales 
-00011880: 6265 7477 6565 6e20 6761 6c61 7879 2061  between galaxy a
-00011890: 6e64 0d0a 7465 6d70 6c61 7465 732e 2054  nd..templates. T
-000118a0: 6f20 7175 6963 6b6c 7920 6465 7465 6374  o quickly detect
-000118b0: 2074 6865 7365 2070 726f 626c 656d 7320   these problems 
-000118c0: 7472 7920 746f 206f 7665 7270 6c6f 7420  try to overplot 
-000118d0: 7468 6520 286c 6f67 0d0a 7265 6269 6e6e  the (log..rebinn
-000118e0: 6564 2920 6761 6c61 7879 2061 6e64 2074  ed) galaxy and t
-000118f0: 6865 2074 656d 706c 6174 6520 6a75 7374  he template just
-00011900: 2062 6566 6f72 6520 6361 6c6c 696e 6720   before calling 
-00011910: 7468 6520 6060 7050 5846 6060 0d0a 7072  the ``pPXF``..pr
-00011920: 6f63 6564 7572 652e 0d0a 0d0a 596f 7520  ocedure.....You 
-00011930: 6361 6e20 7573 6520 736f 6d65 7468 696e  can use somethin
-00011940: 6720 6c69 6b65 2074 6865 2066 6f6c 6c6f  g like the follo
-00011950: 7769 6e67 2050 7974 686f 6e20 6c69 6e65  wing Python line
-00011960: 7320 7768 696c 6520 6164 6a75 7374 696e  s while adjustin
-00011970: 6720 7468 650d 0a73 6d6f 6f74 6869 6e67  g the..smoothing
-00011980: 2077 696e 646f 7720 616e 6420 7468 6520   window and the 
-00011990: 7069 7865 6c73 2073 6869 6674 2e20 4966  pixels shift. If
-000119a0: 2079 6f75 2063 616e 6e6f 7420 6765 7420   you cannot get 
-000119b0: 6120 726f 7567 6820 6d61 7463 680d 0a62  a rough match..b
-000119c0: 7920 6579 6520 6974 206d 6561 6e73 2073  y eye it means s
-000119d0: 6f6d 6574 6869 6e67 2069 7320 7772 6f6e  omething is wron
-000119e0: 6720 616e 6420 6974 2069 7320 756e 6c69  g and it is unli
-000119f0: 6b65 6c79 2074 6861 7420 6060 7050 5846  kely that ``pPXF
-00011a00: 6060 0d0a 286f 7220 616e 7920 6f74 6865  ``..(or any othe
-00011a10: 7220 7072 6f67 7261 6d29 2077 696c 6c20  r program) will 
-00011a20: 6669 6e64 2061 2067 6f6f 6420 6d61 7463  find a good matc
-00011a30: 683a 0d0a 0d0a 2e2e 2063 6f64 652d 626c  h:...... code-bl
-00011a40: 6f63 6b3a 3a20 7079 7468 6f6e 0d0a 0d0a  ock:: python....
-00011a50: 2020 2020 696d 706f 7274 206e 756d 7079      import numpy
-00011a60: 2061 7320 6e70 0d0a 2020 2020 696d 706f   as np..    impo
-00011a70: 7274 206d 6174 706c 6f74 6c69 622e 7079  rt matplotlib.py
-00011a80: 706c 6f74 2061 7320 706c 740d 0a20 2020  plot as plt..   
-00011a90: 2066 726f 6d20 7363 6970 7920 696d 706f   from scipy impo
-00011aa0: 7274 206e 6469 6d61 6765 0d0a 0d0a 2020  rt ndimage....  
-00011ab0: 2020 7369 676d 6120 3d20 3220 2020 2020    sigma = 2     
-00011ac0: 2020 2320 5665 6c6f 6369 7479 2064 6973    # Velocity dis
-00011ad0: 7065 7273 696f 6e20 696e 2070 6978 656c  persion in pixel
-00011ae0: 730d 0a20 2020 2073 6869 6674 203d 202d  s..    shift = -
-00011af0: 3230 2020 2020 2023 2056 656c 6f63 6974  20     # Velocit
-00011b00: 7920 7368 6966 7420 696e 2070 6978 656c  y shift in pixel
-00011b10: 730d 0a20 2020 2074 656d 706c 6174 6520  s..    template 
-00011b20: 3d20 6e70 2e72 6f6c 6c28 6e64 696d 6167  = np.roll(ndimag
-00011b30: 652e 6761 7573 7369 616e 5f66 696c 7465  e.gaussian_filte
-00011b40: 7231 6428 7465 6d70 6c61 7465 2c20 7369  r1d(template, si
-00011b50: 676d 6129 2c20 7368 6966 7429 0d0a 2020  gma), shift)..  
-00011b60: 2020 706c 742e 706c 6f74 2867 616c 6178    plt.plot(galax
-00011b70: 792c 2027 6b27 290d 0a20 2020 2070 6c74  y, 'k')..    plt
-00011b80: 2e70 6c6f 7428 7465 6d70 6c61 7465 2a6e  .plot(template*n
-00011b90: 702e 6d65 6469 616e 2867 616c 6178 7929  p.median(galaxy)
-00011ba0: 2f6e 702e 6d65 6469 616e 2874 656d 706c  /np.median(templ
-00011bb0: 6174 6529 2c20 2772 2729 0d0a 0d0a 2323  ate), 'r')....##
-00011bc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00011bd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00010f80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00010f90: 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a 5468 6520  --------....The 
+00010fa0: 6060 6269 6173 6060 206b 6579 776f 7264  ``bias`` keyword
+00010fb0: 2069 7320 6f6e 6c79 2075 7365 6420 6966   is only used if
+00010fc0: 2060 606d 6f6d 656e 7473 203e 2032 6060   ``moments > 2``
+00010fd0: 2c20 6f74 6865 7277 6973 6520 6974 2069  , otherwise it i
+00010fe0: 7320 6967 6e6f 7265 642e 0d0a 0d0a 5468  s ignored.....Th
+00010ff0: 6520 6060 7050 5846 6060 2072 6f75 7469  e ``pPXF`` routi
+00011000: 6e65 2063 616e 2067 6976 6520 7365 6e73  ne can give sens
+00011010: 6962 6c65 2071 7569 636b 2072 6573 756c  ible quick resul
+00011020: 7473 2077 6974 6820 7468 6520 6465 6661  ts with the defa
+00011030: 756c 740d 0a60 6062 6961 7360 6020 7061  ult..``bias`` pa
+00011040: 7261 6d65 7465 722c 2068 6f77 6576 6572  rameter, however
+00011050: 2c20 6c69 6b65 2069 6e20 616e 7920 7065  , like in any pe
+00011060: 6e61 6c69 7a65 642f 6669 6c74 6572 6564  nalized/filtered
+00011070: 2f72 6567 756c 6172 697a 6564 0d0a 6d65  /regularized..me
+00011080: 7468 6f64 2c20 7468 6520 6f70 7469 6d61  thod, the optima
+00011090: 6c20 616d 6f75 6e74 206f 6620 7065 6e61  l amount of pena
+000110a0: 6c69 7a61 7469 6f6e 2067 656e 6572 616c  lization general
+000110b0: 6c79 2064 6570 656e 6473 206f 6e20 7468  ly depends on th
+000110c0: 6520 7072 6f62 6c65 6d0d 0a75 6e64 6572  e problem..under
+000110d0: 2073 7475 6479 2e0d 0a0d 0a54 6865 2067   study.....The g
+000110e0: 656e 6572 616c 2072 756c 6520 6865 7265  eneral rule here
+000110f0: 2069 7320 7468 6174 2074 6865 2070 656e   is that the pen
+00011100: 616c 7479 2073 686f 756c 6420 6c65 6176  alty should leav
+00011110: 6520 7468 6520 6c69 6e65 2d6f 662d 7369  e the line-of-si
+00011120: 6768 740d 0a76 656c 6f63 6974 792d 6469  ght..velocity-di
+00011130: 7374 7269 6275 7469 6f6e 2028 4c4f 5356  stribution (LOSV
+00011140: 4429 2076 6972 7475 616c 6c79 2075 6e61  D) virtually una
+00011150: 6666 6563 7465 642c 2077 6865 6e20 6974  ffected, when it
+00011160: 2069 7320 7765 6c6c 2073 616d 706c 6564   is well sampled
+00011170: 0d0a 616e 6420 7468 6520 7369 676e 616c  ..and the signal
+00011180: 2d74 6f2d 6e6f 6973 6520 7261 7469 6f20  -to-noise ratio 
+00011190: 2860 6053 2f4e 6060 2920 6973 2073 7566  (``S/N``) is suf
+000111a0: 6669 6369 656e 746c 7920 6869 6768 2e0d  ficiently high..
+000111b0: 0a0d 0a45 5841 4d50 4c45 3a20 4966 2079  ...EXAMPLE: If y
+000111c0: 6f75 2065 7870 6563 7420 6120 4c4f 5356  ou expect a LOSV
+000111d0: 4420 7769 7468 2075 7020 746f 2061 2068  D with up to a h
+000111e0: 6967 6820 6060 6834 207e 2030 2e32 6060  igh ``h4 ~ 0.2``
+000111f0: 2061 6e64 2079 6f75 720d 0a61 646f 7074   and your..adopt
+00011200: 6564 2070 656e 616c 7479 2028 6060 6269  ed penalty (``bi
+00011210: 6173 6060 2920 6269 6173 6573 2074 6865  as``) biases the
+00011220: 2073 6f6c 7574 696f 6e20 746f 7761 7264   solution toward
+00011230: 7320 6120 6d75 6368 206c 6f77 6572 0d0a  s a much lower..
+00011240: 6060 6834 207e 2030 2e31 6060 2c20 6576  ``h4 ~ 0.1``, ev
+00011250: 656e 2077 6865 6e20 7468 6520 6d65 6173  en when the meas
+00011260: 7572 6564 2060 6073 6967 6d61 203e 2033  ured ``sigma > 3
+00011270: 2a76 656c 7363 616c 6560 6020 616e 6420  *velscale`` and 
+00011280: 7468 6520 532f 4e20 6973 0d0a 6869 6768  the S/N is..high
+00011290: 2c20 7468 656e 2079 6f75 2061 7265 202a  , then you are *
+000112a0: 6d69 7375 7369 6e67 2a20 7468 6520 6060  misusing* the ``
+000112b0: 7050 5846 6060 206d 6574 686f 6421 0d0a  pPXF`` method!..
+000112c0: 0d0a 5448 4520 5245 4349 5045 3a20 5468  ..THE RECIPE: Th
+000112d0: 6520 666f 6c6c 6f77 696e 6720 6973 2061  e following is a
+000112e0: 2073 696d 706c 6520 7072 6163 7469 6361   simple practica
+000112f0: 6c20 7265 6369 7065 2066 6f72 2061 2073  l recipe for a s
+00011300: 656e 7369 626c 650d 0a64 6574 6572 6d69  ensible..determi
+00011310: 6e61 7469 6f6e 206f 6620 7468 6520 7065  nation of the pe
+00011320: 6e61 6c74 7920 696e 2060 6070 5058 4660  nalty in ``pPXF`
+00011330: 603a 0d0a 0d0a 312e 2043 686f 6f73 6520  `:....1. Choose 
+00011340: 6120 6d69 6e69 6d75 6d20 6060 2853 2f4e  a minimum ``(S/N
+00011350: 295f 6d69 6e60 6020 6c65 7665 6c20 666f  )_min`` level fo
+00011360: 7220 796f 7572 206b 696e 656d 6174 6963  r your kinematic
+00011370: 7320 6578 7472 6163 7469 6f6e 2061 6e64  s extraction and
+00011380: 0d0a 2020 2073 7061 7469 616c 6c79 2062  ..   spatially b
+00011390: 696e 2079 6f75 7220 6461 7461 2073 6f20  in your data so 
+000113a0: 7468 6174 2074 6865 7265 2061 7265 206e  that there are n
+000113b0: 6f20 7370 6563 7472 6120 6265 6c6f 7720  o spectra below 
+000113c0: 6060 2853 2f4e 295f 6d69 6e60 603b 0d0a  ``(S/N)_min``;..
+000113d0: 322e 2050 6572 666f 726d 2061 2066 6974  2. Perform a fit
+000113e0: 206f 6620 796f 7572 206b 696e 656d 6174   of your kinemat
+000113f0: 6963 7320 2a77 6974 686f 7574 2a20 7065  ics *without* pe
+00011400: 6e61 6c74 7920 286b 6579 776f 7264 2060  nalty (keyword `
+00011410: 6062 6961 733d 3060 6029 2e0d 0a20 2020  `bias=0``)...   
+00011420: 5468 6520 736f 6c75 7469 6f6e 2077 696c  The solution wil
+00011430: 6c20 6265 206e 6f69 7379 2061 6e64 206d  l be noisy and m
+00011440: 6179 2062 6520 6166 6665 6374 6564 2062  ay be affected b
+00011450: 7920 7370 7572 696f 7573 2073 6f6c 7574  y spurious solut
+00011460: 696f 6e73 2c0d 0a20 2020 686f 7765 7665  ions,..   howeve
+00011470: 722c 2074 6869 7320 7374 6570 2077 696c  r, this step wil
+00011480: 6c20 616c 6c6f 7720 796f 7520 746f 2063  l allow you to c
+00011490: 6865 636b 2074 6865 2065 7870 6563 7465  heck the expecte
+000114a0: 6420 6176 6572 6167 6520 7261 6e67 6573  d average ranges
+000114b0: 0d0a 2020 2069 6e20 7468 6520 4761 7573  ..   in the Gaus
+000114c0: 732d 4865 726d 6974 6520 7061 7261 6d65  s-Hermite parame
+000114d0: 7465 7273 2060 605b 6833 2c20 6834 5d60  ters ``[h3, h4]`
+000114e0: 6020 666f 7220 7468 6520 6761 6c61 7879  ` for the galaxy
+000114f0: 2075 6e64 6572 2073 7475 6479 3b0d 0a33   under study;..3
+00011500: 2e20 5065 7266 6f72 6d20 6120 4d6f 6e74  . Perform a Mont
+00011510: 6520 4361 726c 6f20 7369 6d75 6c61 7469  e Carlo simulati
+00011520: 6f6e 206f 6620 796f 7572 2073 7065 6374  on of your spect
+00011530: 7261 2c20 666f 6c6c 6f77 696e 6720 652e  ra, following e.
+00011540: 672e 2074 6865 0d0a 2020 2069 6e63 6c75  g. the..   inclu
+00011550: 6465 6420 6060 7070 7866 5f65 7861 6d70  ded ``ppxf_examp
+00011560: 6c65 5f6d 6f6e 7465 6361 726c 6f5f 7369  le_montecarlo_si
+00011570: 6d75 6c61 7469 6f6e 2e70 7960 6020 726f  mulation.py`` ro
+00011580: 7574 696e 652e 2041 646f 7074 2061 730d  utine. Adopt as.
+00011590: 0a20 2020 6060 532f 4e60 6020 696e 2074  .   ``S/N`` in t
+000115a0: 6865 2073 696d 756c 6174 696f 6e20 7468  he simulation th
+000115b0: 6520 6368 6f73 656e 2076 616c 7565 2060  e chosen value `
+000115c0: 6028 532f 4e29 5f6d 696e 6060 2061 6e64  `(S/N)_min`` and
+000115d0: 2061 7320 696e 7075 740d 0a20 2020 6060   as input..   ``
+000115e0: 5b68 332c 2068 345d 6060 2074 6865 206d  [h3, h4]`` the m
+000115f0: 6178 696d 756d 2072 6570 7265 7365 6e74  aximum represent
+00011600: 6174 6976 6520 7661 6c75 6573 206d 6561  ative values mea
+00011610: 7375 7265 6420 696e 2074 6865 0d0a 2020  sured in the..  
+00011620: 206e 6f6e 2d70 656e 616c 697a 6564 2060   non-penalized `
+00011630: 6070 5058 4660 6020 6669 7420 6f66 2074  `pPXF`` fit of t
+00011640: 6865 2070 7265 7669 6f75 7320 7374 6570  he previous step
+00011650: 3b0d 0a34 2e20 4368 6f6f 7365 2061 7320  ;..4. Choose as 
+00011660: 7468 6520 7065 6e61 6c74 7920 2860 6062  the penalty (``b
+00011670: 6961 7360 6029 2074 6865 202a 6c61 7267  ias``) the *larg
+00011680: 6573 742a 2076 616c 7565 2073 7563 6820  est* value such 
+00011690: 7468 6174 2c20 666f 720d 0a20 2020 6060  that, for..   ``
+000116a0: 7369 676d 6120 3e20 332a 7665 6c73 6361  sigma > 3*velsca
+000116b0: 6c65 6060 2c20 7468 6520 6176 6572 6167  le``, the averag
+000116c0: 6520 6469 6666 6572 656e 6365 2064 656c  e difference del
+000116d0: 7461 2062 6574 7765 656e 2074 6865 206f  ta between the o
+000116e0: 7574 7075 740d 0a20 2020 6060 5b68 332c  utput..   ``[h3,
+000116f0: 2068 345d 6060 2061 6e64 2074 6865 2069   h4]`` and the i
+00011700: 6e70 7574 2060 605b 6833 2c20 6834 5d60  nput ``[h3, h4]`
+00011710: 6020 6973 2077 656c 6c20 7769 7468 696e  ` is well within
+00011720: 2028 652e 672e 0d0a 2020 2060 6064 656c   (e.g...   ``del
+00011730: 7461 207e 2072 6d73 2f33 6060 2920 7468  ta ~ rms/3``) th
+00011740: 6520 726d 7320 7363 6174 7465 7220 6f66  e rms scatter of
+00011750: 2074 6865 2073 696d 756c 6174 6564 2076   the simulated v
+00011760: 616c 7565 7320 2873 6565 2061 6e0d 0a20  alues (see an.. 
+00011770: 2020 6578 616d 706c 6520 696e 2046 6967    example in Fig
+00011780: 2e20 3220 6f66 2060 456d 7365 6c6c 656d  . 2 of `Emsellem
+00011790: 2065 7420 616c 2e20 3230 3034 0d0a 2020   et al. 2004..  
+000117a0: 203c 6874 7470 3a2f 2f75 692e 6164 7361   <http://ui.adsa
+000117b0: 6273 2e68 6172 7661 7264 2e65 6475 2f61  bs.harvard.edu/a
+000117c0: 6273 2f32 3030 344d 4e52 4153 2e33 3532  bs/2004MNRAS.352
+000117d0: 2e2e 3732 3145 3e60 5f29 2e0d 0a0d 0a50  ..721E>`_).....P
+000117e0: 726f 626c 656d 7320 7769 7468 2059 6f75  roblems with You
+000117f0: 7220 4669 7273 7420 4669 743f 0d0a 2d2d  r First Fit?..--
+00011800: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00011810: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a43  -----------....C
+00011820: 6f6d 6d6f 6e20 7072 6f62 6c65 6d73 2077  ommon problems w
+00011830: 6974 6820 796f 7572 2066 6972 7374 2060  ith your first `
+00011840: 6070 5058 4660 6020 6669 7420 6172 6520  `pPXF`` fit are 
+00011850: 6361 7573 6564 2062 7920 696e 636f 7272  caused by incorr
+00011860: 6563 740d 0a77 6176 656c 656e 6774 6820  ect..wavelength 
+00011870: 7261 6e67 6573 206f 7220 6469 6666 6572  ranges or differ
+00011880: 656e 7420 7665 6c6f 6369 7479 2073 6361  ent velocity sca
+00011890: 6c65 7320 6265 7477 6565 6e20 6761 6c61  les between gala
+000118a0: 7879 2061 6e64 0d0a 7465 6d70 6c61 7465  xy and..template
+000118b0: 732e 2054 6f20 7175 6963 6b6c 7920 6465  s. To quickly de
+000118c0: 7465 6374 2074 6865 7365 2070 726f 626c  tect these probl
+000118d0: 656d 7320 7472 7920 746f 206f 7665 7270  ems try to overp
+000118e0: 6c6f 7420 7468 6520 286c 6f67 0d0a 7265  lot the (log..re
+000118f0: 6269 6e6e 6564 2920 6761 6c61 7879 2061  binned) galaxy a
+00011900: 6e64 2074 6865 2074 656d 706c 6174 6520  nd the template 
+00011910: 6a75 7374 2062 6566 6f72 6520 6361 6c6c  just before call
+00011920: 696e 6720 7468 6520 6060 7050 5846 6060  ing the ``pPXF``
+00011930: 0d0a 7072 6f63 6564 7572 652e 0d0a 0d0a  ..procedure.....
+00011940: 596f 7520 6361 6e20 7573 6520 736f 6d65  You can use some
+00011950: 7468 696e 6720 6c69 6b65 2074 6865 2066  thing like the f
+00011960: 6f6c 6c6f 7769 6e67 2050 7974 686f 6e20  ollowing Python 
+00011970: 6c69 6e65 7320 7768 696c 6520 6164 6a75  lines while adju
+00011980: 7374 696e 6720 7468 650d 0a73 6d6f 6f74  sting the..smoot
+00011990: 6869 6e67 2077 696e 646f 7720 616e 6420  hing window and 
+000119a0: 7468 6520 7069 7865 6c73 2073 6869 6674  the pixels shift
+000119b0: 2e20 4966 2079 6f75 2063 616e 6e6f 7420  . If you cannot 
+000119c0: 6765 7420 6120 726f 7567 6820 6d61 7463  get a rough matc
+000119d0: 680d 0a62 7920 6579 6520 6974 206d 6561  h..by eye it mea
+000119e0: 6e73 2073 6f6d 6574 6869 6e67 2069 7320  ns something is 
+000119f0: 7772 6f6e 6720 616e 6420 6974 2069 7320  wrong and it is 
+00011a00: 756e 6c69 6b65 6c79 2074 6861 7420 6060  unlikely that ``
+00011a10: 7050 5846 6060 0d0a 286f 7220 616e 7920  pPXF``..(or any 
+00011a20: 6f74 6865 7220 7072 6f67 7261 6d29 2077  other program) w
+00011a30: 696c 6c20 6669 6e64 2061 2067 6f6f 6420  ill find a good 
+00011a40: 6d61 7463 683a 0d0a 0d0a 2e2e 2063 6f64  match:...... cod
+00011a50: 652d 626c 6f63 6b3a 3a20 7079 7468 6f6e  e-block:: python
+00011a60: 0d0a 0d0a 2020 2020 696d 706f 7274 206e  ....    import n
+00011a70: 756d 7079 2061 7320 6e70 0d0a 2020 2020  umpy as np..    
+00011a80: 696d 706f 7274 206d 6174 706c 6f74 6c69  import matplotli
+00011a90: 622e 7079 706c 6f74 2061 7320 706c 740d  b.pyplot as plt.
+00011aa0: 0a20 2020 2066 726f 6d20 7363 6970 7920  .    from scipy 
+00011ab0: 696d 706f 7274 206e 6469 6d61 6765 0d0a  import ndimage..
+00011ac0: 0d0a 2020 2020 7369 676d 6120 3d20 3220  ..    sigma = 2 
+00011ad0: 2020 2020 2020 2320 5665 6c6f 6369 7479        # Velocity
+00011ae0: 2064 6973 7065 7273 696f 6e20 696e 2070   dispersion in p
+00011af0: 6978 656c 730d 0a20 2020 2073 6869 6674  ixels..    shift
+00011b00: 203d 202d 3230 2020 2020 2023 2056 656c   = -20     # Vel
+00011b10: 6f63 6974 7920 7368 6966 7420 696e 2070  ocity shift in p
+00011b20: 6978 656c 730d 0a20 2020 2074 656d 706c  ixels..    templ
+00011b30: 6174 6520 3d20 6e70 2e72 6f6c 6c28 6e64  ate = np.roll(nd
+00011b40: 696d 6167 652e 6761 7573 7369 616e 5f66  image.gaussian_f
+00011b50: 696c 7465 7231 6428 7465 6d70 6c61 7465  ilter1d(template
+00011b60: 2c20 7369 676d 6129 2c20 7368 6966 7429  , sigma), shift)
+00011b70: 0d0a 2020 2020 706c 742e 706c 6f74 2867  ..    plt.plot(g
+00011b80: 616c 6178 792c 2027 6b27 290d 0a20 2020  alaxy, 'k')..   
+00011b90: 2070 6c74 2e70 6c6f 7428 7465 6d70 6c61   plt.plot(templa
+00011ba0: 7465 2a6e 702e 6d65 6469 616e 2867 616c  te*np.median(gal
+00011bb0: 6178 7929 2f6e 702e 6d65 6469 616e 2874  axy)/np.median(t
+00011bc0: 656d 706c 6174 6529 2c20 2772 2729 0d0a  emplate), 'r')..
+00011bd0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
 00011be0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00011bf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00011c00: 2323 2323 2323 2323 230d 0a0d 0a0d 0a4c  #########......L
-00011c10: 6963 656e 7365 0d0a 2d2d 2d2d 2d2d 2d0d  icense..-------.
-00011c20: 0a0d 0a4f 7468 6572 2f50 726f 7072 6965  ...Other/Proprie
-00011c30: 7461 7279 204c 6963 656e 7365 0d0a 0d0a  tary License....
-00011c40: 436f 7079 7269 6768 7420 2863 2920 3230  Copyright (c) 20
-00011c50: 3031 2d32 3032 3420 4d69 6368 656c 6520  01-2024 Michele 
-00011c60: 4361 7070 656c 6c61 7269 0d0a 0d0a 5468  Cappellari....Th
-00011c70: 6973 2073 6f66 7477 6172 6520 6973 2070  is software is p
-00011c80: 726f 7669 6465 6420 6173 2069 7320 7769  rovided as is wi
-00011c90: 7468 206e 6f20 7761 7272 616e 7479 2e20  th no warranty. 
-00011ca0: 596f 7520 6d61 7920 7573 6520 6974 2066  You may use it f
-00011cb0: 6f72 0d0a 6e6f 6e2d 636f 6d6d 6572 6369  or..non-commerci
-00011cc0: 616c 2070 7572 706f 7365 7320 616e 6420  al purposes and 
-00011cd0: 6d6f 6469 6679 2069 7420 666f 7220 7065  modify it for pe
-00011ce0: 7273 6f6e 616c 206f 7220 696e 7465 726e  rsonal or intern
-00011cf0: 616c 2075 7365 2c20 6173 206c 6f6e 670d  al use, as long.
-00011d00: 0a61 7320 796f 7520 696e 636c 7564 6520  .as you include 
-00011d10: 7468 6973 2063 6f70 7972 6967 6874 2061  this copyright a
-00011d20: 6e64 2064 6973 636c 6169 6d65 7220 696e  nd disclaimer in
-00011d30: 2061 6c6c 2063 6f70 6965 732e 2059 6f75   all copies. You
-00011d40: 206d 6179 206e 6f74 0d0a 7265 6469 7374   may not..redist
-00011d50: 7269 6275 7465 2074 6865 2063 6f64 652e  ribute the code.
-00011d60: 0d0a 0d0a 2323 2323 2323 2323 2323 2323  ....############
-00011d70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00011c00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00011c10: 2323 2323 2323 2323 2323 2323 230d 0a0d  #############...
+00011c20: 0a0d 0a4c 6963 656e 7365 0d0a 2d2d 2d2d  ...License..----
+00011c30: 2d2d 2d0d 0a0d 0a4f 7468 6572 2f50 726f  ---....Other/Pro
+00011c40: 7072 6965 7461 7279 204c 6963 656e 7365  prietary License
+00011c50: 0d0a 0d0a 436f 7079 7269 6768 7420 2863  ....Copyright (c
+00011c60: 2920 3230 3031 2d32 3032 3420 4d69 6368  ) 2001-2024 Mich
+00011c70: 656c 6520 4361 7070 656c 6c61 7269 0d0a  ele Cappellari..
+00011c80: 0d0a 5468 6973 2073 6f66 7477 6172 6520  ..This software 
+00011c90: 6973 2070 726f 7669 6465 6420 6173 2069  is provided as i
+00011ca0: 7320 7769 7468 206e 6f20 7761 7272 616e  s with no warran
+00011cb0: 7479 2e20 596f 7520 6d61 7920 7573 6520  ty. You may use 
+00011cc0: 6974 2066 6f72 0d0a 6e6f 6e2d 636f 6d6d  it for..non-comm
+00011cd0: 6572 6369 616c 2070 7572 706f 7365 7320  ercial purposes 
+00011ce0: 616e 6420 6d6f 6469 6679 2069 7420 666f  and modify it fo
+00011cf0: 7220 7065 7273 6f6e 616c 206f 7220 696e  r personal or in
+00011d00: 7465 726e 616c 2075 7365 2c20 6173 206c  ternal use, as l
+00011d10: 6f6e 670d 0a61 7320 796f 7520 696e 636c  ong..as you incl
+00011d20: 7564 6520 7468 6973 2063 6f70 7972 6967  ude this copyrig
+00011d30: 6874 2061 6e64 2064 6973 636c 6169 6d65  ht and disclaime
+00011d40: 7220 696e 2061 6c6c 2063 6f70 6965 732e  r in all copies.
+00011d50: 2059 6f75 206d 6179 206e 6f74 0d0a 7265   You may not..re
+00011d60: 6469 7374 7269 6275 7465 2074 6865 2063  distribute the c
+00011d70: 6f64 652e 0d0a 0d0a 2323 2323 2323 2323  ode.....########
 00011d80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00011d90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00011da0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00011db0: 0a0d 0a43 6861 6e67 656c 6f67 0d0a 2d2d  ...Changelog..--
-00011dc0: 2d2d 2d2d 2d2d 2d0d 0a0d 0a56 392e 322e  -------....V9.2.
-00011dd0: 313a 204d 432c 204f 7866 6f72 642c 2031  1: MC, Oxford, 1
-00011de0: 3820 4170 7269 6c20 3230 3234 0d0a 2b2b  8 April 2024..++
-00011df0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00011e00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-00011e10: 0a0d 0a2d 202a 2a49 6d70 726f 7665 642a  ...- **Improved*
-00011e20: 2a20 6060 7370 735f 7574 696c 2e73 796e  * ``sps_util.syn
-00011e30: 7468 6574 6963 5f70 686f 746f 6d65 7472  thetic_photometr
-00011e40: 7960 603a 2041 6363 6570 7473 2069 6e70  y``: Accepts inp
-00011e50: 7574 2077 6176 656c 656e 6774 6873 0d0a  ut wavelengths..
-00011e60: 2020 7468 6174 2061 7265 206e 6f74 2065    that are not e
-00011e70: 7665 6e6c 7920 7370 6163 6564 2e0d 0a2d  venly spaced...-
-00011e80: 202a 2a41 6464 6564 2a2a 2060 6070 7078   **Added** ``ppx
-00011e90: 665f 7574 696c 2e6d 6167 5f73 7065 6374  f_util.mag_spect
-00011ea0: 7275 6d60 603a 2041 206e 6577 2066 756e  rum``: A new fun
-00011eb0: 6374 696f 6e20 746f 2067 6574 2074 6865  ction to get the
-00011ec0: 2061 7070 6172 656e 740d 0a20 206d 6167   apparent..  mag
-00011ed0: 6e69 7475 6465 2066 726f 6d20 6120 7370  nitude from a sp
-00011ee0: 6563 7472 756d 2069 6e20 616e 7920 7068  ectrum in any ph
-00011ef0: 6f74 6f6d 6574 7269 6320 6261 6e64 2c20  otometric band, 
-00011f00: 6174 2061 6e79 2072 6564 7368 6966 742c  at any redshift,
-00011f10: 2069 6e20 6569 7468 6572 0d0a 2020 7468   in either..  th
-00011f20: 6520 4142 206f 7220 5665 6761 206d 6167  e AB or Vega mag
-00011f30: 6e69 7475 6465 2073 7973 7465 6d2e 0d0a  nitude system...
-00011f40: 2d20 2a2a 496d 7072 6f76 6564 2a2a 2060  - **Improved** `
-00011f50: 6070 7078 6660 603a 204e 6f77 2063 6f6e  `ppxf``: Now con
-00011f60: 7369 6465 7273 2074 6865 2067 6976 656e  siders the given
-00011f70: 2060 6067 6f6f 6470 6978 656c 7360 6020   ``goodpixels`` 
-00011f80: 7768 656e 2063 6865 636b 696e 670d 0a20  when checking.. 
-00011f90: 2074 6861 7420 7468 6520 6060 7465 6d70   that the ``temp
-00011fa0: 6c61 7465 7360 6020 636f 7665 7220 7468  lates`` cover th
-00011fb0: 6520 6675 6c6c 2060 6067 616c 6178 7960  e full ``galaxy`
-00011fc0: 6020 7370 6563 7472 756d 2c20 6966 2062  ` spectrum, if b
-00011fd0: 6f74 6820 6060 6c61 6d60 600d 0a20 2061  oth ``lam``..  a
-00011fe0: 6e64 2060 606c 616d 5f74 656d 7060 6020  nd ``lam_temp`` 
-00011ff0: 6172 6520 7072 6f76 6964 6564 2e0d 0a2d  are provided...-
-00012000: 202a 2a41 6464 6564 2a2a 2060 6070 7078   **Added** ``ppx
-00012010: 6660 603a 2041 6c6c 6f77 2066 6f72 2076  f``: Allow for v
-00012020: 6172 6961 626c 6520 7374 6570 2073 697a  ariable step siz
-00012030: 6520 6163 726f 7373 2069 6e74 6572 7661  e across interva
-00012040: 6c73 2061 6e64 0d0a 2020 6469 6d65 6e73  ls and..  dimens
-00012050: 696f 6e73 2069 6e20 7468 6520 6e75 6d65  ions in the nume
-00012060: 7269 6361 6c20 6465 7269 7661 7469 7665  rical derivative
-00012070: 7320 7573 6564 2066 6f72 2072 6567 756c  s used for regul
-00012080: 6172 697a 6174 696f 6e2c 2077 6974 6820  arization, with 
-00012090: 7468 6520 6e65 770d 0a20 206b 6579 776f  the new..  keywo
-000120a0: 7264 2060 6072 6567 5f73 7465 7060 602e  rd ``reg_step``.
-000120b0: 0d0a 2d20 2a2a 4669 7865 642a 2a20 6060  ..- **Fixed** ``
-000120c0: 7070 7866 6060 3a20 4176 6f69 6473 206e  ppxf``: Avoids n
-000120d0: 6577 2060 6053 796e 7461 7857 6172 6e69  ew ``SyntaxWarni
-000120e0: 6e67 6060 2069 6e20 4d61 7470 6c6f 746c  ng`` in Matplotl
-000120f0: 6962 204c 6154 6558 2073 7472 696e 670d  ib LaTeX string.
-00012100: 0a20 2069 6e20 7468 6520 6c61 7465 7374  .  in the latest
-00012110: 2050 7974 686f 6e20 332e 3132 2e0d 0a2d   Python 3.12...-
-00012120: 202a 2a46 6978 6564 2a2a 2060 6070 7078   **Fixed** ``ppx
-00012130: 6660 603a 2041 766f 6964 2070 726f 6772  f``: Avoid progr
-00012140: 616d 2073 746f 7020 7768 656e 2070 6173  am stop when pas
-00012150: 7369 6e67 2061 6e20 696e 7075 7420 636f  sing an input co
-00012160: 7661 7269 616e 6365 0d0a 2020 6d61 7472  variance..  matr
-00012170: 6978 2077 6869 6c65 2066 6974 7469 6e67  ix while fitting
-00012180: 2066 6f72 2067 6173 2065 6d69 7373 696f   for gas emissio
-00012190: 6e20 6c69 6e65 732e 2054 6861 6e6b 7320  n lines. Thanks 
-000121a0: 746f 204a 6163 6b73 6f6e 204f 446f 6e6e  to Jackson ODonn
-000121b0: 656c 6c0d 0a20 2028 7563 7363 2e65 6475  ell..  (ucsc.edu
-000121c0: 2920 666f 7220 7468 6520 7265 706f 7274  ) for the report
-000121d0: 2e0d 0a0d 0a56 392e 312e 313a 204d 432c  .....V9.1.1: MC,
-000121e0: 204f 7866 6f72 642c 2031 3820 4a61 6e75   Oxford, 18 Janu
-000121f0: 6172 7920 3230 3234 0d0a 2b2b 2b2b 2b2b  ary 2024..++++++
-00012200: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012210: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00012220: 0a2d 202a 2a49 6d70 726f 7665 642a 2a20  .- **Improved** 
-00012230: 6060 7370 735f 7574 696c 2e6d 6173 735f  ``sps_util.mass_
-00012240: 746f 5f6c 6967 6874 6060 3a20 4e6f 7720  to_light``: Now 
-00012250: 6974 2063 616e 2063 616c 6375 6c61 7465  it can calculate
-00012260: 2074 6865 2073 7465 6c6c 6172 0d0a 2020   the stellar..  
-00012270: 6d61 7373 2d74 6f2d 6c69 6768 7420 7261  mass-to-light ra
-00012280: 7469 6f20 2860 604d 2a2f 4c60 6029 2066  tio (``M*/L``) f
-00012290: 6f72 2061 6e79 2073 7465 6c6c 6172 2070  or any stellar p
-000122a0: 6f70 756c 6174 696f 6e20 7379 6e74 6865  opulation synthe
-000122b0: 7369 7320 2853 5053 290d 0a20 206d 6f64  sis (SPS)..  mod
-000122c0: 656c 2c20 616e 7920 6669 6c74 6572 2c20  el, any filter, 
-000122d0: 616e 6420 616e 7920 7265 6473 6869 6674  and any redshift
-000122e0: 2c20 7573 696e 6720 7468 6520 6f75 7470  , using the outp
-000122f0: 7574 2077 6569 6768 7473 2066 726f 6d20  ut weights from 
-00012300: 6060 7050 5846 6060 2e0d 0a20 204e 6f20  ``pPXF``...  No 
-00012310: 6e65 6564 2066 6f72 2070 7265 2d63 6f6d  need for pre-com
-00012320: 7075 7465 6420 7461 626c 6573 2061 6e79  puted tables any
-00012330: 6d6f 7265 2e0d 0a2d 202a 2a41 6464 6564  more...- **Added
-00012340: 2a2a 2060 6070 7078 665f 7574 696c 2e6d  ** ``ppxf_util.m
-00012350: 6167 5f73 756e 6060 3a20 4120 6e65 7720  ag_sun``: A new 
-00012360: 6675 6e63 7469 6f6e 2074 6f20 6765 7420  function to get 
-00012370: 7468 6520 6162 736f 6c75 7465 2073 6f6c  the absolute sol
-00012380: 6172 0d0a 2020 6d61 676e 6974 7564 6520  ar..  magnitude 
-00012390: 696e 2061 6e79 2070 686f 746f 6d65 7472  in any photometr
-000123a0: 6963 2062 616e 642c 2061 7420 616e 7920  ic band, at any 
-000123b0: 7265 6473 6869 6674 2c20 696e 2065 6974  redshift, in eit
-000123c0: 6865 7220 7468 6520 4142 206f 7220 5665  her the AB or Ve
-000123d0: 6761 0d0a 2020 6d61 676e 6974 7564 6520  ga..  magnitude 
-000123e0: 7379 7374 656d 2e0d 0a0d 0a56 392e 302e  system.....V9.0.
-000123f0: 323a 204d 432c 204f 7866 6f72 642c 2033  2: MC, Oxford, 3
-00012400: 3020 4e6f 7665 6d62 6572 2032 3032 330d  0 November 2023.
-00012410: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-00012420: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012430: 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6070 7078  +++++....- ``ppx
-00012440: 6660 603a 2046 6978 6564 2062 7567 2069  f``: Fixed bug i
-00012450: 6e20 7468 6520 6175 746f 6d61 7469 6320  n the automatic 
-00012460: 7472 756e 6361 7469 6f6e 206f 6620 7468  truncation of th
-00012470: 6520 7465 6d70 6c61 7465 2077 6176 656c  e template wavel
-00012480: 656e 6774 682c 0d0a 2020 7768 656e 2075  ength,..  when u
-00012490: 7369 6e67 2060 6062 6f75 6e64 7360 6020  sing ``bounds`` 
-000124a0: 746f 6765 7468 6572 2077 6974 6820 6060  together with ``
-000124b0: 6c61 6d60 6020 616e 6420 6060 6c61 6d5f  lam`` and ``lam_
-000124c0: 7465 6d70 6060 2e0d 0a0d 0a56 392e 302e  temp``.....V9.0.
-000124d0: 313a 204d 432c 204f 7866 6f72 642c 2031  1: MC, Oxford, 1
-000124e0: 3220 4e6f 7665 6d62 6572 2032 3032 330d  2 November 2023.
-000124f0: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-00012500: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012510: 2b2b 2b2b 2b0d 0a0d 0a2d 2052 6570 6c61  +++++....- Repla
-00012520: 6365 6420 6060 6d69 6c65 735f 7574 696c  ced ``miles_util
-00012530: 6060 2077 6974 6820 6060 7370 735f 7574  `` with ``sps_ut
-00012540: 696c 6060 2c20 6120 7665 7273 6174 696c  il``, a versatil
-00012550: 6520 616e 6420 666c 6578 6962 6c65 2066  e and flexible f
-00012560: 756e 6374 696f 6e0d 0a20 2074 6861 7420  unction..  that 
-00012570: 7375 7070 6f72 7473 2076 6172 696f 7573  supports various
-00012580: 2073 7465 6c6c 6172 2070 6f70 756c 6174   stellar populat
-00012590: 696f 6e20 7379 6e74 6865 7369 7320 2853  ion synthesis (S
-000125a0: 5053 2920 6d6f 6465 6c73 2e20 4375 7272  PS) models. Curr
-000125b0: 656e 746c 792c 2049 0d0a 2020 6469 7374  ently, I..  dist
-000125c0: 7269 6275 7465 2028 7769 7468 2070 6572  ribute (with per
-000125d0: 6d69 7373 696f 6e29 2074 6865 2060 6045  mission) the ``E
-000125e0: 2d4d 494c 4553 6060 2028 5661 7a64 656b  -MILES`` (Vazdek
-000125f0: 6973 2b32 3031 3629 2c20 6060 4741 4c41  is+2016), ``GALA
-00012600: 5845 5660 600d 0a20 2028 4272 757a 7561  XEV``..  (Bruzua
-00012610: 6c20 2620 4368 6172 6c6f 7420 3230 3033  l & Charlot 2003
-00012620: 2920 616e 6420 6060 6673 7073 6060 2028  ) and ``fsps`` (
-00012630: 436f 6e72 6f79 2b32 3030 392c 3230 3130  Conroy+2009,2010
-00012640: 2920 7374 656c 6c61 7220 706f 7075 6c61  ) stellar popula
-00012650: 7469 6f6e 0d0a 2020 7465 6d70 6c61 7465  tion..  template
-00012660: 732e 204f 6e65 2063 616e 206e 6f77 2063  s. One can now c
-00012670: 6861 6e67 6520 5350 5320 6279 206a 7573  hange SPS by jus
-00012680: 7420 6d6f 6469 6679 696e 6720 7468 6520  t modifying the 
-00012690: 6669 6c65 6e61 6d65 2e0d 0a20 200d 0a20  filename...  .. 
-000126a0: 2049 4d50 4f52 5441 4e54 3a20 4920 6e6f   IMPORTANT: I no
-000126b0: 206c 6f6e 6765 7220 696e 636c 7564 6520   longer include 
-000126c0: 7468 6520 5350 5320 6d6f 6465 6c73 2069  the SPS models i
-000126d0: 6e20 7468 6520 6060 7050 5846 6060 2070  n the ``pPXF`` p
-000126e0: 6163 6b61 6765 2c20 6475 6520 746f 0d0a  ackage, due to..
-000126f0: 2020 6669 6c65 2073 697a 6520 636f 6e73    file size cons
-00012700: 7472 6169 6e74 732e 204f 6e65 206d 7573  traints. One mus
-00012710: 7420 646f 776e 6c6f 6164 2074 6865 2053  t download the S
-00012720: 5053 2074 656d 706c 6174 6573 2073 6570  PS templates sep
-00012730: 6172 6174 656c 7920 6166 7465 720d 0a20  arately after.. 
-00012740: 2074 6865 2060 6070 5058 4660 6020 696e   the ``pPXF`` in
-00012750: 7374 616c 6c61 7469 6f6e 2c20 6173 2064  stallation, as d
-00012760: 656d 6f6e 7374 7261 7465 6420 696e 2061  emonstrated in a
-00012770: 6c6c 2074 6865 2060 6070 5058 4660 6020  ll the ``pPXF`` 
-00012780: 6578 616d 706c 6573 2e0d 0a2d 2049 2061  examples...- I a
-00012790: 6461 7074 6564 2061 6c6c 2065 7861 6d70  dapted all examp
-000127a0: 6c65 7320 696e 636c 7564 6564 2069 6e20  les included in 
-000127b0: 7468 6520 7061 636b 6167 6520 746f 2075  the package to u
-000127c0: 7365 2074 6865 206e 6577 2060 6073 7073  se the new ``sps
-000127d0: 5f75 7469 6c60 602e 200d 0a2d 2060 6070  _util``. ..- ``p
-000127e0: 7078 662e 706c 6f74 6060 3a20 4e65 7720  pxf.plot``: New 
-000127f0: 6b65 7977 6f72 6420 6060 6c61 6d5f 666c  keyword ``lam_fl
-00012800: 616d 6060 2074 6f20 706c 6f74 2060 606c  am`` to plot ``l
-00012810: 616d 2a66 286c 616d 2920 3d20 6e75 2a66  am*f(lam) = nu*f
-00012820: 286e 7529 6060 2e0d 0a2d 2060 6070 7078  (nu)``...- ``ppx
-00012830: 665f 7574 696c 2e73 796e 7468 6574 6963  f_util.synthetic
-00012840: 5f70 686f 746f 6d65 7472 7960 603a 2043  _photometry``: C
-00012850: 6f6e 7665 7274 6564 2066 726f 6d20 6120  onverted from a 
-00012860: 6675 6e63 7469 6f6e 2074 6f20 6120 636c  function to a cl
-00012870: 6173 732e 0d0a 2020 4164 6465 6420 6060  ass...  Added ``
-00012880: 2e6c 616d 5f70 6976 6060 2061 7474 7269  .lam_piv`` attri
-00012890: 6275 7465 2074 6f20 636f 6d70 7574 6520  bute to compute 
-000128a0: 7468 6520 7069 766f 7420 7761 7665 6c65  the pivot wavele
-000128b0: 6e67 7468 206f 6620 6561 6368 2066 696c  ngth of each fil
-000128c0: 7465 722e 0d0a 2d20 6060 7070 7866 5f75  ter...- ``ppxf_u
-000128d0: 7469 6c2e 7661 7273 6d6f 6f74 6860 603a  til.varsmooth``:
-000128e0: 2053 7065 6369 616c 697a 6564 2066 6173   Specialized fas
-000128f0: 7465 7220 636f 6e76 6f6c 7574 696f 6e20  ter convolution 
-00012900: 6966 2073 6967 6d61 2069 7320 6120 7363  if sigma is a sc
-00012910: 616c 6172 2e0d 0a20 2077 6869 6c65 2075  alar...  while u
-00012920: 7369 6e67 2074 6865 2061 6e61 6c79 7469  sing the analyti
-00012930: 6320 466f 7572 6965 7220 7472 616e 7366  c Fourier transf
-00012940: 6f72 6d20 746f 2064 6561 6c20 7769 7468  orm to deal with
-00012950: 2075 6e64 6572 7361 6d70 6c69 6e67 2e0d   undersampling..
-00012960: 0a2d 2060 6070 7078 6660 603a 2052 6169  .- ``ppxf``: Rai
-00012970: 7365 6420 616e 2065 7272 6f72 2069 6620  sed an error if 
-00012980: 6060 7068 6f74 6060 2069 6e70 7574 2069  ``phot`` input i
-00012990: 7320 6e6f 7420 6669 6e69 7465 2e0d 0a0d  s not finite....
-000129a0: 0a56 382e 322e 363a 204d 432c 204f 7866  .V8.2.6: MC, Oxf
-000129b0: 6f72 642c 2036 204a 756c 7920 3230 3233  ord, 6 July 2023
-000129c0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-000129d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000129e0: 2b0d 0a0d 0a2d 2060 6063 6170 6669 7460  +....- ``capfit`
-000129f0: 603a 2052 656c 6178 6564 2074 6f6c 6572  `: Relaxed toler
-00012a00: 616e 6365 2077 6865 6e20 6368 6563 6b69  ance when checki
-00012a10: 6e67 2069 6e69 7469 616c 2067 7565 7373  ng initial guess
-00012a20: 2066 6561 7369 6269 6c69 7479 2e0d 0a2d   feasibility...-
-00012a30: 2060 6070 7078 665f 7574 696c 6060 3a20   ``ppxf_util``: 
-00012a40: 4669 7865 6420 7072 6f67 7261 6d20 7374  Fixed program st
-00012a50: 6f70 2069 6e20 6060 6761 7573 7369 616e  op in ``gaussian
-00012a60: 5f66 696c 7465 7231 6460 6020 7768 656e  _filter1d`` when
-00012a70: 2060 6073 6967 3d30 6060 2e0d 0a20 2054   ``sig=0``...  T
-00012a80: 6861 6e6b 7320 746f 204a 6573 7365 2056  hanks to Jesse V
-00012a90: 616e 2064 6520 5361 6e64 6520 2873 7964  an de Sande (syd
-00012aa0: 6e65 792e 6564 752e 6175 2920 666f 7220  ney.edu.au) for 
-00012ab0: 7468 6520 7265 706f 7274 2e0d 0a0d 0a56  the report.....V
-00012ac0: 382e 322e 343a 204d 432c 204f 7866 6f72  8.2.4: MC, Oxfor
-00012ad0: 642c 2031 3220 4d61 7920 3230 3233 0d0a  d, 12 May 2023..
-00012ae0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012af0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-00012b00: 0a0d 0a2d 2060 6070 7078 6660 603a 2046  ...- ``ppxf``: F
-00012b10: 6978 6564 2069 6e63 6f72 7265 6374 6c79  ixed incorrectly
-00012b20: 2073 7769 7463 6869 6e67 2074 6f20 6060   switching to ``
-00012b30: 6d65 7468 6f64 3d27 6c69 6e65 6172 2760  method='linear'`
-00012b40: 6020 7768 656e 2072 6571 7565 7374 696e  ` when requestin
-00012b50: 670d 0a20 2074 6f20 6669 7420 7374 656c  g..  to fit stel
-00012b60: 6c61 7220 7265 6464 656e 696e 6720 616c  lar reddening al
-00012b70: 6f6e 652c 2077 6869 6c65 2061 6c6c 206f  one, while all o
-00012b80: 7468 6572 2070 6172 616d 6574 6572 7320  ther parameters 
-00012b90: 6172 6520 6669 7865 642e 2054 6861 6e6b  are fixed. Thank
-00012ba0: 730d 0a20 2074 6f20 4a6f 6e67 2043 6875  s..  to Jong Chu
-00012bb0: 6c20 4c65 6520 286b 6173 692e 7265 2e6b  l Lee (kasi.re.k
-00012bc0: 7229 2066 6f72 2061 2063 6c65 6172 2065  r) for a clear e
-00012bd0: 7861 6d70 6c65 206f 6620 7265 7072 6f64  xample of reprod
-00012be0: 7563 696e 6720 7468 6520 6275 672e 0d0a  ucing the bug...
-00012bf0: 0d0a 5638 2e32 2e33 3a20 4d43 2c20 4f78  ..V8.2.3: MC, Ox
-00012c00: 666f 7264 2c20 3520 4a61 6e75 6172 7920  ford, 5 January 
-00012c10: 3230 3233 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2023..++++++++++
-00012c20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012c30: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060  ++++++++....- ``
-00012c40: 7070 7866 6060 3a20 4669 7865 6420 7072  ppxf``: Fixed pr
-00012c50: 6f67 7261 6d20 7374 6f70 2077 6865 6e20  ogram stop when 
-00012c60: 6669 7474 696e 6720 626f 7468 2073 6b79  fitting both sky
-00012c70: 2073 7065 6374 7261 2061 6e64 2067 6173   spectra and gas
-00012c80: 2065 6d69 7373 696f 6e0d 0a20 206c 696e   emission..  lin
-00012c90: 6573 2e20 4d61 6e79 2074 6861 6e6b 7320  es. Many thanks 
-00012ca0: 746f 2041 6461 7273 6820 5261 6e6a 616e  to Adarsh Ranjan
-00012cb0: 2028 6b61 7369 2e72 652e 6b72 2920 666f   (kasi.re.kr) fo
-00012cc0: 7220 6120 636c 6561 7220 6578 616d 706c  r a clear exampl
-00012cd0: 650d 0a20 206f 6620 7265 7072 6f64 7563  e..  of reproduc
-00012ce0: 696e 6720 7468 6520 7072 6f62 6c65 6d20  ing the problem 
-00012cf0: 616e 6420 666f 7220 7468 6520 6275 6720  and for the bug 
-00012d00: 6669 782e 0d0a 2d20 6060 7070 7866 6060  fix...- ``ppxf``
-00012d10: 3a20 5261 6973 6520 616e 2065 7272 6f72  : Raise an error
-00012d20: 2069 6620 6060 7665 6c73 6361 6c65 6060   if ``velscale``
-00012d30: 2069 7320 6e6f 7420 6120 7363 616c 6172   is not a scalar
-00012d40: 2e20 5570 6461 7465 6420 6578 616d 706c  . Updated exampl
-00012d50: 650d 0a20 2070 726f 6365 6475 7265 732e  e..  procedures.
-00012d60: 2054 6869 7320 6669 7865 7320 6120 7072   This fixes a pr
-00012d70: 6f67 7261 6d20 7374 6f70 2064 7565 2074  ogram stop due t
-00012d80: 6f20 6120 6368 616e 6765 2069 6e20 4e75  o a change in Nu
-00012d90: 6d50 7920 312e 3234 2e0d 0a2d 2060 6070  mPy 1.24...- ``p
-00012da0: 7078 665f 7574 696c 6060 3a20 4368 616e  pxf_util``: Chan
-00012db0: 6765 6420 6060 6c6f 675f 7265 6269 6e60  ged ``log_rebin`
-00012dc0: 6020 746f 2072 6574 7572 6e20 6060 7665  ` to return ``ve
-00012dd0: 6c73 6361 6c65 6060 2061 7320 6120 7363  lscale`` as a sc
-00012de0: 616c 6172 2e0d 0a2d 204e 6577 2065 7861  alar...- New exa
-00012df0: 6d70 6c65 2070 726f 6365 6475 7265 2060  mple procedure `
-00012e00: 6070 7078 665f 6578 616d 706c 655f 6761  `ppxf_example_ga
-00012e10: 735f 7364 7373 5f74 6965 642e 7079 6060  s_sdss_tied.py``
-00012e20: 2074 6f20 696c 6c75 7374 7261 7465 2074   to illustrate t
-00012e30: 6865 0d0a 2020 7573 6520 6f66 2074 6865  he..  use of the
-00012e40: 2060 6074 6965 6460 6020 616e 6420 6060   ``tied`` and ``
-00012e50: 636f 6e73 7472 5f6b 696e 656d 6060 206b  constr_kinem`` k
-00012e60: 6579 776f 7264 732e 0d0a 0d0a 5638 2e32  eywords.....V8.2
-00012e70: 2e32 3a20 4d43 2c20 4f78 666f 7264 2c20  .2: MC, Oxford, 
-00012e80: 3131 204f 6374 6f62 6572 2032 3032 320d  11 October 2022.
-00012e90: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-00012ea0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012eb0: 2b2b 2b2b 0d0a 0d0a 2d20 6060 7070 7866  ++++....- ``ppxf
-00012ec0: 6060 3a20 4669 7865 6420 7072 6f67 7261  ``: Fixed progra
-00012ed0: 6d20 7374 6f70 2077 6974 6820 6060 7469  m stop with ``ti
-00012ee0: 6564 6060 206f 7220 6060 6669 7865 6460  ed`` or ``fixed`
-00012ef0: 6020 6b65 7977 6f72 6473 2061 6e64 0d0a  ` keywords and..
-00012f00: 2020 6e6f 6e6c 696e 6561 7220 7661 7269    nonlinear vari
-00012f10: 6162 6c65 7320 696e 2061 6464 6974 696f  ables in additio
-00012f20: 6e20 746f 2074 6865 206b 696e 656d 6174  n to the kinemat
-00012f30: 6963 732e 2054 6861 6e6b 7320 746f 2054  ics. Thanks to T
-00012f40: 6f62 6961 7320 4c6f 6f73 6572 0d0a 2020  obias Looser..  
-00012f50: 2863 616d 2e61 632e 756b 2920 666f 7220  (cam.ac.uk) for 
-00012f60: 7468 6520 7265 706f 7274 2061 6e64 2066  the report and f
-00012f70: 6978 2e0d 0a0d 0a56 382e 322e 313a 204d  ix.....V8.2.1: M
-00012f80: 432c 204f 7866 6f72 642c 2033 2053 6570  C, Oxford, 3 Sep
-00012f90: 7465 6d62 6572 2032 3032 320d 0a2b 2b2b  tember 2022..+++
-00012fa0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012fb0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00012fc0: 2b0d 0a0d 0a2d 2060 6070 7078 6660 603a  +....- ``ppxf``:
-00012fd0: 204e 6577 206b 6579 776f 7264 2060 6064   New keyword ``d
-00012fe0: 7573 7460 6020 7768 6963 6820 616c 6c6f  ust`` which allo
-00012ff0: 7773 206f 6e65 2074 6f20 6173 736f 6369  ws one to associ
-00013000: 6174 6520 6469 6666 6572 656e 740d 0a20  ate different.. 
-00013010: 2067 656e 6572 616c 2061 7474 656e 7561   general attenua
-00013020: 7469 6f6e 2066 756e 6374 696f 6e73 2074  tion functions t
-00013030: 6f20 6469 6666 6572 656e 7420 7365 7473  o different sets
-00013040: 206f 6620 7465 6d70 6c61 7465 732e 2054   of templates. T
-00013050: 6869 7320 6973 2075 7365 6675 6c0d 0a20  his is useful.. 
-00013060: 2066 6f72 2065 7861 6d70 6c65 2074 6f20   for example to 
-00013070: 6170 706c 7920 7468 7265 6520 6469 6666  apply three diff
-00013080: 6572 656e 7420 6174 7465 6e75 6174 696f  erent attenuatio
-00013090: 6e20 6675 6e63 7469 6f6e 7320 746f 2074  n functions to t
-000130a0: 6865 2079 6f75 6e67 2061 6e64 0d0a 2020  he young and..  
-000130b0: 6f6c 6420 7374 656c 6c61 7220 7465 6d70  old stellar temp
-000130c0: 6c61 7465 7320 616e 6420 746f 2074 6865  lates and to the
-000130d0: 2067 6173 2065 6d69 7373 696f 6e20 6c69   gas emission li
-000130e0: 6e65 7320 7265 7370 6563 7469 7665 6c79  nes respectively
-000130f0: 2e0d 0a2d 2060 6070 7078 6660 603a 2055  ...- ``ppxf``: U
-00013100: 7365 7320 6060 415f 5660 6020 696e 7374  ses ``A_V`` inst
-00013110: 6561 6420 6f66 2060 6045 2842 2d56 2960  ead of ``E(B-V)`
-00013120: 6020 746f 2070 6172 616d 6574 7269 7a65  ` to parametrize
-00013130: 2061 7474 656e 7561 7469 6f6e 2c20 7768   attenuation, wh
-00013140: 656e 0d0a 2020 7573 696e 6720 7468 6520  en..  using the 
-00013150: 6e6f 772d 6f62 736f 6c65 7465 206b 6579  now-obsolete key
-00013160: 776f 7264 7320 6060 7265 6464 656e 696e  words ``reddenin
-00013170: 6760 6020 616e 6420 2060 6067 6173 5f72  g`` and  ``gas_r
-00013180: 6564 6465 6e69 6e67 6060 2e0d 0a2d 2060  eddening``...- `
-00013190: 6070 7078 6660 603a 204e 6577 2064 6566  `ppxf``: New def
-000131a0: 6175 6c74 2066 756e 6374 696f 6e20 6060  ault function ``
-000131b0: 6174 7465 6e75 6174 696f 6e28 2960 602e  attenuation()``.
-000131c0: 2048 6f77 6576 6572 2c20 6f6e 6520 6361   However, one ca
-000131d0: 6e20 6e6f 7720 7573 650d 0a20 2067 656e  n now use..  gen
-000131e0: 6572 616c 2061 7474 656e 7561 7469 6f6e  eral attenuation
-000131f0: 2066 756e 6374 696f 6e73 2077 6974 6820   functions with 
-00013200: 616e 2061 7262 6974 7261 7279 206e 756d  an arbitrary num
-00013210: 6265 7220 6f66 2062 6f75 6e64 206f 7220  ber of bound or 
-00013220: 6669 7865 640d 0a20 2070 6172 616d 6574  fixed..  paramet
-00013230: 6572 732e 0d0a 2d20 6060 7070 7866 6060  ers...- ``ppxf``
-00013240: 3a20 4e65 7720 696e 7465 726e 616c 2066  : New internal f
-00013250: 756e 6374 696f 6e73 2060 6073 6574 5f6c  unctions ``set_l
-00013260: 616d 5f69 6e70 7574 6060 2c20 6060 7365  am_input``, ``se
-00013270: 745f 6761 735f 696e 7075 7460 602c 0d0a  t_gas_input``,..
-00013280: 2020 6060 7365 745f 6475 7374 5f69 6e70    ``set_dust_inp
-00013290: 7574 6060 2c20 6060 7365 745f 7068 6f74  ut``, ``set_phot
-000132a0: 5f69 6e70 7574 6060 2074 6f20 6f72 6761  _input`` to orga
-000132b0: 6e69 7a65 2074 6865 2063 6f64 652e 0d0a  nize the code...
-000132c0: 2d20 6060 7070 7866 6060 3a20 496d 7072  - ``ppxf``: Impr
-000132d0: 6f76 6564 2076 6572 7469 6361 6c20 7363  oved vertical sc
-000132e0: 616c 696e 6720 6f66 2064 6566 6175 6c74  aling of default
-000132f0: 2070 6c6f 7473 2e0d 0a2d 2060 6070 7078   plots...- ``ppx
-00013300: 6660 603a 204e 6577 206b 6579 776f 7264  f``: New keyword
-00013310: 7320 6060 7070 2e70 6c6f 7428 7370 6563  s ``pp.plot(spec
-00013320: 3d54 7275 652c 2070 686f 743d 5472 7565  =True, phot=True
-00013330: 2960 6020 746f 2070 6c6f 7420 6f6e 6c79  )`` to plot only
-00013340: 2074 6865 0d0a 2020 7068 6f74 6f6d 6574   the..  photomet
-00013350: 7269 6320 6f72 2073 7065 6374 726f 7363  ric or spectrosc
-00013360: 6f70 6963 2062 6573 7420 6669 7473 2072  opic best fits r
-00013370: 6573 7065 6374 6976 656c 792e 0d0a 2d20  espectively...- 
-00013380: 6060 7070 7866 5f75 7469 6c60 603a 204e  ``ppxf_util``: N
-00013390: 6577 2066 756e 6374 696f 6e20 6060 7661  ew function ``va
-000133a0: 7273 6d6f 6f74 6860 6020 666f 7220 4761  rsmooth`` for Ga
-000133b0: 7573 7369 616e 2063 6f6e 766f 6c75 7469  ussian convoluti
-000133c0: 6f6e 2077 6974 6820 610d 0a20 2076 6172  on with a..  var
-000133d0: 6961 626c 6520 7369 676d 612e 2055 6e6c  iable sigma. Unl
-000133e0: 696b 6520 7468 6520 7369 6d69 6c61 7220  ike the similar 
-000133f0: 6060 6761 7573 7369 616e 5f66 696c 7465  ``gaussian_filte
-00013400: 7231 6460 602c 2074 6869 7320 6e65 7720  r1d``, this new 
-00013410: 6675 6e63 7469 6f6e 0d0a 2020 7573 6573  function..  uses
-00013420: 2046 4654 2061 6e64 2074 6865 2061 6e61   FFT and the ana
-00013430: 6c79 7469 6320 466f 7572 6965 7220 5472  lytic Fourier Tr
-00013440: 616e 7366 6f72 6d20 6f66 2061 2047 6175  ansform of a Gau
-00013450: 7373 6961 6e2c 206c 696b 6520 6060 7070  ssian, like ``pp
-00013460: 7866 6060 2e0d 0a2d 2060 6070 7078 665f  xf``...- ``ppxf_
-00013470: 7574 696c 6060 3a20 496e 636c 7564 6564  util``: Included
-00013480: 2061 6464 6974 696f 6e61 6c20 6761 7320   additional gas 
-00013490: 656d 6973 7369 6f6e 206c 696e 6573 2069  emission lines i
-000134a0: 6e20 6060 656d 6973 7369 6f6e 5f6c 696e  n ``emission_lin
-000134b0: 6573 2829 6060 2e0d 0a2d 2060 6063 6170  es()``...- ``cap
-000134c0: 6669 7460 603a 2055 7365 2060 6073 6369  fit``: Use ``sci
-000134d0: 7079 2e6f 7074 696d 697a 652e 6c69 6e70  py.optimize.linp
-000134e0: 726f 6728 6d65 7468 6f64 3d27 6869 6768  rog(method='high
-000134f0: 7327 2960 6020 746f 2066 696e 6420 6665  s')`` to find fe
-00013500: 6173 6962 6c65 0d0a 2020 7374 6172 7469  asible..  starti
-00013510: 6e67 2070 6f69 6e74 2069 6e20 6060 6c73  ng point in ``ls
-00013520: 715f 6c69 6e60 602e 2054 6869 7320 656c  q_lin``. This el
-00013530: 696d 696e 6174 6573 2070 6f73 7369 626c  iminates possibl
-00013540: 6520 7072 6f67 7261 6d20 7374 6f70 7320  e program stops 
-00013550: 696e 0d0a 2020 6365 7274 6169 6e20 7369  in..  certain si
-00013560: 7475 6174 696f 6e73 2077 6974 6820 6c69  tuations with li
-00013570: 6e65 6172 6c79 2064 6570 656e 6465 6e74  nearly dependent
-00013580: 2063 6f6e 7374 7261 696e 7473 2e0d 0a2d   constraints...-
-00013590: 2060 6063 6170 6669 7460 603a 2053 6574   ``capfit``: Set
-000135a0: 2064 6566 6175 6c74 2060 606c 696e 6561   default ``linea
-000135b0: 725f 6d65 7468 6f64 3d27 6c73 715f 6c69  r_method='lsq_li
-000135c0: 6e27 6060 2e20 5468 6973 2072 656d 6f76  n'``. This remov
-000135d0: 6573 2074 6865 206e 6565 640d 0a20 2074  es the need..  t
-000135e0: 6f20 696e 7374 616c 6c20 6060 6376 786f  o install ``cvxo
-000135f0: 7074 6060 2077 6865 6e20 7573 696e 6720  pt`` when using 
-00013600: 6060 636f 6e73 7472 5f6b 696e 656d 6060  ``constr_kinem``
-00013610: 2069 6e20 6060 7050 5846 6060 2e0d 0a0d   in ``pPXF``....
-00013620: 0a56 382e 312e 303a 204d 432c 204f 7866  .V8.1.0: MC, Oxf
-00013630: 6f72 642c 2031 3020 4a75 6e65 2032 3032  ord, 10 June 202
-00013640: 320d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  2..+++++++++++++
-00013650: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00013660: 2b2b 2b0d 0a0d 0a2d 2060 6070 7078 6660  +++....- ``ppxf`
-00013670: 603a 204d 6f72 6520 6163 6375 7261 7465  `: More accurate
-00013680: 2064 6574 6572 6d69 6e61 7469 6f6e 206f   determination o
-00013690: 6620 7468 6520 7261 6e67 6520 666f 7220  f the range for 
-000136a0: 7472 756e 6361 7469 6e67 2074 6865 0d0a  truncating the..
-000136b0: 2020 7465 6d70 6c61 7465 7320 7768 656e    templates when
-000136c0: 2070 6173 7369 6e67 2062 6f74 6820 6060   passing both ``
-000136d0: 6c61 6d5f 7465 6d70 6060 2061 6e64 2060  lam_temp`` and `
-000136e0: 606c 616d 6060 2e0d 0a2d 2060 6070 7078  `lam``...- ``ppx
-000136f0: 6660 603a 2043 6865 636b 2066 6f72 2060  f``: Check for `
-00013700: 606c 616d 6060 206f 7220 6060 6c61 6d5f  `lam`` or ``lam_
-00013710: 7465 6d70 6060 2063 6f6e 7369 7374 656e  temp`` consisten
-00013720: 6379 2077 6974 6820 6060 7665 6c73 6361  cy with ``velsca
-00013730: 6c65 6060 2061 6e64 0d0a 2020 7265 7475  le`` and..  retu
-00013740: 726e 2061 6e20 6572 726f 7220 6966 2074  rn an error if t
-00013750: 6865 7920 646f 206e 6f74 206d 6174 6368  hey do not match
-00013760: 2e0d 0a2d 2060 6070 7078 6660 603a 2055  ...- ``ppxf``: U
-00013770: 7365 206d 6963 726f 6d65 7472 6520 756e  se micrometre un
-00013780: 6974 7320 616e 6420 6465 6e73 6572 2074  its and denser t
-00013790: 6963 6b20 6c61 6265 6c73 2066 6f72 2074  ick labels for t
-000137a0: 6865 206c 6f67 6172 6974 686d 6963 0d0a  he logarithmic..
-000137b0: 2020 7761 7665 6c65 6e67 7468 2061 7869    wavelength axi
-000137c0: 732e 0d0a 2d20 6060 7070 7866 5f75 7469  s...- ``ppxf_uti
-000137d0: 6c2e 7379 6e74 6865 7469 635f 7068 6f74  l.synthetic_phot
-000137e0: 6f6d 6574 7279 6060 3a20 6d6f 7665 6420  ometry``: moved 
-000137f0: 6672 6f6d 2060 606d 696c 6573 5f75 7469  from ``miles_uti
-00013800: 6c60 6020 616e 6420 6d61 6465 2069 740d  l`` and made it.
-00013810: 0a20 2069 6e64 6570 656e 6465 6e74 206f  .  independent o
-00013820: 6620 7468 6520 7374 656c 6c61 7220 6c69  f the stellar li
-00013830: 6272 6172 792e 2041 646f 7074 6564 2074  brary. Adopted t
-00013840: 6865 2073 616d 6520 6669 6c74 6572 2066  he same filter f
-00013850: 696c 6520 666f 726d 6174 2061 730d 0a20  ile format as.. 
-00013860: 2045 415a 592c 2046 4153 542c 2048 7970   EAZY, FAST, Hyp
-00013870: 6572 5a2e 2e2e 2066 6f72 2069 6e74 6572  erZ... for inter
-00013880: 6f70 6572 6162 696c 6974 792e 0d0a 2020  operability...  
-00013890: 416c 6c6f 7720 7061 7373 696e 6720 6120  Allow passing a 
-000138a0: 6669 6c65 2077 6974 6820 7573 6572 2d64  file with user-d
-000138b0: 6566 696e 6564 2066 696c 7465 7220 7265  efined filter re
-000138c0: 7370 6f6e 7365 2066 756e 6374 696f 6e73  sponse functions
-000138d0: 2e0d 0a2d 2060 6070 7078 665f 7574 696c  ...- ``ppxf_util
-000138e0: 2e6c 6f67 5f72 6562 696e 6060 3a20 5375  .log_rebin``: Su
-000138f0: 7070 6f72 7420 6972 7265 6775 6c61 726c  pport irregularl
-00013900: 7920 7361 6d70 6c65 6420 696e 7075 7420  y sampled input 
-00013910: 7761 7665 6c65 6e67 7468 2e0d 0a2d 2060  wavelength...- `
-00013920: 6070 7078 665f 7574 696c 2e67 6175 7373  `ppxf_util.gauss
-00013930: 6961 6e5f 6669 6c74 6572 3164 6060 3a20  ian_filter1d``: 
-00013940: 4e65 7720 6b65 7977 6f72 6420 6060 6d6f  New keyword ``mo
-00013950: 6465 3d27 636f 6e73 7461 6e74 2760 6020  de='constant'`` 
-00013960: 6f72 0d0a 2020 6060 6d6f 6465 3d27 7772  or..  ``mode='wr
-00013970: 6170 2760 602e 0d0a 2d20 5570 6461 7465  ap'``...- Update
-00013980: 6420 6060 7070 7866 5f65 7861 6d70 6c65  d ``ppxf_example
-00013990: 5f70 6f70 756c 6174 696f 6e5f 7068 6f74  _population_phot
-000139a0: 6f6d 6574 7279 2e70 7960 600d 0a0d 0a56  ometry.py``....V
-000139b0: 382e 302e 323a 204d 432c 204f 7866 6f72  8.0.2: MC, Oxfor
-000139c0: 642c 2032 3820 4d61 7263 6820 3230 3232  d, 28 March 2022
-000139d0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-000139e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000139f0: 2b2b 2b0d 0a0d 0a2d 2060 6070 7078 6660  +++....- ``ppxf`
-00013a00: 603a 2041 6c6c 6f77 2066 6974 7469 6e67  `: Allow fitting
-00013a10: 2070 686f 746f 6d65 7472 6963 206d 6561   photometric mea
-00013a20: 7375 7265 6d65 6e74 7320 2853 4544 2066  surements (SED f
-00013a30: 6974 7469 6e67 2920 746f 6765 7468 6572  itting) together
-00013a40: 2077 6974 680d 0a20 2061 2073 7065 6374   with..  a spect
-00013a50: 7275 6d2e 2054 6869 7320 6973 2069 6d70  rum. This is imp
-00013a60: 6c65 6d65 6e74 6564 2076 6961 2074 6865  lemented via the
-00013a70: 206e 6577 206b 6579 776f 7264 2060 6070   new keyword ``p
-00013a80: 686f 7460 6020 7061 7373 696e 6720 610d  hot`` passing a.
-00013a90: 0a20 2064 6963 7469 6f6e 6172 7920 6f66  .  dictionary of
-00013aa0: 2070 6172 616d 6574 6572 732e 0d0a 2d20   parameters...- 
-00013ab0: 6060 7070 7866 6060 3a20 706c 6f74 2070  ``ppxf``: plot p
-00013ac0: 686f 746f 6d65 7472 6963 2066 6974 2074  hotometric fit t
-00013ad0: 6f67 6574 6865 7220 7769 7468 2073 7065  ogether with spe
-00013ae0: 6374 7275 6d20 7768 656e 2066 6974 7469  ctrum when fitti
-00013af0: 6e67 0d0a 2020 7068 6f74 6f6d 6574 7279  ng..  photometry
-00013b00: 2e0d 0a2d 2060 6070 7078 6660 603a 204e  ...- ``ppxf``: N
-00013b10: 6577 206b 6579 776f 7264 2060 606c 616d  ew keyword ``lam
-00013b20: 5f74 656d 7060 6020 746f 2069 6e70 7574  _temp`` to input
-00013b30: 2074 6865 2074 656d 706c 6174 6573 2077   the templates w
-00013b40: 6176 656c 656e 6774 682e 2057 6865 6e0d  avelength. When.
-00013b50: 0a20 2074 6869 7320 6973 2067 6976 656e  .  this is given
-00013b60: 2c20 746f 6765 7468 6572 2077 6974 6820  , together with 
-00013b70: 7468 6520 6761 6c61 7879 2077 6176 656c  the galaxy wavel
-00013b80: 656e 6774 6820 6060 6c61 6d60 602c 2074  ength ``lam``, t
-00013b90: 6865 2074 656d 706c 6174 6573 2061 7265  he templates are
-00013ba0: 0d0a 2020 6175 746f 6d61 7469 6361 6c6c  ..  automaticall
-00013bb0: 7920 7472 756e 6361 7465 6420 746f 2061  y truncated to a
-00013bc0: 6e20 6f70 7469 6d61 6c20 7761 7665 6c65  n optimal wavele
-00013bd0: 6e67 7468 2072 616e 6765 2c20 616e 6420  ngth range, and 
-00013be0: 6974 2062 6563 6f6d 6573 0d0a 2020 756e  it becomes..  un
-00013bf0: 6e65 6365 7373 6172 7920 746f 2075 7365  necessary to use
-00013c00: 2074 6865 206b 6579 776f 7264 2060 6076   the keyword ``v
-00013c10: 7379 7374 6060 2e0d 0a2d 2060 6070 7078  syst``...- ``ppx
-00013c20: 6660 603a 2057 6172 6e69 6e67 2069 6620  f``: Warning if 
-00013c30: 6060 7465 6d70 6c61 7465 7360 6020 6172  ``templates`` ar
-00013c40: 6520 6060 3e20 3278 6060 206c 6f6e 6765  e ``> 2x`` longe
-00013c50: 7220 7468 616e 2060 6067 616c 6178 7960  r than ``galaxy`
-00013c60: 602e 0d0a 2d20 6060 7070 7866 6060 3a20  `...- ``ppxf``: 
-00013c70: 5768 656e 2066 6974 7469 6e67 2070 686f  When fitting pho
-00013c80: 746f 6d65 7472 7920 6f6e 6520 6361 6e20  tometry one can 
-00013c90: 696e 7075 7420 6578 7465 6e64 6564 2074  input extended t
-00013ca0: 656d 706c 6174 6520 7370 6563 7472 6120  emplate spectra 
-00013cb0: 746f 0d0a 2020 6f76 6572 706c 6f74 2074  to..  overplot t
-00013cc0: 6865 2065 7874 7261 706f 6c61 7465 6420  he extrapolated 
-00013cd0: 6265 7374 2d66 6974 2073 7065 6374 7275  best-fit spectru
-00013ce0: 6d20 746f 6765 7468 6572 2077 6974 6820  m together with 
-00013cf0: 7468 6520 7068 6f74 6f6d 6574 7279 2e0d  the photometry..
-00013d00: 0a2d 204e 6577 2064 656d 6f20 6669 6c65  .- New demo file
-00013d10: 206f 6e20 7068 6f74 6f6d 6574 7269 6320   on photometric 
-00013d20: 6669 7474 696e 670d 0a20 2060 6070 7078  fitting..  ``ppx
-00013d30: 665f 6578 616d 706c 655f 706f 7075 6c61  f_example_popula
-00013d40: 7469 6f6e 5f70 686f 746f 6d65 7472 792e  tion_photometry.
-00013d50: 7079 6060 2e0d 0a2d 2060 606d 696c 6573  py``...- ``miles
-00013d60: 5f75 7469 6c2e 7068 6f74 6f6d 6574 7279  _util.photometry
-00013d70: 5f66 726f 6d5f 7461 626c 6560 603a 204e  _from_table``: N
-00013d80: 6577 2065 7861 6d70 6c65 2066 756e 6374  ew example funct
-00013d90: 696f 6e20 746f 2069 6c6c 7573 7472 6174  ion to illustrat
-00013da0: 6520 7468 650d 0a20 2067 656e 6572 6174  e the..  generat
-00013db0: 696f 6e20 6f66 2074 6865 2069 6e70 7574  ion of the input
-00013dc0: 2070 686f 746f 6d65 7472 6963 2074 656d   photometric tem
-00013dd0: 706c 6174 6573 2066 6f72 2074 6865 2060  plates for the `
-00013de0: 6070 686f 7460 6020 6b65 7977 6f72 642c  `phot`` keyword,
-00013df0: 2075 7369 6e67 0d0a 2020 7461 6275 6c61   using..  tabula
-00013e00: 7465 6420 5353 5020 6d6f 6465 6c20 6d61  ted SSP model ma
-00013e10: 676e 6974 7564 6573 2e0d 0a2d 2060 606d  gnitudes...- ``m
-00013e20: 696c 6573 5f75 7469 6c2e 7068 6f74 6f6d  iles_util.photom
-00013e30: 6574 7279 5f66 726f 6d5f 7370 6563 7472  etry_from_spectr
-00013e40: 6160 603a 204e 6577 2065 7861 6d70 6c65  a``: New example
-00013e50: 2066 756e 6374 696f 6e20 746f 2069 6c6c   function to ill
-00013e60: 7573 7472 6174 650d 0a20 2074 6865 2067  ustrate..  the g
-00013e70: 656e 6572 6174 696f 6e20 6f66 2070 686f  eneration of pho
-00013e80: 746f 6d65 7472 6963 2074 656d 706c 6174  tometric templat
-00013e90: 6573 2066 726f 6d20 7468 6520 7370 6563  es from the spec
-00013ea0: 7472 6120 7573 696e 6720 6669 6c74 6572  tra using filter
-00013eb0: 0d0a 2020 7265 7370 6f6e 7365 732e 0d0a  ..  responses...
-00013ec0: 2d20 5265 706c 6163 6564 204d 494c 4553  - Replaced MILES
-00013ed0: 2073 7065 6374 7261 6c20 6d6f 6465 6c73   spectral models
-00013ee0: 206f 6620 5661 7a64 656b 6973 2065 7420   of Vazdekis et 
-00013ef0: 616c 2e20 2832 3031 3029 2077 6974 6820  al. (2010) with 
-00013f00: 452d 4d49 4c45 5320 6d6f 6465 6c73 0d0a  E-MILES models..
-00013f10: 2020 6f66 2056 617a 6465 6b69 7320 6574    of Vazdekis et
-00013f20: 2061 6c2e 2028 3230 3136 292e 2054 6861   al. (2016). Tha
-00013f30: 6e6b 7320 746f 2041 6c65 7861 6e64 7265  nks to Alexandre
-00013f40: 2056 617a 6465 6b69 7320 2869 6163 2e65   Vazdekis (iac.e
-00013f50: 7329 2066 6f72 2074 6865 0d0a 2020 7065  s) for the..  pe
-00013f60: 726d 6973 7369 6f6e 2e0d 0a2d 2041 6461  rmission...- Ada
-00013f70: 7074 6564 2061 6c6c 2060 6070 5058 4660  pted all ``pPXF`
-00013f80: 6020 6578 616d 706c 6573 2074 6f20 7573  ` examples to us
-00013f90: 6520 7468 6520 452d 4d49 4c45 5320 7465  e the E-MILES te
-00013fa0: 6d70 6c61 7465 732e 0d0a 2d20 6060 6d69  mplates...- ``mi
-00013fb0: 6c65 735f 7574 696c 2e6d 696c 6573 6060  les_util.miles``
-00013fc0: 3a20 6368 616e 6765 6420 6e61 6d65 7320  : changed names 
-00013fd0: 6f66 206f 7574 7075 7420 7761 7665 6c65  of output wavele
-00013fe0: 6e67 7468 2060 602e 6c6e 5f6c 616d 5f74  ngth ``.ln_lam_t
-00013ff0: 656d 7060 6020 746f 0d0a 2020 6d61 6b65  emp`` to..  make
-00014000: 2063 6c65 6172 2074 6865 7920 7265 7072   clear they repr
-00014010: 6573 656e 7420 6e61 7475 7261 6c20 6c6f  esent natural lo
-00014020: 6761 7269 7468 6d73 2e0d 0a2d 2060 606d  garithms...- ``m
-00014030: 696c 6573 5f75 7469 6c2e 6d69 6c65 7360  iles_util.miles`
-00014040: 603a 2073 6574 2060 6046 5748 4d5f 6761  `: set ``FWHM_ga
-00014050: 6c3d 4e6f 6e65 6060 2074 6f20 736b 6970  l=None`` to skip
-00014060: 2074 656d 706c 6174 6573 2063 6f6e 766f   templates convo
-00014070: 6c75 7469 6f6e 2e0d 0a2d 2060 6070 7078  lution...- ``ppx
-00014080: 6660 603a 204f 7074 696f 6e61 6c6c 7920  f``: Optionally 
-00014090: 7065 7266 6f72 6d73 2067 6c6f 6261 6c20  performs global 
-000140a0: 6f70 7469 6d69 7a61 7469 6f6e 206f 6620  optimization of 
-000140b0: 7468 6520 6e6f 6e2d 6c69 6e65 6172 0d0a  the non-linear..
-000140c0: 2020 7061 7261 6d65 7465 7273 2e20 5468    parameters. Th
-000140d0: 6973 2069 7320 696d 706c 656d 656e 7465  is is implemente
-000140e0: 6420 7669 6120 7468 6520 6e65 7720 6b65  d via the new ke
-000140f0: 7977 6f72 6420 6060 676c 6f62 616c 5f73  yword ``global_s
-00014100: 6561 7263 6860 602e 0d0a 2d20 6060 7070  earch``...- ``pp
-00014110: 7866 6060 3a20 416c 6c6f 7720 7468 6520  xf``: Allow the 
-00014120: 7573 6520 6f66 206d 756c 7469 706c 6963  use of multiplic
-00014130: 6174 6976 6520 706f 6c79 6e6f 6d69 616c  ative polynomial
-00014140: 7320 746f 6765 7468 6572 2077 6974 680d  s together with.
-00014150: 0a20 2072 6564 6465 6e69 6e67 2e0d 0a2d  .  reddening...-
-00014160: 2060 6070 7078 6660 603a 2050 6c6f 7420   ``ppxf``: Plot 
-00014170: 696e 6469 7669 6475 616c 2067 6173 2065  individual gas e
-00014180: 6d69 7373 696f 6e20 636f 6d70 6f6e 656e  mission componen
-00014190: 7473 2069 6e20 6164 6469 7469 6f6e 2074  ts in addition t
-000141a0: 6f20 7468 6569 7220 7375 6d2e 0d0a 2d20  o their sum...- 
-000141b0: 6060 7070 7866 6060 3a20 5570 6461 7465  ``ppxf``: Update
-000141c0: 6420 646f 6373 7472 696e 6720 646f 6375  d docstring docu
-000141d0: 6d65 6e74 6174 696f 6e20 666f 7220 7468  mentation for th
-000141e0: 6520 6e65 7720 6665 6174 7572 6573 2e0d  e new features..
-000141f0: 0a2d 2060 6063 6170 6669 7460 603a 2043  .- ``capfit``: C
-00014200: 6f6d 706c 6574 656c 7920 7265 6d6f 7665  ompletely remove
-00014210: 6420 7469 6564 2f66 6978 6564 2076 6172  d tied/fixed var
-00014220: 6961 626c 6573 2066 726f 6d20 7468 6520  iables from the 
-00014230: 6f70 7469 6d69 7a61 7469 6f6e 2061 6e64  optimization and
-00014240: 0d0a 2020 636f 6e73 7472 6169 6e74 732e  ..  constraints.
-00014250: 2054 6869 7320 696d 7072 6f76 6573 2074   This improves t
-00014260: 6865 2063 6f6e 6469 7469 6f6e 696e 6720  he conditioning 
-00014270: 6f66 2074 6865 204a 6163 6f62 6961 6e20  of the Jacobian 
-00014280: 616e 6420 6675 7274 6865 720d 0a20 2073  and further..  s
-00014290: 7472 656e 6774 6865 6e73 2074 6865 2072  trengthens the r
-000142a0: 6f62 7573 746e 6573 7320 6f66 2074 6865  obustness of the
-000142b0: 206f 7074 696d 697a 6174 696f 6e2e 0d0a   optimization...
-000142c0: 2d20 6060 6d69 6c65 735f 7574 696c 6060  - ``miles_util``
-000142d0: 3a20 6669 7865 6420 6060 666c 7578 6060  : fixed ``flux``
-000142e0: 2061 7272 6179 206d 6973 6d61 7463 6820   array mismatch 
-000142f0: 7768 656e 2075 7369 6e67 2060 6061 6765  when using ``age
-00014300: 5f72 616e 6765 6060 206f 720d 0a20 2060  _range`` or..  `
-00014310: 606d 6574 616c 5f72 616e 6765 6060 2e20  `metal_range``. 
-00014320: 5468 616e 6b73 2074 6f20 4461 7669 6465  Thanks to Davide
-00014330: 2042 6576 6163 7175 6120 2869 6e61 662e   Bevacqua (inaf.
-00014340: 6974 2920 666f 7220 7468 6520 7265 706f  it) for the repo
-00014350: 7274 2e0d 0a2d 2060 6070 7078 6660 603a  rt...- ``ppxf``:
-00014360: 2046 6978 6564 2070 726f 6772 616d 2073   Fixed program s
-00014370: 746f 7020 7768 656e 2066 6974 7469 6e67  top when fitting
-00014380: 2067 6173 2077 6974 6820 6120 7465 6d70   gas with a temp
-00014390: 6c61 7465 206c 656e 6774 6820 7468 6174  late length that
-000143a0: 2069 730d 0a20 206e 6f74 2061 206d 756c   is..  not a mul
-000143b0: 7469 706c 6520 6f66 2060 6076 656c 7363  tiple of ``velsc
-000143c0: 616c 655f 7261 7469 6f60 602e 0d0a 0d0a  ale_ratio``.....
-000143d0: 5637 2e34 2e35 3a20 4d43 2c20 4f78 666f  V7.4.5: MC, Oxfo
-000143e0: 7264 2c20 3136 204a 756c 7920 3230 3231  rd, 16 July 2021
-000143f0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-00014400: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00014410: 2b2b 0d0a 0d0a 2d20 6060 7070 7866 6060  ++....- ``ppxf``
-00014420: 3a20 4e65 7720 6b65 7977 6f72 6420 6060  : New keyword ``
-00014430: 7070 2e70 6c6f 7428 636c 6970 5f67 6173  pp.plot(clip_gas
-00014440: 3d54 7275 6529 6060 2074 6f20 6967 6e6f  =True)`` to igno
-00014450: 7265 2074 6865 2067 6173 2065 6d69 7373  re the gas emiss
-00014460: 696f 6e0d 0a20 206c 696e 6573 2077 6869  ion..  lines whi
-00014470: 6c65 2064 6574 6572 6d69 6e69 6e67 2074  le determining t
-00014480: 6865 2070 6c6f 7474 696e 6720 7261 6e67  he plotting rang
-00014490: 6573 2066 6f72 2074 6865 2062 6573 742d  es for the best-
-000144a0: 6669 7474 696e 6720 6d6f 6465 6c2e 0d0a  fitting model...
-000144b0: 2d20 6060 6d69 6c65 735f 7574 696c 6060  - ``miles_util``
-000144c0: 3a20 4e65 7720 6174 7472 6962 7574 6520  : New attribute 
-000144d0: 6060 2e66 6c75 7860 6020 746f 2063 6f6e  ``.flux`` to con
-000144e0: 7665 7274 2062 6574 7765 656e 206c 6967  vert between lig
-000144f0: 6874 2d77 6569 6768 7465 640d 0a20 2061  ht-weighted..  a
-00014500: 6e64 206d 6173 732d 7765 6967 6874 6564  nd mass-weighted
-00014510: 2073 7465 6c6c 6172 2070 6f70 756c 6174   stellar populat
-00014520: 696f 6e20 7175 616e 7469 7469 6573 2e20  ion quantities. 
-00014530: 5570 6461 7465 6420 7468 6520 636f 7272  Updated the corr
-00014540: 6573 706f 6e64 696e 670d 0a20 2064 6f63  esponding..  doc
-00014550: 756d 656e 7461 7469 6f6e 2069 6e20 7468  umentation in th
-00014560: 6520 646f 6373 7472 696e 672e 0d0a 2d20  e docstring...- 
-00014570: 6060 7070 7866 5f65 7861 6d70 6c65 5f70  ``ppxf_example_p
-00014580: 6f70 756c 6174 696f 6e5f 6761 735f 7364  opulation_gas_sd
-00014590: 7373 6060 3a20 5368 6f77 2068 6f77 2074  ss``: Show how t
-000145a0: 6f20 636f 6e76 6572 7420 6265 7477 6565  o convert betwee
-000145b0: 6e20 6c69 6768 742d 7765 6967 6874 6564  n light-weighted
-000145c0: 0d0a 2020 616e 6420 6d61 7373 2d77 6569  ..  and mass-wei
-000145d0: 6768 7465 6420 7374 656c 6c61 7220 706f  ghted stellar po
-000145e0: 7075 6c61 7469 6f6e 2075 7369 6e67 2074  pulation using t
-000145f0: 6865 206e 6577 2060 606d 696c 6573 2e66  he new ``miles.f
-00014600: 6c75 7860 6020 6174 7472 6962 7574 652e  lux`` attribute.
-00014610: 0d0a 2d20 6060 7070 7866 5f75 7469 6c2e  ..- ``ppxf_util.
-00014620: 6c6f 675f 7265 6269 6e60 603a 2073 7570  log_rebin``: sup
-00014630: 706f 7274 2066 6173 7420 6c6f 6720 7265  port fast log re
-00014640: 6269 6e6e 696e 6720 6f66 2061 6c6c 2063  binning of all c
-00014650: 6f6c 756d 6e73 206f 6620 322d 6469 6d20  olumns of 2-dim 
-00014660: 6172 7261 7973 2e0d 0a0d 0a56 372e 342e  arrays.....V7.4.
-00014670: 343a 204d 432c 204f 7866 6f72 642c 2031  4: MC, Oxford, 1
-00014680: 3020 4665 6272 7561 7279 2032 3032 310d  0 February 2021.
-00014690: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-000146a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000146b0: 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6070 7078  +++++....- ``ppx
-000146c0: 6660 603a 204d 6f72 6520 726f 6275 7374  f``: More robust
-000146d0: 206d 6174 7269 7820 7363 616c 696e 6720   matrix scaling 
-000146e0: 7768 656e 2075 7369 6e67 206c 696e 6561  when using linea
-000146f0: 7220 6571 7561 6c69 7479 2063 6f6e 7374  r equality const
-00014700: 7261 696e 7473 0d0a 2020 696e 2060 6063  raints..  in ``c
-00014710: 6f6e 7374 725f 7465 6d70 6c60 6020 7769  onstr_templ`` wi
-00014720: 7468 2060 606c 696e 6561 725f 6d65 7468  th ``linear_meth
-00014730: 6f64 3d27 6c73 715f 626f 7827 6060 2e20  od='lsq_box'``. 
-00014740: 5468 616e 6b73 2074 6f20 5368 7261 7661  Thanks to Shrava
-00014750: 6e20 5368 6574 7479 0d0a 2020 2870 6b75  n Shetty..  (pku
-00014760: 2e65 6475 2e63 6e29 2066 6f72 2061 2064  .edu.cn) for a d
-00014770: 6574 6169 6c65 6420 7265 706f 7274 2061  etailed report a
-00014780: 6e64 2066 6f72 2074 6573 7469 6e67 206d  nd for testing m
-00014790: 7920 6669 782e 0d0a 0d0a 5637 2e34 2e33  y fix.....V7.4.3
-000147a0: 3a20 4d43 2c20 4f78 666f 7264 2c20 3231  : MC, Oxford, 21
-000147b0: 2044 6563 656d 6265 7220 3230 3230 0d0a   December 2020..
-000147c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000147d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000147e0: 2b2b 2b2b 0d0a 0d0a 2d20 6060 6361 7066  ++++....- ``capf
-000147f0: 6974 6060 3a20 4e65 7720 6060 6c69 6e65  it``: New ``line
-00014800: 6172 5f6d 6574 686f 6460 6020 6b65 7977  ar_method`` keyw
-00014810: 6f72 6420 746f 2073 656c 6563 7420 6265  ord to select be
-00014820: 7477 6565 6e20 6060 6376 786f 7074 6060  tween ``cvxopt``
-00014830: 206f 720d 0a20 2060 606c 7371 5f6c 696e   or..  ``lsq_lin
-00014840: 6060 2c20 7768 656e 2075 7369 6e67 206c  ``, when using l
-00014850: 696e 6561 7220 636f 6e73 7472 6169 6e74  inear constraint
-00014860: 732c 2066 6f72 2063 6173 6573 2077 6865  s, for cases whe
-00014870: 7265 2074 6865 206c 6174 7465 7220 7374  re the latter st
-00014880: 6f70 732e 0d0a 2020 5468 6520 6060 6376  ops...  The ``cv
-00014890: 786f 7074 6060 2070 6163 6b61 6765 206d  xopt`` package m
-000148a0: 7573 7420 6265 2069 6e73 7461 6c6c 6564  ust be installed
-000148b0: 2077 6865 6e20 7365 7474 696e 6720 7468   when setting th
-000148c0: 6174 206f 7074 696f 6e2e 0d0a 2d20 6060  at option...- ``
-000148d0: 7070 7866 6060 3a20 4164 6170 7465 6420  ppxf``: Adapted 
-000148e0: 746f 2075 7365 2060 6063 6170 6669 7460  to use ``capfit`
-000148f0: 6020 7769 7468 2060 606c 696e 6561 725f  ` with ``linear_
-00014900: 6d65 7468 6f64 3d27 6376 786f 7074 2760  method='cvxopt'`
-00014910: 6020 7768 656e 0d0a 2020 656e 666f 7263  ` when..  enforc
-00014920: 696e 6720 6c69 6e65 6172 2063 6f6e 7374  ing linear const
-00014930: 7261 696e 7473 206f 6e20 7468 6520 6b69  raints on the ki
-00014940: 6e65 6d61 7469 6373 2077 6974 6820 6060  nematics with ``
-00014950: 636f 6e73 7472 5f6b 696e 656d 6060 2e0d  constr_kinem``..
-00014960: 0a2d 2060 6070 7078 6660 603a 2049 6e63  .- ``ppxf``: Inc
-00014970: 6c75 6465 6420 4e4f 5445 2069 6e20 7468  luded NOTE in th
-00014980: 6520 646f 6375 6d65 6e74 6174 696f 6e20  e documentation 
-00014990: 6f66 2060 6063 6f6e 7374 725f 6b69 6e65  of ``constr_kine
-000149a0: 6d60 602e 0d0a 2020 416c 6c20 6368 616e  m``...  All chan
-000149b0: 6765 7320 6162 6f76 6520 7765 7265 2061  ges above were a
-000149c0: 6674 6572 2064 6574 6169 6c65 6420 7265  fter detailed re
-000149d0: 706f 7274 7320 6279 204b 796c 6520 5765  ports by Kyle We
-000149e0: 7374 6661 6c6c 2028 7563 6f6c 6963 6b2e  stfall (ucolick.
-000149f0: 6f72 6729 2e0d 0a0d 0a56 372e 342e 323a  org).....V7.4.2:
-00014a00: 204d 432c 204f 7866 6f72 642c 2039 204f   MC, Oxford, 9 O
-00014a10: 6374 6f62 6572 2032 3032 300d 0a2b 2b2b  ctober 2020..+++
-00014a20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00014a30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-00014a40: 0a0d 0a2d 2060 6070 7078 6660 603a 2043  ...- ``ppxf``: C
-00014a50: 6f72 7265 6374 6564 2074 7970 6f20 696e  orrected typo in
-00014a60: 2065 7861 6d70 6c65 2069 6e20 7468 6520   example in the 
-00014a70: 646f 6375 6d65 6e74 6174 696f 6e20 6f66  documentation of
-00014a80: 2060 6063 6f6e 7374 725f 7465 6d70 6c60   ``constr_templ`
-00014a90: 602e 0d0a 2d20 6060 7070 7866 6060 3a20  `...- ``ppxf``: 
-00014aa0: 4368 6563 6b20 7468 6174 2060 6063 6f6e  Check that ``con
-00014ab0: 7374 725f 7465 6d70 6c60 6020 616e 6420  str_templ`` and 
-00014ac0: 6060 636f 6e73 7472 5f6b 696e 656d 6060  ``constr_kinem``
-00014ad0: 2061 7265 2064 6963 7469 6f6e 6172 6965   are dictionarie
-00014ae0: 732e 0d0a 2020 5468 616e 6b73 2074 6f20  s...  Thanks to 
-00014af0: 4461 7669 6465 2042 6576 6163 7175 6120  Davide Bevacqua 
-00014b00: 2875 6e69 626f 2e69 7429 2066 6f72 2074  (unibo.it) for t
-00014b10: 6865 2066 6565 6462 6163 6b2e 0d0a 0d0a  he feedback.....
-00014b20: 5637 2e34 2e31 3a20 4d43 2c20 4f78 666f  V7.4.1: MC, Oxfo
-00014b30: 7264 2c20 3131 2053 6570 7465 6d62 6572  rd, 11 September
-00014b40: 2032 3032 300d 0a2b 2b2b 2b2b 2b2b 2b2b   2020..+++++++++
-00014b50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00014b60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-00014b70: 2d20 6060 6361 7066 6974 6060 3a20 4669  - ``capfit``: Fi
-00014b80: 7865 6420 706f 7373 6962 6c65 2069 6e66  xed possible inf
-00014b90: 696e 6974 6520 6c6f 6f70 2069 6e20 6060  inite loop in ``
-00014ba0: 6c73 715f 626f 7860 6020 616e 6420 6060  lsq_box`` and ``
-00014bb0: 6c73 715f 6c69 6e60 602e 0d0a 2020 5468  lsq_lin``...  Th
-00014bc0: 616e 6b73 2074 6f20 5368 7261 7661 6e20  anks to Shravan 
-00014bd0: 5368 6574 7479 2028 706b 752e 6564 752e  Shetty (pku.edu.
-00014be0: 636e 2920 666f 7220 7468 6520 6465 7461  cn) for the deta
-00014bf0: 696c 6564 2072 6570 6f72 7420 616e 6420  iled report and 
-00014c00: 746f 2062 6f74 680d 0a20 2068 696d 2061  to both..  him a
-00014c10: 6e64 204b 796c 6520 5765 7374 6661 6c6c  nd Kyle Westfall
-00014c20: 2028 7563 6f6c 6963 6b2e 6f72 6729 2066   (ucolick.org) f
-00014c30: 6f72 2074 6573 7469 6e67 2074 6865 2066  or testing the f
-00014c40: 6978 2e0d 0a2d 2060 6063 6170 6669 7460  ix...- ``capfit`
-00014c50: 603a 2055 7365 204e 756d 5079 2072 6174  `: Use NumPy rat
-00014c60: 6865 7220 7468 616e 2074 6865 2053 6369  her than the Sci
-00014c70: 5079 2076 6572 7369 6f6e 206f 6620 6060  Py version of ``
-00014c80: 6c69 6e61 6c67 2e6c 7374 7371 6060 2074  linalg.lstsq`` t
-00014c90: 6f0d 0a20 2061 766f 6964 2061 2063 7572  o..  avoid a cur
-00014ca0: 7265 6e74 2053 6369 5079 2062 7567 2069  rent SciPy bug i
-00014cb0: 6e20 7468 6520 6465 6661 756c 7420 6372  n the default cr
-00014cc0: 6974 6572 696f 6e20 666f 7220 7261 6e6b  iterion for rank
-00014cd0: 2064 6566 6963 6965 6e63 792e 0d0a 2d20   deficiency...- 
-00014ce0: 6060 6361 7066 6974 6060 3a20 5265 6e61  ``capfit``: Rena
-00014cf0: 6d65 6420 6060 636f 6e64 6060 206b 6579  med ``cond`` key
-00014d00: 776f 7264 2074 6f20 6060 7263 6f6e 6460  word to ``rcond`
-00014d10: 6020 666f 7220 636f 6e73 6973 7465 6e63  ` for consistenc
-00014d20: 7920 7769 7468 204e 756d 5079 2e0d 0a2d  y with NumPy...-
-00014d30: 2060 6063 6170 6669 7460 603a 2050 6173   ``capfit``: Pas
-00014d40: 7365 6420 6060 7263 6f6e 6460 6020 6b65  sed ``rcond`` ke
-00014d50: 7977 6f72 6420 746f 2060 6063 6f76 5f65  yword to ``cov_e
-00014d60: 7272 6060 2066 756e 6374 696f 6e2e 0d0a  rr`` function...
-00014d70: 2d20 6060 7070 7866 6060 3a20 7265 6d6f  - ``ppxf``: remo
-00014d80: 7665 6420 6060 7263 6f6e 6460 6020 6b65  ved ``rcond`` ke
-00014d90: 7977 6f72 6420 696e 2060 6063 6170 6669  yword in ``capfi
-00014da0: 7460 6020 6361 6c6c 2e20 5573 6520 6465  t`` call. Use de
-00014db0: 6661 756c 7420 696e 7374 6561 642e 0d0a  fault instead...
-00014dc0: 0d0a 5637 2e34 2e30 3a20 4d43 2c20 4f78  ..V7.4.0: MC, Ox
-00014dd0: 666f 7264 2c20 3230 2041 7567 7573 7420  ford, 20 August 
-00014de0: 3230 3230 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2020..++++++++++
-00014df0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00014e00: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060  ++++++++....- ``
-00014e10: 6361 7066 6974 6060 3a20 4e65 7720 6675  capfit``: New fu
-00014e20: 6e63 7469 6f6e 2060 606c 7371 5f6c 696e  nction ``lsq_lin
-00014e30: 6060 2069 6d70 6c65 6d65 6e74 696e 6720  `` implementing 
-00014e40: 6120 6c69 6e65 6172 206c 6561 7374 2d73  a linear least-s
-00014e50: 7175 6172 6573 0d0a 2020 6c69 6e65 6172  quares..  linear
-00014e60: 6c79 2063 6f6e 7374 7261 696e 6564 2061  ly constrained a
-00014e70: 6c67 6f72 6974 686d 2073 7570 706f 7274  lgorithm support
-00014e80: 696e 6720 7261 6e6b 2d64 6566 6963 6965  ing rank-deficie
-00014e90: 6e74 206d 6174 7269 6365 7320 616e 6420  nt matrices and 
-00014ea0: 616c 6c6f 7769 6e67 0d0a 2020 666f 7220  allowing..  for 
-00014eb0: 6120 7374 6172 7469 6e67 2067 7565 7373  a starting guess
-00014ec0: 2e0d 0a2d 2060 6063 6170 6669 7460 603a  ...- ``capfit``:
-00014ed0: 2052 656d 6f76 6564 2074 6865 2060 606c   Removed the ``l
-00014ee0: 7371 6c69 6e60 6020 7072 6f63 6564 7572  sqlin`` procedur
-00014ef0: 6520 7768 6963 6820 6973 2073 7570 6572  e which is super
-00014f00: 7365 6465 6420 6279 2060 606c 7371 5f6c  seded by ``lsq_l
-00014f10: 696e 6060 2e0d 0a2d 2060 6063 6170 6669  in``...- ``capfi
-00014f20: 7460 603a 2052 656e 616d 6564 2060 606c  t``: Renamed ``l
-00014f30: 7371 626f 7860 6020 746f 2060 606c 7371  sqbox`` to ``lsq
-00014f40: 5f62 6f78 6060 2061 6e64 2072 6576 6973  _box`` and revis
-00014f50: 6564 2069 7473 2069 6e74 6572 6661 6365  ed its interface
-00014f60: 2e0d 0a2d 2060 6070 7078 6660 603a 204d  ...- ``ppxf``: M
-00014f70: 6f64 6966 6965 6420 746f 2075 7365 2074  odified to use t
-00014f80: 6865 206e 6577 2060 606c 7371 5f6c 696e  he new ``lsq_lin
-00014f90: 6060 2061 6e64 2074 6865 2075 7064 6174  `` and the updat
-00014fa0: 6564 2060 606c 7371 5f62 6f78 6060 2066  ed ``lsq_box`` f
-00014fb0: 756e 6374 696f 6e73 2e0d 0a2d 2060 6070  unctions...- ``p
-00014fc0: 7078 6660 603a 204d 6f72 6520 6578 616d  pxf``: More exam
-00014fd0: 706c 6573 2066 6f72 2074 6865 2060 6063  ples for the ``c
-00014fe0: 6f6e 7374 725f 7465 6d70 6c60 6020 616e  onstr_templ`` an
-00014ff0: 6420 6060 636f 6e73 7472 5f6b 696e 656d  d ``constr_kinem
-00015000: 6060 206b 6579 776f 7264 732e 0d0a 2d20  `` keywords...- 
-00015010: 5365 7420 7265 6473 6869 6674 2060 607a  Set redshift ``z
-00015020: 203d 2030 6060 2077 6865 6e20 6f6e 6520   = 0`` when one 
-00015030: 756e 636f 6d6d 656e 7473 2074 6865 206c  uncomments the l
-00015040: 696e 6573 2074 6f20 6272 696e 6720 7468  ines to bring th
-00015050: 6520 7370 6563 7472 756d 2074 6f0d 0a20  e spectrum to.. 
-00015060: 2074 6865 2072 6573 742d 6672 616d 6520   the rest-frame 
-00015070: 696e 2060 6070 7078 665f 6578 616d 706c  in ``ppxf_exampl
-00015080: 655f 6b69 6e65 6d61 7469 6373 5f73 6473  e_kinematics_sds
-00015090: 732e 7079 6060 2e20 5468 616e 6b73 2074  s.py``. Thanks t
-000150a0: 6f0d 0a20 2056 6169 6465 6869 2053 2e20  o..  Vaidehi S. 
-000150b0: 5061 6c69 7961 2028 6465 7379 2e64 6529  Paliya (desy.de)
-000150c0: 2066 6f72 2070 6f69 6e74 696e 6720 6f75   for pointing ou
-000150d0: 7420 7468 6520 696e 636f 6e73 6973 7465  t the inconsiste
-000150e0: 6e63 7920 696e 206d 7920 6578 616d 706c  ncy in my exampl
-000150f0: 652e 0d0a 0d0a 5637 2e33 2e30 3a20 4d43  e.....V7.3.0: MC
-00015100: 2c20 4f78 666f 7264 2c20 3130 204a 756c  , Oxford, 10 Jul
-00015110: 7920 3230 3230 0d0a 2b2b 2b2b 2b2b 2b2b  y 2020..++++++++
-00015120: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00015130: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060  ++++++++....- ``
-00015140: 6361 7066 6974 6060 3a20 4e65 7720 6675  capfit``: New fu
-00015150: 6e63 7469 6f6e 2060 606c 7371 626f 7860  nction ``lsqbox`
-00015160: 6020 696d 706c 656d 656e 7469 6e67 2061  ` implementing a
-00015170: 2066 6173 7420 6c69 6e65 6172 206c 6561   fast linear lea
-00015180: 7374 2d73 7175 6172 6573 0d0a 2020 626f  st-squares..  bo
-00015190: 782d 636f 6e73 7472 6169 6e65 6420 2862  x-constrained (b
-000151a0: 6f75 6e64 7329 2061 6c67 6f72 6974 686d  ounds) algorithm
-000151b0: 2077 6869 6368 2061 6c6c 6f77 7320 666f   which allows fo
-000151c0: 7220 6120 7374 6172 7469 6e67 2067 7565  r a starting gue
-000151d0: 7373 2e0d 0a20 2057 6869 6c65 2074 6573  ss...  While tes
-000151e0: 7469 6e67 2049 2061 6c73 6f20 6469 7363  ting I also disc
-000151f0: 6f76 6572 6564 2061 206d 616a 6f72 206d  overed a major m
-00015200: 6973 7461 6b65 2069 6e20 7468 6520 6375  istake in the cu
-00015210: 7272 656e 7420 696d 706c 656d 656e 7461  rrent implementa
-00015220: 7469 6f6e 0d0a 2020 6f66 2060 6073 6369  tion..  of ``sci
-00015230: 7079 2e6f 7074 696d 697a 652e 6c73 715f  py.optimize.lsq_
-00015240: 6c69 6e65 6172 6060 2028 6d79 2066 6978  linear`` (my fix
-00015250: 2077 6173 206c 6174 6572 2069 6e63 6c75   was later inclu
-00015260: 6465 6420 696e 2053 6369 7079 2031 2e36  ded in Scipy 1.6
-00015270: 292e 0d0a 2d20 6060 7070 7866 6060 3a20  )...- ``ppxf``: 
-00015280: 5468 6520 6e65 7720 6060 6c69 6e65 6172  The new ``linear
-00015290: 5f6d 6574 686f 643d 276c 7371 626f 7827  _method='lsqbox'
-000152a0: 6060 2061 6e64 2060 606c 696e 6561 725f  `` and ``linear_
-000152b0: 6d65 7468 6f64 3d27 6376 786f 7074 2760  method='cvxopt'`
-000152c0: 600d 0a20 206e 6f77 2075 7365 2061 6e20  `..  now use an 
-000152d0: 696e 6974 6961 6c20 6775 6573 7320 666f  initial guess fo
-000152e0: 7220 7468 6520 736f 6c75 7469 6f6e 2c20  r the solution, 
-000152f0: 7768 6963 6820 7369 676e 6966 6963 616e  which significan
-00015300: 746c 7920 7370 6565 6473 2075 7020 7468  tly speeds up th
-00015310: 650d 0a20 206b 696e 656d 6174 6963 2066  e..  kinematic f
-00015320: 6974 2077 6974 6820 6d75 6c74 6970 6c65  it with multiple
-00015330: 2074 656d 706c 6174 6573 2e20 4173 2061   templates. As a
-00015340: 6e20 6578 616d 706c 652c 206d 7920 7072  n example, my pr
-00015350: 6f63 6564 7572 650d 0a20 2060 6070 7078  ocedure..  ``ppx
-00015360: 665f 6578 616d 706c 655f 706f 7075 6c61  f_example_popula
-00015370: 7469 6f6e 5f67 6173 5f73 6473 7360 6020  tion_gas_sdss`` 
-00015380: 6973 206e 6f77 2061 626f 7574 2034 2074  is now about 4 t
-00015390: 696d 6573 2066 6173 7465 7220 7769 7468  imes faster with
-000153a0: 2074 6865 206e 6577 0d0a 2020 6060 6c69   the new..  ``li
-000153b0: 6e65 6172 5f6d 6574 686f 643d 276c 7371  near_method='lsq
-000153c0: 626f 7827 6060 2074 6861 6e20 7769 7468  box'`` than with
-000153d0: 2074 6865 206c 6567 6163 7920 6060 6c69   the legacy ``li
-000153e0: 6e65 6172 5f6d 6574 686f 643d 276e 6e6c  near_method='nnl
-000153f0: 7327 6060 2e0d 0a2d 2060 6070 7078 6660  s'``...- ``ppxf`
-00015400: 603a 2041 6464 6564 2073 7570 706f 7274  `: Added support
-00015410: 2066 6f72 206c 696e 6561 7220 6571 7561   for linear equa
-00015420: 6c69 7479 2063 6f6e 7374 7261 696e 7473  lity constraints
-00015430: 206f 6e20 7468 6520 7465 6d70 6c61 7465   on the template
-00015440: 730d 0a20 2060 6063 6f6e 7374 725f 7465  s..  ``constr_te
-00015450: 6d70 6c60 6020 616e 6420 666f 7220 7573  mpl`` and for us
-00015460: 696e 6720 7468 6520 6b65 7977 6f72 6420  ing the keyword 
-00015470: 6060 6672 6163 7469 6f6e 6060 2077 6974  ``fraction`` wit
-00015480: 6820 626f 7468 0d0a 2020 6060 6c69 6e65  h both..  ``line
-00015490: 6172 5f6d 6574 686f 643d 276c 7371 626f  ar_method='lsqbo
-000154a0: 7827 6060 2061 6e64 2060 606c 696e 6561  x'`` and ``linea
-000154b0: 725f 6d65 7468 6f64 3d27 6e6e 6c73 2760  r_method='nnls'`
-000154c0: 602e 0d0a 2d20 5072 696e 7420 6060 6465  `...- Print ``de
-000154d0: 6772 6565 6060 2061 6e64 2060 606d 6465  gree`` and ``mde
-000154e0: 6772 6565 6060 2077 6974 6820 7468 6520  gree`` with the 
-000154f0: 6669 6e61 6c20 7265 7375 6c74 732e 0d0a  final results...
-00015500: 2d20 5365 7420 6060 6c69 6e65 6172 3d54  - Set ``linear=T
-00015510: 7275 6560 6020 6175 746f 6d61 7469 6361  rue`` automatica
-00015520: 6c6c 7920 6966 2074 6865 2066 6974 2068  lly if the fit h
-00015530: 6173 206e 6f20 6672 6565 206e 6f6e 2d6c  as no free non-l
-00015540: 696e 6561 7220 7061 7261 6d65 7465 7273  inear parameters
-00015550: 2c0d 0a20 2074 6f20 6176 6f69 6420 6120  ,..  to avoid a 
-00015560: 7072 6f67 7261 6d20 7374 6f70 2e20 5468  program stop. Th
-00015570: 616e 6b73 2074 6f20 5368 7261 7661 6e20  anks to Shravan 
-00015580: 5368 6574 7479 2028 706b 752e 6564 752e  Shetty (pku.edu.
-00015590: 636e 2920 666f 7220 7468 6520 7265 706f  cn) for the repo
-000155a0: 7274 2e0d 0a0d 0a56 372e 322e 313a 204d  rt.....V7.2.1: M
-000155b0: 432c 204f 7866 6f72 642c 2031 3220 4a75  C, Oxford, 12 Ju
-000155c0: 6e65 2032 3032 300d 0a2b 2b2b 2b2b 2b2b  ne 2020..+++++++
-000155d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000155e0: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2060  +++++++++....- `
-000155f0: 6063 6170 6669 7460 603a 204e 6577 2069  `capfit``: New i
-00015600: 6e70 7574 206b 6579 776f 7264 2060 6063  nput keyword ``c
-00015610: 6f6e 6460 6020 666f 7220 4a61 636f 6269  ond`` for Jacobi
-00015620: 616e 2072 616e 6b20 746f 6c65 7261 6e63  an rank toleranc
-00015630: 652e 0d0a 2d20 6060 6361 7066 6974 6060  e...- ``capfit``
-00015640: 3a20 5573 6520 6060 6276 6c73 6060 2074  : Use ``bvls`` t
-00015650: 6f20 736f 6c76 6520 7175 6164 7261 7469  o solve quadrati
-00015660: 6320 7375 6270 726f 626c 656d 2077 6974  c subproblem wit
-00015670: 6820 6f6e 6c79 2060 6062 6f75 6e64 7360  h only ``bounds`
-00015680: 602e 0d0a 2d20 6060 7070 7866 6060 3a20  `...- ``ppxf``: 
-00015690: 5365 7420 6060 636f 6e64 3d31 652d 3760  Set ``cond=1e-7`
-000156a0: 6020 696e 2060 6063 6170 6669 7460 6020  ` in ``capfit`` 
-000156b0: 6361 6c6c 2c20 7768 656e 2075 7369 6e67  call, when using
-000156c0: 206c 696e 6561 7220 636f 6e73 7472 6169   linear constrai
-000156d0: 6e74 732e 0d0a 2020 5468 6520 6060 6361  nts...  The ``ca
-000156e0: 7066 6974 6060 2072 656c 6174 6564 2063  pfit`` related c
-000156f0: 6861 6e67 6573 2077 6572 6520 6475 6520  hanges were due 
-00015700: 746f 2064 6574 6169 6c65 6420 6665 6564  to detailed feed
-00015710: 6261 636b 2062 7920 4b79 6c65 2057 6573  back by Kyle Wes
-00015720: 7466 616c 6c0d 0a20 2028 7563 6f6c 6963  tfall..  (ucolic
-00015730: 6b2e 6f72 6729 2c20 746f 2064 6561 6c20  k.org), to deal 
-00015740: 7769 7468 2073 6974 7561 7469 6f6e 7320  with situations 
-00015750: 7769 7468 2064 6567 656e 6572 6174 6520  with degenerate 
-00015760: 4a61 636f 6269 616e 732c 206c 696b 6520  Jacobians, like 
-00015770: 7768 656e 0d0a 2020 7468 6572 6520 6973  when..  there is
-00015780: 206e 6f20 7374 656c 6c61 7220 636f 6e74   no stellar cont
-00015790: 696e 7575 6d20 616e 6420 6f6e 6520 7573  inuum and one us
-000157a0: 6573 206d 756c 7469 706c 6963 6174 6976  es multiplicativ
-000157b0: 6520 706f 6c79 6e6f 6d69 616c 732e 0d0a  e polynomials...
-000157c0: 2d20 6060 7070 7866 6060 3a20 436c 6172  - ``ppxf``: Clar
-000157d0: 6966 6965 6420 646f 6375 6d65 6e74 6174  ified documentat
-000157e0: 696f 6e20 666f 7220 6060 2e67 6173 5f7a  ion for ``.gas_z
-000157f0: 6572 6f5f 7465 6d70 6c61 7465 6060 2061  ero_template`` a
-00015800: 6e64 2074 6865 0d0a 2020 636f 7272 6573  nd the..  corres
-00015810: 706f 6e64 696e 6720 7761 726e 696e 6720  ponding warning 
-00015820: 6d65 7373 6167 652c 2061 6674 6572 2066  message, after f
-00015830: 6565 6462 6163 6b20 6279 204c 6175 7261  eedback by Laura
-00015840: 2053 616c 6f20 2875 6d6e 2e65 6475 292e   Salo (umn.edu).
-00015850: 0d0a 0d0a 5637 2e32 2e30 3a20 4d43 2c20  ....V7.2.0: MC, 
-00015860: 4f78 666f 7264 2c20 3420 4d61 7920 3230  Oxford, 4 May 20
-00015870: 3230 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  20..++++++++++++
-00015880: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00015890: 2b2b 0d0a 0d0a 2d20 416c 6c6f 7720 666f  ++....- Allow fo
-000158a0: 7220 6060 6c69 6e65 6172 5f6d 6574 686f  r ``linear_metho
-000158b0: 643d 2763 7678 6f70 7427 6060 2077 6865  d='cvxopt'`` whe
-000158c0: 6e20 7468 6520 6f70 7469 6f6e 616c 2060  n the optional `
-000158d0: 6063 7678 6f70 7460 6020 7061 636b 6167  `cvxopt`` packag
-000158e0: 650d 0a20 2069 7320 696e 7374 616c 6c65  e..  is installe
-000158f0: 642e 0d0a 0d0a 5637 2e31 2e30 3a20 4d43  d.....V7.1.0: MC
-00015900: 2c20 4f78 666f 7264 2c20 3330 2041 7072  , Oxford, 30 Apr
-00015910: 696c 2032 3032 300d 0a2b 2b2b 2b2b 2b2b  il 2020..+++++++
-00015920: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00015930: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-00015940: 496e 7472 6f64 7563 6564 206e 6577 2060  Introduced new `
-00015950: 6070 7078 6660 6020 6b65 7977 6f72 6420  `ppxf`` keyword 
-00015960: 6060 6c69 6e65 6172 5f6d 6574 686f 6460  ``linear_method`
-00015970: 602c 2061 6e64 2063 6f72 7265 7370 6f6e  `, and correspon
-00015980: 6469 6e67 2063 6861 6e67 6573 0d0a 2020  ding changes..  
-00015990: 696e 2074 6865 2063 6f64 652c 2074 6f20  in the code, to 
-000159a0: 7365 6c65 6374 2062 6574 7765 656e 2074  select between t
-000159b0: 6865 206f 6c64 2028 276e 6e6c 7327 2920  he old ('nnls') 
-000159c0: 616e 6420 7468 6520 6e65 7720 2827 6c73  and the new ('ls
-000159d0: 716c 696e 2729 0d0a 2020 6170 7072 6f61  qlin')..  approa
-000159e0: 6368 2074 6f20 7468 6520 736f 6c75 7469  ch to the soluti
-000159f0: 6f6e 206f 6620 7468 6520 6c69 6e65 6172  on of the linear
-00015a00: 206c 6561 7374 2d73 7175 6172 6573 2073   least-squares s
-00015a10: 7562 7072 6f62 6c65 6d20 696e 2060 6070  ubproblem in ``p
-00015a20: 7078 6660 602e 0d0a 2020 5468 616e 6b73  pxf``...  Thanks
-00015a30: 2074 6f20 5361 6d20 5661 7567 6861 6e20   to Sam Vaughan 
-00015a40: 2873 7964 6e65 792e 6564 752e 6175 2920  (sydney.edu.au) 
-00015a50: 666f 7220 6120 636f 6e76 696e 6369 6e67  for a convincing
-00015a60: 206d 696e 696d 616c 2065 7861 6d70 6c65   minimal example
-00015a70: 0d0a 2020 696c 6c75 7374 7261 7469 6e67  ..  illustrating
-00015a80: 2074 6865 2075 7365 6675 6c6e 6573 7320   the usefulness 
-00015a90: 6f66 2074 6869 7320 6b65 7977 6f72 642e  of this keyword.
-00015aa0: 0d0a 0d0a 5637 2e30 2e31 3a20 4d43 2c20  ....V7.0.1: MC, 
-00015ab0: 4f78 666f 7264 2c20 3820 4170 7269 6c20  Oxford, 8 April 
-00015ac0: 3230 3230 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2020..++++++++++
-00015ad0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00015ae0: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5375 7070  ++++++....- Supp
-00015af0: 6f72 7420 6060 2e67 6173 5f7a 6572 6f5f  ort ``.gas_zero_
-00015b00: 7465 6d70 6c61 7465 6060 2061 6e64 2060  template`` and `
-00015b10: 6066 7261 6374 696f 6e60 6020 746f 6765  `fraction`` toge
-00015b20: 7468 6572 2077 6974 6820 6f74 6865 720d  ther with other.
-00015b30: 0a20 2065 7175 616c 6974 7920 636f 6e73  .  equality cons
-00015b40: 7472 6169 6e74 732e 0d0a 2d20 496e 636c  traints...- Incl
-00015b50: 7564 6564 2060 606e 702e 7061 6428 2e2e  uded ``np.pad(..
-00015b60: 2e6d 6f64 653d 2763 6f6e 7374 616e 7427  .mode='constant'
-00015b70: 2960 6020 666f 7220 6261 636b 7761 7264  )`` for backward
-00015b80: 2063 6f6d 7061 7469 6269 6c69 7479 2077   compatibility w
-00015b90: 6974 680d 0a20 204e 756d 7079 2031 2e31  ith..  Numpy 1.1
-00015ba0: 362e 2054 6861 6e6b 7320 746f 2053 6872  6. Thanks to Shr
-00015bb0: 6176 616e 2053 6865 7474 7920 284b 4941  avan Shetty (KIA
-00015bc0: 412d 504b 5529 2066 6f72 2074 6865 2073  A-PKU) for the s
-00015bd0: 7567 6765 7374 696f 6e2e 0d0a 2d20 4669  uggestion...- Fi
-00015be0: 7820 6060 7265 6269 6e28 2960 6020 6e6f  x ``rebin()`` no
-00015bf0: 7420 7265 7461 696e 696e 6720 7468 6520  t retaining the 
-00015c00: 6469 6d65 6e73 696f 6e61 6c69 7479 206f  dimensionality o
-00015c10: 6620 616e 2069 6e70 7574 2063 6f6c 756d  f an input colum
-00015c20: 6e2d 7665 6374 6f72 2e0d 0a20 2054 6869  n-vector...  Thi
-00015c30: 7320 7265 7375 6c74 6564 2069 6e20 6120  s resulted in a 
-00015c40: 7072 6f67 7261 6d20 7374 6f70 2077 6974  program stop wit
-00015c50: 6820 6120 7369 6e67 6c65 2067 6173 2074  h a single gas t
-00015c60: 656d 706c 6174 6520 616e 640d 0a20 2060  emplate and..  `
-00015c70: 6076 656c 7363 616c 655f 7261 7469 6f20  `velscale_ratio 
-00015c80: 3e20 3160 602e 2054 6861 6e6b 7320 746f  > 1``. Thanks to
-00015c90: 205a 6869 7975 616e 204a 6920 2861 7374   Zhiyuan Ji (ast
-00015ca0: 726f 2e75 6d61 7373 2e65 6475 2920 666f  ro.umass.edu) fo
-00015cb0: 7220 6120 636c 6561 720d 0a20 2065 7861  r a clear..  exa
-00015cc0: 6d70 6c65 2072 6570 726f 6475 6369 6e67  mple reproducing
-00015cd0: 2074 6865 2062 7567 2e0d 0a2d 2060 6063   the bug...- ``c
-00015ce0: 6170 6669 7460 603a 204e 6577 206b 6579  apfit``: New key
-00015cf0: 776f 7264 2060 6063 6f6e 6460 6020 666f  word ``cond`` fo
-00015d00: 7220 6060 6c73 716c 696e 6060 2e0d 0a2d  r ``lsqlin``...-
-00015d10: 2060 6063 6170 6669 7460 603a 2052 656c   ``capfit``: Rel
-00015d20: 6178 6564 2061 7373 6572 7469 6f6e 2066  axed assertion f
-00015d30: 6f72 2069 6e63 6f6e 7369 7374 656e 7420  or inconsistent 
-00015d40: 696e 6571 7561 6c69 7469 6573 2069 6e20  inequalities in 
-00015d50: 6060 6c73 716c 696e 6060 0d0a 2020 746f  ``lsqlin``..  to
-00015d60: 2061 766f 6964 2066 616c 7365 2070 6f73   avoid false pos
-00015d70: 6974 6976 6573 2e20 5468 616e 6b73 2074  itives. Thanks t
-00015d80: 6f20 4b79 6c65 2057 6573 7466 616c 6c20  o Kyle Westfall 
-00015d90: 2855 434f 204c 6963 6b29 2066 6f72 2061  (UCO Lick) for a
-00015da0: 2064 6574 6169 6c65 640d 0a20 2062 7567   detailed..  bug
-00015db0: 2072 6570 6f72 742e 0d0a 0d0a 5637 2e30   report.....V7.0
-00015dc0: 2e30 3a20 4d43 2c20 4f78 666f 7264 2c20  .0: MC, Oxford, 
-00015dd0: 3130 204a 616e 7561 7279 2032 3032 300d  10 January 2020.
-00015de0: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-00015df0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00015e00: 2b2b 2b2b 0d0a 0d0a 2d20 6060 6361 7066  ++++....- ``capf
-00015e10: 6974 6060 3a20 4e65 7720 6765 6e65 7261  it``: New genera
-00015e20: 6c20 6c69 6e65 6172 206c 6561 7374 2d73  l linear least-s
-00015e30: 7175 6172 6573 206f 7074 696d 697a 6174  quares optimizat
-00015e40: 696f 6e20 6675 6e63 7469 6f6e 0d0a 2020  ion function..  
-00015e50: 6060 6c73 716c 696e 6060 2077 6869 6368  ``lsqlin`` which
-00015e60: 2069 7320 6e6f 7720 7573 6564 2074 6f20   is now used to 
-00015e70: 736f 6c76 6520 7468 6520 7175 6164 7261  solve the quadra
-00015e80: 7469 6320 7375 6270 726f 626c 656d 2e0d  tic subproblem..
-00015e90: 0a2d 2060 6063 6170 6669 7460 603a 2041  .- ``capfit``: A
-00015ea0: 6c6c 6f77 2066 6f72 206c 696e 6561 7220  llow for linear 
-00015eb0: 696e 6571 7561 6c69 7479 2f65 7175 616c  inequality/equal
-00015ec0: 6974 7920 636f 6e73 7472 6169 6e74 730d  ity constraints.
-00015ed0: 0a20 2060 6041 5f69 6e65 7160 602c 2060  .  ``A_ineq``, `
-00015ee0: 6062 5f69 6e65 7160 6020 616e 6420 2060  `b_ineq`` and  `
-00015ef0: 6041 5f65 7160 602c 2060 6062 5f65 7160  `A_eq``, ``b_eq`
-00015f00: 602e 0d0a 2d20 6060 7070 7866 6060 3a20  `...- ``ppxf``: 
-00015f10: 5573 6520 2866 6173 7465 7229 2060 6063  Use (faster) ``c
-00015f20: 6170 6669 742e 6c73 716c 696e 6060 2066  apfit.lsqlin`` f
-00015f30: 6f72 2074 6865 206c 696e 6561 7220 6669  or the linear fi
-00015f40: 742e 0d0a 2d20 6060 7070 7866 6060 3a20  t...- ``ppxf``: 
-00015f50: 5573 6520 7570 6461 7465 6420 6060 6361  Use updated ``ca
-00015f60: 7066 6974 2e63 6170 6669 7460 6020 666f  pfit.capfit`` fo
-00015f70: 7220 7468 6520 6e6f 6e2d 6c69 6e65 6172  r the non-linear
-00015f80: 206f 7074 696d 697a 6174 696f 6e2e 0d0a   optimization...
-00015f90: 2d20 6060 7070 7866 6060 3a20 416c 6c6f  - ``ppxf``: Allo
-00015fa0: 7720 666f 7220 6c69 6e65 6172 2065 7175  w for linear equ
-00015fb0: 616c 6974 6965 732f 696e 6571 7561 6c69  alities/inequali
-00015fc0: 7469 6573 2066 6f72 2062 6f74 6820 7468  ties for both th
-00015fd0: 6520 7465 6d70 6c61 7465 0d0a 2020 7765  e template..  we
-00015fe0: 6967 6874 7320 616e 6420 7468 6520 6b69  ights and the ki
-00015ff0: 6e65 6d61 7469 6320 7061 7261 6d65 7465  nematic paramete
-00016000: 7273 2077 6974 6820 7468 6520 6060 636f  rs with the ``co
-00016010: 6e73 7472 5f74 656d 706c 6060 2061 6e64  nstr_templ`` and
-00016020: 0d0a 2020 6060 636f 6e73 7472 5f6b 696e  ..  ``constr_kin
-00016030: 656d 6060 206f 7074 696f 6e61 6c20 6b65  em`` optional ke
-00016040: 7977 6f72 6473 2e0d 0a2d 2060 6070 7078  ywords...- ``ppx
-00016050: 6660 603a 204e 6577 2060 6073 6574 5f6c  f``: New ``set_l
-00016060: 696e 6561 725f 636f 6e73 7472 6169 6e74  inear_constraint
-00016070: 7360 6020 6675 6e63 7469 6f6e 2e0d 0a2d  s`` function...-
-00016080: 2060 6070 7078 6660 603a 2055 7064 6174   ``ppxf``: Updat
-00016090: 6564 2064 6f63 756d 656e 7461 7469 6f6e  ed documentation
-000160a0: 2e0d 0a0d 0a56 362e 372e 3137 3a20 4d43  .....V6.7.17: MC
-000160b0: 2c20 4f78 666f 7264 2c20 3134 204e 6f76  , Oxford, 14 Nov
-000160c0: 656d 6265 7220 3230 3139 0d0a 2b2b 2b2b  ember 2019..++++
-000160d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000160e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000160f0: 2b0d 0a0d 0a2d 2060 6063 6170 6669 7460  +....- ``capfit`
-00016100: 603a 2057 7269 7474 656e 2063 6f6d 706c  `: Written compl
-00016110: 6574 6520 646f 6375 6d65 6e74 6174 696f  ete documentatio
-00016120: 6e2e 0d0a 2d20 6060 6361 7066 6974 6060  n...- ``capfit``
-00016130: 3a20 496d 7072 6f76 6564 2070 7269 6e74  : Improved print
-00016140: 2066 6f72 6d61 7474 696e 672e 0d0a 2d20   formatting...- 
-00016150: 6060 6361 7066 6974 6060 3a20 5265 7475  ``capfit``: Retu
-00016160: 726e 2060 602e 6d65 7373 6167 6560 6020  rn ``.message`` 
-00016170: 6174 7472 6962 7574 652e 0d0a 2d20 6060  attribute...- ``
-00016180: 6361 7066 6974 6060 3a20 496d 7072 6f76  capfit``: Improv
-00016190: 6564 2060 6078 746f 6c60 6020 636f 6e76  ed ``xtol`` conv
-000161a0: 6572 6765 6e63 6520 7465 7374 2e0d 0a2d  ergence test...-
-000161b0: 2060 6063 6170 6669 7460 603a 204f 6e6c   ``capfit``: Onl
-000161c0: 7920 6163 6365 7074 2066 696e 616c 206d  y accept final m
-000161d0: 6f76 6520 6966 2060 6063 6869 3260 6020  ove if ``chi2`` 
-000161e0: 6465 6372 6561 7365 642e 0d0a 2d20 6060  decreased...- ``
-000161f0: 6361 7066 6974 6060 3a20 5374 7269 6374  capfit``: Strict
-00016200: 6c79 2073 6174 6973 6679 2062 6f75 6e64  ly satisfy bound
-00016210: 7320 6475 7269 6e67 204a 6163 6f62 6961  s during Jacobia
-00016220: 6e20 636f 6d70 7574 6174 696f 6e2e 0d0a  n computation...
-00016230: 0d0a 5636 2e37 2e31 363a 204d 432c 204f  ..V6.7.16: MC, O
-00016240: 7866 6f72 642c 2031 3220 4a75 6e65 2032  xford, 12 June 2
-00016250: 3031 390d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  019..+++++++++++
-00016260: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016270: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060 6361  ++++++....- ``ca
-00016280: 7066 6974 6060 3a20 5573 6520 6f6e 6c79  pfit``: Use only
-00016290: 2066 7265 6520 7061 7261 6d65 7465 7273   free parameters
-000162a0: 2066 6f72 2060 6078 746f 6c60 6020 636f   for ``xtol`` co
-000162b0: 6e76 6572 6765 6e63 6520 7465 7374 2e0d  nvergence test..
-000162c0: 0a2d 2060 6063 6170 6669 7460 603a 2044  .- ``capfit``: D
-000162d0: 6573 6372 6962 6520 696e 2077 6f72 6473  escribe in words
-000162e0: 2063 6f6e 7665 7267 656e 6365 2073 7461   convergence sta
-000162f0: 7475 7320 7769 7468 206e 6f6e 7a65 726f  tus with nonzero
-00016300: 2060 6076 6572 626f 7365 6060 2e0d 0a2d   ``verbose``...-
-00016310: 2060 6063 6170 6669 7460 603a 2046 6978   ``capfit``: Fix
-00016320: 6564 2070 726f 6772 616d 2073 746f 7020  ed program stop 
-00016330: 7768 656e 2060 6061 6273 5f73 7465 7060  when ``abs_step`
-00016340: 6020 6973 2075 6e64 6566 696e 6564 2e0d  ` is undefined..
-00016350: 0a2d 2060 6063 6170 6669 7460 603a 2046  .- ``capfit``: F
-00016360: 6978 6564 2069 676e 6f72 696e 6720 6f70  ixed ignoring op
-00016370: 7469 6f6e 616c 2060 606d 6178 5f6e 6665  tional ``max_nfe
-00016380: 7660 602e 0d0a 0d0a 5636 2e37 2e31 353a  v``.....V6.7.15:
-00016390: 204d 432c 204f 7866 6f72 642c 2037 2046   MC, Oxford, 7 F
-000163a0: 6562 7275 6172 7920 3230 3139 0d0a 2b2b  ebruary 2019..++
-000163b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000163c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000163d0: 2b2b 0d0a 2d20 5265 6d6f 7665 6420 756e  ++..- Removed un
-000163e0: 7573 6564 2060 6072 6560 6020 696d 706f  used ``re`` impo
-000163f0: 7274 2e0d 0a2d 2052 656d 6f76 6564 2053  rt...- Removed S
-00016400: 6369 7079 2773 2060 606e 6578 745f 6661  cipy's ``next_fa
-00016410: 7374 5f6c 656e 6060 2075 7361 6765 2064  st_len`` usage d
-00016420: 7565 2074 6f20 616e 2069 7373 7565 2077  ue to an issue w
-00016430: 6974 6820 6f64 6420 7061 6464 696e 6720  ith odd padding 
-00016440: 7369 7a65 2e0d 0a20 2054 6861 6e6b 7320  size...  Thanks 
-00016450: 746f 2045 7269 6320 456d 7365 6c6c 656d  to Eric Emsellem
-00016460: 2028 4553 4f29 2066 6f72 2061 2063 6c65   (ESO) for a cle
-00016470: 6172 2065 7861 6d70 6c65 2069 6c6c 7573  ar example illus
-00016480: 7472 6174 696e 6720 7468 6973 2072 6172  trating this rar
-00016490: 6520 616e 640d 0a20 2073 7562 746c 6520  e and..  subtle 
-000164a0: 6275 672e 0d0a 0d0a 5636 2e37 2e31 343a  bug.....V6.7.14:
-000164b0: 204d 432c 204f 7866 6f72 642c 2032 3720   MC, Oxford, 27 
-000164c0: 4e6f 7665 6d62 6572 2032 3031 380d 0a2b  November 2018..+
-000164d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000164e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000164f0: 2b2b 2b2b 2b0d 0a2d 2050 7269 6e74 2074  +++++..- Print t
-00016500: 6865 2075 7365 6420 6060 7469 6564 6060  he used ``tied``
-00016510: 2070 6172 616d 6574 6572 7320 6571 7561   parameters equa
-00016520: 6c69 7469 6573 2c20 6966 2061 6e79 2e0d  lities, if any..
-00016530: 0a2d 2052 6574 7572 6e20 6060 2e6e 646f  .- Return ``.ndo
-00016540: 6660 6020 6174 7472 6962 7574 652e 0d0a  f`` attribute...
-00016550: 2d20 446f 206e 6f74 2072 656d 6f76 6520  - Do not remove 
-00016560: 6060 6669 7865 6460 6020 6f72 2060 6074  ``fixed`` or ``t
-00016570: 6965 6460 6020 7061 7261 6d65 7465 7273  ied`` parameters
-00016580: 2066 726f 6d20 7468 6520 444f 4620 6361   from the DOF ca
-00016590: 6c63 756c 6174 696f 6e2e 0d0a 2020 5468  lculation...  Th
-000165a0: 616e 6b73 2074 6f20 4a6f 616e 6e61 2057  anks to Joanna W
-000165b0: 6f6f 2028 556e 6976 2e20 6f66 2056 6963  oo (Univ. of Vic
-000165c0: 746f 7269 6129 2066 6f72 2074 6865 2063  toria) for the c
-000165d0: 6f72 7265 6374 696f 6e2e 0d0a 2d20 5265  orrection...- Re
-000165e0: 706c 6163 6564 2060 606e 6f72 6d61 6c69  placed ``normali
-000165f0: 7a65 6060 2c20 6060 6d69 6e5f 6167 6560  ze``, ``min_age`
-00016600: 602c 2060 606d 6178 5f61 6765 6060 2061  `, ``max_age`` a
-00016610: 6e64 2060 606d 6574 616c 6060 206b 6579  nd ``metal`` key
-00016620: 776f 7264 7320 7769 7468 0d0a 2020 6060  words with..  ``
-00016630: 6e6f 726d 5f72 616e 6765 6060 2c20 6060  norm_range``, ``
-00016640: 6167 655f 7261 6e67 6560 6020 616e 6420  age_range`` and 
-00016650: 6060 6d65 7461 6c5f 7261 6e67 6560 6020  ``metal_range`` 
-00016660: 696e 2060 6070 7078 662e 6d69 6c65 735f  in ``ppxf.miles_
-00016670: 7574 696c 2e6d 696c 6573 6060 2e0d 0a2d  util.miles``...-
-00016680: 2046 6978 6564 2060 6063 6c6f 636b 6060   Fixed ``clock``
-00016690: 2060 6044 6570 7265 6361 7469 6f6e 5761   ``DeprecationWa
-000166a0: 726e 696e 6760 6020 696e 2050 7974 686f  rning`` in Pytho
-000166b0: 6e20 332e 372e 0d0a 0d0a 5636 2e37 2e31  n 3.7.....V6.7.1
-000166c0: 333a 204d 432c 204f 7866 6f72 642c 2032  3: MC, Oxford, 2
-000166d0: 3020 5365 7074 656d 6265 7220 3230 3138  0 September 2018
-000166e0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-000166f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016700: 2b2b 2b2b 2b2b 2b2b 0d0a 2d20 4578 7061  ++++++++..- Expa
-00016710: 6e64 6564 2064 6f63 756d 656e 7461 7469  nded documentati
-00016720: 6f6e 206f 6620 6060 7265 6464 656e 696e  on of ``reddenin
-00016730: 6760 6020 616e 6420 6060 6761 735f 7265  g`` and ``gas_re
-00016740: 6464 656e 696e 6760 602e 0d0a 2020 5468  ddening``...  Th
-00016750: 616e 6b73 2074 6f20 4e69 636b 2042 6f61  anks to Nick Boa
-00016760: 7264 6d61 6e20 2855 6e69 762e 2055 7461  rdman (Univ. Uta
-00016770: 6829 2066 6f72 2074 6865 2066 6565 6462  h) for the feedb
-00016780: 6163 6b2e 0d0a 2d20 6060 6361 7066 6974  ack...- ``capfit
-00016790: 6060 206e 6f77 2072 6169 7365 7320 616e  `` now raises an
-000167a0: 2065 7272 6f72 2069 6620 6f6e 6520 7472   error if one tr
-000167b0: 6965 7320 746f 2074 6965 2070 6172 616d  ies to tie param
-000167c0: 6574 6572 7320 746f 2074 6865 6d73 656c  eters to themsel
-000167d0: 7665 732e 0d0a 2020 5468 616e 6b73 2074  ves...  Thanks t
-000167e0: 6f20 4b79 6c65 2057 6573 7466 616c 6c20  o Kyle Westfall 
-000167f0: 2855 6e69 762e 2053 616e 7461 2043 7275  (Univ. Santa Cru
-00016800: 7a29 2066 6f72 2074 6865 2073 7567 6765  z) for the sugge
-00016810: 7374 696f 6e2e 0d0a 2d20 6060 6361 7066  stion...- ``capf
-00016820: 6974 6060 2075 7365 7320 5079 7468 6f6e  it`` uses Python
-00016830: 2033 2e36 2066 2d73 7472 696e 6773 2e0d   3.6 f-strings..
-00016840: 0a0d 0a56 362e 372e 3132 3a20 4d43 2c20  ...V6.7.12: MC, 
-00016850: 4f78 666f 7264 2c20 3920 4a75 6c79 2032  Oxford, 9 July 2
-00016860: 3031 380d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  018..+++++++++++
-00016870: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016880: 2b2b 2b2b 2b0d 0a2d 2041 6c6c 6f77 2066  +++++..- Allow f
-00016890: 6f72 2060 6076 656c 7363 616c 6560 6020  or ``velscale`` 
-000168a0: 616e 6420 6060 7673 7973 7460 6020 746f  and ``vsyst`` to
-000168b0: 2062 6520 4e75 6d70 7920 6172 7261 7973   be Numpy arrays
-000168c0: 2072 6174 6865 7220 7468 616e 2073 6361   rather than sca
-000168d0: 6c61 7273 2e0d 0a2d 2049 6d70 726f 7665  lars...- Improve
-000168e0: 6420 6372 6974 6572 696f 6e20 666f 7220  d criterion for 
-000168f0: 7768 656e 2074 6865 2042 616c 6d65 7220  when the Balmer 
-00016900: 7365 7269 6573 2069 7320 7769 7468 696e  series is within
-00016910: 2074 6865 2066 6974 7465 6420 7761 7665   the fitted wave
-00016920: 6c65 6e67 7468 0d0a 2020 7261 6e67 6520  length..  range 
-00016930: 696e 2060 6070 7078 662e 7070 7866 5f75  in ``ppxf.ppxf_u
-00016940: 7469 6c2e 656d 6973 7369 6f6e 5f6c 696e  til.emission_lin
-00016950: 6573 6060 2e20 5468 616e 6b73 2074 6f20  es``. Thanks to 
-00016960: 5361 6d20 5661 7567 6861 6e0d 0a20 2028  Sam Vaughan..  (
-00016970: 556e 6976 2e20 6f66 204f 7866 6f72 6429  Univ. of Oxford)
-00016980: 2066 6f72 2074 6865 2066 6565 6462 6163   for the feedbac
-00016990: 6b2e 0d0a 2d20 496e 636c 7564 6564 2060  k...- Included `
-000169a0: 6077 6964 7468 6060 206b 6579 776f 7264  `width`` keyword
-000169b0: 2069 6e20 6060 7070 7866 2e70 7078 665f   in ``ppxf.ppxf_
-000169c0: 7574 696c 2e64 6574 6572 6d69 6e65 5f67  util.determine_g
-000169d0: 6f6f 6470 6978 656c 7360 602e 0d0a 2020  oodpixels``...  
-000169e0: 5468 616e 6b73 2074 6f20 4765 6f72 6765  Thanks to George
-000169f0: 2050 7269 766f 6e20 2855 6e69 762e 206f   Privon (Univ. o
-00016a00: 6620 466c 6f72 6964 6129 2066 6f72 2074  f Florida) for t
-00016a10: 6865 2073 7567 6765 7374 696f 6e2e 0d0a  he suggestion...
-00016a20: 2d20 4578 7061 6e64 6564 2060 602e 6761  - Expanded ``.ga
-00016a30: 735f 666c 7578 6060 2064 6f63 756d 656e  s_flux`` documen
-00016a40: 7461 7469 6f6e 2e0d 0a0d 0a56 362e 372e  tation.....V6.7.
-00016a50: 3131 3a20 4d43 2c20 4f78 666f 7264 2c20  11: MC, Oxford, 
-00016a60: 3520 4a75 6e65 2032 3031 380d 0a2b 2b2b  5 June 2018..+++
-00016a70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016a80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00016a90: 0a2d 2046 6f72 6d61 7474 6564 2060 6070  .- Formatted ``p
-00016aa0: 7078 662e 7079 6060 2064 6f63 7374 7269  pxf.py`` docstri
-00016ab0: 6e67 2069 6e20 7265 5374 7275 6374 7572  ng in reStructur
-00016ac0: 6564 5465 7874 2e0d 0a2d 2052 656d 6f76  edText...- Remov
-00016ad0: 6564 2043 4841 4e47 454c 4f47 2066 726f  ed CHANGELOG fro
-00016ae0: 6d20 7468 6520 636f 6465 2061 6e64 2070  m the code and p
-00016af0: 6c61 6365 6420 6974 2069 6e20 6120 7365  laced it in a se
-00016b00: 7061 7261 7465 2066 696c 652e 0d0a 2d20  parate file...- 
-00016b10: 4d6f 6469 6669 6564 2060 6073 6574 7570  Modified ``setup
-00016b20: 2e70 7960 6020 746f 2073 686f 7720 6865  .py`` to show he
-00016b30: 6c70 2061 6e64 2043 4841 4e47 454c 4f47  lp and CHANGELOG
-00016b40: 206f 6e20 5079 5069 2070 6167 652e 0d0a   on PyPi page...
-00016b50: 2d20 496e 636c 7564 6564 2060 6070 7078  - Included ``ppx
-00016b60: 662e 5f5f 7665 7273 696f 6e5f 5f60 602e  f.__version__``.
-00016b70: 0d0a 0d0a 5636 2e37 2e38 3a20 4d43 2c20  ....V6.7.8: MC, 
-00016b80: 4f78 666f 7264 2c20 3231 204d 6179 2032  Oxford, 21 May 2
-00016b90: 3031 380d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  018..+++++++++++
-00016ba0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016bb0: 2b2b 2b2b 0d0a 0d0a 2d20 4d6f 7665 6420  ++++....- Moved 
-00016bc0: 7061 636b 6167 6520 746f 2074 6865 2050  package to the P
-00016bd0: 7974 686f 6e20 5061 636b 6167 6520 496e  ython Package In
-00016be0: 6465 7820 2850 7950 6929 2e0d 0a2d 2044  dex (PyPi)...- D
-00016bf0: 726f 7070 6564 206c 6567 6163 7920 5079  ropped legacy Py
-00016c00: 7468 6f6e 2032 2e37 2073 7570 706f 7274  thon 2.7 support
-00016c10: 2e0d 0a0d 0a56 362e 372e 363a 204d 432c  .....V6.7.6: MC,
-00016c20: 204f 7866 6f72 642c 2031 3620 4170 7269   Oxford, 16 Apri
-00016c30: 6c20 3230 3138 0d0a 2b2b 2b2b 2b2b 2b2b  l 2018..++++++++
-00016c40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016c50: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2043  +++++++++....- C
-00016c60: 6861 6e67 6564 2069 6d70 6f72 7473 2066  hanged imports f
-00016c70: 6f72 2074 6865 2063 6f6e 7665 7273 696f  or the conversio
-00016c80: 6e20 6f66 2070 5058 4620 746f 2061 2070  n of pPXF to a p
-00016c90: 6163 6b61 6765 2e0d 0a20 2054 6861 6e6b  ackage...  Thank
-00016ca0: 7320 746f 204a 6f65 2042 7572 6368 6574  s to Joe Burchet
-00016cb0: 7420 2853 616e 7461 2043 7275 7a29 2066  t (Santa Cruz) f
-00016cc0: 6f72 2074 6865 2073 7567 6765 7374 696f  or the suggestio
-00016cd0: 6e2e 0d0a 0d0a 5636 2e37 2e35 3a20 4d43  n.....V6.7.5: MC
-00016ce0: 2c20 4f78 666f 7264 2c20 3130 2041 7072  , Oxford, 10 Apr
-00016cf0: 696c 2032 3031 380d 0a2b 2b2b 2b2b 2b2b  il 2018..+++++++
-00016d00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016d10: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-00016d20: 4669 7865 6420 7379 6e74 6178 2065 7272  Fixed syntax err
-00016d30: 6f72 2075 6e64 6572 2050 7974 686f 6e20  or under Python 
-00016d40: 322e 372e 0d0a 0d0a 5636 2e37 2e34 3a20  2.7.....V6.7.4: 
-00016d50: 4d43 2c20 4f78 666f 7264 2c20 3136 2046  MC, Oxford, 16 F
-00016d60: 6562 7275 6172 7920 3230 3138 0d0a 2b2b  ebruary 2018..++
-00016d70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016d80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016d90: 2b2b 0d0a 0d0a 2d20 4669 7865 6420 6275  ++....- Fixed bu
-00016da0: 6720 696e 2060 6072 6564 6465 6e69 6e67  g in ``reddening
-00016db0: 5f63 616c 3030 2829 6060 2e20 4974 206f  _cal00()``. It o
-00016dc0: 6e6c 7920 6166 6665 6374 6564 204e 4952  nly affected NIR
-00016dd0: 206c 616d 203e 2031 3030 3020 6e6d 2e0d   lam > 1000 nm..
-00016de0: 0a0d 0a56 362e 372e 333a 204d 432c 204f  ...V6.7.3: MC, O
-00016df0: 7866 6f72 642c 2038 2046 6562 7275 6172  xford, 8 Februar
-00016e00: 7920 3230 3138 0d0a 2b2b 2b2b 2b2b 2b2b  y 2018..++++++++
+00011da0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00011db0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00011dc0: 2323 230d 0a0d 0a43 6861 6e67 656c 6f67  ###....Changelog
+00011dd0: 0d0a 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a56  ..---------....V
+00011de0: 392e 322e 323a 204d 432c 204f 7866 6f72  9.2.2: MC, Oxfor
+00011df0: 642c 2032 3020 4d61 7920 3230 3234 0d0a  d, 20 May 2024..
+00011e00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00011e10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+00011e20: 0a0d 0a2d 2060 6070 7078 6660 603a 2046  ...- ``ppxf``: F
+00011e30: 6978 6564 2061 6e20 6973 7375 6520 7768  ixed an issue wh
+00011e40: 6572 6520 7468 6520 6162 7365 6e63 6520  ere the absence 
+00011e50: 6f66 2074 6865 2060 6072 6567 5f64 696d  of the ``reg_dim
+00011e60: 6060 206b 6579 776f 7264 2063 6f75 6c64  `` keyword could
+00011e70: 0d0a 2020 6861 6c74 2074 6865 2070 726f  ..  halt the pro
+00011e80: 6772 616d 2028 6275 6720 6672 6f6d 2056  gram (bug from V
+00011e90: 392e 322e 3129 2e20 5468 616e 6b73 2074  9.2.1). Thanks t
+00011ea0: 6f20 4a65 7373 6520 7661 6e20 6465 2053  o Jesse van de S
+00011eb0: 616e 6465 0d0a 2020 2875 6e73 772e 6564  ande..  (unsw.ed
+00011ec0: 752e 6175 2920 616e 6420 4c75 697a 2041  u.au) and Luiz A
+00011ed0: 2e20 5369 6c76 612d 4c69 6d61 2028 556e  . Silva-Lima (Un
+00011ee0: 6976 2e20 53c3 83c2 a36f 2050 6175 6c6f  iv. S....o Paulo
+00011ef0: 2c20 4272 617a 696c 2920 666f 7220 7468  , Brazil) for th
+00011f00: 650d 0a20 2072 6570 6f72 742e 0d0a 0d0a  e..  report.....
+00011f10: 2d20 6060 7070 7866 6060 3a20 4176 6f69  - ``ppxf``: Avoi
+00011f20: 6420 706f 7373 6962 6c65 2070 726f 6772  d possible progr
+00011f30: 616d 2073 746f 7020 7768 656e 2060 6074  am stop when ``t
+00011f40: 656d 706c 6174 6573 6060 2061 7265 2073  emplates`` are s
+00011f50: 686f 7274 6572 2074 6861 6e0d 0a20 2060  horter than..  `
+00011f60: 6067 616c 6178 7960 6020 2862 7567 2066  `galaxy`` (bug f
+00011f70: 726f 6d20 5639 2e32 2e31 292e 0d0a 0d0a  rom V9.2.1).....
+00011f80: 2d20 6060 7070 7866 6060 3a20 4176 6f69  - ``ppxf``: Avoi
+00011f90: 6420 7472 756e 6361 7469 6e67 2060 6074  d truncating ``t
+00011fa0: 656d 706c 6174 6573 6060 2074 6f20 6060  emplates`` to ``
+00011fb0: 676f 6f64 7069 7865 6c73 6060 2069 6e20  goodpixels`` in 
+00011fc0: 7468 6520 6669 6e61 6c20 706c 6f74 2c0d  the final plot,.
+00011fd0: 0a20 2077 6865 6e20 626f 7468 2060 606c  .  when both ``l
+00011fe0: 616d 6060 2061 6e64 2060 606c 616d 5f74  am`` and ``lam_t
+00011ff0: 656d 7060 6020 7061 7261 6d65 7465 7273  emp`` parameters
+00012000: 2061 7265 2073 7570 706c 6965 642e 2049   are supplied. I
+00012010: 6e73 7465 6164 2c20 7368 6f77 2074 6865  nstead, show the
+00012020: 0d0a 2020 6060 7465 6d70 6c61 7465 7360  ..  ``templates`
+00012030: 6020 6f76 6572 2074 6865 2066 756c 6c20  ` over the full 
+00012040: 6060 6761 6c61 7879 6060 2073 7065 6374  ``galaxy`` spect
+00012050: 7261 6c20 7261 6e67 652e 0d0a 2020 0d0a  ral range...  ..
+00012060: 2d20 6060 7070 7866 6060 3a20 436f 7272  - ``ppxf``: Corr
+00012070: 6563 7465 6420 6265 6861 7669 6f75 7220  ected behaviour 
+00012080: 746f 206f 6e6c 7920 7573 6520 7468 6520  to only use the 
+00012090: 7261 6e67 6520 6265 7477 6565 6e20 7468  range between th
+000120a0: 6520 6669 7273 7420 616e 640d 0a20 206c  e first and..  l
+000120b0: 6173 7420 6060 676f 6f64 7069 7865 6c73  ast ``goodpixels
+000120c0: 6060 2066 6f72 2064 6574 6572 6d69 6e69  `` for determini
+000120d0: 6e67 2074 6865 2076 6572 7469 6361 6c20  ng the vertical 
+000120e0: 706c 6f74 7469 6e67 2072 616e 6765 2e20  plotting range. 
+000120f0: 2054 6861 6e6b 7320 746f 0d0a 2020 4461   Thanks to..  Da
+00012100: 7669 6420 476f 6f64 696e 6720 2863 6863  vid Gooding (chc
+00012110: 682e 6f78 2e61 632e 756b 2920 666f 7220  h.ox.ac.uk) for 
+00012120: 696c 6c75 7374 7261 7469 6e67 2074 6865  illustrating the
+00012130: 2070 726f 626c 656d 2e0d 0a0d 0a2d 2060   problem.....- `
+00012140: 6070 7078 665f 6578 616d 706c 655f 6b69  `ppxf_example_ki
+00012150: 6e65 6d61 7469 6373 5f73 6473 732e 7079  nematics_sdss.py
+00012160: 6060 3a20 4d6f 6469 6669 6564 2074 6865  ``: Modified the
+00012170: 2065 7861 6d70 6c65 2074 6f20 6465 2d72   example to de-r
+00012180: 6564 7368 6966 7420 7468 650d 0a20 2073  edshift the..  s
+00012190: 7065 6374 7275 6d20 6279 2064 6566 6175  pectrum by defau
+000121a0: 6c74 2c20 6d69 6e69 6d69 7a69 6e67 2070  lt, minimizing p
+000121b0: 6f74 656e 7469 616c 2063 6f6e 6675 7369  otential confusi
+000121c0: 6f6e 2e0d 0a0d 0a56 392e 322e 313a 204d  on.....V9.2.1: M
+000121d0: 432c 204f 7866 6f72 642c 2031 3820 4170  C, Oxford, 18 Ap
+000121e0: 7269 6c20 3230 3234 0d0a 2b2b 2b2b 2b2b  ril 2024..++++++
+000121f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00012200: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+00012210: 2060 6073 7073 5f75 7469 6c2e 7379 6e74   ``sps_util.synt
+00012220: 6865 7469 635f 7068 6f74 6f6d 6574 7279  hetic_photometry
+00012230: 6060 3a20 4163 6365 7074 7320 696e 7075  ``: Accepts inpu
+00012240: 7420 7761 7665 6c65 6e67 7468 7320 7468  t wavelengths th
+00012250: 6174 2061 7265 206e 6f74 0d0a 2020 6576  at are not..  ev
+00012260: 656e 6c79 2073 7061 6365 642e 0d0a 2d20  enly spaced...- 
+00012270: 6060 7070 7866 5f75 7469 6c2e 6d61 675f  ``ppxf_util.mag_
+00012280: 7370 6563 7472 756d 6060 3a20 4120 6e65  spectrum``: A ne
+00012290: 7720 6675 6e63 7469 6f6e 2074 6f20 6765  w function to ge
+000122a0: 7420 7468 6520 6170 7061 7265 6e74 206d  t the apparent m
+000122b0: 6167 6e69 7475 6465 2066 726f 6d0d 0a20  agnitude from.. 
+000122c0: 2061 2073 7065 6374 7275 6d20 696e 2061   a spectrum in a
+000122d0: 6e79 2070 686f 746f 6d65 7472 6963 2062  ny photometric b
+000122e0: 616e 642c 2061 7420 616e 7920 7265 6473  and, at any reds
+000122f0: 6869 6674 2c20 696e 2065 6974 6865 7220  hift, in either 
+00012300: 7468 6520 4142 206f 7220 5665 6761 0d0a  the AB or Vega..
+00012310: 2020 6d61 676e 6974 7564 6520 7379 7374    magnitude syst
+00012320: 656d 2e0d 0a2d 2060 6070 7078 6660 603a  em...- ``ppxf``:
+00012330: 204e 6f77 2063 6f6e 7369 6465 7273 2074   Now considers t
+00012340: 6865 2067 6976 656e 2060 6067 6f6f 6470  he given ``goodp
+00012350: 6978 656c 7360 6020 7768 656e 2063 6865  ixels`` when che
+00012360: 636b 696e 6720 7468 6174 2074 6865 0d0a  cking that the..
+00012370: 2020 6060 7465 6d70 6c61 7465 7360 6020    ``templates`` 
+00012380: 636f 7665 7220 7468 6520 6675 6c6c 2060  cover the full `
+00012390: 6067 616c 6178 7960 6020 7370 6563 7472  `galaxy`` spectr
+000123a0: 756d 2c20 6966 2062 6f74 6820 6060 6c61  um, if both ``la
+000123b0: 6d60 6020 616e 640d 0a20 2060 606c 616d  m`` and..  ``lam
+000123c0: 5f74 656d 7060 6020 6172 6520 7072 6f76  _temp`` are prov
+000123d0: 6964 6564 2e0d 0a2d 2060 6070 7078 6660  ided...- ``ppxf`
+000123e0: 603a 2041 6c6c 6f77 2066 6f72 2076 6172  `: Allow for var
+000123f0: 6961 626c 6520 7374 6570 2073 697a 6520  iable step size 
+00012400: 6163 726f 7373 2069 6e74 6572 7661 6c73  across intervals
+00012410: 2061 6e64 2064 696d 656e 7369 6f6e 7320   and dimensions 
+00012420: 696e 2074 6865 0d0a 2020 6e75 6d65 7269  in the..  numeri
+00012430: 6361 6c20 6465 7269 7661 7469 7665 7320  cal derivatives 
+00012440: 7573 6564 2066 6f72 2072 6567 756c 6172  used for regular
+00012450: 697a 6174 696f 6e2c 2077 6974 6820 7468  ization, with th
+00012460: 6520 6e65 7720 6b65 7977 6f72 640d 0a20  e new keyword.. 
+00012470: 2060 6072 6567 5f73 7465 7060 602e 0d0a   ``reg_step``...
+00012480: 2d20 6060 7070 7866 6060 3a20 4176 6f69  - ``ppxf``: Avoi
+00012490: 6473 206e 6577 2060 6053 796e 7461 7857  ds new ``SyntaxW
+000124a0: 6172 6e69 6e67 6060 2069 6e20 4d61 7470  arning`` in Matp
+000124b0: 6c6f 746c 6962 204c 6154 6558 2073 7472  lotlib LaTeX str
+000124c0: 696e 6720 696e 2074 6865 0d0a 2020 6c61  ing in the..  la
+000124d0: 7465 7374 2050 7974 686f 6e20 332e 3132  test Python 3.12
+000124e0: 2e0d 0a2d 2060 6070 7078 6660 603a 2041  ...- ``ppxf``: A
+000124f0: 766f 6964 2070 726f 6772 616d 2073 746f  void program sto
+00012500: 7020 7768 656e 2070 6173 7369 6e67 2061  p when passing a
+00012510: 6e20 696e 7075 7420 636f 7661 7269 616e  n input covarian
+00012520: 6365 206d 6174 7269 7820 7768 696c 650d  ce matrix while.
+00012530: 0a20 2066 6974 7469 6e67 2066 6f72 2067  .  fitting for g
+00012540: 6173 2065 6d69 7373 696f 6e20 6c69 6e65  as emission line
+00012550: 732e 2054 6861 6e6b 7320 746f 204a 6163  s. Thanks to Jac
+00012560: 6b73 6f6e 204f 446f 6e6e 656c 6c20 2875  kson ODonnell (u
+00012570: 6373 632e 6564 7529 2066 6f72 2074 6865  csc.edu) for the
+00012580: 0d0a 2020 7265 706f 7274 2e0d 0a0d 0a56  ..  report.....V
+00012590: 392e 312e 313a 204d 432c 204f 7866 6f72  9.1.1: MC, Oxfor
+000125a0: 642c 2031 3820 4a61 6e75 6172 7920 3230  d, 18 January 20
+000125b0: 3234 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  24..++++++++++++
+000125c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000125d0: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6073  +++++++....- ``s
+000125e0: 7073 5f75 7469 6c2e 6d61 7373 5f74 6f5f  ps_util.mass_to_
+000125f0: 6c69 6768 7460 603a 204e 6f77 2069 7420  light``: Now it 
+00012600: 6361 6e20 6361 6c63 756c 6174 6520 7468  can calculate th
+00012610: 6520 7374 656c 6c61 7220 6d61 7373 2d74  e stellar mass-t
+00012620: 6f2d 6c69 6768 740d 0a20 2072 6174 696f  o-light..  ratio
+00012630: 2028 6060 4d2a 2f4c 6060 2920 666f 7220   (``M*/L``) for 
+00012640: 616e 7920 7374 656c 6c61 7220 706f 7075  any stellar popu
+00012650: 6c61 7469 6f6e 2073 796e 7468 6573 6973  lation synthesis
+00012660: 2028 5350 5329 206d 6f64 656c 2c20 616e   (SPS) model, an
+00012670: 790d 0a20 2066 696c 7465 722c 2061 6e64  y..  filter, and
+00012680: 2061 6e79 2072 6564 7368 6966 742c 2075   any redshift, u
+00012690: 7369 6e67 2074 6865 206f 7574 7075 7420  sing the output 
+000126a0: 7765 6967 6874 7320 6672 6f6d 2060 6070  weights from ``p
+000126b0: 5058 4660 602e 204e 6f20 6e65 6564 2066  PXF``. No need f
+000126c0: 6f72 0d0a 2020 7072 652d 636f 6d70 7574  or..  pre-comput
+000126d0: 6564 2074 6162 6c65 7320 616e 796d 6f72  ed tables anymor
+000126e0: 652e 0d0a 2d20 6060 7070 7866 5f75 7469  e...- ``ppxf_uti
+000126f0: 6c2e 6d61 675f 7375 6e60 603a 2041 206e  l.mag_sun``: A n
+00012700: 6577 2066 756e 6374 696f 6e20 746f 2067  ew function to g
+00012710: 6574 2074 6865 2061 6273 6f6c 7574 6520  et the absolute 
+00012720: 736f 6c61 7220 6d61 676e 6974 7564 6520  solar magnitude 
+00012730: 696e 0d0a 2020 616e 7920 7068 6f74 6f6d  in..  any photom
+00012740: 6574 7269 6320 6261 6e64 2c20 6174 2061  etric band, at a
+00012750: 6e79 2072 6564 7368 6966 742c 2069 6e20  ny redshift, in 
+00012760: 6569 7468 6572 2074 6865 2041 4220 6f72  either the AB or
+00012770: 2056 6567 6120 6d61 676e 6974 7564 650d   Vega magnitude.
+00012780: 0a20 2073 7973 7465 6d2e 0d0a 0d0a 5639  .  system.....V9
+00012790: 2e30 2e32 3a20 4d43 2c20 4f78 666f 7264  .0.2: MC, Oxford
+000127a0: 2c20 3330 204e 6f76 656d 6265 7220 3230  , 30 November 20
+000127b0: 3233 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  23..++++++++++++
+000127c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000127d0: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060  ++++++++....- ``
+000127e0: 7070 7866 6060 3a20 4669 7865 6420 6275  ppxf``: Fixed bu
+000127f0: 6720 696e 2074 6865 2061 7574 6f6d 6174  g in the automat
+00012800: 6963 2074 7275 6e63 6174 696f 6e20 6f66  ic truncation of
+00012810: 2074 6865 2074 656d 706c 6174 6520 7761   the template wa
+00012820: 7665 6c65 6e67 7468 2c0d 0a20 2077 6865  velength,..  whe
+00012830: 6e20 7573 696e 6720 6060 626f 756e 6473  n using ``bounds
+00012840: 6060 2074 6f67 6574 6865 7220 7769 7468  `` together with
+00012850: 2060 606c 616d 6060 2061 6e64 2060 606c   ``lam`` and ``l
+00012860: 616d 5f74 656d 7060 602e 0d0a 0d0a 5639  am_temp``.....V9
+00012870: 2e30 2e31 3a20 4d43 2c20 4f78 666f 7264  .0.1: MC, Oxford
+00012880: 2c20 3132 204e 6f76 656d 6265 7220 3230  , 12 November 20
+00012890: 3233 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  23..++++++++++++
+000128a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000128b0: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5265  ++++++++....- Re
+000128c0: 706c 6163 6564 2060 606d 696c 6573 5f75  placed ``miles_u
+000128d0: 7469 6c60 6020 7769 7468 2060 6073 7073  til`` with ``sps
+000128e0: 5f75 7469 6c60 602c 2061 2076 6572 7361  _util``, a versa
+000128f0: 7469 6c65 2061 6e64 2066 6c65 7869 626c  tile and flexibl
+00012900: 6520 6675 6e63 7469 6f6e 0d0a 2020 7468  e function..  th
+00012910: 6174 2073 7570 706f 7274 7320 7661 7269  at supports vari
+00012920: 6f75 7320 7374 656c 6c61 7220 706f 7075  ous stellar popu
+00012930: 6c61 7469 6f6e 2073 796e 7468 6573 6973  lation synthesis
+00012940: 2028 5350 5329 206d 6f64 656c 732e 2043   (SPS) models. C
+00012950: 7572 7265 6e74 6c79 2c20 490d 0a20 2064  urrently, I..  d
+00012960: 6973 7472 6962 7574 6520 2877 6974 6820  istribute (with 
+00012970: 7065 726d 6973 7369 6f6e 2920 7468 6520  permission) the 
+00012980: 6060 452d 4d49 4c45 5360 6020 2856 617a  ``E-MILES`` (Vaz
+00012990: 6465 6b69 732b 3230 3136 292c 2060 6047  dekis+2016), ``G
+000129a0: 414c 4158 4556 6060 0d0a 2020 2842 7275  ALAXEV``..  (Bru
+000129b0: 7a75 616c 2026 2043 6861 726c 6f74 2032  zual & Charlot 2
+000129c0: 3030 3329 2061 6e64 2060 6066 7370 7360  003) and ``fsps`
+000129d0: 6020 2843 6f6e 726f 792b 3230 3039 2c32  ` (Conroy+2009,2
+000129e0: 3031 3029 2073 7465 6c6c 6172 2070 6f70  010) stellar pop
+000129f0: 756c 6174 696f 6e0d 0a20 2074 656d 706c  ulation..  templ
+00012a00: 6174 6573 2e20 4f6e 6520 6361 6e20 6e6f  ates. One can no
+00012a10: 7720 6368 616e 6765 2053 5053 2062 7920  w change SPS by 
+00012a20: 6a75 7374 206d 6f64 6966 7969 6e67 2074  just modifying t
+00012a30: 6865 2066 696c 656e 616d 652e 0d0a 2020  he filename...  
+00012a40: 0d0a 2020 494d 504f 5254 414e 543a 2049  ..  IMPORTANT: I
+00012a50: 206e 6f20 6c6f 6e67 6572 2069 6e63 6c75   no longer inclu
+00012a60: 6465 2074 6865 2053 5053 206d 6f64 656c  de the SPS model
+00012a70: 7320 696e 2074 6865 2060 6070 5058 4660  s in the ``pPXF`
+00012a80: 6020 7061 636b 6167 652c 2064 7565 2074  ` package, due t
+00012a90: 6f0d 0a20 2066 696c 6520 7369 7a65 2063  o..  file size c
+00012aa0: 6f6e 7374 7261 696e 7473 2e20 4f6e 6520  onstraints. One 
+00012ab0: 6d75 7374 2064 6f77 6e6c 6f61 6420 7468  must download th
+00012ac0: 6520 5350 5320 7465 6d70 6c61 7465 7320  e SPS templates 
+00012ad0: 7365 7061 7261 7465 6c79 2061 6674 6572  separately after
+00012ae0: 0d0a 2020 7468 6520 6060 7050 5846 6060  ..  the ``pPXF``
+00012af0: 2069 6e73 7461 6c6c 6174 696f 6e2c 2061   installation, a
+00012b00: 7320 6465 6d6f 6e73 7472 6174 6564 2069  s demonstrated i
+00012b10: 6e20 616c 6c20 7468 6520 6060 7050 5846  n all the ``pPXF
+00012b20: 6060 2065 7861 6d70 6c65 732e 0d0a 2d20  `` examples...- 
+00012b30: 4920 6164 6170 7465 6420 616c 6c20 6578  I adapted all ex
+00012b40: 616d 706c 6573 2069 6e63 6c75 6465 6420  amples included 
+00012b50: 696e 2074 6865 2070 6163 6b61 6765 2074  in the package t
+00012b60: 6f20 7573 6520 7468 6520 6e65 7720 6060  o use the new ``
+00012b70: 7370 735f 7574 696c 6060 2e20 0d0a 2d20  sps_util``. ..- 
+00012b80: 6060 7070 7866 2e70 6c6f 7460 603a 204e  ``ppxf.plot``: N
+00012b90: 6577 206b 6579 776f 7264 2060 606c 616d  ew keyword ``lam
+00012ba0: 5f66 6c61 6d60 6020 746f 2070 6c6f 7420  _flam`` to plot 
+00012bb0: 6060 6c61 6d2a 6628 6c61 6d29 203d 206e  ``lam*f(lam) = n
+00012bc0: 752a 6628 6e75 2960 602e 0d0a 2d20 6060  u*f(nu)``...- ``
+00012bd0: 7070 7866 5f75 7469 6c2e 7379 6e74 6865  ppxf_util.synthe
+00012be0: 7469 635f 7068 6f74 6f6d 6574 7279 6060  tic_photometry``
+00012bf0: 3a20 436f 6e76 6572 7465 6420 6672 6f6d  : Converted from
+00012c00: 2061 2066 756e 6374 696f 6e20 746f 2061   a function to a
+00012c10: 2063 6c61 7373 2e0d 0a20 2041 6464 6564   class...  Added
+00012c20: 2060 602e 6c61 6d5f 7069 7660 6020 6174   ``.lam_piv`` at
+00012c30: 7472 6962 7574 6520 746f 2063 6f6d 7075  tribute to compu
+00012c40: 7465 2074 6865 2070 6976 6f74 2077 6176  te the pivot wav
+00012c50: 656c 656e 6774 6820 6f66 2065 6163 6820  elength of each 
+00012c60: 6669 6c74 6572 2e0d 0a2d 2060 6070 7078  filter...- ``ppx
+00012c70: 665f 7574 696c 2e76 6172 736d 6f6f 7468  f_util.varsmooth
+00012c80: 6060 3a20 5370 6563 6961 6c69 7a65 6420  ``: Specialized 
+00012c90: 6661 7374 6572 2063 6f6e 766f 6c75 7469  faster convoluti
+00012ca0: 6f6e 2069 6620 7369 676d 6120 6973 2061  on if sigma is a
+00012cb0: 2073 6361 6c61 722e 0d0a 2020 7768 696c   scalar...  whil
+00012cc0: 6520 7573 696e 6720 7468 6520 616e 616c  e using the anal
+00012cd0: 7974 6963 2046 6f75 7269 6572 2074 7261  ytic Fourier tra
+00012ce0: 6e73 666f 726d 2074 6f20 6465 616c 2077  nsform to deal w
+00012cf0: 6974 6820 756e 6465 7273 616d 706c 696e  ith undersamplin
+00012d00: 672e 0d0a 2d20 6060 7070 7866 6060 3a20  g...- ``ppxf``: 
+00012d10: 5261 6973 6564 2061 6e20 6572 726f 7220  Raised an error 
+00012d20: 6966 2060 6070 686f 7460 6020 696e 7075  if ``phot`` inpu
+00012d30: 7420 6973 206e 6f74 2066 696e 6974 652e  t is not finite.
+00012d40: 0d0a 0d0a 5638 2e32 2e36 3a20 4d43 2c20  ....V8.2.6: MC, 
+00012d50: 4f78 666f 7264 2c20 3620 4a75 6c79 2032  Oxford, 6 July 2
+00012d60: 3032 330d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  023..+++++++++++
+00012d70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00012d80: 2b2b 2b2b 0d0a 0d0a 2d20 6060 6361 7066  ++++....- ``capf
+00012d90: 6974 6060 3a20 5265 6c61 7865 6420 746f  it``: Relaxed to
+00012da0: 6c65 7261 6e63 6520 7768 656e 2063 6865  lerance when che
+00012db0: 636b 696e 6720 696e 6974 6961 6c20 6775  cking initial gu
+00012dc0: 6573 7320 6665 6173 6962 696c 6974 792e  ess feasibility.
+00012dd0: 0d0a 2d20 6060 7070 7866 5f75 7469 6c60  ..- ``ppxf_util`
+00012de0: 603a 2046 6978 6564 2070 726f 6772 616d  `: Fixed program
+00012df0: 2073 746f 7020 696e 2060 6067 6175 7373   stop in ``gauss
+00012e00: 6961 6e5f 6669 6c74 6572 3164 6060 2077  ian_filter1d`` w
+00012e10: 6865 6e20 6060 7369 673d 3060 602e 0d0a  hen ``sig=0``...
+00012e20: 2020 5468 616e 6b73 2074 6f20 4a65 7373    Thanks to Jess
+00012e30: 6520 5661 6e20 6465 2053 616e 6465 2028  e Van de Sande (
+00012e40: 7379 646e 6579 2e65 6475 2e61 7529 2066  sydney.edu.au) f
+00012e50: 6f72 2074 6865 2072 6570 6f72 742e 0d0a  or the report...
+00012e60: 0d0a 5638 2e32 2e34 3a20 4d43 2c20 4f78  ..V8.2.4: MC, Ox
+00012e70: 666f 7264 2c20 3132 204d 6179 2032 3032  ford, 12 May 202
+00012e80: 330d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  3..+++++++++++++
+00012e90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00012ea0: 2b2b 0d0a 0d0a 2d20 6060 7070 7866 6060  ++....- ``ppxf``
+00012eb0: 3a20 4669 7865 6420 696e 636f 7272 6563  : Fixed incorrec
+00012ec0: 746c 7920 7377 6974 6368 696e 6720 746f  tly switching to
+00012ed0: 2060 606d 6574 686f 643d 276c 696e 6561   ``method='linea
+00012ee0: 7227 6060 2077 6865 6e20 7265 7175 6573  r'`` when reques
+00012ef0: 7469 6e67 0d0a 2020 746f 2066 6974 2073  ting..  to fit s
+00012f00: 7465 6c6c 6172 2072 6564 6465 6e69 6e67  tellar reddening
+00012f10: 2061 6c6f 6e65 2c20 7768 696c 6520 616c   alone, while al
+00012f20: 6c20 6f74 6865 7220 7061 7261 6d65 7465  l other paramete
+00012f30: 7273 2061 7265 2066 6978 6564 2e20 5468  rs are fixed. Th
+00012f40: 616e 6b73 0d0a 2020 746f 204a 6f6e 6720  anks..  to Jong 
+00012f50: 4368 756c 204c 6565 2028 6b61 7369 2e72  Chul Lee (kasi.r
+00012f60: 652e 6b72 2920 666f 7220 6120 636c 6561  e.kr) for a clea
+00012f70: 7220 6578 616d 706c 6520 6f66 2072 6570  r example of rep
+00012f80: 726f 6475 6369 6e67 2074 6865 2062 7567  roducing the bug
+00012f90: 2e0d 0a0d 0a56 382e 322e 333a 204d 432c  .....V8.2.3: MC,
+00012fa0: 204f 7866 6f72 642c 2035 204a 616e 7561   Oxford, 5 Janua
+00012fb0: 7279 2032 3032 330d 0a2b 2b2b 2b2b 2b2b  ry 2023..+++++++
+00012fc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00012fd0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+00012fe0: 2060 6070 7078 6660 603a 2046 6978 6564   ``ppxf``: Fixed
+00012ff0: 2070 726f 6772 616d 2073 746f 7020 7768   program stop wh
+00013000: 656e 2066 6974 7469 6e67 2062 6f74 6820  en fitting both 
+00013010: 736b 7920 7370 6563 7472 6120 616e 6420  sky spectra and 
+00013020: 6761 7320 656d 6973 7369 6f6e 0d0a 2020  gas emission..  
+00013030: 6c69 6e65 732e 204d 616e 7920 7468 616e  lines. Many than
+00013040: 6b73 2074 6f20 4164 6172 7368 2052 616e  ks to Adarsh Ran
+00013050: 6a61 6e20 286b 6173 692e 7265 2e6b 7229  jan (kasi.re.kr)
+00013060: 2066 6f72 2061 2063 6c65 6172 2065 7861   for a clear exa
+00013070: 6d70 6c65 0d0a 2020 6f66 2072 6570 726f  mple..  of repro
+00013080: 6475 6369 6e67 2074 6865 2070 726f 626c  ducing the probl
+00013090: 656d 2061 6e64 2066 6f72 2074 6865 2062  em and for the b
+000130a0: 7567 2066 6978 2e0d 0a2d 2060 6070 7078  ug fix...- ``ppx
+000130b0: 6660 603a 2052 6169 7365 2061 6e20 6572  f``: Raise an er
+000130c0: 726f 7220 6966 2060 6076 656c 7363 616c  ror if ``velscal
+000130d0: 6560 6020 6973 206e 6f74 2061 2073 6361  e`` is not a sca
+000130e0: 6c61 722e 2055 7064 6174 6564 2065 7861  lar. Updated exa
+000130f0: 6d70 6c65 0d0a 2020 7072 6f63 6564 7572  mple..  procedur
+00013100: 6573 2e20 5468 6973 2066 6978 6573 2061  es. This fixes a
+00013110: 2070 726f 6772 616d 2073 746f 7020 6475   program stop du
+00013120: 6520 746f 2061 2063 6861 6e67 6520 696e  e to a change in
+00013130: 204e 756d 5079 2031 2e32 342e 0d0a 2d20   NumPy 1.24...- 
+00013140: 6060 7070 7866 5f75 7469 6c60 603a 2043  ``ppxf_util``: C
+00013150: 6861 6e67 6564 2060 606c 6f67 5f72 6562  hanged ``log_reb
+00013160: 696e 6060 2074 6f20 7265 7475 726e 2060  in`` to return `
+00013170: 6076 656c 7363 616c 6560 6020 6173 2061  `velscale`` as a
+00013180: 2073 6361 6c61 722e 0d0a 2d20 4e65 7720   scalar...- New 
+00013190: 6578 616d 706c 6520 7072 6f63 6564 7572  example procedur
+000131a0: 6520 6060 7070 7866 5f65 7861 6d70 6c65  e ``ppxf_example
+000131b0: 5f67 6173 5f73 6473 735f 7469 6564 2e70  _gas_sdss_tied.p
+000131c0: 7960 6020 746f 2069 6c6c 7573 7472 6174  y`` to illustrat
+000131d0: 6520 7468 650d 0a20 2075 7365 206f 6620  e the..  use of 
+000131e0: 7468 6520 6060 7469 6564 6060 2061 6e64  the ``tied`` and
+000131f0: 2060 6063 6f6e 7374 725f 6b69 6e65 6d60   ``constr_kinem`
+00013200: 6020 6b65 7977 6f72 6473 2e0d 0a0d 0a56  ` keywords.....V
+00013210: 382e 322e 323a 204d 432c 204f 7866 6f72  8.2.2: MC, Oxfor
+00013220: 642c 2031 3120 4f63 746f 6265 7220 3230  d, 11 October 20
+00013230: 3232 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  22..++++++++++++
+00013240: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00013250: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6070  +++++++....- ``p
+00013260: 7078 6660 603a 2046 6978 6564 2070 726f  pxf``: Fixed pro
+00013270: 6772 616d 2073 746f 7020 7769 7468 2060  gram stop with `
+00013280: 6074 6965 6460 6020 6f72 2060 6066 6978  `tied`` or ``fix
+00013290: 6564 6060 206b 6579 776f 7264 7320 616e  ed`` keywords an
+000132a0: 640d 0a20 206e 6f6e 6c69 6e65 6172 2076  d..  nonlinear v
+000132b0: 6172 6961 626c 6573 2069 6e20 6164 6469  ariables in addi
+000132c0: 7469 6f6e 2074 6f20 7468 6520 6b69 6e65  tion to the kine
+000132d0: 6d61 7469 6373 2e20 5468 616e 6b73 2074  matics. Thanks t
+000132e0: 6f20 546f 6269 6173 204c 6f6f 7365 720d  o Tobias Looser.
+000132f0: 0a20 2028 6361 6d2e 6163 2e75 6b29 2066  .  (cam.ac.uk) f
+00013300: 6f72 2074 6865 2072 6570 6f72 7420 616e  or the report an
+00013310: 6420 6669 782e 0d0a 0d0a 5638 2e32 2e31  d fix.....V8.2.1
+00013320: 3a20 4d43 2c20 4f78 666f 7264 2c20 3320  : MC, Oxford, 3 
+00013330: 5365 7074 656d 6265 7220 3230 3232 0d0a  September 2022..
+00013340: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00013350: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00013360: 2b2b 2b2b 0d0a 0d0a 2d20 6060 7070 7866  ++++....- ``ppxf
+00013370: 6060 3a20 4e65 7720 6b65 7977 6f72 6420  ``: New keyword 
+00013380: 6060 6475 7374 6060 2077 6869 6368 2061  ``dust`` which a
+00013390: 6c6c 6f77 7320 6f6e 6520 746f 2061 7373  llows one to ass
+000133a0: 6f63 6961 7465 2064 6966 6665 7265 6e74  ociate different
+000133b0: 0d0a 2020 6765 6e65 7261 6c20 6174 7465  ..  general atte
+000133c0: 6e75 6174 696f 6e20 6675 6e63 7469 6f6e  nuation function
+000133d0: 7320 746f 2064 6966 6665 7265 6e74 2073  s to different s
+000133e0: 6574 7320 6f66 2074 656d 706c 6174 6573  ets of templates
+000133f0: 2e20 5468 6973 2069 7320 7573 6566 756c  . This is useful
+00013400: 0d0a 2020 666f 7220 6578 616d 706c 6520  ..  for example 
+00013410: 746f 2061 7070 6c79 2074 6872 6565 2064  to apply three d
+00013420: 6966 6665 7265 6e74 2061 7474 656e 7561  ifferent attenua
+00013430: 7469 6f6e 2066 756e 6374 696f 6e73 2074  tion functions t
+00013440: 6f20 7468 6520 796f 756e 6720 616e 640d  o the young and.
+00013450: 0a20 206f 6c64 2073 7465 6c6c 6172 2074  .  old stellar t
+00013460: 656d 706c 6174 6573 2061 6e64 2074 6f20  emplates and to 
+00013470: 7468 6520 6761 7320 656d 6973 7369 6f6e  the gas emission
+00013480: 206c 696e 6573 2072 6573 7065 6374 6976   lines respectiv
+00013490: 656c 792e 0d0a 2d20 6060 7070 7866 6060  ely...- ``ppxf``
+000134a0: 3a20 5573 6573 2060 6041 5f56 6060 2069  : Uses ``A_V`` i
+000134b0: 6e73 7465 6164 206f 6620 6060 4528 422d  nstead of ``E(B-
+000134c0: 5629 6060 2074 6f20 7061 7261 6d65 7472  V)`` to parametr
+000134d0: 697a 6520 6174 7465 6e75 6174 696f 6e2c  ize attenuation,
+000134e0: 2077 6865 6e0d 0a20 2075 7369 6e67 2074   when..  using t
+000134f0: 6865 206e 6f77 2d6f 6273 6f6c 6574 6520  he now-obsolete 
+00013500: 6b65 7977 6f72 6473 2060 6072 6564 6465  keywords ``redde
+00013510: 6e69 6e67 6060 2061 6e64 2020 6060 6761  ning`` and  ``ga
+00013520: 735f 7265 6464 656e 696e 6760 602e 0d0a  s_reddening``...
+00013530: 2d20 6060 7070 7866 6060 3a20 4e65 7720  - ``ppxf``: New 
+00013540: 6465 6661 756c 7420 6675 6e63 7469 6f6e  default function
+00013550: 2060 6061 7474 656e 7561 7469 6f6e 2829   ``attenuation()
+00013560: 6060 2e20 486f 7765 7665 722c 206f 6e65  ``. However, one
+00013570: 2063 616e 206e 6f77 2075 7365 0d0a 2020   can now use..  
+00013580: 6765 6e65 7261 6c20 6174 7465 6e75 6174  general attenuat
+00013590: 696f 6e20 6675 6e63 7469 6f6e 7320 7769  ion functions wi
+000135a0: 7468 2061 6e20 6172 6269 7472 6172 7920  th an arbitrary 
+000135b0: 6e75 6d62 6572 206f 6620 626f 756e 6420  number of bound 
+000135c0: 6f72 2066 6978 6564 0d0a 2020 7061 7261  or fixed..  para
+000135d0: 6d65 7465 7273 2e0d 0a2d 2060 6070 7078  meters...- ``ppx
+000135e0: 6660 603a 204e 6577 2069 6e74 6572 6e61  f``: New interna
+000135f0: 6c20 6675 6e63 7469 6f6e 7320 6060 7365  l functions ``se
+00013600: 745f 6c61 6d5f 696e 7075 7460 602c 2060  t_lam_input``, `
+00013610: 6073 6574 5f67 6173 5f69 6e70 7574 6060  `set_gas_input``
+00013620: 2c0d 0a20 2060 6073 6574 5f64 7573 745f  ,..  ``set_dust_
+00013630: 696e 7075 7460 602c 2060 6073 6574 5f70  input``, ``set_p
+00013640: 686f 745f 696e 7075 7460 6020 746f 206f  hot_input`` to o
+00013650: 7267 616e 697a 6520 7468 6520 636f 6465  rganize the code
+00013660: 2e0d 0a2d 2060 6070 7078 6660 603a 2049  ...- ``ppxf``: I
+00013670: 6d70 726f 7665 6420 7665 7274 6963 616c  mproved vertical
+00013680: 2073 6361 6c69 6e67 206f 6620 6465 6661   scaling of defa
+00013690: 756c 7420 706c 6f74 732e 0d0a 2d20 6060  ult plots...- ``
+000136a0: 7070 7866 6060 3a20 4e65 7720 6b65 7977  ppxf``: New keyw
+000136b0: 6f72 6473 2060 6070 702e 706c 6f74 2873  ords ``pp.plot(s
+000136c0: 7065 633d 5472 7565 2c20 7068 6f74 3d54  pec=True, phot=T
+000136d0: 7275 6529 6060 2074 6f20 706c 6f74 206f  rue)`` to plot o
+000136e0: 6e6c 7920 7468 650d 0a20 2070 686f 746f  nly the..  photo
+000136f0: 6d65 7472 6963 206f 7220 7370 6563 7472  metric or spectr
+00013700: 6f73 636f 7069 6320 6265 7374 2066 6974  oscopic best fit
+00013710: 7320 7265 7370 6563 7469 7665 6c79 2e0d  s respectively..
+00013720: 0a2d 2060 6070 7078 665f 7574 696c 6060  .- ``ppxf_util``
+00013730: 3a20 4e65 7720 6675 6e63 7469 6f6e 2060  : New function `
+00013740: 6076 6172 736d 6f6f 7468 6060 2066 6f72  `varsmooth`` for
+00013750: 2047 6175 7373 6961 6e20 636f 6e76 6f6c   Gaussian convol
+00013760: 7574 696f 6e20 7769 7468 2061 0d0a 2020  ution with a..  
+00013770: 7661 7269 6162 6c65 2073 6967 6d61 2e20  variable sigma. 
+00013780: 556e 6c69 6b65 2074 6865 2073 696d 696c  Unlike the simil
+00013790: 6172 2060 6067 6175 7373 6961 6e5f 6669  ar ``gaussian_fi
+000137a0: 6c74 6572 3164 6060 2c20 7468 6973 206e  lter1d``, this n
+000137b0: 6577 2066 756e 6374 696f 6e0d 0a20 2075  ew function..  u
+000137c0: 7365 7320 4646 5420 616e 6420 7468 6520  ses FFT and the 
+000137d0: 616e 616c 7974 6963 2046 6f75 7269 6572  analytic Fourier
+000137e0: 2054 7261 6e73 666f 726d 206f 6620 6120   Transform of a 
+000137f0: 4761 7573 7369 616e 2c20 6c69 6b65 2060  Gaussian, like `
+00013800: 6070 7078 6660 602e 0d0a 2d20 6060 7070  `ppxf``...- ``pp
+00013810: 7866 5f75 7469 6c60 603a 2049 6e63 6c75  xf_util``: Inclu
+00013820: 6465 6420 6164 6469 7469 6f6e 616c 2067  ded additional g
+00013830: 6173 2065 6d69 7373 696f 6e20 6c69 6e65  as emission line
+00013840: 7320 696e 2060 6065 6d69 7373 696f 6e5f  s in ``emission_
+00013850: 6c69 6e65 7328 2960 602e 0d0a 2d20 6060  lines()``...- ``
+00013860: 6361 7066 6974 6060 3a20 5573 6520 6060  capfit``: Use ``
+00013870: 7363 6970 792e 6f70 7469 6d69 7a65 2e6c  scipy.optimize.l
+00013880: 696e 7072 6f67 286d 6574 686f 643d 2768  inprog(method='h
+00013890: 6967 6873 2729 6060 2074 6f20 6669 6e64  ighs')`` to find
+000138a0: 2066 6561 7369 626c 650d 0a20 2073 7461   feasible..  sta
+000138b0: 7274 696e 6720 706f 696e 7420 696e 2060  rting point in `
+000138c0: 606c 7371 5f6c 696e 6060 2e20 5468 6973  `lsq_lin``. This
+000138d0: 2065 6c69 6d69 6e61 7465 7320 706f 7373   eliminates poss
+000138e0: 6962 6c65 2070 726f 6772 616d 2073 746f  ible program sto
+000138f0: 7073 2069 6e0d 0a20 2063 6572 7461 696e  ps in..  certain
+00013900: 2073 6974 7561 7469 6f6e 7320 7769 7468   situations with
+00013910: 206c 696e 6561 726c 7920 6465 7065 6e64   linearly depend
+00013920: 656e 7420 636f 6e73 7472 6169 6e74 732e  ent constraints.
+00013930: 0d0a 2d20 6060 6361 7066 6974 6060 3a20  ..- ``capfit``: 
+00013940: 5365 7420 6465 6661 756c 7420 6060 6c69  Set default ``li
+00013950: 6e65 6172 5f6d 6574 686f 643d 276c 7371  near_method='lsq
+00013960: 5f6c 696e 2760 602e 2054 6869 7320 7265  _lin'``. This re
+00013970: 6d6f 7665 7320 7468 6520 6e65 6564 0d0a  moves the need..
+00013980: 2020 746f 2069 6e73 7461 6c6c 2060 6063    to install ``c
+00013990: 7678 6f70 7460 6020 7768 656e 2075 7369  vxopt`` when usi
+000139a0: 6e67 2060 6063 6f6e 7374 725f 6b69 6e65  ng ``constr_kine
+000139b0: 6d60 6020 696e 2060 6070 5058 4660 602e  m`` in ``pPXF``.
+000139c0: 0d0a 0d0a 5638 2e31 2e30 3a20 4d43 2c20  ....V8.1.0: MC, 
+000139d0: 4f78 666f 7264 2c20 3130 204a 756e 6520  Oxford, 10 June 
+000139e0: 3230 3232 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2022..++++++++++
+000139f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00013a00: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060 7070  ++++++....- ``pp
+00013a10: 7866 6060 3a20 4d6f 7265 2061 6363 7572  xf``: More accur
+00013a20: 6174 6520 6465 7465 726d 696e 6174 696f  ate determinatio
+00013a30: 6e20 6f66 2074 6865 2072 616e 6765 2066  n of the range f
+00013a40: 6f72 2074 7275 6e63 6174 696e 6720 7468  or truncating th
+00013a50: 650d 0a20 2074 656d 706c 6174 6573 2077  e..  templates w
+00013a60: 6865 6e20 7061 7373 696e 6720 626f 7468  hen passing both
+00013a70: 2060 606c 616d 5f74 656d 7060 6020 616e   ``lam_temp`` an
+00013a80: 6420 6060 6c61 6d60 602e 0d0a 2d20 6060  d ``lam``...- ``
+00013a90: 7070 7866 6060 3a20 4368 6563 6b20 666f  ppxf``: Check fo
+00013aa0: 7220 6060 6c61 6d60 6020 6f72 2060 606c  r ``lam`` or ``l
+00013ab0: 616d 5f74 656d 7060 6020 636f 6e73 6973  am_temp`` consis
+00013ac0: 7465 6e63 7920 7769 7468 2060 6076 656c  tency with ``vel
+00013ad0: 7363 616c 6560 6020 616e 640d 0a20 2072  scale`` and..  r
+00013ae0: 6574 7572 6e20 616e 2065 7272 6f72 2069  eturn an error i
+00013af0: 6620 7468 6579 2064 6f20 6e6f 7420 6d61  f they do not ma
+00013b00: 7463 682e 0d0a 2d20 6060 7070 7866 6060  tch...- ``ppxf``
+00013b10: 3a20 5573 6520 6d69 6372 6f6d 6574 7265  : Use micrometre
+00013b20: 2075 6e69 7473 2061 6e64 2064 656e 7365   units and dense
+00013b30: 7220 7469 636b 206c 6162 656c 7320 666f  r tick labels fo
+00013b40: 7220 7468 6520 6c6f 6761 7269 7468 6d69  r the logarithmi
+00013b50: 630d 0a20 2077 6176 656c 656e 6774 6820  c..  wavelength 
+00013b60: 6178 6973 2e0d 0a2d 2060 6070 7078 665f  axis...- ``ppxf_
+00013b70: 7574 696c 2e73 796e 7468 6574 6963 5f70  util.synthetic_p
+00013b80: 686f 746f 6d65 7472 7960 603a 206d 6f76  hotometry``: mov
+00013b90: 6564 2066 726f 6d20 6060 6d69 6c65 735f  ed from ``miles_
+00013ba0: 7574 696c 6060 2061 6e64 206d 6164 6520  util`` and made 
+00013bb0: 6974 0d0a 2020 696e 6465 7065 6e64 656e  it..  independen
+00013bc0: 7420 6f66 2074 6865 2073 7465 6c6c 6172  t of the stellar
+00013bd0: 206c 6962 7261 7279 2e20 4164 6f70 7465   library. Adopte
+00013be0: 6420 7468 6520 7361 6d65 2066 696c 7465  d the same filte
+00013bf0: 7220 6669 6c65 2066 6f72 6d61 7420 6173  r file format as
+00013c00: 0d0a 2020 4541 5a59 2c20 4641 5354 2c20  ..  EAZY, FAST, 
+00013c10: 4879 7065 725a 2e2e 2e20 666f 7220 696e  HyperZ... for in
+00013c20: 7465 726f 7065 7261 6269 6c69 7479 2e0d  teroperability..
+00013c30: 0a20 2041 6c6c 6f77 2070 6173 7369 6e67  .  Allow passing
+00013c40: 2061 2066 696c 6520 7769 7468 2075 7365   a file with use
+00013c50: 722d 6465 6669 6e65 6420 6669 6c74 6572  r-defined filter
+00013c60: 2072 6573 706f 6e73 6520 6675 6e63 7469   response functi
+00013c70: 6f6e 732e 0d0a 2d20 6060 7070 7866 5f75  ons...- ``ppxf_u
+00013c80: 7469 6c2e 6c6f 675f 7265 6269 6e60 603a  til.log_rebin``:
+00013c90: 2053 7570 706f 7274 2069 7272 6567 756c   Support irregul
+00013ca0: 6172 6c79 2073 616d 706c 6564 2069 6e70  arly sampled inp
+00013cb0: 7574 2077 6176 656c 656e 6774 682e 0d0a  ut wavelength...
+00013cc0: 2d20 6060 7070 7866 5f75 7469 6c2e 6761  - ``ppxf_util.ga
+00013cd0: 7573 7369 616e 5f66 696c 7465 7231 6460  ussian_filter1d`
+00013ce0: 603a 204e 6577 206b 6579 776f 7264 2060  `: New keyword `
+00013cf0: 606d 6f64 653d 2763 6f6e 7374 616e 7427  `mode='constant'
+00013d00: 6060 206f 720d 0a20 2060 606d 6f64 653d  `` or..  ``mode=
+00013d10: 2777 7261 7027 6060 2e0d 0a2d 2055 7064  'wrap'``...- Upd
+00013d20: 6174 6564 2060 6070 7078 665f 6578 616d  ated ``ppxf_exam
+00013d30: 706c 655f 706f 7075 6c61 7469 6f6e 5f70  ple_population_p
+00013d40: 686f 746f 6d65 7472 792e 7079 6060 0d0a  hotometry.py``..
+00013d50: 0d0a 5638 2e30 2e32 3a20 4d43 2c20 4f78  ..V8.0.2: MC, Ox
+00013d60: 666f 7264 2c20 3238 204d 6172 6368 2032  ford, 28 March 2
+00013d70: 3032 320d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  022..+++++++++++
+00013d80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00013d90: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060 7070  ++++++....- ``pp
+00013da0: 7866 6060 3a20 416c 6c6f 7720 6669 7474  xf``: Allow fitt
+00013db0: 696e 6720 7068 6f74 6f6d 6574 7269 6320  ing photometric 
+00013dc0: 6d65 6173 7572 656d 656e 7473 2028 5345  measurements (SE
+00013dd0: 4420 6669 7474 696e 6729 2074 6f67 6574  D fitting) toget
+00013de0: 6865 7220 7769 7468 0d0a 2020 6120 7370  her with..  a sp
+00013df0: 6563 7472 756d 2e20 5468 6973 2069 7320  ectrum. This is 
+00013e00: 696d 706c 656d 656e 7465 6420 7669 6120  implemented via 
+00013e10: 7468 6520 6e65 7720 6b65 7977 6f72 6420  the new keyword 
+00013e20: 6060 7068 6f74 6060 2070 6173 7369 6e67  ``phot`` passing
+00013e30: 2061 0d0a 2020 6469 6374 696f 6e61 7279   a..  dictionary
+00013e40: 206f 6620 7061 7261 6d65 7465 7273 2e0d   of parameters..
+00013e50: 0a2d 2060 6070 7078 6660 603a 2070 6c6f  .- ``ppxf``: plo
+00013e60: 7420 7068 6f74 6f6d 6574 7269 6320 6669  t photometric fi
+00013e70: 7420 746f 6765 7468 6572 2077 6974 6820  t together with 
+00013e80: 7370 6563 7472 756d 2077 6865 6e20 6669  spectrum when fi
+00013e90: 7474 696e 670d 0a20 2070 686f 746f 6d65  tting..  photome
+00013ea0: 7472 792e 0d0a 2d20 6060 7070 7866 6060  try...- ``ppxf``
+00013eb0: 3a20 4e65 7720 6b65 7977 6f72 6420 6060  : New keyword ``
+00013ec0: 6c61 6d5f 7465 6d70 6060 2074 6f20 696e  lam_temp`` to in
+00013ed0: 7075 7420 7468 6520 7465 6d70 6c61 7465  put the template
+00013ee0: 7320 7761 7665 6c65 6e67 7468 2e20 5768  s wavelength. Wh
+00013ef0: 656e 0d0a 2020 7468 6973 2069 7320 6769  en..  this is gi
+00013f00: 7665 6e2c 2074 6f67 6574 6865 7220 7769  ven, together wi
+00013f10: 7468 2074 6865 2067 616c 6178 7920 7761  th the galaxy wa
+00013f20: 7665 6c65 6e67 7468 2060 606c 616d 6060  velength ``lam``
+00013f30: 2c20 7468 6520 7465 6d70 6c61 7465 7320  , the templates 
+00013f40: 6172 650d 0a20 2061 7574 6f6d 6174 6963  are..  automatic
+00013f50: 616c 6c79 2074 7275 6e63 6174 6564 2074  ally truncated t
+00013f60: 6f20 616e 206f 7074 696d 616c 2077 6176  o an optimal wav
+00013f70: 656c 656e 6774 6820 7261 6e67 652c 2061  elength range, a
+00013f80: 6e64 2069 7420 6265 636f 6d65 730d 0a20  nd it becomes.. 
+00013f90: 2075 6e6e 6563 6573 7361 7279 2074 6f20   unnecessary to 
+00013fa0: 7573 6520 7468 6520 6b65 7977 6f72 6420  use the keyword 
+00013fb0: 6060 7673 7973 7460 602e 0d0a 2d20 6060  ``vsyst``...- ``
+00013fc0: 7070 7866 6060 3a20 5761 726e 696e 6720  ppxf``: Warning 
+00013fd0: 6966 2060 6074 656d 706c 6174 6573 6060  if ``templates``
+00013fe0: 2061 7265 2060 603e 2032 7860 6020 6c6f   are ``> 2x`` lo
+00013ff0: 6e67 6572 2074 6861 6e20 6060 6761 6c61  nger than ``gala
+00014000: 7879 6060 2e0d 0a2d 2060 6070 7078 6660  xy``...- ``ppxf`
+00014010: 603a 2057 6865 6e20 6669 7474 696e 6720  `: When fitting 
+00014020: 7068 6f74 6f6d 6574 7279 206f 6e65 2063  photometry one c
+00014030: 616e 2069 6e70 7574 2065 7874 656e 6465  an input extende
+00014040: 6420 7465 6d70 6c61 7465 2073 7065 6374  d template spect
+00014050: 7261 2074 6f0d 0a20 206f 7665 7270 6c6f  ra to..  overplo
+00014060: 7420 7468 6520 6578 7472 6170 6f6c 6174  t the extrapolat
+00014070: 6564 2062 6573 742d 6669 7420 7370 6563  ed best-fit spec
+00014080: 7472 756d 2074 6f67 6574 6865 7220 7769  trum together wi
+00014090: 7468 2074 6865 2070 686f 746f 6d65 7472  th the photometr
+000140a0: 792e 0d0a 2d20 4e65 7720 6465 6d6f 2066  y...- New demo f
+000140b0: 696c 6520 6f6e 2070 686f 746f 6d65 7472  ile on photometr
+000140c0: 6963 2066 6974 7469 6e67 0d0a 2020 6060  ic fitting..  ``
+000140d0: 7070 7866 5f65 7861 6d70 6c65 5f70 6f70  ppxf_example_pop
+000140e0: 756c 6174 696f 6e5f 7068 6f74 6f6d 6574  ulation_photomet
+000140f0: 7279 2e70 7960 602e 0d0a 2d20 6060 6d69  ry.py``...- ``mi
+00014100: 6c65 735f 7574 696c 2e70 686f 746f 6d65  les_util.photome
+00014110: 7472 795f 6672 6f6d 5f74 6162 6c65 6060  try_from_table``
+00014120: 3a20 4e65 7720 6578 616d 706c 6520 6675  : New example fu
+00014130: 6e63 7469 6f6e 2074 6f20 696c 6c75 7374  nction to illust
+00014140: 7261 7465 2074 6865 0d0a 2020 6765 6e65  rate the..  gene
+00014150: 7261 7469 6f6e 206f 6620 7468 6520 696e  ration of the in
+00014160: 7075 7420 7068 6f74 6f6d 6574 7269 6320  put photometric 
+00014170: 7465 6d70 6c61 7465 7320 666f 7220 7468  templates for th
+00014180: 6520 6060 7068 6f74 6060 206b 6579 776f  e ``phot`` keywo
+00014190: 7264 2c20 7573 696e 670d 0a20 2074 6162  rd, using..  tab
+000141a0: 756c 6174 6564 2053 5350 206d 6f64 656c  ulated SSP model
+000141b0: 206d 6167 6e69 7475 6465 732e 0d0a 2d20   magnitudes...- 
+000141c0: 6060 6d69 6c65 735f 7574 696c 2e70 686f  ``miles_util.pho
+000141d0: 746f 6d65 7472 795f 6672 6f6d 5f73 7065  tometry_from_spe
+000141e0: 6374 7261 6060 3a20 4e65 7720 6578 616d  ctra``: New exam
+000141f0: 706c 6520 6675 6e63 7469 6f6e 2074 6f20  ple function to 
+00014200: 696c 6c75 7374 7261 7465 0d0a 2020 7468  illustrate..  th
+00014210: 6520 6765 6e65 7261 7469 6f6e 206f 6620  e generation of 
+00014220: 7068 6f74 6f6d 6574 7269 6320 7465 6d70  photometric temp
+00014230: 6c61 7465 7320 6672 6f6d 2074 6865 2073  lates from the s
+00014240: 7065 6374 7261 2075 7369 6e67 2066 696c  pectra using fil
+00014250: 7465 720d 0a20 2072 6573 706f 6e73 6573  ter..  responses
+00014260: 2e0d 0a2d 2052 6570 6c61 6365 6420 4d49  ...- Replaced MI
+00014270: 4c45 5320 7370 6563 7472 616c 206d 6f64  LES spectral mod
+00014280: 656c 7320 6f66 2056 617a 6465 6b69 7320  els of Vazdekis 
+00014290: 6574 2061 6c2e 2028 3230 3130 2920 7769  et al. (2010) wi
+000142a0: 7468 2045 2d4d 494c 4553 206d 6f64 656c  th E-MILES model
+000142b0: 730d 0a20 206f 6620 5661 7a64 656b 6973  s..  of Vazdekis
+000142c0: 2065 7420 616c 2e20 2832 3031 3629 2e20   et al. (2016). 
+000142d0: 5468 616e 6b73 2074 6f20 416c 6578 616e  Thanks to Alexan
+000142e0: 6472 6520 5661 7a64 656b 6973 2028 6961  dre Vazdekis (ia
+000142f0: 632e 6573 2920 666f 7220 7468 650d 0a20  c.es) for the.. 
+00014300: 2070 6572 6d69 7373 696f 6e2e 0d0a 2d20   permission...- 
+00014310: 4164 6170 7465 6420 616c 6c20 6060 7050  Adapted all ``pP
+00014320: 5846 6060 2065 7861 6d70 6c65 7320 746f  XF`` examples to
+00014330: 2075 7365 2074 6865 2045 2d4d 494c 4553   use the E-MILES
+00014340: 2074 656d 706c 6174 6573 2e0d 0a2d 2060   templates...- `
+00014350: 606d 696c 6573 5f75 7469 6c2e 6d69 6c65  `miles_util.mile
+00014360: 7360 603a 2063 6861 6e67 6564 206e 616d  s``: changed nam
+00014370: 6573 206f 6620 6f75 7470 7574 2077 6176  es of output wav
+00014380: 656c 656e 6774 6820 6060 2e6c 6e5f 6c61  elength ``.ln_la
+00014390: 6d5f 7465 6d70 6060 2074 6f0d 0a20 206d  m_temp`` to..  m
+000143a0: 616b 6520 636c 6561 7220 7468 6579 2072  ake clear they r
+000143b0: 6570 7265 7365 6e74 206e 6174 7572 616c  epresent natural
+000143c0: 206c 6f67 6172 6974 686d 732e 0d0a 2d20   logarithms...- 
+000143d0: 6060 6d69 6c65 735f 7574 696c 2e6d 696c  ``miles_util.mil
+000143e0: 6573 6060 3a20 7365 7420 6060 4657 484d  es``: set ``FWHM
+000143f0: 5f67 616c 3d4e 6f6e 6560 6020 746f 2073  _gal=None`` to s
+00014400: 6b69 7020 7465 6d70 6c61 7465 7320 636f  kip templates co
+00014410: 6e76 6f6c 7574 696f 6e2e 0d0a 2d20 6060  nvolution...- ``
+00014420: 7070 7866 6060 3a20 4f70 7469 6f6e 616c  ppxf``: Optional
+00014430: 6c79 2070 6572 666f 726d 7320 676c 6f62  ly performs glob
+00014440: 616c 206f 7074 696d 697a 6174 696f 6e20  al optimization 
+00014450: 6f66 2074 6865 206e 6f6e 2d6c 696e 6561  of the non-linea
+00014460: 720d 0a20 2070 6172 616d 6574 6572 732e  r..  parameters.
+00014470: 2054 6869 7320 6973 2069 6d70 6c65 6d65   This is impleme
+00014480: 6e74 6564 2076 6961 2074 6865 206e 6577  nted via the new
+00014490: 206b 6579 776f 7264 2060 6067 6c6f 6261   keyword ``globa
+000144a0: 6c5f 7365 6172 6368 6060 2e0d 0a2d 2060  l_search``...- `
+000144b0: 6070 7078 6660 603a 2041 6c6c 6f77 2074  `ppxf``: Allow t
+000144c0: 6865 2075 7365 206f 6620 6d75 6c74 6970  he use of multip
+000144d0: 6c69 6361 7469 7665 2070 6f6c 796e 6f6d  licative polynom
+000144e0: 6961 6c73 2074 6f67 6574 6865 7220 7769  ials together wi
+000144f0: 7468 0d0a 2020 7265 6464 656e 696e 672e  th..  reddening.
+00014500: 0d0a 2d20 6060 7070 7866 6060 3a20 506c  ..- ``ppxf``: Pl
+00014510: 6f74 2069 6e64 6976 6964 7561 6c20 6761  ot individual ga
+00014520: 7320 656d 6973 7369 6f6e 2063 6f6d 706f  s emission compo
+00014530: 6e65 6e74 7320 696e 2061 6464 6974 696f  nents in additio
+00014540: 6e20 746f 2074 6865 6972 2073 756d 2e0d  n to their sum..
+00014550: 0a2d 2060 6070 7078 6660 603a 2055 7064  .- ``ppxf``: Upd
+00014560: 6174 6564 2064 6f63 7374 7269 6e67 2064  ated docstring d
+00014570: 6f63 756d 656e 7461 7469 6f6e 2066 6f72  ocumentation for
+00014580: 2074 6865 206e 6577 2066 6561 7475 7265   the new feature
+00014590: 732e 0d0a 2d20 6060 6361 7066 6974 6060  s...- ``capfit``
+000145a0: 3a20 436f 6d70 6c65 7465 6c79 2072 656d  : Completely rem
+000145b0: 6f76 6564 2074 6965 642f 6669 7865 6420  oved tied/fixed 
+000145c0: 7661 7269 6162 6c65 7320 6672 6f6d 2074  variables from t
+000145d0: 6865 206f 7074 696d 697a 6174 696f 6e20  he optimization 
+000145e0: 616e 640d 0a20 2063 6f6e 7374 7261 696e  and..  constrain
+000145f0: 7473 2e20 5468 6973 2069 6d70 726f 7665  ts. This improve
+00014600: 7320 7468 6520 636f 6e64 6974 696f 6e69  s the conditioni
+00014610: 6e67 206f 6620 7468 6520 4a61 636f 6269  ng of the Jacobi
+00014620: 616e 2061 6e64 2066 7572 7468 6572 0d0a  an and further..
+00014630: 2020 7374 7265 6e67 7468 656e 7320 7468    strengthens th
+00014640: 6520 726f 6275 7374 6e65 7373 206f 6620  e robustness of 
+00014650: 7468 6520 6f70 7469 6d69 7a61 7469 6f6e  the optimization
+00014660: 2e0d 0a2d 2060 606d 696c 6573 5f75 7469  ...- ``miles_uti
+00014670: 6c60 603a 2066 6978 6564 2060 6066 6c75  l``: fixed ``flu
+00014680: 7860 6020 6172 7261 7920 6d69 736d 6174  x`` array mismat
+00014690: 6368 2077 6865 6e20 7573 696e 6720 6060  ch when using ``
+000146a0: 6167 655f 7261 6e67 6560 6020 6f72 0d0a  age_range`` or..
+000146b0: 2020 6060 6d65 7461 6c5f 7261 6e67 6560    ``metal_range`
+000146c0: 602e 2054 6861 6e6b 7320 746f 2044 6176  `. Thanks to Dav
+000146d0: 6964 6520 4265 7661 6371 7561 2028 696e  ide Bevacqua (in
+000146e0: 6166 2e69 7429 2066 6f72 2074 6865 2072  af.it) for the r
+000146f0: 6570 6f72 742e 0d0a 2d20 6060 7070 7866  eport...- ``ppxf
+00014700: 6060 3a20 4669 7865 6420 7072 6f67 7261  ``: Fixed progra
+00014710: 6d20 7374 6f70 2077 6865 6e20 6669 7474  m stop when fitt
+00014720: 696e 6720 6761 7320 7769 7468 2061 2074  ing gas with a t
+00014730: 656d 706c 6174 6520 6c65 6e67 7468 2074  emplate length t
+00014740: 6861 7420 6973 0d0a 2020 6e6f 7420 6120  hat is..  not a 
+00014750: 6d75 6c74 6970 6c65 206f 6620 6060 7665  multiple of ``ve
+00014760: 6c73 6361 6c65 5f72 6174 696f 6060 2e0d  lscale_ratio``..
+00014770: 0a0d 0a56 372e 342e 353a 204d 432c 204f  ...V7.4.5: MC, O
+00014780: 7866 6f72 642c 2031 3620 4a75 6c79 2032  xford, 16 July 2
+00014790: 3032 310d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  021..+++++++++++
+000147a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000147b0: 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6070 7078  +++++....- ``ppx
+000147c0: 6660 603a 204e 6577 206b 6579 776f 7264  f``: New keyword
+000147d0: 2060 6070 702e 706c 6f74 2863 6c69 705f   ``pp.plot(clip_
+000147e0: 6761 733d 5472 7565 2960 6020 746f 2069  gas=True)`` to i
+000147f0: 676e 6f72 6520 7468 6520 6761 7320 656d  gnore the gas em
+00014800: 6973 7369 6f6e 0d0a 2020 6c69 6e65 7320  ission..  lines 
+00014810: 7768 696c 6520 6465 7465 726d 696e 696e  while determinin
+00014820: 6720 7468 6520 706c 6f74 7469 6e67 2072  g the plotting r
+00014830: 616e 6765 7320 666f 7220 7468 6520 6265  anges for the be
+00014840: 7374 2d66 6974 7469 6e67 206d 6f64 656c  st-fitting model
+00014850: 2e0d 0a2d 2060 606d 696c 6573 5f75 7469  ...- ``miles_uti
+00014860: 6c60 603a 204e 6577 2061 7474 7269 6275  l``: New attribu
+00014870: 7465 2060 602e 666c 7578 6060 2074 6f20  te ``.flux`` to 
+00014880: 636f 6e76 6572 7420 6265 7477 6565 6e20  convert between 
+00014890: 6c69 6768 742d 7765 6967 6874 6564 0d0a  light-weighted..
+000148a0: 2020 616e 6420 6d61 7373 2d77 6569 6768    and mass-weigh
+000148b0: 7465 6420 7374 656c 6c61 7220 706f 7075  ted stellar popu
+000148c0: 6c61 7469 6f6e 2071 7561 6e74 6974 6965  lation quantitie
+000148d0: 732e 2055 7064 6174 6564 2074 6865 2063  s. Updated the c
+000148e0: 6f72 7265 7370 6f6e 6469 6e67 0d0a 2020  orresponding..  
+000148f0: 646f 6375 6d65 6e74 6174 696f 6e20 696e  documentation in
+00014900: 2074 6865 2064 6f63 7374 7269 6e67 2e0d   the docstring..
+00014910: 0a2d 2060 6070 7078 665f 6578 616d 706c  .- ``ppxf_exampl
+00014920: 655f 706f 7075 6c61 7469 6f6e 5f67 6173  e_population_gas
+00014930: 5f73 6473 7360 603a 2053 686f 7720 686f  _sdss``: Show ho
+00014940: 7720 746f 2063 6f6e 7665 7274 2062 6574  w to convert bet
+00014950: 7765 656e 206c 6967 6874 2d77 6569 6768  ween light-weigh
+00014960: 7465 640d 0a20 2061 6e64 206d 6173 732d  ted..  and mass-
+00014970: 7765 6967 6874 6564 2073 7465 6c6c 6172  weighted stellar
+00014980: 2070 6f70 756c 6174 696f 6e20 7573 696e   population usin
+00014990: 6720 7468 6520 6e65 7720 6060 6d69 6c65  g the new ``mile
+000149a0: 732e 666c 7578 6060 2061 7474 7269 6275  s.flux`` attribu
+000149b0: 7465 2e0d 0a2d 2060 6070 7078 665f 7574  te...- ``ppxf_ut
+000149c0: 696c 2e6c 6f67 5f72 6562 696e 6060 3a20  il.log_rebin``: 
+000149d0: 7375 7070 6f72 7420 6661 7374 206c 6f67  support fast log
+000149e0: 2072 6562 696e 6e69 6e67 206f 6620 616c   rebinning of al
+000149f0: 6c20 636f 6c75 6d6e 7320 6f66 2032 2d64  l columns of 2-d
+00014a00: 696d 2061 7272 6179 732e 0d0a 0d0a 5637  im arrays.....V7
+00014a10: 2e34 2e34 3a20 4d43 2c20 4f78 666f 7264  .4.4: MC, Oxford
+00014a20: 2c20 3130 2046 6562 7275 6172 7920 3230  , 10 February 20
+00014a30: 3231 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  21..++++++++++++
+00014a40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00014a50: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060  ++++++++....- ``
+00014a60: 7070 7866 6060 3a20 4d6f 7265 2072 6f62  ppxf``: More rob
+00014a70: 7573 7420 6d61 7472 6978 2073 6361 6c69  ust matrix scali
+00014a80: 6e67 2077 6865 6e20 7573 696e 6720 6c69  ng when using li
+00014a90: 6e65 6172 2065 7175 616c 6974 7920 636f  near equality co
+00014aa0: 6e73 7472 6169 6e74 730d 0a20 2069 6e20  nstraints..  in 
+00014ab0: 6060 636f 6e73 7472 5f74 656d 706c 6060  ``constr_templ``
+00014ac0: 2077 6974 6820 6060 6c69 6e65 6172 5f6d   with ``linear_m
+00014ad0: 6574 686f 643d 276c 7371 5f62 6f78 2760  ethod='lsq_box'`
+00014ae0: 602e 2054 6861 6e6b 7320 746f 2053 6872  `. Thanks to Shr
+00014af0: 6176 616e 2053 6865 7474 790d 0a20 2028  avan Shetty..  (
+00014b00: 706b 752e 6564 752e 636e 2920 666f 7220  pku.edu.cn) for 
+00014b10: 6120 6465 7461 696c 6564 2072 6570 6f72  a detailed repor
+00014b20: 7420 616e 6420 666f 7220 7465 7374 696e  t and for testin
+00014b30: 6720 6d79 2066 6978 2e0d 0a0d 0a56 372e  g my fix.....V7.
+00014b40: 342e 333a 204d 432c 204f 7866 6f72 642c  4.3: MC, Oxford,
+00014b50: 2032 3120 4465 6365 6d62 6572 2032 3032   21 December 202
+00014b60: 300d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  0..+++++++++++++
+00014b70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00014b80: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6063  +++++++....- ``c
+00014b90: 6170 6669 7460 603a 204e 6577 2060 606c  apfit``: New ``l
+00014ba0: 696e 6561 725f 6d65 7468 6f64 6060 206b  inear_method`` k
+00014bb0: 6579 776f 7264 2074 6f20 7365 6c65 6374  eyword to select
+00014bc0: 2062 6574 7765 656e 2060 6063 7678 6f70   between ``cvxop
+00014bd0: 7460 6020 6f72 0d0a 2020 6060 6c73 715f  t`` or..  ``lsq_
+00014be0: 6c69 6e60 602c 2077 6865 6e20 7573 696e  lin``, when usin
+00014bf0: 6720 6c69 6e65 6172 2063 6f6e 7374 7261  g linear constra
+00014c00: 696e 7473 2c20 666f 7220 6361 7365 7320  ints, for cases 
+00014c10: 7768 6572 6520 7468 6520 6c61 7474 6572  where the latter
+00014c20: 2073 746f 7073 2e0d 0a20 2054 6865 2060   stops...  The `
+00014c30: 6063 7678 6f70 7460 6020 7061 636b 6167  `cvxopt`` packag
+00014c40: 6520 6d75 7374 2062 6520 696e 7374 616c  e must be instal
+00014c50: 6c65 6420 7768 656e 2073 6574 7469 6e67  led when setting
+00014c60: 2074 6861 7420 6f70 7469 6f6e 2e0d 0a2d   that option...-
+00014c70: 2060 6070 7078 6660 603a 2041 6461 7074   ``ppxf``: Adapt
+00014c80: 6564 2074 6f20 7573 6520 6060 6361 7066  ed to use ``capf
+00014c90: 6974 6060 2077 6974 6820 6060 6c69 6e65  it`` with ``line
+00014ca0: 6172 5f6d 6574 686f 643d 2763 7678 6f70  ar_method='cvxop
+00014cb0: 7427 6060 2077 6865 6e0d 0a20 2065 6e66  t'`` when..  enf
+00014cc0: 6f72 6369 6e67 206c 696e 6561 7220 636f  orcing linear co
+00014cd0: 6e73 7472 6169 6e74 7320 6f6e 2074 6865  nstraints on the
+00014ce0: 206b 696e 656d 6174 6963 7320 7769 7468   kinematics with
+00014cf0: 2060 6063 6f6e 7374 725f 6b69 6e65 6d60   ``constr_kinem`
+00014d00: 602e 0d0a 2d20 6060 7070 7866 6060 3a20  `...- ``ppxf``: 
+00014d10: 496e 636c 7564 6564 204e 4f54 4520 696e  Included NOTE in
+00014d20: 2074 6865 2064 6f63 756d 656e 7461 7469   the documentati
+00014d30: 6f6e 206f 6620 6060 636f 6e73 7472 5f6b  on of ``constr_k
+00014d40: 696e 656d 6060 2e0d 0a20 2041 6c6c 2063  inem``...  All c
+00014d50: 6861 6e67 6573 2061 626f 7665 2077 6572  hanges above wer
+00014d60: 6520 6166 7465 7220 6465 7461 696c 6564  e after detailed
+00014d70: 2072 6570 6f72 7473 2062 7920 4b79 6c65   reports by Kyle
+00014d80: 2057 6573 7466 616c 6c20 2875 636f 6c69   Westfall (ucoli
+00014d90: 636b 2e6f 7267 292e 0d0a 0d0a 5637 2e34  ck.org).....V7.4
+00014da0: 2e32 3a20 4d43 2c20 4f78 666f 7264 2c20  .2: MC, Oxford, 
+00014db0: 3920 4f63 746f 6265 7220 3230 3230 0d0a  9 October 2020..
+00014dc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00014dd0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00014de0: 2b2b 0d0a 0d0a 2d20 6060 7070 7866 6060  ++....- ``ppxf``
+00014df0: 3a20 436f 7272 6563 7465 6420 7479 706f  : Corrected typo
+00014e00: 2069 6e20 6578 616d 706c 6520 696e 2074   in example in t
+00014e10: 6865 2064 6f63 756d 656e 7461 7469 6f6e  he documentation
+00014e20: 206f 6620 6060 636f 6e73 7472 5f74 656d   of ``constr_tem
+00014e30: 706c 6060 2e0d 0a2d 2060 6070 7078 6660  pl``...- ``ppxf`
+00014e40: 603a 2043 6865 636b 2074 6861 7420 6060  `: Check that ``
+00014e50: 636f 6e73 7472 5f74 656d 706c 6060 2061  constr_templ`` a
+00014e60: 6e64 2060 6063 6f6e 7374 725f 6b69 6e65  nd ``constr_kine
+00014e70: 6d60 6020 6172 6520 6469 6374 696f 6e61  m`` are dictiona
+00014e80: 7269 6573 2e0d 0a20 2054 6861 6e6b 7320  ries...  Thanks 
+00014e90: 746f 2044 6176 6964 6520 4265 7661 6371  to Davide Bevacq
+00014ea0: 7561 2028 756e 6962 6f2e 6974 2920 666f  ua (unibo.it) fo
+00014eb0: 7220 7468 6520 6665 6564 6261 636b 2e0d  r the feedback..
+00014ec0: 0a0d 0a56 372e 342e 313a 204d 432c 204f  ...V7.4.1: MC, O
+00014ed0: 7866 6f72 642c 2031 3120 5365 7074 656d  xford, 11 Septem
+00014ee0: 6265 7220 3230 3230 0d0a 2b2b 2b2b 2b2b  ber 2020..++++++
+00014ef0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00014f00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+00014f10: 0a0d 0a2d 2060 6063 6170 6669 7460 603a  ...- ``capfit``:
+00014f20: 2046 6978 6564 2070 6f73 7369 626c 6520   Fixed possible 
+00014f30: 696e 6669 6e69 7465 206c 6f6f 7020 696e  infinite loop in
+00014f40: 2060 606c 7371 5f62 6f78 6060 2061 6e64   ``lsq_box`` and
+00014f50: 2060 606c 7371 5f6c 696e 6060 2e0d 0a20   ``lsq_lin``... 
+00014f60: 2054 6861 6e6b 7320 746f 2053 6872 6176   Thanks to Shrav
+00014f70: 616e 2053 6865 7474 7920 2870 6b75 2e65  an Shetty (pku.e
+00014f80: 6475 2e63 6e29 2066 6f72 2074 6865 2064  du.cn) for the d
+00014f90: 6574 6169 6c65 6420 7265 706f 7274 2061  etailed report a
+00014fa0: 6e64 2074 6f20 626f 7468 0d0a 2020 6869  nd to both..  hi
+00014fb0: 6d20 616e 6420 4b79 6c65 2057 6573 7466  m and Kyle Westf
+00014fc0: 616c 6c20 2875 636f 6c69 636b 2e6f 7267  all (ucolick.org
+00014fd0: 2920 666f 7220 7465 7374 696e 6720 7468  ) for testing th
+00014fe0: 6520 6669 782e 0d0a 2d20 6060 6361 7066  e fix...- ``capf
+00014ff0: 6974 6060 3a20 5573 6520 4e75 6d50 7920  it``: Use NumPy 
+00015000: 7261 7468 6572 2074 6861 6e20 7468 6520  rather than the 
+00015010: 5363 6950 7920 7665 7273 696f 6e20 6f66  SciPy version of
+00015020: 2060 606c 696e 616c 672e 6c73 7473 7160   ``linalg.lstsq`
+00015030: 6020 746f 0d0a 2020 6176 6f69 6420 6120  ` to..  avoid a 
+00015040: 6375 7272 656e 7420 5363 6950 7920 6275  current SciPy bu
+00015050: 6720 696e 2074 6865 2064 6566 6175 6c74  g in the default
+00015060: 2063 7269 7465 7269 6f6e 2066 6f72 2072   criterion for r
+00015070: 616e 6b20 6465 6669 6369 656e 6379 2e0d  ank deficiency..
+00015080: 0a2d 2060 6063 6170 6669 7460 603a 2052  .- ``capfit``: R
+00015090: 656e 616d 6564 2060 6063 6f6e 6460 6020  enamed ``cond`` 
+000150a0: 6b65 7977 6f72 6420 746f 2060 6072 636f  keyword to ``rco
+000150b0: 6e64 6060 2066 6f72 2063 6f6e 7369 7374  nd`` for consist
+000150c0: 656e 6379 2077 6974 6820 4e75 6d50 792e  ency with NumPy.
+000150d0: 0d0a 2d20 6060 6361 7066 6974 6060 3a20  ..- ``capfit``: 
+000150e0: 5061 7373 6564 2060 6072 636f 6e64 6060  Passed ``rcond``
+000150f0: 206b 6579 776f 7264 2074 6f20 6060 636f   keyword to ``co
+00015100: 765f 6572 7260 6020 6675 6e63 7469 6f6e  v_err`` function
+00015110: 2e0d 0a2d 2060 6070 7078 6660 603a 2072  ...- ``ppxf``: r
+00015120: 656d 6f76 6564 2060 6072 636f 6e64 6060  emoved ``rcond``
+00015130: 206b 6579 776f 7264 2069 6e20 6060 6361   keyword in ``ca
+00015140: 7066 6974 6060 2063 616c 6c2e 2055 7365  pfit`` call. Use
+00015150: 2064 6566 6175 6c74 2069 6e73 7465 6164   default instead
+00015160: 2e0d 0a0d 0a56 372e 342e 303a 204d 432c  .....V7.4.0: MC,
+00015170: 204f 7866 6f72 642c 2032 3020 4175 6775   Oxford, 20 Augu
+00015180: 7374 2032 3032 300d 0a2b 2b2b 2b2b 2b2b  st 2020..+++++++
+00015190: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000151a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+000151b0: 2060 6063 6170 6669 7460 603a 204e 6577   ``capfit``: New
+000151c0: 2066 756e 6374 696f 6e20 6060 6c73 715f   function ``lsq_
+000151d0: 6c69 6e60 6020 696d 706c 656d 656e 7469  lin`` implementi
+000151e0: 6e67 2061 206c 696e 6561 7220 6c65 6173  ng a linear leas
+000151f0: 742d 7371 7561 7265 730d 0a20 206c 696e  t-squares..  lin
+00015200: 6561 726c 7920 636f 6e73 7472 6169 6e65  early constraine
+00015210: 6420 616c 676f 7269 7468 6d20 7375 7070  d algorithm supp
+00015220: 6f72 7469 6e67 2072 616e 6b2d 6465 6669  orting rank-defi
+00015230: 6369 656e 7420 6d61 7472 6963 6573 2061  cient matrices a
+00015240: 6e64 2061 6c6c 6f77 696e 670d 0a20 2066  nd allowing..  f
+00015250: 6f72 2061 2073 7461 7274 696e 6720 6775  or a starting gu
+00015260: 6573 732e 0d0a 2d20 6060 6361 7066 6974  ess...- ``capfit
+00015270: 6060 3a20 5265 6d6f 7665 6420 7468 6520  ``: Removed the 
+00015280: 6060 6c73 716c 696e 6060 2070 726f 6365  ``lsqlin`` proce
+00015290: 6475 7265 2077 6869 6368 2069 7320 7375  dure which is su
+000152a0: 7065 7273 6564 6564 2062 7920 6060 6c73  perseded by ``ls
+000152b0: 715f 6c69 6e60 602e 0d0a 2d20 6060 6361  q_lin``...- ``ca
+000152c0: 7066 6974 6060 3a20 5265 6e61 6d65 6420  pfit``: Renamed 
+000152d0: 6060 6c73 7162 6f78 6060 2074 6f20 6060  ``lsqbox`` to ``
+000152e0: 6c73 715f 626f 7860 6020 616e 6420 7265  lsq_box`` and re
+000152f0: 7669 7365 6420 6974 7320 696e 7465 7266  vised its interf
+00015300: 6163 652e 0d0a 2d20 6060 7070 7866 6060  ace...- ``ppxf``
+00015310: 3a20 4d6f 6469 6669 6564 2074 6f20 7573  : Modified to us
+00015320: 6520 7468 6520 6e65 7720 6060 6c73 715f  e the new ``lsq_
+00015330: 6c69 6e60 6020 616e 6420 7468 6520 7570  lin`` and the up
+00015340: 6461 7465 6420 6060 6c73 715f 626f 7860  dated ``lsq_box`
+00015350: 6020 6675 6e63 7469 6f6e 732e 0d0a 2d20  ` functions...- 
+00015360: 6060 7070 7866 6060 3a20 4d6f 7265 2065  ``ppxf``: More e
+00015370: 7861 6d70 6c65 7320 666f 7220 7468 6520  xamples for the 
+00015380: 6060 636f 6e73 7472 5f74 656d 706c 6060  ``constr_templ``
+00015390: 2061 6e64 2060 6063 6f6e 7374 725f 6b69   and ``constr_ki
+000153a0: 6e65 6d60 6020 6b65 7977 6f72 6473 2e0d  nem`` keywords..
+000153b0: 0a2d 2053 6574 2072 6564 7368 6966 7420  .- Set redshift 
+000153c0: 6060 7a20 3d20 3060 6020 7768 656e 206f  ``z = 0`` when o
+000153d0: 6e65 2075 6e63 6f6d 6d65 6e74 7320 7468  ne uncomments th
+000153e0: 6520 6c69 6e65 7320 746f 2062 7269 6e67  e lines to bring
+000153f0: 2074 6865 2073 7065 6374 7275 6d20 746f   the spectrum to
+00015400: 0d0a 2020 7468 6520 7265 7374 2d66 7261  ..  the rest-fra
+00015410: 6d65 2069 6e20 6060 7070 7866 5f65 7861  me in ``ppxf_exa
+00015420: 6d70 6c65 5f6b 696e 656d 6174 6963 735f  mple_kinematics_
+00015430: 7364 7373 2e70 7960 602e 2054 6861 6e6b  sdss.py``. Thank
+00015440: 7320 746f 0d0a 2020 5661 6964 6568 6920  s to..  Vaidehi 
+00015450: 532e 2050 616c 6979 6120 2864 6573 792e  S. Paliya (desy.
+00015460: 6465 2920 666f 7220 706f 696e 7469 6e67  de) for pointing
+00015470: 206f 7574 2074 6865 2069 6e63 6f6e 7369   out the inconsi
+00015480: 7374 656e 6379 2069 6e20 6d79 2065 7861  stency in my exa
+00015490: 6d70 6c65 2e0d 0a0d 0a56 372e 332e 303a  mple.....V7.3.0:
+000154a0: 204d 432c 204f 7866 6f72 642c 2031 3020   MC, Oxford, 10 
+000154b0: 4a75 6c79 2032 3032 300d 0a2b 2b2b 2b2b  July 2020..+++++
+000154c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000154d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+000154e0: 2060 6063 6170 6669 7460 603a 204e 6577   ``capfit``: New
+000154f0: 2066 756e 6374 696f 6e20 6060 6c73 7162   function ``lsqb
+00015500: 6f78 6060 2069 6d70 6c65 6d65 6e74 696e  ox`` implementin
+00015510: 6720 6120 6661 7374 206c 696e 6561 7220  g a fast linear 
+00015520: 6c65 6173 742d 7371 7561 7265 730d 0a20  least-squares.. 
+00015530: 2062 6f78 2d63 6f6e 7374 7261 696e 6564   box-constrained
+00015540: 2028 626f 756e 6473 2920 616c 676f 7269   (bounds) algori
+00015550: 7468 6d20 7768 6963 6820 616c 6c6f 7773  thm which allows
+00015560: 2066 6f72 2061 2073 7461 7274 696e 6720   for a starting 
+00015570: 6775 6573 732e 0d0a 2020 5768 696c 6520  guess...  While 
+00015580: 7465 7374 696e 6720 4920 616c 736f 2064  testing I also d
+00015590: 6973 636f 7665 7265 6420 6120 6d61 6a6f  iscovered a majo
+000155a0: 7220 6d69 7374 616b 6520 696e 2074 6865  r mistake in the
+000155b0: 2063 7572 7265 6e74 2069 6d70 6c65 6d65   current impleme
+000155c0: 6e74 6174 696f 6e0d 0a20 206f 6620 6060  ntation..  of ``
+000155d0: 7363 6970 792e 6f70 7469 6d69 7a65 2e6c  scipy.optimize.l
+000155e0: 7371 5f6c 696e 6561 7260 6020 286d 7920  sq_linear`` (my 
+000155f0: 6669 7820 7761 7320 6c61 7465 7220 696e  fix was later in
+00015600: 636c 7564 6564 2069 6e20 5363 6970 7920  cluded in Scipy 
+00015610: 312e 3629 2e0d 0a2d 2060 6070 7078 6660  1.6)...- ``ppxf`
+00015620: 603a 2054 6865 206e 6577 2060 606c 696e  `: The new ``lin
+00015630: 6561 725f 6d65 7468 6f64 3d27 6c73 7162  ear_method='lsqb
+00015640: 6f78 2760 6020 616e 6420 6060 6c69 6e65  ox'`` and ``line
+00015650: 6172 5f6d 6574 686f 643d 2763 7678 6f70  ar_method='cvxop
+00015660: 7427 6060 0d0a 2020 6e6f 7720 7573 6520  t'``..  now use 
+00015670: 616e 2069 6e69 7469 616c 2067 7565 7373  an initial guess
+00015680: 2066 6f72 2074 6865 2073 6f6c 7574 696f   for the solutio
+00015690: 6e2c 2077 6869 6368 2073 6967 6e69 6669  n, which signifi
+000156a0: 6361 6e74 6c79 2073 7065 6564 7320 7570  cantly speeds up
+000156b0: 2074 6865 0d0a 2020 6b69 6e65 6d61 7469   the..  kinemati
+000156c0: 6320 6669 7420 7769 7468 206d 756c 7469  c fit with multi
+000156d0: 706c 6520 7465 6d70 6c61 7465 732e 2041  ple templates. A
+000156e0: 7320 616e 2065 7861 6d70 6c65 2c20 6d79  s an example, my
+000156f0: 2070 726f 6365 6475 7265 0d0a 2020 6060   procedure..  ``
+00015700: 7070 7866 5f65 7861 6d70 6c65 5f70 6f70  ppxf_example_pop
+00015710: 756c 6174 696f 6e5f 6761 735f 7364 7373  ulation_gas_sdss
+00015720: 6060 2069 7320 6e6f 7720 6162 6f75 7420  `` is now about 
+00015730: 3420 7469 6d65 7320 6661 7374 6572 2077  4 times faster w
+00015740: 6974 6820 7468 6520 6e65 770d 0a20 2060  ith the new..  `
+00015750: 606c 696e 6561 725f 6d65 7468 6f64 3d27  `linear_method='
+00015760: 6c73 7162 6f78 2760 6020 7468 616e 2077  lsqbox'`` than w
+00015770: 6974 6820 7468 6520 6c65 6761 6379 2060  ith the legacy `
+00015780: 606c 696e 6561 725f 6d65 7468 6f64 3d27  `linear_method='
+00015790: 6e6e 6c73 2760 602e 0d0a 2d20 6060 7070  nnls'``...- ``pp
+000157a0: 7866 6060 3a20 4164 6465 6420 7375 7070  xf``: Added supp
+000157b0: 6f72 7420 666f 7220 6c69 6e65 6172 2065  ort for linear e
+000157c0: 7175 616c 6974 7920 636f 6e73 7472 6169  quality constrai
+000157d0: 6e74 7320 6f6e 2074 6865 2074 656d 706c  nts on the templ
+000157e0: 6174 6573 0d0a 2020 6060 636f 6e73 7472  ates..  ``constr
+000157f0: 5f74 656d 706c 6060 2061 6e64 2066 6f72  _templ`` and for
+00015800: 2075 7369 6e67 2074 6865 206b 6579 776f   using the keywo
+00015810: 7264 2060 6066 7261 6374 696f 6e60 6020  rd ``fraction`` 
+00015820: 7769 7468 2062 6f74 680d 0a20 2060 606c  with both..  ``l
+00015830: 696e 6561 725f 6d65 7468 6f64 3d27 6c73  inear_method='ls
+00015840: 7162 6f78 2760 6020 616e 6420 6060 6c69  qbox'`` and ``li
+00015850: 6e65 6172 5f6d 6574 686f 643d 276e 6e6c  near_method='nnl
+00015860: 7327 6060 2e0d 0a2d 2050 7269 6e74 2060  s'``...- Print `
+00015870: 6064 6567 7265 6560 6020 616e 6420 6060  `degree`` and ``
+00015880: 6d64 6567 7265 6560 6020 7769 7468 2074  mdegree`` with t
+00015890: 6865 2066 696e 616c 2072 6573 756c 7473  he final results
+000158a0: 2e0d 0a2d 2053 6574 2060 606c 696e 6561  ...- Set ``linea
+000158b0: 723d 5472 7565 6060 2061 7574 6f6d 6174  r=True`` automat
+000158c0: 6963 616c 6c79 2069 6620 7468 6520 6669  ically if the fi
+000158d0: 7420 6861 7320 6e6f 2066 7265 6520 6e6f  t has no free no
+000158e0: 6e2d 6c69 6e65 6172 2070 6172 616d 6574  n-linear paramet
+000158f0: 6572 732c 0d0a 2020 746f 2061 766f 6964  ers,..  to avoid
+00015900: 2061 2070 726f 6772 616d 2073 746f 702e   a program stop.
+00015910: 2054 6861 6e6b 7320 746f 2053 6872 6176   Thanks to Shrav
+00015920: 616e 2053 6865 7474 7920 2870 6b75 2e65  an Shetty (pku.e
+00015930: 6475 2e63 6e29 2066 6f72 2074 6865 2072  du.cn) for the r
+00015940: 6570 6f72 742e 0d0a 0d0a 5637 2e32 2e31  eport.....V7.2.1
+00015950: 3a20 4d43 2c20 4f78 666f 7264 2c20 3132  : MC, Oxford, 12
+00015960: 204a 756e 6520 3230 3230 0d0a 2b2b 2b2b   June 2020..++++
+00015970: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00015980: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+00015990: 2d20 6060 6361 7066 6974 6060 3a20 4e65  - ``capfit``: Ne
+000159a0: 7720 696e 7075 7420 6b65 7977 6f72 6420  w input keyword 
+000159b0: 6060 636f 6e64 6060 2066 6f72 204a 6163  ``cond`` for Jac
+000159c0: 6f62 6961 6e20 7261 6e6b 2074 6f6c 6572  obian rank toler
+000159d0: 616e 6365 2e0d 0a2d 2060 6063 6170 6669  ance...- ``capfi
+000159e0: 7460 603a 2055 7365 2060 6062 766c 7360  t``: Use ``bvls`
+000159f0: 6020 746f 2073 6f6c 7665 2071 7561 6472  ` to solve quadr
+00015a00: 6174 6963 2073 7562 7072 6f62 6c65 6d20  atic subproblem 
+00015a10: 7769 7468 206f 6e6c 7920 6060 626f 756e  with only ``boun
+00015a20: 6473 6060 2e0d 0a2d 2060 6070 7078 6660  ds``...- ``ppxf`
+00015a30: 603a 2053 6574 2060 6063 6f6e 643d 3165  `: Set ``cond=1e
+00015a40: 2d37 6060 2069 6e20 6060 6361 7066 6974  -7`` in ``capfit
+00015a50: 6060 2063 616c 6c2c 2077 6865 6e20 7573  `` call, when us
+00015a60: 696e 6720 6c69 6e65 6172 2063 6f6e 7374  ing linear const
+00015a70: 7261 696e 7473 2e0d 0a20 2054 6865 2060  raints...  The `
+00015a80: 6063 6170 6669 7460 6020 7265 6c61 7465  `capfit`` relate
+00015a90: 6420 6368 616e 6765 7320 7765 7265 2064  d changes were d
+00015aa0: 7565 2074 6f20 6465 7461 696c 6564 2066  ue to detailed f
+00015ab0: 6565 6462 6163 6b20 6279 204b 796c 6520  eedback by Kyle 
+00015ac0: 5765 7374 6661 6c6c 0d0a 2020 2875 636f  Westfall..  (uco
+00015ad0: 6c69 636b 2e6f 7267 292c 2074 6f20 6465  lick.org), to de
+00015ae0: 616c 2077 6974 6820 7369 7475 6174 696f  al with situatio
+00015af0: 6e73 2077 6974 6820 6465 6765 6e65 7261  ns with degenera
+00015b00: 7465 204a 6163 6f62 6961 6e73 2c20 6c69  te Jacobians, li
+00015b10: 6b65 2077 6865 6e0d 0a20 2074 6865 7265  ke when..  there
+00015b20: 2069 7320 6e6f 2073 7465 6c6c 6172 2063   is no stellar c
+00015b30: 6f6e 7469 6e75 756d 2061 6e64 206f 6e65  ontinuum and one
+00015b40: 2075 7365 7320 6d75 6c74 6970 6c69 6361   uses multiplica
+00015b50: 7469 7665 2070 6f6c 796e 6f6d 6961 6c73  tive polynomials
+00015b60: 2e0d 0a2d 2060 6070 7078 6660 603a 2043  ...- ``ppxf``: C
+00015b70: 6c61 7269 6669 6564 2064 6f63 756d 656e  larified documen
+00015b80: 7461 7469 6f6e 2066 6f72 2060 602e 6761  tation for ``.ga
+00015b90: 735f 7a65 726f 5f74 656d 706c 6174 6560  s_zero_template`
+00015ba0: 6020 616e 6420 7468 650d 0a20 2063 6f72  ` and the..  cor
+00015bb0: 7265 7370 6f6e 6469 6e67 2077 6172 6e69  responding warni
+00015bc0: 6e67 206d 6573 7361 6765 2c20 6166 7465  ng message, afte
+00015bd0: 7220 6665 6564 6261 636b 2062 7920 4c61  r feedback by La
+00015be0: 7572 6120 5361 6c6f 2028 756d 6e2e 6564  ura Salo (umn.ed
+00015bf0: 7529 2e0d 0a0d 0a56 372e 322e 303a 204d  u).....V7.2.0: M
+00015c00: 432c 204f 7866 6f72 642c 2034 204d 6179  C, Oxford, 4 May
+00015c10: 2032 3032 300d 0a2b 2b2b 2b2b 2b2b 2b2b   2020..+++++++++
+00015c20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00015c30: 2b2b 2b2b 2b0d 0a0d 0a2d 2041 6c6c 6f77  +++++....- Allow
+00015c40: 2066 6f72 2060 606c 696e 6561 725f 6d65   for ``linear_me
+00015c50: 7468 6f64 3d27 6376 786f 7074 2760 6020  thod='cvxopt'`` 
+00015c60: 7768 656e 2074 6865 206f 7074 696f 6e61  when the optiona
+00015c70: 6c20 6060 6376 786f 7074 6060 2070 6163  l ``cvxopt`` pac
+00015c80: 6b61 6765 0d0a 2020 6973 2069 6e73 7461  kage..  is insta
+00015c90: 6c6c 6564 2e0d 0a0d 0a56 372e 312e 303a  lled.....V7.1.0:
+00015ca0: 204d 432c 204f 7866 6f72 642c 2033 3020   MC, Oxford, 30 
+00015cb0: 4170 7269 6c20 3230 3230 0d0a 2b2b 2b2b  April 2020..++++
+00015cc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00015cd0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+00015ce0: 0a2d 2049 6e74 726f 6475 6365 6420 6e65  .- Introduced ne
+00015cf0: 7720 6060 7070 7866 6060 206b 6579 776f  w ``ppxf`` keywo
+00015d00: 7264 2060 606c 696e 6561 725f 6d65 7468  rd ``linear_meth
+00015d10: 6f64 6060 2c20 616e 6420 636f 7272 6573  od``, and corres
+00015d20: 706f 6e64 696e 6720 6368 616e 6765 730d  ponding changes.
+00015d30: 0a20 2069 6e20 7468 6520 636f 6465 2c20  .  in the code, 
+00015d40: 746f 2073 656c 6563 7420 6265 7477 6565  to select betwee
+00015d50: 6e20 7468 6520 6f6c 6420 2827 6e6e 6c73  n the old ('nnls
+00015d60: 2729 2061 6e64 2074 6865 206e 6577 2028  ') and the new (
+00015d70: 276c 7371 6c69 6e27 290d 0a20 2061 7070  'lsqlin')..  app
+00015d80: 726f 6163 6820 746f 2074 6865 2073 6f6c  roach to the sol
+00015d90: 7574 696f 6e20 6f66 2074 6865 206c 696e  ution of the lin
+00015da0: 6561 7220 6c65 6173 742d 7371 7561 7265  ear least-square
+00015db0: 7320 7375 6270 726f 626c 656d 2069 6e20  s subproblem in 
+00015dc0: 6060 7070 7866 6060 2e0d 0a20 2054 6861  ``ppxf``...  Tha
+00015dd0: 6e6b 7320 746f 2053 616d 2056 6175 6768  nks to Sam Vaugh
+00015de0: 616e 2028 7379 646e 6579 2e65 6475 2e61  an (sydney.edu.a
+00015df0: 7529 2066 6f72 2061 2063 6f6e 7669 6e63  u) for a convinc
+00015e00: 696e 6720 6d69 6e69 6d61 6c20 6578 616d  ing minimal exam
+00015e10: 706c 650d 0a20 2069 6c6c 7573 7472 6174  ple..  illustrat
+00015e20: 696e 6720 7468 6520 7573 6566 756c 6e65  ing the usefulne
+00015e30: 7373 206f 6620 7468 6973 206b 6579 776f  ss of this keywo
+00015e40: 7264 2e0d 0a0d 0a56 372e 302e 313a 204d  rd.....V7.0.1: M
+00015e50: 432c 204f 7866 6f72 642c 2038 2041 7072  C, Oxford, 8 Apr
+00015e60: 696c 2032 3032 300d 0a2b 2b2b 2b2b 2b2b  il 2020..+++++++
+00015e70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00015e80: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2053  +++++++++....- S
+00015e90: 7570 706f 7274 2060 602e 6761 735f 7a65  upport ``.gas_ze
+00015ea0: 726f 5f74 656d 706c 6174 6560 6020 616e  ro_template`` an
+00015eb0: 6420 6060 6672 6163 7469 6f6e 6060 2074  d ``fraction`` t
+00015ec0: 6f67 6574 6865 7220 7769 7468 206f 7468  ogether with oth
+00015ed0: 6572 0d0a 2020 6571 7561 6c69 7479 2063  er..  equality c
+00015ee0: 6f6e 7374 7261 696e 7473 2e0d 0a2d 2049  onstraints...- I
+00015ef0: 6e63 6c75 6465 6420 6060 6e70 2e70 6164  ncluded ``np.pad
+00015f00: 282e 2e2e 6d6f 6465 3d27 636f 6e73 7461  (...mode='consta
+00015f10: 6e74 2729 6060 2066 6f72 2062 6163 6b77  nt')`` for backw
+00015f20: 6172 6420 636f 6d70 6174 6962 696c 6974  ard compatibilit
+00015f30: 7920 7769 7468 0d0a 2020 4e75 6d70 7920  y with..  Numpy 
+00015f40: 312e 3136 2e20 5468 616e 6b73 2074 6f20  1.16. Thanks to 
+00015f50: 5368 7261 7661 6e20 5368 6574 7479 2028  Shravan Shetty (
+00015f60: 4b49 4141 2d50 4b55 2920 666f 7220 7468  KIAA-PKU) for th
+00015f70: 6520 7375 6767 6573 7469 6f6e 2e0d 0a2d  e suggestion...-
+00015f80: 2046 6978 2060 6072 6562 696e 2829 6060   Fix ``rebin()``
+00015f90: 206e 6f74 2072 6574 6169 6e69 6e67 2074   not retaining t
+00015fa0: 6865 2064 696d 656e 7369 6f6e 616c 6974  he dimensionalit
+00015fb0: 7920 6f66 2061 6e20 696e 7075 7420 636f  y of an input co
+00015fc0: 6c75 6d6e 2d76 6563 746f 722e 0d0a 2020  lumn-vector...  
+00015fd0: 5468 6973 2072 6573 756c 7465 6420 696e  This resulted in
+00015fe0: 2061 2070 726f 6772 616d 2073 746f 7020   a program stop 
+00015ff0: 7769 7468 2061 2073 696e 676c 6520 6761  with a single ga
+00016000: 7320 7465 6d70 6c61 7465 2061 6e64 0d0a  s template and..
+00016010: 2020 6060 7665 6c73 6361 6c65 5f72 6174    ``velscale_rat
+00016020: 696f 203e 2031 6060 2e20 5468 616e 6b73  io > 1``. Thanks
+00016030: 2074 6f20 5a68 6979 7561 6e20 4a69 2028   to Zhiyuan Ji (
+00016040: 6173 7472 6f2e 756d 6173 732e 6564 7529  astro.umass.edu)
+00016050: 2066 6f72 2061 2063 6c65 6172 0d0a 2020   for a clear..  
+00016060: 6578 616d 706c 6520 7265 7072 6f64 7563  example reproduc
+00016070: 696e 6720 7468 6520 6275 672e 0d0a 2d20  ing the bug...- 
+00016080: 6060 6361 7066 6974 6060 3a20 4e65 7720  ``capfit``: New 
+00016090: 6b65 7977 6f72 6420 6060 636f 6e64 6060  keyword ``cond``
+000160a0: 2066 6f72 2060 606c 7371 6c69 6e60 602e   for ``lsqlin``.
+000160b0: 0d0a 2d20 6060 6361 7066 6974 6060 3a20  ..- ``capfit``: 
+000160c0: 5265 6c61 7865 6420 6173 7365 7274 696f  Relaxed assertio
+000160d0: 6e20 666f 7220 696e 636f 6e73 6973 7465  n for inconsiste
+000160e0: 6e74 2069 6e65 7175 616c 6974 6965 7320  nt inequalities 
+000160f0: 696e 2060 606c 7371 6c69 6e60 600d 0a20  in ``lsqlin``.. 
+00016100: 2074 6f20 6176 6f69 6420 6661 6c73 6520   to avoid false 
+00016110: 706f 7369 7469 7665 732e 2054 6861 6e6b  positives. Thank
+00016120: 7320 746f 204b 796c 6520 5765 7374 6661  s to Kyle Westfa
+00016130: 6c6c 2028 5543 4f20 4c69 636b 2920 666f  ll (UCO Lick) fo
+00016140: 7220 6120 6465 7461 696c 6564 0d0a 2020  r a detailed..  
+00016150: 6275 6720 7265 706f 7274 2e0d 0a0d 0a56  bug report.....V
+00016160: 372e 302e 303a 204d 432c 204f 7866 6f72  7.0.0: MC, Oxfor
+00016170: 642c 2031 3020 4a61 6e75 6172 7920 3230  d, 10 January 20
+00016180: 3230 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  20..++++++++++++
+00016190: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000161a0: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2060 6063  +++++++....- ``c
+000161b0: 6170 6669 7460 603a 204e 6577 2067 656e  apfit``: New gen
+000161c0: 6572 616c 206c 696e 6561 7220 6c65 6173  eral linear leas
+000161d0: 742d 7371 7561 7265 7320 6f70 7469 6d69  t-squares optimi
+000161e0: 7a61 7469 6f6e 2066 756e 6374 696f 6e0d  zation function.
+000161f0: 0a20 2060 606c 7371 6c69 6e60 6020 7768  .  ``lsqlin`` wh
+00016200: 6963 6820 6973 206e 6f77 2075 7365 6420  ich is now used 
+00016210: 746f 2073 6f6c 7665 2074 6865 2071 7561  to solve the qua
+00016220: 6472 6174 6963 2073 7562 7072 6f62 6c65  dratic subproble
+00016230: 6d2e 0d0a 2d20 6060 6361 7066 6974 6060  m...- ``capfit``
+00016240: 3a20 416c 6c6f 7720 666f 7220 6c69 6e65  : Allow for line
+00016250: 6172 2069 6e65 7175 616c 6974 792f 6571  ar inequality/eq
+00016260: 7561 6c69 7479 2063 6f6e 7374 7261 696e  uality constrain
+00016270: 7473 0d0a 2020 6060 415f 696e 6571 6060  ts..  ``A_ineq``
+00016280: 2c20 6060 625f 696e 6571 6060 2061 6e64  , ``b_ineq`` and
+00016290: 2020 6060 415f 6571 6060 2c20 6060 625f    ``A_eq``, ``b_
+000162a0: 6571 6060 2e0d 0a2d 2060 6070 7078 6660  eq``...- ``ppxf`
+000162b0: 603a 2055 7365 2028 6661 7374 6572 2920  `: Use (faster) 
+000162c0: 6060 6361 7066 6974 2e6c 7371 6c69 6e60  ``capfit.lsqlin`
+000162d0: 6020 666f 7220 7468 6520 6c69 6e65 6172  ` for the linear
+000162e0: 2066 6974 2e0d 0a2d 2060 6070 7078 6660   fit...- ``ppxf`
+000162f0: 603a 2055 7365 2075 7064 6174 6564 2060  `: Use updated `
+00016300: 6063 6170 6669 742e 6361 7066 6974 6060  `capfit.capfit``
+00016310: 2066 6f72 2074 6865 206e 6f6e 2d6c 696e   for the non-lin
+00016320: 6561 7220 6f70 7469 6d69 7a61 7469 6f6e  ear optimization
+00016330: 2e0d 0a2d 2060 6070 7078 6660 603a 2041  ...- ``ppxf``: A
+00016340: 6c6c 6f77 2066 6f72 206c 696e 6561 7220  llow for linear 
+00016350: 6571 7561 6c69 7469 6573 2f69 6e65 7175  equalities/inequ
+00016360: 616c 6974 6965 7320 666f 7220 626f 7468  alities for both
+00016370: 2074 6865 2074 656d 706c 6174 650d 0a20   the template.. 
+00016380: 2077 6569 6768 7473 2061 6e64 2074 6865   weights and the
+00016390: 206b 696e 656d 6174 6963 2070 6172 616d   kinematic param
+000163a0: 6574 6572 7320 7769 7468 2074 6865 2060  eters with the `
+000163b0: 6063 6f6e 7374 725f 7465 6d70 6c60 6020  `constr_templ`` 
+000163c0: 616e 640d 0a20 2060 6063 6f6e 7374 725f  and..  ``constr_
+000163d0: 6b69 6e65 6d60 6020 6f70 7469 6f6e 616c  kinem`` optional
+000163e0: 206b 6579 776f 7264 732e 0d0a 2d20 6060   keywords...- ``
+000163f0: 7070 7866 6060 3a20 4e65 7720 6060 7365  ppxf``: New ``se
+00016400: 745f 6c69 6e65 6172 5f63 6f6e 7374 7261  t_linear_constra
+00016410: 696e 7473 6060 2066 756e 6374 696f 6e2e  ints`` function.
+00016420: 0d0a 2d20 6060 7070 7866 6060 3a20 5570  ..- ``ppxf``: Up
+00016430: 6461 7465 6420 646f 6375 6d65 6e74 6174  dated documentat
+00016440: 696f 6e2e 0d0a 0d0a 5636 2e37 2e31 373a  ion.....V6.7.17:
+00016450: 204d 432c 204f 7866 6f72 642c 2031 3420   MC, Oxford, 14 
+00016460: 4e6f 7665 6d62 6572 2032 3031 390d 0a2b  November 2019..+
+00016470: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016480: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016490: 2b2b 2b2b 0d0a 0d0a 2d20 6060 6361 7066  ++++....- ``capf
+000164a0: 6974 6060 3a20 5772 6974 7465 6e20 636f  it``: Written co
+000164b0: 6d70 6c65 7465 2064 6f63 756d 656e 7461  mplete documenta
+000164c0: 7469 6f6e 2e0d 0a2d 2060 6063 6170 6669  tion...- ``capfi
+000164d0: 7460 603a 2049 6d70 726f 7665 6420 7072  t``: Improved pr
+000164e0: 696e 7420 666f 726d 6174 7469 6e67 2e0d  int formatting..
+000164f0: 0a2d 2060 6063 6170 6669 7460 603a 2052  .- ``capfit``: R
+00016500: 6574 7572 6e20 6060 2e6d 6573 7361 6765  eturn ``.message
+00016510: 6060 2061 7474 7269 6275 7465 2e0d 0a2d  `` attribute...-
+00016520: 2060 6063 6170 6669 7460 603a 2049 6d70   ``capfit``: Imp
+00016530: 726f 7665 6420 6060 7874 6f6c 6060 2063  roved ``xtol`` c
+00016540: 6f6e 7665 7267 656e 6365 2074 6573 742e  onvergence test.
+00016550: 0d0a 2d20 6060 6361 7066 6974 6060 3a20  ..- ``capfit``: 
+00016560: 4f6e 6c79 2061 6363 6570 7420 6669 6e61  Only accept fina
+00016570: 6c20 6d6f 7665 2069 6620 6060 6368 6932  l move if ``chi2
+00016580: 6060 2064 6563 7265 6173 6564 2e0d 0a2d  `` decreased...-
+00016590: 2060 6063 6170 6669 7460 603a 2053 7472   ``capfit``: Str
+000165a0: 6963 746c 7920 7361 7469 7366 7920 626f  ictly satisfy bo
+000165b0: 756e 6473 2064 7572 696e 6720 4a61 636f  unds during Jaco
+000165c0: 6269 616e 2063 6f6d 7075 7461 7469 6f6e  bian computation
+000165d0: 2e0d 0a0d 0a56 362e 372e 3136 3a20 4d43  .....V6.7.16: MC
+000165e0: 2c20 4f78 666f 7264 2c20 3132 204a 756e  , Oxford, 12 Jun
+000165f0: 6520 3230 3139 0d0a 2b2b 2b2b 2b2b 2b2b  e 2019..++++++++
+00016600: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016610: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2060  +++++++++....- `
+00016620: 6063 6170 6669 7460 603a 2055 7365 206f  `capfit``: Use o
+00016630: 6e6c 7920 6672 6565 2070 6172 616d 6574  nly free paramet
+00016640: 6572 7320 666f 7220 6060 7874 6f6c 6060  ers for ``xtol``
+00016650: 2063 6f6e 7665 7267 656e 6365 2074 6573   convergence tes
+00016660: 742e 0d0a 2d20 6060 6361 7066 6974 6060  t...- ``capfit``
+00016670: 3a20 4465 7363 7269 6265 2069 6e20 776f  : Describe in wo
+00016680: 7264 7320 636f 6e76 6572 6765 6e63 6520  rds convergence 
+00016690: 7374 6174 7573 2077 6974 6820 6e6f 6e7a  status with nonz
+000166a0: 6572 6f20 6060 7665 7262 6f73 6560 602e  ero ``verbose``.
+000166b0: 0d0a 2d20 6060 6361 7066 6974 6060 3a20  ..- ``capfit``: 
+000166c0: 4669 7865 6420 7072 6f67 7261 6d20 7374  Fixed program st
+000166d0: 6f70 2077 6865 6e20 6060 6162 735f 7374  op when ``abs_st
+000166e0: 6570 6060 2069 7320 756e 6465 6669 6e65  ep`` is undefine
+000166f0: 642e 0d0a 2d20 6060 6361 7066 6974 6060  d...- ``capfit``
+00016700: 3a20 4669 7865 6420 6967 6e6f 7269 6e67  : Fixed ignoring
+00016710: 206f 7074 696f 6e61 6c20 6060 6d61 785f   optional ``max_
+00016720: 6e66 6576 6060 2e0d 0a0d 0a56 362e 372e  nfev``.....V6.7.
+00016730: 3135 3a20 4d43 2c20 4f78 666f 7264 2c20  15: MC, Oxford, 
+00016740: 3720 4665 6272 7561 7279 2032 3031 390d  7 February 2019.
+00016750: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
+00016760: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016770: 2b2b 2b2b 2b0d 0a2d 2052 656d 6f76 6564  +++++..- Removed
+00016780: 2075 6e75 7365 6420 6060 7265 6060 2069   unused ``re`` i
+00016790: 6d70 6f72 742e 0d0a 2d20 5265 6d6f 7665  mport...- Remove
+000167a0: 6420 5363 6970 7927 7320 6060 6e65 7874  d Scipy's ``next
+000167b0: 5f66 6173 745f 6c65 6e60 6020 7573 6167  _fast_len`` usag
+000167c0: 6520 6475 6520 746f 2061 6e20 6973 7375  e due to an issu
+000167d0: 6520 7769 7468 206f 6464 2070 6164 6469  e with odd paddi
+000167e0: 6e67 2073 697a 652e 0d0a 2020 5468 616e  ng size...  Than
+000167f0: 6b73 2074 6f20 4572 6963 2045 6d73 656c  ks to Eric Emsel
+00016800: 6c65 6d20 2845 534f 2920 666f 7220 6120  lem (ESO) for a 
+00016810: 636c 6561 7220 6578 616d 706c 6520 696c  clear example il
+00016820: 6c75 7374 7261 7469 6e67 2074 6869 7320  lustrating this 
+00016830: 7261 7265 2061 6e64 0d0a 2020 7375 6274  rare and..  subt
+00016840: 6c65 2062 7567 2e0d 0a0d 0a56 362e 372e  le bug.....V6.7.
+00016850: 3134 3a20 4d43 2c20 4f78 666f 7264 2c20  14: MC, Oxford, 
+00016860: 3237 204e 6f76 656d 6265 7220 3230 3138  27 November 2018
+00016870: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+00016880: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016890: 2b2b 2b2b 2b2b 2b2b 0d0a 2d20 5072 696e  ++++++++..- Prin
+000168a0: 7420 7468 6520 7573 6564 2060 6074 6965  t the used ``tie
+000168b0: 6460 6020 7061 7261 6d65 7465 7273 2065  d`` parameters e
+000168c0: 7175 616c 6974 6965 732c 2069 6620 616e  qualities, if an
+000168d0: 792e 0d0a 2d20 5265 7475 726e 2060 602e  y...- Return ``.
+000168e0: 6e64 6f66 6060 2061 7474 7269 6275 7465  ndof`` attribute
+000168f0: 2e0d 0a2d 2044 6f20 6e6f 7420 7265 6d6f  ...- Do not remo
+00016900: 7665 2060 6066 6978 6564 6060 206f 7220  ve ``fixed`` or 
+00016910: 6060 7469 6564 6060 2070 6172 616d 6574  ``tied`` paramet
+00016920: 6572 7320 6672 6f6d 2074 6865 2044 4f46  ers from the DOF
+00016930: 2063 616c 6375 6c61 7469 6f6e 2e0d 0a20   calculation... 
+00016940: 2054 6861 6e6b 7320 746f 204a 6f61 6e6e   Thanks to Joann
+00016950: 6120 576f 6f20 2855 6e69 762e 206f 6620  a Woo (Univ. of 
+00016960: 5669 6374 6f72 6961 2920 666f 7220 7468  Victoria) for th
+00016970: 6520 636f 7272 6563 7469 6f6e 2e0d 0a2d  e correction...-
+00016980: 2052 6570 6c61 6365 6420 6060 6e6f 726d   Replaced ``norm
+00016990: 616c 697a 6560 602c 2060 606d 696e 5f61  alize``, ``min_a
+000169a0: 6765 6060 2c20 6060 6d61 785f 6167 6560  ge``, ``max_age`
+000169b0: 6020 616e 6420 6060 6d65 7461 6c60 6020  ` and ``metal`` 
+000169c0: 6b65 7977 6f72 6473 2077 6974 680d 0a20  keywords with.. 
+000169d0: 2060 606e 6f72 6d5f 7261 6e67 6560 602c   ``norm_range``,
+000169e0: 2060 6061 6765 5f72 616e 6765 6060 2061   ``age_range`` a
+000169f0: 6e64 2060 606d 6574 616c 5f72 616e 6765  nd ``metal_range
+00016a00: 6060 2069 6e20 6060 7070 7866 2e6d 696c  `` in ``ppxf.mil
+00016a10: 6573 5f75 7469 6c2e 6d69 6c65 7360 602e  es_util.miles``.
+00016a20: 0d0a 2d20 4669 7865 6420 6060 636c 6f63  ..- Fixed ``cloc
+00016a30: 6b60 6020 6060 4465 7072 6563 6174 696f  k`` ``Deprecatio
+00016a40: 6e57 6172 6e69 6e67 6060 2069 6e20 5079  nWarning`` in Py
+00016a50: 7468 6f6e 2033 2e37 2e0d 0a0d 0a56 362e  thon 3.7.....V6.
+00016a60: 372e 3133 3a20 4d43 2c20 4f78 666f 7264  7.13: MC, Oxford
+00016a70: 2c20 3230 2053 6570 7465 6d62 6572 2032  , 20 September 2
+00016a80: 3031 380d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  018..+++++++++++
+00016a90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016aa0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a2d 2045  +++++++++++..- E
+00016ab0: 7870 616e 6465 6420 646f 6375 6d65 6e74  xpanded document
+00016ac0: 6174 696f 6e20 6f66 2060 6072 6564 6465  ation of ``redde
+00016ad0: 6e69 6e67 6060 2061 6e64 2060 6067 6173  ning`` and ``gas
+00016ae0: 5f72 6564 6465 6e69 6e67 6060 2e0d 0a20  _reddening``... 
+00016af0: 2054 6861 6e6b 7320 746f 204e 6963 6b20   Thanks to Nick 
+00016b00: 426f 6172 646d 616e 2028 556e 6976 2e20  Boardman (Univ. 
+00016b10: 5574 6168 2920 666f 7220 7468 6520 6665  Utah) for the fe
+00016b20: 6564 6261 636b 2e0d 0a2d 2060 6063 6170  edback...- ``cap
+00016b30: 6669 7460 6020 6e6f 7720 7261 6973 6573  fit`` now raises
+00016b40: 2061 6e20 6572 726f 7220 6966 206f 6e65   an error if one
+00016b50: 2074 7269 6573 2074 6f20 7469 6520 7061   tries to tie pa
+00016b60: 7261 6d65 7465 7273 2074 6f20 7468 656d  rameters to them
+00016b70: 7365 6c76 6573 2e0d 0a20 2054 6861 6e6b  selves...  Thank
+00016b80: 7320 746f 204b 796c 6520 5765 7374 6661  s to Kyle Westfa
+00016b90: 6c6c 2028 556e 6976 2e20 5361 6e74 6120  ll (Univ. Santa 
+00016ba0: 4372 757a 2920 666f 7220 7468 6520 7375  Cruz) for the su
+00016bb0: 6767 6573 7469 6f6e 2e0d 0a2d 2060 6063  ggestion...- ``c
+00016bc0: 6170 6669 7460 6020 7573 6573 2050 7974  apfit`` uses Pyt
+00016bd0: 686f 6e20 332e 3620 662d 7374 7269 6e67  hon 3.6 f-string
+00016be0: 732e 0d0a 0d0a 5636 2e37 2e31 323a 204d  s.....V6.7.12: M
+00016bf0: 432c 204f 7866 6f72 642c 2039 204a 756c  C, Oxford, 9 Jul
+00016c00: 7920 3230 3138 0d0a 2b2b 2b2b 2b2b 2b2b  y 2018..++++++++
+00016c10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016c20: 2b2b 2b2b 2b2b 2b2b 0d0a 2d20 416c 6c6f  ++++++++..- Allo
+00016c30: 7720 666f 7220 6060 7665 6c73 6361 6c65  w for ``velscale
+00016c40: 6060 2061 6e64 2060 6076 7379 7374 6060  `` and ``vsyst``
+00016c50: 2074 6f20 6265 204e 756d 7079 2061 7272   to be Numpy arr
+00016c60: 6179 7320 7261 7468 6572 2074 6861 6e20  ays rather than 
+00016c70: 7363 616c 6172 732e 0d0a 2d20 496d 7072  scalars...- Impr
+00016c80: 6f76 6564 2063 7269 7465 7269 6f6e 2066  oved criterion f
+00016c90: 6f72 2077 6865 6e20 7468 6520 4261 6c6d  or when the Balm
+00016ca0: 6572 2073 6572 6965 7320 6973 2077 6974  er series is wit
+00016cb0: 6869 6e20 7468 6520 6669 7474 6564 2077  hin the fitted w
+00016cc0: 6176 656c 656e 6774 680d 0a20 2072 616e  avelength..  ran
+00016cd0: 6765 2069 6e20 6060 7070 7866 2e70 7078  ge in ``ppxf.ppx
+00016ce0: 665f 7574 696c 2e65 6d69 7373 696f 6e5f  f_util.emission_
+00016cf0: 6c69 6e65 7360 602e 2054 6861 6e6b 7320  lines``. Thanks 
+00016d00: 746f 2053 616d 2056 6175 6768 616e 0d0a  to Sam Vaughan..
+00016d10: 2020 2855 6e69 762e 206f 6620 4f78 666f    (Univ. of Oxfo
+00016d20: 7264 2920 666f 7220 7468 6520 6665 6564  rd) for the feed
+00016d30: 6261 636b 2e0d 0a2d 2049 6e63 6c75 6465  back...- Include
+00016d40: 6420 6060 7769 6474 6860 6020 6b65 7977  d ``width`` keyw
+00016d50: 6f72 6420 696e 2060 6070 7078 662e 7070  ord in ``ppxf.pp
+00016d60: 7866 5f75 7469 6c2e 6465 7465 726d 696e  xf_util.determin
+00016d70: 655f 676f 6f64 7069 7865 6c73 6060 2e0d  e_goodpixels``..
+00016d80: 0a20 2054 6861 6e6b 7320 746f 2047 656f  .  Thanks to Geo
+00016d90: 7267 6520 5072 6976 6f6e 2028 556e 6976  rge Privon (Univ
+00016da0: 2e20 6f66 2046 6c6f 7269 6461 2920 666f  . of Florida) fo
+00016db0: 7220 7468 6520 7375 6767 6573 7469 6f6e  r the suggestion
+00016dc0: 2e0d 0a2d 2045 7870 616e 6465 6420 6060  ...- Expanded ``
+00016dd0: 2e67 6173 5f66 6c75 7860 6020 646f 6375  .gas_flux`` docu
+00016de0: 6d65 6e74 6174 696f 6e2e 0d0a 0d0a 5636  mentation.....V6
+00016df0: 2e37 2e31 313a 204d 432c 204f 7866 6f72  .7.11: MC, Oxfor
+00016e00: 642c 2035 204a 756e 6520 3230 3138 0d0a  d, 5 June 2018..
 00016e10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016e20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
-00016e30: 2050 6c6f 7420 7761 7665 6c65 6e67 7468   Plot wavelength
-00016e40: 2069 6e20 6e6d 2069 6e73 7465 6164 206f   in nm instead o
-00016e50: 6620 416e 6773 7472 6f6d 2c20 666f 6c6c  f Angstrom, foll
-00016e60: 6f77 696e 6720 4941 5520 7275 6c65 732e  owing IAU rules.
-00016e70: 0d0a 2d20 456e 7375 7265 7320 6561 6368  ..- Ensures each
-00016e80: 2065 6c65 6d65 6e74 206f 6620 6060 7374   element of ``st
-00016e90: 6172 7460 6020 6973 206e 6f74 206c 6f6e  art`` is not lon
-00016ea0: 6765 7220 7468 616e 2069 7473 2060 606d  ger than its ``m
-00016eb0: 6f6d 656e 7473 6060 2e0d 0a2d 2052 656d  oments``...- Rem
-00016ec0: 6f76 6564 2075 6e64 6572 7363 6f72 6520  oved underscore 
-00016ed0: 6672 6f6d 2069 6e74 6572 6e61 6c20 6675  from internal fu
-00016ee0: 6e63 7469 6f6e 206e 616d 6573 2e0d 0a2d  nction names...-
-00016ef0: 2049 6e63 6c75 6465 6420 6060 6674 6f6c   Included ``ftol
-00016f00: 6060 206b 6579 776f 7264 2e0d 0a0d 0a56  `` keyword.....V
-00016f10: 362e 372e 323a 204d 432c 204f 7866 6f72  6.7.2: MC, Oxfor
-00016f20: 642c 2033 3020 4a61 6e75 6172 7920 3230  d, 30 January 20
-00016f30: 3138 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  18..++++++++++++
+00016e20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016e30: 0d0a 0d0a 2d20 466f 726d 6174 7465 6420  ....- Formatted 
+00016e40: 6060 7070 7866 2e70 7960 6020 646f 6373  ``ppxf.py`` docs
+00016e50: 7472 696e 6720 696e 2072 6553 7472 7563  tring in reStruc
+00016e60: 7475 7265 6454 6578 742e 0d0a 2d20 5265  turedText...- Re
+00016e70: 6d6f 7665 6420 4348 414e 4745 4c4f 4720  moved CHANGELOG 
+00016e80: 6672 6f6d 2074 6865 2063 6f64 6520 616e  from the code an
+00016e90: 6420 706c 6163 6564 2069 7420 696e 2061  d placed it in a
+00016ea0: 2073 6570 6172 6174 6520 6669 6c65 2e0d   separate file..
+00016eb0: 0a2d 204d 6f64 6966 6965 6420 6060 7365  .- Modified ``se
+00016ec0: 7475 702e 7079 6060 2074 6f20 7368 6f77  tup.py`` to show
+00016ed0: 2068 656c 7020 616e 6420 4348 414e 4745   help and CHANGE
+00016ee0: 4c4f 4720 6f6e 2050 7950 6920 7061 6765  LOG on PyPi page
+00016ef0: 2e0d 0a2d 2049 6e63 6c75 6465 6420 6060  ...- Included ``
+00016f00: 7070 7866 2e5f 5f76 6572 7369 6f6e 5f5f  ppxf.__version__
+00016f10: 6060 2e0d 0a0d 0a56 362e 372e 383a 204d  ``.....V6.7.8: M
+00016f20: 432c 204f 7866 6f72 642c 2032 3120 4d61  C, Oxford, 21 Ma
+00016f30: 7920 3230 3138 0d0a 2b2b 2b2b 2b2b 2b2b  y 2018..++++++++
 00016f40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00016f50: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2049 6e63  +++++++....- Inc
-00016f60: 6c75 6465 6420 6475 6e64 6572 206e 616d  luded dunder nam
-00016f70: 6573 2061 7320 7375 6767 6573 7465 6420  es as suggested 
-00016f80: 6279 2050 6574 6572 2057 6569 6c62 6163  by Peter Weilbac
-00016f90: 6865 7220 2850 6f74 7364 616d 292e 0d0a  her (Potsdam)...
-00016fa0: 2d20 4669 7865 6420 7772 6f6e 6720 6060  - Fixed wrong ``
-00016fb0: 2e67 6173 5f72 6564 6465 6e69 6e67 6060  .gas_reddening``
-00016fc0: 2077 6865 6e20 6060 6d64 6567 7265 6520   when ``mdegree 
-00016fd0: 3e20 3060 602e 0d0a 2d20 496d 7072 6f76  > 0``...- Improv
-00016fe0: 6564 2066 6f72 6d61 7474 696e 6720 6f66  ed formatting of
-00016ff0: 2074 6865 2064 6f63 756d 656e 7461 7469   the documentati
-00017000: 6f6e 2e0d 0a0d 0a56 362e 372e 313a 204d  on.....V6.7.1: M
-00017010: 432c 204f 7866 6f72 642c 2032 3920 4e6f  C, Oxford, 29 No
-00017020: 7665 6d62 6572 2032 3031 370d 0a2b 2b2b  vember 2017..+++
-00017030: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017040: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017050: 2b0d 0a0d 0a2d 2052 656d 6f76 6564 2069  +....- Removed i
-00017060: 6d70 6f72 7420 6f66 2060 606d 6973 632e  mport of ``misc.
-00017070: 6661 6374 6f72 6961 6c60 602c 2064 6570  factorial``, dep
-00017080: 7265 6361 7465 6420 696e 2053 6369 7079  recated in Scipy
-00017090: 2031 2e30 2e0d 0a0d 0a56 362e 372e 303a   1.0.....V6.7.0:
-000170a0: 204d 432c 204f 7866 6f72 642c 2036 204e   MC, Oxford, 6 N
-000170b0: 6f76 656d 6265 7220 3230 3137 0d0a 2b2b  ovember 2017..++
-000170c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000170d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000170e0: 2b0d 0a0d 0a2d 2041 6c6c 6f77 2075 7365  +....- Allow use
-000170f0: 7273 2074 6f20 696e 7075 7420 6964 656e  rs to input iden
-00017100: 7469 6361 6c6c 7920 7a65 726f 2067 6173  tically zero gas
-00017110: 2074 656d 706c 6174 6573 2077 6869 6c65   templates while
-00017120: 2073 7469 6c6c 0d0a 2020 7072 6f64 7563   still..  produc
-00017130: 696e 6720 6120 7374 6162 6c65 204e 4e4c  ing a stable NNL
-00017140: 5320 736f 6c75 7469 6f6e 2e20 496e 2074  S solution. In t
-00017150: 6869 7320 6361 7365 2c20 7761 726e 2074  his case, warn t
-00017160: 6865 2075 7365 7220 616e 6420 7365 740d  he user and set.
-00017170: 0a20 2074 6865 202e 6761 735f 7a65 726f  .  the .gas_zero
-00017180: 5f74 656d 706c 6174 6520 6174 7472 6962  _template attrib
-00017190: 7574 652e 2054 6869 7320 7369 7475 6174  ute. This situat
-000171a0: 696f 6e20 6361 6e20 696e 6469 6361 7465  ion can indicate
-000171b0: 2061 6e20 696e 7075 740d 0a20 2062 7567   an input..  bug
-000171c0: 206f 7220 6120 6761 7320 6c69 6e65 2074   or a gas line t
-000171d0: 6861 7420 656e 7469 7265 6c79 2066 616c  hat entirely fal
-000171e0: 6c73 2077 6974 6869 6e20 6120 6d61 736b  ls within a mask
-000171f0: 6564 2072 6567 696f 6e2e 0d0a 2d20 436f  ed region...- Co
-00017200: 7272 6563 7465 6420 6060 6761 735f 666c  rrected ``gas_fl
-00017210: 7578 5f65 7272 6f72 6060 206e 6f72 6d61  ux_error`` norma
-00017220: 6c69 7a61 7469 6f6e 2c20 7768 656e 2069  lization, when i
-00017230: 6e70 7574 206e 6f74 206e 6f72 6d61 6c69  nput not normali
-00017240: 7a65 642e 0d0a 2d20 5265 7475 726e 2060  zed...- Return `
-00017250: 602e 6761 735f 6265 7374 6669 7460 602c  `.gas_bestfit``,
-00017260: 2060 602e 6761 735f 6d70 6f6c 7960 602c   ``.gas_mpoly``,
-00017270: 2060 602e 6d70 6f6c 7960 6020 616e 6420   ``.mpoly`` and 
-00017280: 6060 2e61 706f 6c79 6060 2061 7474 7269  ``.apoly`` attri
-00017290: 6275 7465 732e 0d0a 2d20 446f 206e 6f74  butes...- Do not
-000172a0: 206d 756c 7469 706c 7920 6761 7320 656d   multiply gas em
-000172b0: 6973 7369 6f6e 206c 696e 6573 2062 7920  ission lines by 
-000172c0: 706f 6c79 6e6f 6d69 616c 732c 2069 6e73  polynomials, ins
-000172d0: 7465 6164 2061 6c6c 6f77 2066 6f72 0d0a  tead allow for..
-000172e0: 2020 6060 6761 735f 7265 6464 656e 696e    ``gas_reddenin
-000172f0: 6760 6020 2875 7365 6675 6c20 7769 7468  g`` (useful with
-00017300: 2074 6965 6420 4261 6c6d 6572 2065 6d69   tied Balmer emi
-00017310: 7373 696f 6e20 6c69 6e65 7329 2e0d 0a2d  ssion lines)...-
-00017320: 2055 7365 2060 6061 7876 7370 616e 6060   Use ``axvspan``
-00017330: 2074 6f20 7669 7375 616c 697a 6520 6d61   to visualize ma
-00017340: 736b 6564 2072 6567 696f 6e73 2069 6e20  sked regions in 
-00017350: 7468 6520 706c 6f74 2e0d 0a2d 2046 6978  the plot...- Fix
-00017360: 6564 2070 726f 6772 616d 2073 746f 7020  ed program stop 
-00017370: 7769 7468 2060 606c 696e 6561 7260 6020  with ``linear`` 
-00017380: 6b65 7977 6f72 642e 0d0a 2d20 496e 7472  keyword...- Intr
-00017390: 6f64 7563 6564 2060 6072 6564 6465 6e69  oduced ``reddeni
-000173a0: 6e67 5f66 756e 6360 6020 6b65 7977 6f72  ng_func`` keywor
-000173b0: 642e 0d0a 0d0a 5636 2e36 2e34 3a20 4d43  d.....V6.6.4: MC
-000173c0: 2c20 4f78 666f 7264 2c20 3520 4f63 746f  , Oxford, 5 Octo
-000173d0: 6265 7220 3230 3137 0d0a 2b2b 2b2b 2b2b  ber 2017..++++++
+00016f50: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 204d 6f76  +++++++....- Mov
+00016f60: 6564 2070 6163 6b61 6765 2074 6f20 7468  ed package to th
+00016f70: 6520 5079 7468 6f6e 2050 6163 6b61 6765  e Python Package
+00016f80: 2049 6e64 6578 2028 5079 5069 292e 0d0a   Index (PyPi)...
+00016f90: 2d20 4472 6f70 7065 6420 6c65 6761 6379  - Dropped legacy
+00016fa0: 2050 7974 686f 6e20 322e 3720 7375 7070   Python 2.7 supp
+00016fb0: 6f72 742e 0d0a 0d0a 5636 2e37 2e36 3a20  ort.....V6.7.6: 
+00016fc0: 4d43 2c20 4f78 666f 7264 2c20 3136 2041  MC, Oxford, 16 A
+00016fd0: 7072 696c 2032 3031 380d 0a2b 2b2b 2b2b  pril 2018..+++++
+00016fe0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00016ff0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+00017000: 2d20 4368 616e 6765 6420 696d 706f 7274  - Changed import
+00017010: 7320 666f 7220 7468 6520 636f 6e76 6572  s for the conver
+00017020: 7369 6f6e 206f 6620 7050 5846 2074 6f20  sion of pPXF to 
+00017030: 6120 7061 636b 6167 652e 0d0a 2020 5468  a package...  Th
+00017040: 616e 6b73 2074 6f20 4a6f 6520 4275 7263  anks to Joe Burc
+00017050: 6865 7474 2028 5361 6e74 6120 4372 757a  hett (Santa Cruz
+00017060: 2920 666f 7220 7468 6520 7375 6767 6573  ) for the sugges
+00017070: 7469 6f6e 2e0d 0a0d 0a56 362e 372e 353a  tion.....V6.7.5:
+00017080: 204d 432c 204f 7866 6f72 642c 2031 3020   MC, Oxford, 10 
+00017090: 4170 7269 6c20 3230 3138 0d0a 2b2b 2b2b  April 2018..++++
+000170a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000170b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+000170c0: 0a2d 2046 6978 6564 2073 796e 7461 7820  .- Fixed syntax 
+000170d0: 6572 726f 7220 756e 6465 7220 5079 7468  error under Pyth
+000170e0: 6f6e 2032 2e37 2e0d 0a0d 0a56 362e 372e  on 2.7.....V6.7.
+000170f0: 343a 204d 432c 204f 7866 6f72 642c 2031  4: MC, Oxford, 1
+00017100: 3620 4665 6272 7561 7279 2032 3031 380d  6 February 2018.
+00017110: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
+00017120: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017130: 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978 6564  +++++....- Fixed
+00017140: 2062 7567 2069 6e20 6060 7265 6464 656e   bug in ``redden
+00017150: 696e 675f 6361 6c30 3028 2960 602e 2049  ing_cal00()``. I
+00017160: 7420 6f6e 6c79 2061 6666 6563 7465 6420  t only affected 
+00017170: 4e49 5220 6c61 6d20 3e20 3130 3030 206e  NIR lam > 1000 n
+00017180: 6d2e 0d0a 0d0a 5636 2e37 2e33 3a20 4d43  m.....V6.7.3: MC
+00017190: 2c20 4f78 666f 7264 2c20 3820 4665 6272  , Oxford, 8 Febr
+000171a0: 7561 7279 2032 3031 380d 0a2b 2b2b 2b2b  uary 2018..+++++
+000171b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000171c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
+000171d0: 0d0a 2d20 506c 6f74 2077 6176 656c 656e  ..- Plot wavelen
+000171e0: 6774 6820 696e 206e 6d20 696e 7374 6561  gth in nm instea
+000171f0: 6420 6f66 2041 6e67 7374 726f 6d2c 2066  d of Angstrom, f
+00017200: 6f6c 6c6f 7769 6e67 2049 4155 2072 756c  ollowing IAU rul
+00017210: 6573 2e0d 0a2d 2045 6e73 7572 6573 2065  es...- Ensures e
+00017220: 6163 6820 656c 656d 656e 7420 6f66 2060  ach element of `
+00017230: 6073 7461 7274 6060 2069 7320 6e6f 7420  `start`` is not 
+00017240: 6c6f 6e67 6572 2074 6861 6e20 6974 7320  longer than its 
+00017250: 6060 6d6f 6d65 6e74 7360 602e 0d0a 2d20  ``moments``...- 
+00017260: 5265 6d6f 7665 6420 756e 6465 7273 636f  Removed undersco
+00017270: 7265 2066 726f 6d20 696e 7465 726e 616c  re from internal
+00017280: 2066 756e 6374 696f 6e20 6e61 6d65 732e   function names.
+00017290: 0d0a 2d20 496e 636c 7564 6564 2060 6066  ..- Included ``f
+000172a0: 746f 6c60 6020 6b65 7977 6f72 642e 0d0a  tol`` keyword...
+000172b0: 0d0a 5636 2e37 2e32 3a20 4d43 2c20 4f78  ..V6.7.2: MC, Ox
+000172c0: 666f 7264 2c20 3330 204a 616e 7561 7279  ford, 30 January
+000172d0: 2032 3031 380d 0a2b 2b2b 2b2b 2b2b 2b2b   2018..+++++++++
+000172e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000172f0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
+00017300: 496e 636c 7564 6564 2064 756e 6465 7220  Included dunder 
+00017310: 6e61 6d65 7320 6173 2073 7567 6765 7374  names as suggest
+00017320: 6564 2062 7920 5065 7465 7220 5765 696c  ed by Peter Weil
+00017330: 6261 6368 6572 2028 506f 7473 6461 6d29  bacher (Potsdam)
+00017340: 2e0d 0a2d 2046 6978 6564 2077 726f 6e67  ...- Fixed wrong
+00017350: 2060 602e 6761 735f 7265 6464 656e 696e   ``.gas_reddenin
+00017360: 6760 6020 7768 656e 2060 606d 6465 6772  g`` when ``mdegr
+00017370: 6565 203e 2030 6060 2e0d 0a2d 2049 6d70  ee > 0``...- Imp
+00017380: 726f 7665 6420 666f 726d 6174 7469 6e67  roved formatting
+00017390: 206f 6620 7468 6520 646f 6375 6d65 6e74   of the document
+000173a0: 6174 696f 6e2e 0d0a 0d0a 5636 2e37 2e31  ation.....V6.7.1
+000173b0: 3a20 4d43 2c20 4f78 666f 7264 2c20 3239  : MC, Oxford, 29
+000173c0: 204e 6f76 656d 6265 7220 3230 3137 0d0a   November 2017..
+000173d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 000173e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000173f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-00017400: 2d20 4368 6563 6b20 666f 7220 4e61 4e20  - Check for NaN 
-00017410: 696e 2060 6067 616c 6178 7960 6020 616e  in ``galaxy`` an
-00017420: 6420 6368 6563 6b20 616c 6c20 6060 626f  d check all ``bo
-00017430: 756e 6473 6060 2068 6176 6520 7477 6f20  unds`` have two 
-00017440: 656c 656d 656e 7473 2e0d 0a2d 2041 6c6c  elements...- All
-00017450: 6f77 2060 6073 7461 7274 6060 2074 6f20  ow ``start`` to 
-00017460: 6265 2065 6974 6865 7220 6120 6c69 7374  be either a list
-00017470: 206f 7220 616e 2061 7272 6179 206f 7220   or an array or 
-00017480: 7665 6374 6f72 732e 0d0a 0d0a 5636 2e36  vectors.....V6.6
-00017490: 2e33 3a20 4d43 2c20 4f78 666f 7264 2c20  .3: MC, Oxford, 
-000174a0: 3235 2053 6570 7465 6d62 6572 2032 3031  25 September 201
-000174b0: 370d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  7..+++++++++++++
-000174c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000174d0: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5265  ++++++++....- Re
-000174e0: 6475 6365 6420 626f 756e 6473 206f 6e20  duced bounds on 
-000174f0: 6d75 6c74 6970 6c69 6361 7469 7665 2070  multiplicative p
-00017500: 6f6c 796e 6f6d 6961 6c73 2061 6e64 2063  olynomials and c
-00017510: 6c69 7070 6564 2074 6f20 706f 7369 7469  lipped to positi
-00017520: 7665 0d0a 2020 7661 6c75 6573 2e20 5468  ve..  values. Th
-00017530: 616e 6b73 2074 6f20 5869 6861 6e20 4a69  anks to Xihan Ji
-00017540: 2028 5473 696e 6768 7561 2055 6e69 7665   (Tsinghua Unive
-00017550: 7273 6974 7929 2066 6f72 2070 726f 7669  rsity) for provi
-00017560: 6469 6e67 2061 6e0d 0a20 2065 7861 6d70  ding an..  examp
-00017570: 6c65 206f 6620 736c 6967 6874 6c79 206e  le of slightly n
-00017580: 6567 6174 6976 6520 6761 7320 656d 6973  egative gas emis
-00017590: 7369 6f6e 206c 696e 6573 2c20 7768 656e  sion lines, when
-000175a0: 2074 6865 2073 7065 6374 7275 6d0d 0a20   the spectrum.. 
-000175b0: 2063 6f6e 7461 696e 7320 6573 7365 6e74   contains essent
-000175c0: 6961 6c6c 7920 6a75 7374 206e 6f69 7365  ially just noise
-000175d0: 2e0d 0a2d 2049 6d70 726f 7665 6420 7669  ...- Improved vi
-000175e0: 7375 616c 697a 6174 696f 6e20 6f66 206d  sualization of m
-000175f0: 6173 6b65 6420 7069 7865 6c73 2e0d 0a0d  asked pixels....
-00017600: 0a56 362e 362e 323a 204d 432c 204f 7866  .V6.6.2: MC, Oxf
-00017610: 6f72 642c 2031 3520 5365 7074 656d 6265  ord, 15 Septembe
-00017620: 7220 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b  r 2017..++++++++
-00017630: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017640: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00017650: 0a2d 2046 6978 6564 2070 726f 6772 616d  .- Fixed program
-00017660: 2073 746f 7020 7769 7468 2061 2032 2d64   stop with a 2-d
-00017670: 696d 2074 656d 706c 6174 6520 6172 7261  im template arra
-00017680: 7920 616e 6420 7265 6775 6c61 7269 7a61  y and regulariza
-00017690: 7469 6f6e 2e0d 0a20 2054 6861 6e6b 7320  tion...  Thanks 
-000176a0: 746f 2041 6472 6961 6e6f 2050 6f63 6920  to Adriano Poci 
-000176b0: 284d 6163 7175 6172 6965 2055 6e69 7665  (Macquarie Unive
-000176c0: 7273 6974 7929 2066 6f72 2074 6865 2063  rsity) for the c
-000176d0: 6c65 6172 2072 6570 6f72 7420 616e 640d  lear report and.
-000176e0: 0a20 2074 6865 2066 6978 2e0d 0a0d 0a56  .  the fix.....V
-000176f0: 362e 362e 313a 204d 432c 204f 7866 6f72  6.6.1: MC, Oxfor
-00017700: 642c 2034 2041 7567 7573 7420 3230 3137  d, 4 August 2017
-00017710: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-00017720: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017730: 2b2b 2b0d 0a0d 0a2d 2049 6e63 6c75 6465  +++....- Include
-00017740: 6420 6e6f 7465 206f 6e20 6060 2e67 6173  d note on ``.gas
-00017750: 5f66 6c75 7860 6020 6f75 7470 7574 2075  _flux`` output u
-00017760: 6e69 7473 2e20 5468 616e 6b73 2074 6f20  nits. Thanks to 
-00017770: 5869 6861 6e20 4a69 0d0a 2020 2854 7369  Xihan Ji..  (Tsi
-00017780: 6e67 6875 6120 556e 6976 6572 7369 7479  nghua University
-00017790: 2920 666f 7220 7468 6520 6665 6564 6261  ) for the feedba
-000177a0: 636b 2e0d 0a0d 0a56 362e 362e 303a 204d  ck.....V6.6.0: M
-000177b0: 432c 204f 7866 6f72 642c 2032 3720 4a75  C, Oxford, 27 Ju
-000177c0: 6e65 2032 3031 370d 0a2b 2b2b 2b2b 2b2b  ne 2017..+++++++
-000177d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000177e0: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2050  +++++++++....- P
-000177f0: 7269 6e74 2061 6e64 2072 6574 7572 6e20  rint and return 
-00017800: 6761 7320 666c 7578 6573 2061 6e64 2065  gas fluxes and e
-00017810: 7272 6f72 732c 2069 6620 7265 7175 6573  rrors, if reques
-00017820: 7465 642c 2077 6974 6820 7468 6520 6e65  ted, with the ne
-00017830: 770d 0a20 2060 6067 6173 5f63 6f6d 706f  w..  ``gas_compo
-00017840: 6e65 6e74 6060 2061 6e64 2060 6067 6173  nent`` and ``gas
-00017850: 5f6e 616d 6573 6060 206b 6579 776f 7264  _names`` keyword
-00017860: 732e 0d0a 0d0a 5636 2e35 2e30 3a20 4d43  s.....V6.5.0: MC
-00017870: 2c20 4f78 666f 7264 2c20 3233 204a 756e  , Oxford, 23 Jun
-00017880: 6520 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b  e 2017..++++++++
-00017890: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000178a0: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5265  ++++++++....- Re
-000178b0: 706c 6163 6564 2060 604d 5046 4954 6060  placed ``MPFIT``
-000178c0: 2077 6974 6820 6060 6361 7066 6974 6060   with ``capfit``
-000178d0: 2066 6f72 2061 204c 6576 656e 6265 7267   for a Levenberg
-000178e0: 2d4d 6172 7175 6172 6474 206d 6574 686f  -Marquardt metho
-000178f0: 6420 7769 7468 0d0a 2020 6669 7865 6420  d with..  fixed 
-00017900: 6f72 2074 6965 6420 7661 7269 6162 6c65  or tied variable
-00017910: 732c 2077 6869 6368 2072 6967 6f72 6f75  s, which rigorou
-00017920: 736c 7920 6163 636f 756e 7473 2066 6f72  sly accounts for
-00017930: 2062 6f78 2063 6f6e 7374 7261 696e 7473   box constraints
-00017940: 2e0d 0a0d 0a56 362e 342e 323a 204d 432c  .....V6.4.2: MC,
-00017950: 204f 7866 6f72 642c 2032 204a 756e 6520   Oxford, 2 June 
-00017960: 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2017..++++++++++
-00017970: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017980: 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978 6564  +++++....- Fixed
-00017990: 2072 656d 6f76 616c 206f 6620 626f 756e   removal of boun
-000179a0: 6473 2069 6e20 736f 6c75 7469 6f6e 2c20  ds in solution, 
-000179b0: 696e 7472 6f64 7563 6564 2069 6e20 5636  introduced in V6
-000179c0: 2e34 2e31 2e0d 0a20 2054 6861 6e6b 7320  .4.1...  Thanks 
-000179d0: 746f 204b 796c 6520 5765 7374 6661 6c6c  to Kyle Westfall
-000179e0: 2028 556e 6976 2e20 5361 6e74 6120 4372   (Univ. Santa Cr
-000179f0: 757a 2920 666f 7220 7265 706f 7274 696e  uz) for reportin
-00017a00: 6720 7468 6973 2e0d 0a2d 2049 6e63 6c75  g this...- Inclu
-00017a10: 6465 6420 6060 6d65 7468 6f64 6060 206b  ded ``method`` k
-00017a20: 6579 776f 7264 2074 6f20 7573 6520 5363  eyword to use Sc
-00017a30: 6970 7927 7320 6060 6c65 6173 745f 7371  ipy's ``least_sq
-00017a40: 7561 7265 7328 2960 600d 0a20 2061 7320  uares()``..  as 
-00017a50: 616e 2061 6c74 6572 6e61 7469 7665 2074  an alternative t
-00017a60: 6f20 4d50 4649 542e 0d0a 2d20 466f 7263  o MPFIT...- Forc
-00017a70: 6520 666c 6f61 7420 6469 7669 7369 6f6e  e float division
-00017a80: 2069 6e20 7069 7865 6c20 636f 6e76 6572   in pixel conver
-00017a90: 7369 6f6e 206f 6620 6060 7374 6172 7460  sion of ``start`
-00017aa0: 6020 616e 6420 6060 626f 756e 6473 6060  ` and ``bounds``
-00017ab0: 2e0d 0a0d 0a56 362e 342e 313a 204d 432c  .....V6.4.1: MC,
-00017ac0: 204f 7866 6f72 642c 2032 3520 4d61 7920   Oxford, 25 May 
-00017ad0: 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2017..++++++++++
-00017ae0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017af0: 2b2b 2b2b 2b0d 0a0d 0a2d 2060 606c 696e  +++++....- ``lin
-00017b00: 6561 725f 6669 7428 2960 6020 646f 6573  ear_fit()`` does
-00017b10: 206e 6f74 2072 6574 7572 6e20 756e 7573   not return unus
-00017b20: 6564 2073 7461 7475 7320 616e 796d 6f72  ed status anymor
-00017b30: 652c 2066 6f72 0d0a 2020 636f 6e73 6973  e, for..  consis
-00017b40: 7465 6e63 7920 7769 7468 2074 6865 2063  tency with the c
-00017b50: 6f72 7265 7370 6f6e 6469 6e67 2063 6861  orresponding cha
-00017b60: 6e67 6520 746f 2060 6063 6170 5f6d 7066  nge to ``cap_mpf
-00017b70: 6974 6060 2e0d 0a0d 0a56 362e 342e 303a  it``.....V6.4.0:
-00017b80: 204d 432c 204f 7866 6f72 642c 2031 3220   MC, Oxford, 12 
-00017b90: 4d61 7920 3230 3137 0d0a 2b2b 2b2b 2b2b  May 2017..++++++
-00017ba0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017bb0: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2049  +++++++++....- I
-00017bc0: 6e74 726f 6475 6365 6420 6060 7469 6564  ntroduced ``tied
-00017bd0: 6060 206b 6579 776f 7264 2074 6f20 7469  `` keyword to ti
-00017be0: 6520 7061 7261 6d65 7465 7273 2064 7572  e parameters dur
-00017bf0: 696e 6720 6669 7474 696e 672e 0d0a 2d20  ing fitting...- 
-00017c00: 496e 636c 7564 6564 2064 6973 6375 7373  Included discuss
-00017c10: 696f 6e20 6f66 2066 6f72 6d61 6c20 6572  ion of formal er
-00017c20: 726f 7273 206f 6620 6060 2e77 6569 6768  rors of ``.weigh
-00017c30: 7473 6060 2e0d 0a0d 0a56 362e 332e 323a  ts``.....V6.3.2:
-00017c40: 204d 432c 204f 7866 6f72 642c 2034 204d   MC, Oxford, 4 M
-00017c50: 6179 2032 3031 370d 0a2b 2b2b 2b2b 2b2b  ay 2017..+++++++
-00017c60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017c70: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978  +++++++....- Fix
-00017c80: 6564 2070 6f73 7369 626c 6520 7072 6f67  ed possible prog
-00017c90: 7261 6d20 7374 6f70 2069 6e74 726f 6475  ram stop introdu
-00017ca0: 6365 6420 696e 2056 362e 302e 3720 616e  ced in V6.0.7 an
-00017cb0: 6420 636f 6e73 6571 7565 6e74 6c79 0d0a  d consequently..
-00017cc0: 2020 7265 6d6f 7665 6420 756e 6e65 6365    removed unnece
-00017cd0: 7373 6172 7920 6675 6e63 7469 6f6e 2060  ssary function `
-00017ce0: 605f 7465 6d70 6c61 7465 735f 7266 6674  `_templates_rfft
-00017cf0: 2829 6060 2e20 4d61 6e79 2074 6861 6e6b  ()``. Many thank
-00017d00: 7320 746f 0d0a 2020 4a65 7375 7320 4661  s to..  Jesus Fa
-00017d10: 6c63 6f6e 2d42 6172 726f 736f 2066 6f72  lcon-Barroso for
-00017d20: 2061 2076 6572 7920 636c 6561 7220 616e   a very clear an
-00017d30: 6420 7573 6566 756c 2062 7567 2072 6570  d useful bug rep
-00017d40: 6f72 7421 0d0a 0d0a 5636 2e33 2e31 3a20  ort!....V6.3.1: 
-00017d50: 4d43 2c20 4f78 666f 7264 2c20 3133 2041  MC, Oxford, 13 A
-00017d60: 7072 696c 2032 3031 370d 0a2b 2b2b 2b2b  pril 2017..+++++
-00017d70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017d80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-00017d90: 2d20 4669 7865 6420 7072 6f67 7261 6d20  - Fixed program 
-00017da0: 7374 6f70 2077 6865 6e20 6669 7474 696e  stop when fittin
-00017db0: 6720 7477 6f20 6761 6c61 7879 2073 7065  g two galaxy spe
-00017dc0: 6374 7261 2077 6974 680d 0a20 2072 6566  ctra with..  ref
-00017dd0: 6c65 6374 696f 6e2d 7379 6d6d 6574 7269  lection-symmetri
-00017de0: 6320 4c4f 5356 442e 0d0a 0d0a 5636 2e33  c LOSVD.....V6.3
-00017df0: 2e30 3a20 4d43 2c20 4f78 666f 7264 2c20  .0: MC, Oxford, 
-00017e00: 3330 204d 6172 6368 2032 3031 370d 0a2b  30 March 2017..+
-00017e10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017e20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017e30: 0d0a 0d0a 2d20 496e 636c 7564 6564 2060  ....- Included `
-00017e40: 6072 6567 5f6f 7264 6060 206b 6579 776f  `reg_ord`` keywo
-00017e50: 7264 2074 6f20 616c 6c6f 7720 666f 7220  rd to allow for 
-00017e60: 626f 7468 2066 6972 7374 2061 6e64 2073  both first and s
-00017e70: 6563 6f6e 642d 6f72 6465 720d 0a20 2072  econd-order..  r
-00017e80: 6567 756c 6172 697a 6174 696f 6e2e 0d0a  egularization...
-00017e90: 0d0a 5636 2e32 2e30 3a20 4d43 2c20 4f78  ..V6.2.0: MC, Ox
-00017ea0: 666f 7264 2c20 3237 204d 6172 6368 2032  ford, 27 March 2
-00017eb0: 3031 370d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  017..+++++++++++
-00017ec0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017ed0: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 496d 7072  ++++++....- Impr
-00017ee0: 6f76 6564 2063 7572 7661 7475 7265 2063  oved curvature c
-00017ef0: 7269 7465 7269 6f6e 2066 6f72 2072 6567  riterion for reg
-00017f00: 756c 6172 697a 6174 696f 6e20 7768 656e  ularization when
-00017f10: 2060 6064 696d 203e 2031 6060 2e0d 0a0d   ``dim > 1``....
-00017f20: 0a56 362e 312e 303a 204d 432c 204f 7866  .V6.1.0: MC, Oxf
-00017f30: 6f72 642c 2031 3520 4d61 7263 6820 3230  ord, 15 March 20
-00017f40: 3137 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  17..++++++++++++
-00017f50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00017f60: 2b2b 2b2b 2b0d 0a0d 0a2d 2049 6e74 726f  +++++....- Intro
-00017f70: 6475 6365 6420 6060 7472 6967 6060 206b  duced ``trig`` k
-00017f80: 6579 776f 7264 2074 6f20 7573 6520 6120  eyword to use a 
-00017f90: 7472 6967 6f6e 6f6d 6574 7269 6320 7365  trigonometric se
-00017fa0: 7269 6573 2061 730d 0a20 2061 6c74 6572  ries as..  alter
-00017fb0: 6e61 7469 7665 2074 6f20 4c65 6765 6e64  native to Legend
-00017fc0: 7265 2070 6f6c 796e 6f6d 6961 6c73 2e0d  re polynomials..
-00017fd0: 0a0d 0a56 362e 302e 373a 204d 432c 204f  ...V6.0.7: MC, O
-00017fe0: 7866 6f72 642c 2031 3320 4d61 7263 6820  xford, 13 March 
-00017ff0: 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2017..++++++++++
+000173f0: 2b2b 2b2b 0d0a 0d0a 2d20 5265 6d6f 7665  ++++....- Remove
+00017400: 6420 696d 706f 7274 206f 6620 6060 6d69  d import of ``mi
+00017410: 7363 2e66 6163 746f 7269 616c 6060 2c20  sc.factorial``, 
+00017420: 6465 7072 6563 6174 6564 2069 6e20 5363  deprecated in Sc
+00017430: 6970 7920 312e 302e 0d0a 0d0a 5636 2e37  ipy 1.0.....V6.7
+00017440: 2e30 3a20 4d43 2c20 4f78 666f 7264 2c20  .0: MC, Oxford, 
+00017450: 3620 4e6f 7665 6d62 6572 2032 3031 370d  6 November 2017.
+00017460: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
+00017470: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017480: 2b2b 2b2b 0d0a 0d0a 2d20 416c 6c6f 7720  ++++....- Allow 
+00017490: 7573 6572 7320 746f 2069 6e70 7574 2069  users to input i
+000174a0: 6465 6e74 6963 616c 6c79 207a 6572 6f20  dentically zero 
+000174b0: 6761 7320 7465 6d70 6c61 7465 7320 7768  gas templates wh
+000174c0: 696c 6520 7374 696c 6c0d 0a20 2070 726f  ile still..  pro
+000174d0: 6475 6369 6e67 2061 2073 7461 626c 6520  ducing a stable 
+000174e0: 4e4e 4c53 2073 6f6c 7574 696f 6e2e 2049  NNLS solution. I
+000174f0: 6e20 7468 6973 2063 6173 652c 2077 6172  n this case, war
+00017500: 6e20 7468 6520 7573 6572 2061 6e64 2073  n the user and s
+00017510: 6574 0d0a 2020 7468 6520 2e67 6173 5f7a  et..  the .gas_z
+00017520: 6572 6f5f 7465 6d70 6c61 7465 2061 7474  ero_template att
+00017530: 7269 6275 7465 2e20 5468 6973 2073 6974  ribute. This sit
+00017540: 7561 7469 6f6e 2063 616e 2069 6e64 6963  uation can indic
+00017550: 6174 6520 616e 2069 6e70 7574 0d0a 2020  ate an input..  
+00017560: 6275 6720 6f72 2061 2067 6173 206c 696e  bug or a gas lin
+00017570: 6520 7468 6174 2065 6e74 6972 656c 7920  e that entirely 
+00017580: 6661 6c6c 7320 7769 7468 696e 2061 206d  falls within a m
+00017590: 6173 6b65 6420 7265 6769 6f6e 2e0d 0a2d  asked region...-
+000175a0: 2043 6f72 7265 6374 6564 2060 6067 6173   Corrected ``gas
+000175b0: 5f66 6c75 785f 6572 726f 7260 6020 6e6f  _flux_error`` no
+000175c0: 726d 616c 697a 6174 696f 6e2c 2077 6865  rmalization, whe
+000175d0: 6e20 696e 7075 7420 6e6f 7420 6e6f 726d  n input not norm
+000175e0: 616c 697a 6564 2e0d 0a2d 2052 6574 7572  alized...- Retur
+000175f0: 6e20 6060 2e67 6173 5f62 6573 7466 6974  n ``.gas_bestfit
+00017600: 6060 2c20 6060 2e67 6173 5f6d 706f 6c79  ``, ``.gas_mpoly
+00017610: 6060 2c20 6060 2e6d 706f 6c79 6060 2061  ``, ``.mpoly`` a
+00017620: 6e64 2060 602e 6170 6f6c 7960 6020 6174  nd ``.apoly`` at
+00017630: 7472 6962 7574 6573 2e0d 0a2d 2044 6f20  tributes...- Do 
+00017640: 6e6f 7420 6d75 6c74 6970 6c79 2067 6173  not multiply gas
+00017650: 2065 6d69 7373 696f 6e20 6c69 6e65 7320   emission lines 
+00017660: 6279 2070 6f6c 796e 6f6d 6961 6c73 2c20  by polynomials, 
+00017670: 696e 7374 6561 6420 616c 6c6f 7720 666f  instead allow fo
+00017680: 720d 0a20 2060 6067 6173 5f72 6564 6465  r..  ``gas_redde
+00017690: 6e69 6e67 6060 2028 7573 6566 756c 2077  ning`` (useful w
+000176a0: 6974 6820 7469 6564 2042 616c 6d65 7220  ith tied Balmer 
+000176b0: 656d 6973 7369 6f6e 206c 696e 6573 292e  emission lines).
+000176c0: 0d0a 2d20 5573 6520 6060 6178 7673 7061  ..- Use ``axvspa
+000176d0: 6e60 6020 746f 2076 6973 7561 6c69 7a65  n`` to visualize
+000176e0: 206d 6173 6b65 6420 7265 6769 6f6e 7320   masked regions 
+000176f0: 696e 2074 6865 2070 6c6f 742e 0d0a 2d20  in the plot...- 
+00017700: 4669 7865 6420 7072 6f67 7261 6d20 7374  Fixed program st
+00017710: 6f70 2077 6974 6820 6060 6c69 6e65 6172  op with ``linear
+00017720: 6060 206b 6579 776f 7264 2e0d 0a2d 2049  `` keyword...- I
+00017730: 6e74 726f 6475 6365 6420 6060 7265 6464  ntroduced ``redd
+00017740: 656e 696e 675f 6675 6e63 6060 206b 6579  ening_func`` key
+00017750: 776f 7264 2e0d 0a0d 0a56 362e 362e 343a  word.....V6.6.4:
+00017760: 204d 432c 204f 7866 6f72 642c 2035 204f   MC, Oxford, 5 O
+00017770: 6374 6f62 6572 2032 3031 370d 0a2b 2b2b  ctober 2017..+++
+00017780: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017790: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+000177a0: 0a0d 0a2d 2043 6865 636b 2066 6f72 204e  ...- Check for N
+000177b0: 614e 2069 6e20 6060 6761 6c61 7879 6060  aN in ``galaxy``
+000177c0: 2061 6e64 2063 6865 636b 2061 6c6c 2060   and check all `
+000177d0: 6062 6f75 6e64 7360 6020 6861 7665 2074  `bounds`` have t
+000177e0: 776f 2065 6c65 6d65 6e74 732e 0d0a 2d20  wo elements...- 
+000177f0: 416c 6c6f 7720 6060 7374 6172 7460 6020  Allow ``start`` 
+00017800: 746f 2062 6520 6569 7468 6572 2061 206c  to be either a l
+00017810: 6973 7420 6f72 2061 6e20 6172 7261 7920  ist or an array 
+00017820: 6f72 2076 6563 746f 7273 2e0d 0a0d 0a56  or vectors.....V
+00017830: 362e 362e 333a 204d 432c 204f 7866 6f72  6.6.3: MC, Oxfor
+00017840: 642c 2032 3520 5365 7074 656d 6265 7220  d, 25 September 
+00017850: 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2017..++++++++++
+00017860: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017870: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+00017880: 2052 6564 7563 6564 2062 6f75 6e64 7320   Reduced bounds 
+00017890: 6f6e 206d 756c 7469 706c 6963 6174 6976  on multiplicativ
+000178a0: 6520 706f 6c79 6e6f 6d69 616c 7320 616e  e polynomials an
+000178b0: 6420 636c 6970 7065 6420 746f 2070 6f73  d clipped to pos
+000178c0: 6974 6976 650d 0a20 2076 616c 7565 732e  itive..  values.
+000178d0: 2054 6861 6e6b 7320 746f 2058 6968 616e   Thanks to Xihan
+000178e0: 204a 6920 2854 7369 6e67 6875 6120 556e   Ji (Tsinghua Un
+000178f0: 6976 6572 7369 7479 2920 666f 7220 7072  iversity) for pr
+00017900: 6f76 6964 696e 6720 616e 0d0a 2020 6578  oviding an..  ex
+00017910: 616d 706c 6520 6f66 2073 6c69 6768 746c  ample of slightl
+00017920: 7920 6e65 6761 7469 7665 2067 6173 2065  y negative gas e
+00017930: 6d69 7373 696f 6e20 6c69 6e65 732c 2077  mission lines, w
+00017940: 6865 6e20 7468 6520 7370 6563 7472 756d  hen the spectrum
+00017950: 0d0a 2020 636f 6e74 6169 6e73 2065 7373  ..  contains ess
+00017960: 656e 7469 616c 6c79 206a 7573 7420 6e6f  entially just no
+00017970: 6973 652e 0d0a 2d20 496d 7072 6f76 6564  ise...- Improved
+00017980: 2076 6973 7561 6c69 7a61 7469 6f6e 206f   visualization o
+00017990: 6620 6d61 736b 6564 2070 6978 656c 732e  f masked pixels.
+000179a0: 0d0a 0d0a 5636 2e36 2e32 3a20 4d43 2c20  ....V6.6.2: MC, 
+000179b0: 4f78 666f 7264 2c20 3135 2053 6570 7465  Oxford, 15 Septe
+000179c0: 6d62 6572 2032 3031 370d 0a2b 2b2b 2b2b  mber 2017..+++++
+000179d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000179e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000179f0: 0d0a 0d0a 2d20 4669 7865 6420 7072 6f67  ....- Fixed prog
+00017a00: 7261 6d20 7374 6f70 2077 6974 6820 6120  ram stop with a 
+00017a10: 322d 6469 6d20 7465 6d70 6c61 7465 2061  2-dim template a
+00017a20: 7272 6179 2061 6e64 2072 6567 756c 6172  rray and regular
+00017a30: 697a 6174 696f 6e2e 0d0a 2020 5468 616e  ization...  Than
+00017a40: 6b73 2074 6f20 4164 7269 616e 6f20 506f  ks to Adriano Po
+00017a50: 6369 2028 4d61 6371 7561 7269 6520 556e  ci (Macquarie Un
+00017a60: 6976 6572 7369 7479 2920 666f 7220 7468  iversity) for th
+00017a70: 6520 636c 6561 7220 7265 706f 7274 2061  e clear report a
+00017a80: 6e64 0d0a 2020 7468 6520 6669 782e 0d0a  nd..  the fix...
+00017a90: 0d0a 5636 2e36 2e31 3a20 4d43 2c20 4f78  ..V6.6.1: MC, Ox
+00017aa0: 666f 7264 2c20 3420 4175 6775 7374 2032  ford, 4 August 2
+00017ab0: 3031 370d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  017..+++++++++++
+00017ac0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017ad0: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 496e 636c  ++++++....- Incl
+00017ae0: 7564 6564 206e 6f74 6520 6f6e 2060 602e  uded note on ``.
+00017af0: 6761 735f 666c 7578 6060 206f 7574 7075  gas_flux`` outpu
+00017b00: 7420 756e 6974 732e 2054 6861 6e6b 7320  t units. Thanks 
+00017b10: 746f 2058 6968 616e 204a 690d 0a20 2028  to Xihan Ji..  (
+00017b20: 5473 696e 6768 7561 2055 6e69 7665 7273  Tsinghua Univers
+00017b30: 6974 7929 2066 6f72 2074 6865 2066 6565  ity) for the fee
+00017b40: 6462 6163 6b2e 0d0a 0d0a 5636 2e36 2e30  dback.....V6.6.0
+00017b50: 3a20 4d43 2c20 4f78 666f 7264 2c20 3237  : MC, Oxford, 27
+00017b60: 204a 756e 6520 3230 3137 0d0a 2b2b 2b2b   June 2017..++++
+00017b70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017b80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+00017b90: 2d20 5072 696e 7420 616e 6420 7265 7475  - Print and retu
+00017ba0: 726e 2067 6173 2066 6c75 7865 7320 616e  rn gas fluxes an
+00017bb0: 6420 6572 726f 7273 2c20 6966 2072 6571  d errors, if req
+00017bc0: 7565 7374 6564 2c20 7769 7468 2074 6865  uested, with the
+00017bd0: 206e 6577 0d0a 2020 6060 6761 735f 636f   new..  ``gas_co
+00017be0: 6d70 6f6e 656e 7460 6020 616e 6420 6060  mponent`` and ``
+00017bf0: 6761 735f 6e61 6d65 7360 6020 6b65 7977  gas_names`` keyw
+00017c00: 6f72 6473 2e0d 0a0d 0a56 362e 352e 303a  ords.....V6.5.0:
+00017c10: 204d 432c 204f 7866 6f72 642c 2032 3320   MC, Oxford, 23 
+00017c20: 4a75 6e65 2032 3031 370d 0a2b 2b2b 2b2b  June 2017..+++++
+00017c30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017c40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+00017c50: 2052 6570 6c61 6365 6420 6060 4d50 4649   Replaced ``MPFI
+00017c60: 5460 6020 7769 7468 2060 6063 6170 6669  T`` with ``capfi
+00017c70: 7460 6020 666f 7220 6120 4c65 7665 6e62  t`` for a Levenb
+00017c80: 6572 672d 4d61 7271 7561 7264 7420 6d65  erg-Marquardt me
+00017c90: 7468 6f64 2077 6974 680d 0a20 2066 6978  thod with..  fix
+00017ca0: 6564 206f 7220 7469 6564 2076 6172 6961  ed or tied varia
+00017cb0: 626c 6573 2c20 7768 6963 6820 7269 676f  bles, which rigo
+00017cc0: 726f 7573 6c79 2061 6363 6f75 6e74 7320  rously accounts 
+00017cd0: 666f 7220 626f 7820 636f 6e73 7472 6169  for box constrai
+00017ce0: 6e74 732e 0d0a 0d0a 5636 2e34 2e32 3a20  nts.....V6.4.2: 
+00017cf0: 4d43 2c20 4f78 666f 7264 2c20 3220 4a75  MC, Oxford, 2 Ju
+00017d00: 6e65 2032 3031 370d 0a2b 2b2b 2b2b 2b2b  ne 2017..+++++++
+00017d10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017d20: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 4669  ++++++++....- Fi
+00017d30: 7865 6420 7265 6d6f 7661 6c20 6f66 2062  xed removal of b
+00017d40: 6f75 6e64 7320 696e 2073 6f6c 7574 696f  ounds in solutio
+00017d50: 6e2c 2069 6e74 726f 6475 6365 6420 696e  n, introduced in
+00017d60: 2056 362e 342e 312e 0d0a 2020 5468 616e   V6.4.1...  Than
+00017d70: 6b73 2074 6f20 4b79 6c65 2057 6573 7466  ks to Kyle Westf
+00017d80: 616c 6c20 2855 6e69 762e 2053 616e 7461  all (Univ. Santa
+00017d90: 2043 7275 7a29 2066 6f72 2072 6570 6f72   Cruz) for repor
+00017da0: 7469 6e67 2074 6869 732e 0d0a 2d20 496e  ting this...- In
+00017db0: 636c 7564 6564 2060 606d 6574 686f 6460  cluded ``method`
+00017dc0: 6020 6b65 7977 6f72 6420 746f 2075 7365  ` keyword to use
+00017dd0: 2053 6369 7079 2773 2060 606c 6561 7374   Scipy's ``least
+00017de0: 5f73 7175 6172 6573 2829 6060 0d0a 2020  _squares()``..  
+00017df0: 6173 2061 6e20 616c 7465 726e 6174 6976  as an alternativ
+00017e00: 6520 746f 204d 5046 4954 2e0d 0a2d 2046  e to MPFIT...- F
+00017e10: 6f72 6365 2066 6c6f 6174 2064 6976 6973  orce float divis
+00017e20: 696f 6e20 696e 2070 6978 656c 2063 6f6e  ion in pixel con
+00017e30: 7665 7273 696f 6e20 6f66 2060 6073 7461  version of ``sta
+00017e40: 7274 6060 2061 6e64 2060 6062 6f75 6e64  rt`` and ``bound
+00017e50: 7360 602e 0d0a 0d0a 5636 2e34 2e31 3a20  s``.....V6.4.1: 
+00017e60: 4d43 2c20 4f78 666f 7264 2c20 3235 204d  MC, Oxford, 25 M
+00017e70: 6179 2032 3031 370d 0a2b 2b2b 2b2b 2b2b  ay 2017..+++++++
+00017e80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017e90: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 6060  ++++++++....- ``
+00017ea0: 6c69 6e65 6172 5f66 6974 2829 6060 2064  linear_fit()`` d
+00017eb0: 6f65 7320 6e6f 7420 7265 7475 726e 2075  oes not return u
+00017ec0: 6e75 7365 6420 7374 6174 7573 2061 6e79  nused status any
+00017ed0: 6d6f 7265 2c20 666f 720d 0a20 2063 6f6e  more, for..  con
+00017ee0: 7369 7374 656e 6379 2077 6974 6820 7468  sistency with th
+00017ef0: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
+00017f00: 6368 616e 6765 2074 6f20 6060 6361 705f  change to ``cap_
+00017f10: 6d70 6669 7460 602e 0d0a 0d0a 5636 2e34  mpfit``.....V6.4
+00017f20: 2e30 3a20 4d43 2c20 4f78 666f 7264 2c20  .0: MC, Oxford, 
+00017f30: 3132 204d 6179 2032 3031 370d 0a2b 2b2b  12 May 2017..+++
+00017f40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00017f50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+00017f60: 2d20 496e 7472 6f64 7563 6564 2060 6074  - Introduced ``t
+00017f70: 6965 6460 6020 6b65 7977 6f72 6420 746f  ied`` keyword to
+00017f80: 2074 6965 2070 6172 616d 6574 6572 7320   tie parameters 
+00017f90: 6475 7269 6e67 2066 6974 7469 6e67 2e0d  during fitting..
+00017fa0: 0a2d 2049 6e63 6c75 6465 6420 6469 7363  .- Included disc
+00017fb0: 7573 7369 6f6e 206f 6620 666f 726d 616c  ussion of formal
+00017fc0: 2065 7272 6f72 7320 6f66 2060 602e 7765   errors of ``.we
+00017fd0: 6967 6874 7360 602e 0d0a 0d0a 5636 2e33  ights``.....V6.3
+00017fe0: 2e32 3a20 4d43 2c20 4f78 666f 7264 2c20  .2: MC, Oxford, 
+00017ff0: 3420 4d61 7920 3230 3137 0d0a 2b2b 2b2b  4 May 2017..++++
 00018000: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018010: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2055 7365  +++++++....- Use
-00018020: 2060 606e 6578 745f 6661 7374 5f6c 656e   ``next_fast_len
-00018030: 2829 6060 2066 6f72 206f 7074 696d 616c  ()`` for optimal
-00018040: 2060 6072 6666 7428 2960 6020 7a65 726f   ``rfft()`` zero
-00018050: 2070 6164 6469 6e67 2e0d 0a2d 2049 6e63   padding...- Inc
-00018060: 6c75 6465 6420 6b65 7977 6f72 6420 6060  luded keyword ``
-00018070: 6761 735f 636f 6d70 6f6e 656e 7460 6020  gas_component`` 
-00018080: 696e 2074 6865 2060 602e 706c 6f74 2829  in the ``.plot()
-00018090: 6060 206d 6574 686f 642c 2074 6f0d 0a20  `` method, to.. 
-000180a0: 2064 6973 7469 6e67 7569 7368 2067 6173   distinguish gas
-000180b0: 2065 6d69 7373 696f 6e20 6c69 6e65 7320   emission lines 
-000180c0: 696e 2062 6573 742d 6669 7474 696e 6720  in best-fitting 
-000180d0: 706c 6f74 732e 0d0a 2d20 496d 7072 6f76  plots...- Improv
-000180e0: 6564 2070 6c6f 7420 6f66 2072 6573 6964  ed plot of resid
-000180f0: 7561 6c73 2066 6f72 206e 6f69 7379 2073  uals for noisy s
-00018100: 7065 6374 7261 2e0d 0a2d 2053 696d 706c  pectra...- Simpl
-00018110: 6966 6965 6420 7265 6775 6c61 7269 7a61  ified regulariza
-00018120: 7469 6f6e 2069 6d70 6c65 6d65 6e74 6174  tion implementat
-00018130: 696f 6e2e 0d0a 0d0a 5636 2e30 2e36 3a20  ion.....V6.0.6: 
-00018140: 4d43 2c20 4f78 666f 7264 2c20 3233 2046  MC, Oxford, 23 F
-00018150: 6562 7275 6172 7920 3230 3137 0d0a 2b2b  ebruary 2017..++
-00018160: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018170: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018180: 2b2b 0d0a 0d0a 2d20 4164 6465 6420 6060  ++....- Added ``
-00018190: 6c69 6e65 6172 5f66 6974 2829 6060 2061  linear_fit()`` a
-000181a0: 6e64 2060 606e 6f6e 6c69 6e65 6172 5f66  nd ``nonlinear_f
-000181b0: 6974 2829 6060 2066 756e 6374 696f 6e73  it()`` functions
-000181c0: 2074 6f20 6265 7474 6572 0d0a 2020 636c   to better..  cl
-000181d0: 6172 6966 7920 7468 6520 636f 6465 2073  arify the code s
-000181e0: 7472 7563 7475 7265 2e20 496e 636c 7564  tructure. Includ
-000181f0: 6564 2060 6074 656d 706c 6174 6573 5f72  ed ``templates_r
-00018200: 6666 7460 6020 6b65 7977 6f72 642e 0d0a  fft`` keyword...
-00018210: 2d20 5570 6461 7465 6420 646f 6375 6d65  - Updated docume
-00018220: 6e74 6174 696f 6e2e 2053 6f6d 6520 636f  ntation. Some co
-00018230: 6465 2073 696d 706c 6966 6963 6174 696f  de simplificatio
-00018240: 6e73 2e0d 0a0d 0a56 362e 302e 353a 204d  ns.....V6.0.5: M
-00018250: 432c 204f 7866 6f72 642c 2032 3120 4665  C, Oxford, 21 Fe
-00018260: 6272 7561 7279 2032 3031 370d 0a2b 2b2b  bruary 2017..+++
-00018270: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018280: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018290: 2b0d 0a0d 0a2d 2043 6f6e 7369 7374 656e  +....- Consisten
-000182a0: 746c 7920 7573 6520 6e65 7720 666f 726d  tly use new form
-000182b0: 6174 5f6f 7574 7075 7428 2920 6675 6e63  at_output() func
-000182c0: 7469 6f6e 2062 6f74 6820 7769 7468 2f77  tion both with/w
-000182d0: 6974 686f 7574 0d0a 2020 7468 6520 6060  ithout..  the ``
-000182e0: 6c69 6e65 6172 6060 206b 6579 776f 7264  linear`` keyword
-000182f0: 2e20 4164 6465 6420 6060 2e73 7461 7475  . Added ``.statu
-00018300: 7360 6020 6174 7472 6962 7574 652e 2043  s`` attribute. C
-00018310: 6861 6e67 6573 2073 7567 6765 7374 6564  hanges suggested
-00018320: 2062 790d 0a20 204b 796c 6520 5765 7374   by..  Kyle West
-00018330: 6661 6c6c 2028 556e 6976 2e20 5361 6e74  fall (Univ. Sant
-00018340: 6120 4372 757a 292e 0d0a 0d0a 5636 2e30  a Cruz).....V6.0
-00018350: 2e34 3a20 4d43 2c20 4f78 666f 7264 2c20  .4: MC, Oxford, 
-00018360: 3330 204a 616e 7561 7279 2032 3031 370d  30 January 2017.
-00018370: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-00018380: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018390: 2b2b 2b2b 0d0a 0d0a 2d20 5265 2d69 6e74  ++++....- Re-int
-000183a0: 726f 6475 6365 6420 6060 6c69 6e65 6172  roduced ``linear
-000183b0: 6060 206b 6579 776f 7264 2074 6f20 6f6e  `` keyword to on
-000183c0: 6c79 2070 6572 666f 726d 2061 206c 696e  ly perform a lin
-000183d0: 6561 7220 6669 7420 616e 640d 0a20 2073  ear fit and..  s
-000183e0: 6b69 7020 7468 6520 6e6f 6e2d 6c69 6e65  kip the non-line
-000183f0: 6172 206f 7074 696d 697a 6174 696f 6e2e  ar optimization.
-00018400: 0d0a 0d0a 5636 2e30 2e33 3a20 4d43 2c20  ....V6.0.3: MC, 
-00018410: 4f78 666f 7264 2c20 3120 4465 6365 6d62  Oxford, 1 Decemb
-00018420: 6572 2032 3031 360d 0a2b 2b2b 2b2b 2b2b  er 2016..+++++++
-00018430: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018440: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-00018450: 2d20 5265 7475 726e 2075 7375 616c 2060  - Return usual `
-00018460: 6043 6869 2a2a 322f 444f 4660 6020 696e  `Chi**2/DOF`` in
-00018470: 7374 6561 6420 6f66 2042 6977 6569 6768  stead of Biweigh
-00018480: 7420 6573 7469 6d61 7465 2e0d 0a0d 0a56  t estimate.....V
-00018490: 362e 302e 323a 204d 432c 204f 7866 6f72  6.0.2: MC, Oxfor
-000184a0: 642c 2031 3520 4175 6775 7374 2032 3031  d, 15 August 201
-000184b0: 360d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  6..+++++++++++++
-000184c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000184d0: 2b2b 2b2b 2b0d 0a0d 0a2d 2049 6d70 726f  +++++....- Impro
-000184e0: 7665 6420 666f 726d 6174 7469 6e67 206f  ved formatting o
-000184f0: 6620 7072 696e 7465 6420 6f75 7470 7574  f printed output
-00018500: 2e0d 0a0d 0a56 362e 302e 313a 204d 432c  .....V6.0.1: MC,
-00018510: 204f 7866 6f72 642c 2031 3020 4175 6775   Oxford, 10 Augu
-00018520: 7374 2032 3031 360d 0a2b 2b2b 2b2b 2b2b  st 2016..+++++++
-00018530: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018540: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
-00018550: 2041 6c6c 6f77 2060 606d 6f6d 656e 7473   Allow ``moments
-00018560: 6060 2074 6f20 6265 2061 6e20 6172 6269  `` to be an arbi
-00018570: 7472 6172 7920 696e 7465 6765 722e 0d0a  trary integer...
-00018580: 2d20 416c 6c6f 7720 666f 7220 7363 616c  - Allow for scal
-00018590: 6172 2060 606d 6f6d 656e 7473 6060 2077  ar ``moments`` w
-000185a0: 6974 6820 6d75 6c74 6970 6c65 206b 696e  ith multiple kin
-000185b0: 656d 6174 6963 2063 6f6d 706f 6e65 6e74  ematic component
-000185c0: 732e 0d0a 0d0a 5636 2e30 2e30 3a20 4d43  s.....V6.0.0: MC
-000185d0: 2c20 4f78 666f 7264 2c20 3238 204a 756c  , Oxford, 28 Jul
-000185e0: 7920 3230 3136 0d0a 2b2b 2b2b 2b2b 2b2b  y 2016..++++++++
-000185f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018600: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 436f  ++++++++....- Co
-00018610: 6d70 7574 6520 7468 6520 466f 7572 6965  mpute the Fourie
-00018620: 7220 5472 616e 7366 6f72 6d20 6f66 2074  r Transform of t
-00018630: 6865 204c 4f53 5644 2061 6e61 6c79 7469  he LOSVD analyti
-00018640: 6361 6c6c 793a 0d0a 2d20 4d61 6a6f 7220  cally:..- Major 
-00018650: 696d 7072 6f76 656d 656e 7420 696e 2076  improvement in v
-00018660: 656c 6f63 6974 7920 6163 6375 7261 6379  elocity accuracy
-00018670: 2077 6865 6e20 6060 7369 676d 6120 3c20   when ``sigma < 
-00018680: 7665 6c73 6361 6c65 6060 2e0d 0a2d 2052  velscale``...- R
-00018690: 656d 6f76 6564 2060 606f 7665 7273 616d  emoved ``oversam
-000186a0: 706c 6560 6020 6b65 7977 6f72 642c 2077  ple`` keyword, w
-000186b0: 6869 6368 2069 7320 6e6f 7720 756e 6e65  hich is now unne
-000186c0: 6365 7373 6172 792e 0d0a 2d20 5265 6d6f  cessary...- Remo
-000186d0: 7665 6420 6c69 6d69 7420 6f6e 2076 656c  ved limit on vel
-000186e0: 6f63 6974 7920 7368 6966 7420 6f66 2074  ocity shift of t
-000186f0: 656d 706c 6174 6573 2e0d 0a2d 2053 696d  emplates...- Sim
-00018700: 706c 6966 6965 6420 4646 5420 7a65 726f  plified FFT zero
-00018710: 2070 6164 6469 6e67 2e20 5570 6461 7465   padding. Update
-00018720: 6420 646f 6375 6d65 6e74 6174 696f 6e2e  d documentation.
-00018730: 0d0a 0d0a 5635 2e33 2e33 3a20 4d43 2c20  ....V5.3.3: MC, 
-00018740: 4f78 666f 7264 2032 3420 4d61 7920 3230  Oxford 24 May 20
-00018750: 3136 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  16..++++++++++++
-00018760: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018770: 2b2b 0d0a 0d0a 2d20 4669 7865 6420 5079  ++....- Fixed Py
-00018780: 7468 6f6e 2032 2063 6f6d 7061 7469 6269  thon 2 compatibi
-00018790: 6c69 7479 2e20 5468 616e 6b73 2074 6f20  lity. Thanks to 
-000187a0: 4d61 7361 746f 204f 6e6f 6465 7261 2028  Masato Onodera (
-000187b0: 4e41 4f4a 292e 0d0a 0d0a 5635 2e33 2e32  NAOJ).....V5.3.2
-000187c0: 3a20 4d43 2c20 4f78 666f 7264 2c20 3232  : MC, Oxford, 22
-000187d0: 204d 6179 2032 3031 360d 0a2b 2b2b 2b2b   May 2016..+++++
-000187e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000187f0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-00018800: 4261 636b 7761 7264 2063 6f6d 7061 7469  Backward compati
-00018810: 6269 6c69 7479 2063 6861 6e67 653a 2061  bility change: a
-00018820: 6c6c 6f77 2060 6073 7461 7274 6060 2074  llow ``start`` t
-00018830: 6f20 6265 2073 6d61 6c6c 6572 2074 6861  o be smaller tha
-00018840: 6e0d 0a20 2060 606d 6f6d 656e 7473 6060  n..  ``moments``
-00018850: 2e20 4166 7465 7220 6665 6564 6261 636b  . After feedback
-00018860: 2062 7920 4d61 7361 746f 204f 6e6f 6465   by Masato Onode
-00018870: 7261 2028 4e41 4f4a 292e 0d0a 2d20 5570  ra (NAOJ)...- Up
-00018880: 6461 7465 6420 646f 6375 6d65 6e74 6174  dated documentat
-00018890: 696f 6e20 6f66 2060 6062 6f75 6e64 7360  ion of ``bounds`
-000188a0: 6020 616e 6420 6060 6669 7865 6460 602e  ` and ``fixed``.
-000188b0: 0d0a 0d0a 5635 2e33 2e31 3a20 4d43 2c20  ....V5.3.1: MC, 
-000188c0: 4f78 666f 7264 2c20 3138 204d 6179 2032  Oxford, 18 May 2
-000188d0: 3031 360d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  016..+++++++++++
-000188e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000188f0: 2b2b 2b2b 0d0a 0d0a 2d20 5573 6520 7761  ++++....- Use wa
-00018900: 7665 6c65 6e67 7468 2069 6e20 7468 6520  velength in the 
-00018910: 706c 6f74 2077 6865 6e20 6176 6169 6c61  plot when availa
-00018920: 626c 652e 204d 616b 6520 6060 706c 6f74  ble. Make ``plot
-00018930: 2829 6060 2061 2063 6c61 7373 2066 756e  ()`` a class fun
-00018940: 6374 696f 6e2e 0d0a 2020 4368 616e 6765  ction...  Change
-00018950: 7320 7375 6767 6573 7465 6420 616e 6420  s suggested and 
-00018960: 7072 6f76 6964 6564 2062 7920 4a6f 6861  provided by Joha
-00018970: 6e6e 2043 6f68 656e 2d54 616e 7567 6920  nn Cohen-Tanugi 
-00018980: 284c 5550 4d29 2e0d 0a0d 0a56 352e 332e  (LUPM).....V5.3.
-00018990: 303a 204d 432c 204f 7866 6f72 642c 2039  0: MC, Oxford, 9
-000189a0: 204d 6179 2032 3031 360d 0a2b 2b2b 2b2b   May 2016..+++++
-000189b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000189c0: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2049  +++++++++....- I
-000189d0: 6e63 6c75 6465 6420 6060 7665 6c73 6361  ncluded ``velsca
-000189e0: 6c65 5f72 6174 696f 6060 206b 6579 776f  le_ratio`` keywo
-000189f0: 7264 2074 6f20 7061 7373 2061 2073 6574  rd to pass a set
-00018a00: 206f 6620 7465 6d70 6c61 7465 7320 7769   of templates wi
-00018a10: 7468 0d0a 2020 6869 6768 6572 2072 6573  th..  higher res
-00018a20: 6f6c 7574 696f 6e20 7468 616e 2074 6865  olution than the
-00018a30: 2067 616c 6178 7920 7370 6563 7472 756d   galaxy spectrum
-00018a40: 2e0d 0a2d 2043 6861 6e67 6564 2060 606f  ...- Changed ``o
-00018a50: 7665 7273 616d 706c 6560 6020 6b65 7977  versample`` keyw
-00018a60: 6f72 6420 746f 2072 6571 7569 7265 2069  ord to require i
-00018a70: 6e74 6567 6572 732c 206e 6f74 2042 6f6f  ntegers, not Boo
-00018a80: 6c65 616e 732e 0d0a 0d0a 5635 2e32 2e30  leans.....V5.2.0
-00018a90: 3a20 4d43 2c20 4261 6c74 696d 6f72 652c  : MC, Baltimore,
-00018aa0: 2032 3620 4170 7269 6c20 3230 3136 0d0a   26 April 2016..
-00018ab0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018ac0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018ad0: 2b2b 2b2b 0d0a 0d0a 2d20 496e 636c 7564  ++++....- Includ
-00018ae0: 6564 2060 6062 6f75 6e64 7360 602c 2060  ed ``bounds``, `
-00018af0: 6066 6978 6564 6060 2061 6e64 2060 6066  `fixed`` and ``f
-00018b00: 7261 6374 696f 6e60 6020 6b65 7977 6f72  raction`` keywor
-00018b10: 6473 2e0d 0a0d 0a56 352e 312e 3138 3a20  ds.....V5.1.18: 
-00018b20: 4d43 2c20 4f78 666f 7264 2c20 3230 2041  MC, Oxford, 20 A
-00018b30: 7072 696c 2032 3031 360d 0a2b 2b2b 2b2b  pril 2016..+++++
-00018b40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018b50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00018b60: 0a2d 2046 6978 6564 2064 6570 7265 6361  .- Fixed depreca
-00018b70: 7469 6f6e 2077 6172 6e69 6e67 2069 6e20  tion warning in 
-00018b80: 4e75 6d70 7920 312e 3131 2e20 4368 616e  Numpy 1.11. Chan
-00018b90: 6765 6420 6f72 6465 7220 6672 6f6d 2031  ged order from 1
-00018ba0: 2074 6f20 330d 0a20 2064 7572 696e 6720   to 3..  during 
-00018bb0: 6f76 6572 7361 6d70 6c69 6e67 2e20 5761  oversampling. Wa
-00018bc0: 726e 2069 6620 7369 676d 6120 6973 2075  rn if sigma is u
-00018bd0: 6e64 6572 2d73 616d 706c 6564 2e0d 0a0d  nder-sampled....
-00018be0: 0a56 352e 312e 3137 3a20 4d43 2c20 4f78  .V5.1.17: MC, Ox
-00018bf0: 666f 7264 2c20 3231 204a 616e 7561 7279  ford, 21 January
-00018c00: 2032 3031 360d 0a2b 2b2b 2b2b 2b2b 2b2b   2016..+++++++++
-00018c10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018c20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
-00018c30: 2045 7870 616e 6465 6420 6578 706c 616e   Expanded explan
-00018c40: 6174 696f 6e20 6f66 2074 6865 2072 656c  ation of the rel
-00018c50: 6174 696f 6e73 6869 7020 6265 7477 6565  ationship betwee
-00018c60: 6e20 6f75 7470 7574 2076 656c 6f63 6974  n output velocit
-00018c70: 7920 616e 6420 7265 6473 6869 6674 2e0d  y and redshift..
-00018c80: 0a0d 0a56 352e 312e 3136 3a20 4d43 2c20  ...V5.1.16: MC, 
-00018c90: 4f78 666f 7264 2c20 3920 4e6f 7665 6d62  Oxford, 9 Novemb
-00018ca0: 6572 2032 3031 350d 0a2b 2b2b 2b2b 2b2b  er 2015..+++++++
-00018cb0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018cc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00018cd0: 0a2d 2046 6978 6564 2070 6f74 656e 7469  .- Fixed potenti
-00018ce0: 616c 6c79 206d 6973 6c65 6164 696e 6720  ally misleading 
-00018cf0: 7479 706f 2069 6e20 646f 6375 6d65 6e74  typo in document
-00018d00: 6174 696f 6e20 6f66 2060 606d 6f6d 656e  ation of ``momen
-00018d10: 7473 6060 2e0d 0a0d 0a56 352e 312e 3135  ts``.....V5.1.15
-00018d20: 3a20 4d43 2c20 4f78 666f 7264 2c20 3232  : MC, Oxford, 22
-00018d30: 204f 6374 6f62 6572 2032 3031 350d 0a2b   October 2015..+
-00018d40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018010: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
+00018020: 4669 7865 6420 706f 7373 6962 6c65 2070  Fixed possible p
+00018030: 726f 6772 616d 2073 746f 7020 696e 7472  rogram stop intr
+00018040: 6f64 7563 6564 2069 6e20 5636 2e30 2e37  oduced in V6.0.7
+00018050: 2061 6e64 2063 6f6e 7365 7175 656e 746c   and consequentl
+00018060: 790d 0a20 2072 656d 6f76 6564 2075 6e6e  y..  removed unn
+00018070: 6563 6573 7361 7279 2066 756e 6374 696f  ecessary functio
+00018080: 6e20 6060 5f74 656d 706c 6174 6573 5f72  n ``_templates_r
+00018090: 6666 7428 2960 602e 204d 616e 7920 7468  fft()``. Many th
+000180a0: 616e 6b73 2074 6f0d 0a20 204a 6573 7573  anks to..  Jesus
+000180b0: 2046 616c 636f 6e2d 4261 7272 6f73 6f20   Falcon-Barroso 
+000180c0: 666f 7220 6120 7665 7279 2063 6c65 6172  for a very clear
+000180d0: 2061 6e64 2075 7365 6675 6c20 6275 6720   and useful bug 
+000180e0: 7265 706f 7274 210d 0a0d 0a56 362e 332e  report!....V6.3.
+000180f0: 313a 204d 432c 204f 7866 6f72 642c 2031  1: MC, Oxford, 1
+00018100: 3320 4170 7269 6c20 3230 3137 0d0a 2b2b  3 April 2017..++
+00018110: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018120: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+00018130: 0a0d 0a2d 2046 6978 6564 2070 726f 6772  ...- Fixed progr
+00018140: 616d 2073 746f 7020 7768 656e 2066 6974  am stop when fit
+00018150: 7469 6e67 2074 776f 2067 616c 6178 7920  ting two galaxy 
+00018160: 7370 6563 7472 6120 7769 7468 0d0a 2020  spectra with..  
+00018170: 7265 666c 6563 7469 6f6e 2d73 796d 6d65  reflection-symme
+00018180: 7472 6963 204c 4f53 5644 2e0d 0a0d 0a56  tric LOSVD.....V
+00018190: 362e 332e 303a 204d 432c 204f 7866 6f72  6.3.0: MC, Oxfor
+000181a0: 642c 2033 3020 4d61 7263 6820 3230 3137  d, 30 March 2017
+000181b0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+000181c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000181d0: 2b2b 2b0d 0a0d 0a2d 2049 6e63 6c75 6465  +++....- Include
+000181e0: 6420 6060 7265 675f 6f72 6460 6020 6b65  d ``reg_ord`` ke
+000181f0: 7977 6f72 6420 746f 2061 6c6c 6f77 2066  yword to allow f
+00018200: 6f72 2062 6f74 6820 6669 7273 7420 616e  or both first an
+00018210: 6420 7365 636f 6e64 2d6f 7264 6572 0d0a  d second-order..
+00018220: 2020 7265 6775 6c61 7269 7a61 7469 6f6e    regularization
+00018230: 2e0d 0a0d 0a56 362e 322e 303a 204d 432c  .....V6.2.0: MC,
+00018240: 204f 7866 6f72 642c 2032 3720 4d61 7263   Oxford, 27 Marc
+00018250: 6820 3230 3137 0d0a 2b2b 2b2b 2b2b 2b2b  h 2017..++++++++
+00018260: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018270: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2049  +++++++++....- I
+00018280: 6d70 726f 7665 6420 6375 7276 6174 7572  mproved curvatur
+00018290: 6520 6372 6974 6572 696f 6e20 666f 7220  e criterion for 
+000182a0: 7265 6775 6c61 7269 7a61 7469 6f6e 2077  regularization w
+000182b0: 6865 6e20 6060 6469 6d20 3e20 3160 602e  hen ``dim > 1``.
+000182c0: 0d0a 0d0a 5636 2e31 2e30 3a20 4d43 2c20  ....V6.1.0: MC, 
+000182d0: 4f78 666f 7264 2c20 3135 204d 6172 6368  Oxford, 15 March
+000182e0: 2032 3031 370d 0a2b 2b2b 2b2b 2b2b 2b2b   2017..+++++++++
+000182f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018300: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 496e  ++++++++....- In
+00018310: 7472 6f64 7563 6564 2060 6074 7269 6760  troduced ``trig`
+00018320: 6020 6b65 7977 6f72 6420 746f 2075 7365  ` keyword to use
+00018330: 2061 2074 7269 676f 6e6f 6d65 7472 6963   a trigonometric
+00018340: 2073 6572 6965 7320 6173 0d0a 2020 616c   series as..  al
+00018350: 7465 726e 6174 6976 6520 746f 204c 6567  ternative to Leg
+00018360: 656e 6472 6520 706f 6c79 6e6f 6d69 616c  endre polynomial
+00018370: 732e 0d0a 0d0a 5636 2e30 2e37 3a20 4d43  s.....V6.0.7: MC
+00018380: 2c20 4f78 666f 7264 2c20 3133 204d 6172  , Oxford, 13 Mar
+00018390: 6368 2032 3031 370d 0a2b 2b2b 2b2b 2b2b  ch 2017..+++++++
+000183a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000183b0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
+000183c0: 5573 6520 6060 6e65 7874 5f66 6173 745f  Use ``next_fast_
+000183d0: 6c65 6e28 2960 6020 666f 7220 6f70 7469  len()`` for opti
+000183e0: 6d61 6c20 6060 7266 6674 2829 6060 207a  mal ``rfft()`` z
+000183f0: 6572 6f20 7061 6464 696e 672e 0d0a 2d20  ero padding...- 
+00018400: 496e 636c 7564 6564 206b 6579 776f 7264  Included keyword
+00018410: 2060 6067 6173 5f63 6f6d 706f 6e65 6e74   ``gas_component
+00018420: 6060 2069 6e20 7468 6520 6060 2e70 6c6f  `` in the ``.plo
+00018430: 7428 2960 6020 6d65 7468 6f64 2c20 746f  t()`` method, to
+00018440: 0d0a 2020 6469 7374 696e 6775 6973 6820  ..  distinguish 
+00018450: 6761 7320 656d 6973 7369 6f6e 206c 696e  gas emission lin
+00018460: 6573 2069 6e20 6265 7374 2d66 6974 7469  es in best-fitti
+00018470: 6e67 2070 6c6f 7473 2e0d 0a2d 2049 6d70  ng plots...- Imp
+00018480: 726f 7665 6420 706c 6f74 206f 6620 7265  roved plot of re
+00018490: 7369 6475 616c 7320 666f 7220 6e6f 6973  siduals for nois
+000184a0: 7920 7370 6563 7472 612e 0d0a 2d20 5369  y spectra...- Si
+000184b0: 6d70 6c69 6669 6564 2072 6567 756c 6172  mplified regular
+000184c0: 697a 6174 696f 6e20 696d 706c 656d 656e  ization implemen
+000184d0: 7461 7469 6f6e 2e0d 0a0d 0a56 362e 302e  tation.....V6.0.
+000184e0: 363a 204d 432c 204f 7866 6f72 642c 2032  6: MC, Oxford, 2
+000184f0: 3320 4665 6272 7561 7279 2032 3031 370d  3 February 2017.
+00018500: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
+00018510: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018520: 2b2b 2b2b 2b0d 0a0d 0a2d 2041 6464 6564  +++++....- Added
+00018530: 2060 606c 696e 6561 725f 6669 7428 2960   ``linear_fit()`
+00018540: 6020 616e 6420 6060 6e6f 6e6c 696e 6561  ` and ``nonlinea
+00018550: 725f 6669 7428 2960 6020 6675 6e63 7469  r_fit()`` functi
+00018560: 6f6e 7320 746f 2062 6574 7465 720d 0a20  ons to better.. 
+00018570: 2063 6c61 7269 6679 2074 6865 2063 6f64   clarify the cod
+00018580: 6520 7374 7275 6374 7572 652e 2049 6e63  e structure. Inc
+00018590: 6c75 6465 6420 6060 7465 6d70 6c61 7465  luded ``template
+000185a0: 735f 7266 6674 6060 206b 6579 776f 7264  s_rfft`` keyword
+000185b0: 2e0d 0a2d 2055 7064 6174 6564 2064 6f63  ...- Updated doc
+000185c0: 756d 656e 7461 7469 6f6e 2e20 536f 6d65  umentation. Some
+000185d0: 2063 6f64 6520 7369 6d70 6c69 6669 6361   code simplifica
+000185e0: 7469 6f6e 732e 0d0a 0d0a 5636 2e30 2e35  tions.....V6.0.5
+000185f0: 3a20 4d43 2c20 4f78 666f 7264 2c20 3231  : MC, Oxford, 21
+00018600: 2046 6562 7275 6172 7920 3230 3137 0d0a   February 2017..
+00018610: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018620: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018630: 2b2b 2b2b 0d0a 0d0a 2d20 436f 6e73 6973  ++++....- Consis
+00018640: 7465 6e74 6c79 2075 7365 206e 6577 2066  tently use new f
+00018650: 6f72 6d61 745f 6f75 7470 7574 2829 2066  ormat_output() f
+00018660: 756e 6374 696f 6e20 626f 7468 2077 6974  unction both wit
+00018670: 682f 7769 7468 6f75 740d 0a20 2074 6865  h/without..  the
+00018680: 2060 606c 696e 6561 7260 6020 6b65 7977   ``linear`` keyw
+00018690: 6f72 642e 2041 6464 6564 2060 602e 7374  ord. Added ``.st
+000186a0: 6174 7573 6060 2061 7474 7269 6275 7465  atus`` attribute
+000186b0: 2e20 4368 616e 6765 7320 7375 6767 6573  . Changes sugges
+000186c0: 7465 6420 6279 0d0a 2020 4b79 6c65 2057  ted by..  Kyle W
+000186d0: 6573 7466 616c 6c20 2855 6e69 762e 2053  estfall (Univ. S
+000186e0: 616e 7461 2043 7275 7a29 2e0d 0a0d 0a56  anta Cruz).....V
+000186f0: 362e 302e 343a 204d 432c 204f 7866 6f72  6.0.4: MC, Oxfor
+00018700: 642c 2033 3020 4a61 6e75 6172 7920 3230  d, 30 January 20
+00018710: 3137 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  17..++++++++++++
+00018720: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018730: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2052 652d  +++++++....- Re-
+00018740: 696e 7472 6f64 7563 6564 2060 606c 696e  introduced ``lin
+00018750: 6561 7260 6020 6b65 7977 6f72 6420 746f  ear`` keyword to
+00018760: 206f 6e6c 7920 7065 7266 6f72 6d20 6120   only perform a 
+00018770: 6c69 6e65 6172 2066 6974 2061 6e64 0d0a  linear fit and..
+00018780: 2020 736b 6970 2074 6865 206e 6f6e 2d6c    skip the non-l
+00018790: 696e 6561 7220 6f70 7469 6d69 7a61 7469  inear optimizati
+000187a0: 6f6e 2e0d 0a0d 0a56 362e 302e 333a 204d  on.....V6.0.3: M
+000187b0: 432c 204f 7866 6f72 642c 2031 2044 6563  C, Oxford, 1 Dec
+000187c0: 656d 6265 7220 3230 3136 0d0a 2b2b 2b2b  ember 2016..++++
+000187d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000187e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+000187f0: 0a0d 0a2d 2052 6574 7572 6e20 7573 7561  ...- Return usua
+00018800: 6c20 6060 4368 692a 2a32 2f44 4f46 6060  l ``Chi**2/DOF``
+00018810: 2069 6e73 7465 6164 206f 6620 4269 7765   instead of Biwe
+00018820: 6967 6874 2065 7374 696d 6174 652e 0d0a  ight estimate...
+00018830: 0d0a 5636 2e30 2e32 3a20 4d43 2c20 4f78  ..V6.0.2: MC, Ox
+00018840: 666f 7264 2c20 3135 2041 7567 7573 7420  ford, 15 August 
+00018850: 3230 3136 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2016..++++++++++
+00018860: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018870: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 496d  ++++++++....- Im
+00018880: 7072 6f76 6564 2066 6f72 6d61 7474 696e  proved formattin
+00018890: 6720 6f66 2070 7269 6e74 6564 206f 7574  g of printed out
+000188a0: 7075 742e 0d0a 0d0a 5636 2e30 2e31 3a20  put.....V6.0.1: 
+000188b0: 4d43 2c20 4f78 666f 7264 2c20 3130 2041  MC, Oxford, 10 A
+000188c0: 7567 7573 7420 3230 3136 0d0a 2b2b 2b2b  ugust 2016..++++
+000188d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000188e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
+000188f0: 0d0a 2d20 416c 6c6f 7720 6060 6d6f 6d65  ..- Allow ``mome
+00018900: 6e74 7360 6020 746f 2062 6520 616e 2061  nts`` to be an a
+00018910: 7262 6974 7261 7279 2069 6e74 6567 6572  rbitrary integer
+00018920: 2e0d 0a2d 2041 6c6c 6f77 2066 6f72 2073  ...- Allow for s
+00018930: 6361 6c61 7220 6060 6d6f 6d65 6e74 7360  calar ``moments`
+00018940: 6020 7769 7468 206d 756c 7469 706c 6520  ` with multiple 
+00018950: 6b69 6e65 6d61 7469 6320 636f 6d70 6f6e  kinematic compon
+00018960: 656e 7473 2e0d 0a0d 0a56 362e 302e 303a  ents.....V6.0.0:
+00018970: 204d 432c 204f 7866 6f72 642c 2032 3820   MC, Oxford, 28 
+00018980: 4a75 6c79 2032 3031 360d 0a2b 2b2b 2b2b  July 2016..+++++
+00018990: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000189a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+000189b0: 2043 6f6d 7075 7465 2074 6865 2046 6f75   Compute the Fou
+000189c0: 7269 6572 2054 7261 6e73 666f 726d 206f  rier Transform o
+000189d0: 6620 7468 6520 4c4f 5356 4420 616e 616c  f the LOSVD anal
+000189e0: 7974 6963 616c 6c79 3a0d 0a2d 204d 616a  ytically:..- Maj
+000189f0: 6f72 2069 6d70 726f 7665 6d65 6e74 2069  or improvement i
+00018a00: 6e20 7665 6c6f 6369 7479 2061 6363 7572  n velocity accur
+00018a10: 6163 7920 7768 656e 2060 6073 6967 6d61  acy when ``sigma
+00018a20: 203c 2076 656c 7363 616c 6560 602e 0d0a   < velscale``...
+00018a30: 2d20 5265 6d6f 7665 6420 6060 6f76 6572  - Removed ``over
+00018a40: 7361 6d70 6c65 6060 206b 6579 776f 7264  sample`` keyword
+00018a50: 2c20 7768 6963 6820 6973 206e 6f77 2075  , which is now u
+00018a60: 6e6e 6563 6573 7361 7279 2e0d 0a2d 2052  nnecessary...- R
+00018a70: 656d 6f76 6564 206c 696d 6974 206f 6e20  emoved limit on 
+00018a80: 7665 6c6f 6369 7479 2073 6869 6674 206f  velocity shift o
+00018a90: 6620 7465 6d70 6c61 7465 732e 0d0a 2d20  f templates...- 
+00018aa0: 5369 6d70 6c69 6669 6564 2046 4654 207a  Simplified FFT z
+00018ab0: 6572 6f20 7061 6464 696e 672e 2055 7064  ero padding. Upd
+00018ac0: 6174 6564 2064 6f63 756d 656e 7461 7469  ated documentati
+00018ad0: 6f6e 2e0d 0a0d 0a56 352e 332e 333a 204d  on.....V5.3.3: M
+00018ae0: 432c 204f 7866 6f72 6420 3234 204d 6179  C, Oxford 24 May
+00018af0: 2032 3031 360d 0a2b 2b2b 2b2b 2b2b 2b2b   2016..+++++++++
+00018b00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018b10: 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978 6564  +++++....- Fixed
+00018b20: 2050 7974 686f 6e20 3220 636f 6d70 6174   Python 2 compat
+00018b30: 6962 696c 6974 792e 2054 6861 6e6b 7320  ibility. Thanks 
+00018b40: 746f 204d 6173 6174 6f20 4f6e 6f64 6572  to Masato Onoder
+00018b50: 6120 284e 414f 4a29 2e0d 0a0d 0a56 352e  a (NAOJ).....V5.
+00018b60: 332e 323a 204d 432c 204f 7866 6f72 642c  3.2: MC, Oxford,
+00018b70: 2032 3220 4d61 7920 3230 3136 0d0a 2b2b   22 May 2016..++
+00018b80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018b90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+00018ba0: 0a2d 2042 6163 6b77 6172 6420 636f 6d70  .- Backward comp
+00018bb0: 6174 6962 696c 6974 7920 6368 616e 6765  atibility change
+00018bc0: 3a20 616c 6c6f 7720 6060 7374 6172 7460  : allow ``start`
+00018bd0: 6020 746f 2062 6520 736d 616c 6c65 7220  ` to be smaller 
+00018be0: 7468 616e 0d0a 2020 6060 6d6f 6d65 6e74  than..  ``moment
+00018bf0: 7360 602e 2041 6674 6572 2066 6565 6462  s``. After feedb
+00018c00: 6163 6b20 6279 204d 6173 6174 6f20 4f6e  ack by Masato On
+00018c10: 6f64 6572 6120 284e 414f 4a29 2e0d 0a2d  odera (NAOJ)...-
+00018c20: 2055 7064 6174 6564 2064 6f63 756d 656e   Updated documen
+00018c30: 7461 7469 6f6e 206f 6620 6060 626f 756e  tation of ``boun
+00018c40: 6473 6060 2061 6e64 2060 6066 6978 6564  ds`` and ``fixed
+00018c50: 6060 2e0d 0a0d 0a56 352e 332e 313a 204d  ``.....V5.3.1: M
+00018c60: 432c 204f 7866 6f72 642c 2031 3820 4d61  C, Oxford, 18 Ma
+00018c70: 7920 3230 3136 0d0a 2b2b 2b2b 2b2b 2b2b  y 2016..++++++++
+00018c80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018c90: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2055 7365  +++++++....- Use
+00018ca0: 2077 6176 656c 656e 6774 6820 696e 2074   wavelength in t
+00018cb0: 6865 2070 6c6f 7420 7768 656e 2061 7661  he plot when ava
+00018cc0: 696c 6162 6c65 2e20 4d61 6b65 2060 6070  ilable. Make ``p
+00018cd0: 6c6f 7428 2960 6020 6120 636c 6173 7320  lot()`` a class 
+00018ce0: 6675 6e63 7469 6f6e 2e0d 0a20 2043 6861  function...  Cha
+00018cf0: 6e67 6573 2073 7567 6765 7374 6564 2061  nges suggested a
+00018d00: 6e64 2070 726f 7669 6465 6420 6279 204a  nd provided by J
+00018d10: 6f68 616e 6e20 436f 6865 6e2d 5461 6e75  ohann Cohen-Tanu
+00018d20: 6769 2028 4c55 504d 292e 0d0a 0d0a 5635  gi (LUPM).....V5
+00018d30: 2e33 2e30 3a20 4d43 2c20 4f78 666f 7264  .3.0: MC, Oxford
+00018d40: 2c20 3920 4d61 7920 3230 3136 0d0a 2b2b  , 9 May 2016..++
 00018d50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018d60: 2b2b 2b0d 0a0d 0a2d 2055 7064 6174 6564  +++....- Updated
-00018d70: 2064 6f63 756d 656e 7461 7469 6f6e 2e20   documentation. 
-00018d80: 5468 616e 6b73 2074 6f20 5065 7465 7220  Thanks to Peter 
-00018d90: 5765 696c 6261 6368 6572 2028 506f 7473  Weilbacher (Pots
-00018da0: 6461 6d29 2066 6f72 0d0a 2020 636f 7272  dam) for..  corr
-00018db0: 6563 7469 6f6e 732e 0d0a 0d0a 5635 2e31  ections.....V5.1
-00018dc0: 2e31 343a 204d 432c 204f 7866 6f72 642c  .14: MC, Oxford,
-00018dd0: 2031 3920 4f63 746f 6265 7220 3230 3135   19 October 2015
-00018de0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-00018df0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018e00: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 4669 7865  ++++++....- Fixe
-00018e10: 6420 6465 7072 6563 6174 696f 6e20 7761  d deprecation wa
-00018e20: 726e 696e 6720 696e 204e 756d 7079 2031  rning in Numpy 1
-00018e30: 2e31 302e 0d0a 0d0a 5635 2e31 2e31 333a  .10.....V5.1.13:
-00018e40: 204d 432c 204f 7866 6f72 642c 2032 3420   MC, Oxford, 24 
-00018e50: 4170 7269 6c20 3230 3135 0d0a 2b2b 2b2b  April 2015..++++
+00018d60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+00018d70: 2d20 496e 636c 7564 6564 2060 6076 656c  - Included ``vel
+00018d80: 7363 616c 655f 7261 7469 6f60 6020 6b65  scale_ratio`` ke
+00018d90: 7977 6f72 6420 746f 2070 6173 7320 6120  yword to pass a 
+00018da0: 7365 7420 6f66 2074 656d 706c 6174 6573  set of templates
+00018db0: 2077 6974 680d 0a20 2068 6967 6865 7220   with..  higher 
+00018dc0: 7265 736f 6c75 7469 6f6e 2074 6861 6e20  resolution than 
+00018dd0: 7468 6520 6761 6c61 7879 2073 7065 6374  the galaxy spect
+00018de0: 7275 6d2e 0d0a 2d20 4368 616e 6765 6420  rum...- Changed 
+00018df0: 6060 6f76 6572 7361 6d70 6c65 6060 206b  ``oversample`` k
+00018e00: 6579 776f 7264 2074 6f20 7265 7175 6972  eyword to requir
+00018e10: 6520 696e 7465 6765 7273 2c20 6e6f 7420  e integers, not 
+00018e20: 426f 6f6c 6561 6e73 2e0d 0a0d 0a56 352e  Booleans.....V5.
+00018e30: 322e 303a 204d 432c 2042 616c 7469 6d6f  2.0: MC, Baltimo
+00018e40: 7265 2c20 3236 2041 7072 696c 2032 3031  re, 26 April 201
+00018e50: 360d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  6..+++++++++++++
 00018e60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018e70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
-00018e80: 0d0a 2d20 5570 6461 7465 6420 646f 6375  ..- Updated docu
-00018e90: 6d65 6e74 6174 696f 6e2e 0d0a 0d0a 5635  mentation.....V5
-00018ea0: 2e31 2e31 323a 204d 432c 204f 7866 6f72  .1.12: MC, Oxfor
-00018eb0: 642c 2032 3520 4665 6272 7561 7279 2032  d, 25 February 2
-00018ec0: 3031 350d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  015..+++++++++++
-00018ed0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018ee0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-00018ef0: 5573 6520 6060 636f 6c6f 723d 6060 2069  Use ``color=`` i
-00018f00: 6e73 7465 6164 206f 6620 6060 633d 6060  nstead of ``c=``
-00018f10: 2074 6f20 6176 6f69 6420 6120 6e65 7720   to avoid a new 
-00018f20: 4d61 7470 6c6f 746c 6962 2031 2e34 2062  Matplotlib 1.4 b
-00018f30: 7567 2e0d 0a0d 0a56 352e 312e 3131 3a20  ug.....V5.1.11: 
-00018f40: 4d43 2c20 5379 646e 6579 2c20 3520 4665  MC, Sydney, 5 Fe
-00018f50: 6272 7561 7279 2032 3031 350d 0a2b 2b2b  bruary 2015..+++
-00018f60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018f70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00018f80: 2b0d 0a0d 0a2d 2052 6576 6572 7465 6420  +....- Reverted 
-00018f90: 6368 616e 6765 2069 6e74 726f 6475 6365  change introduce
-00018fa0: 6420 696e 2056 352e 312e 322e 2054 6861  d in V5.1.2. Tha
-00018fb0: 6e6b 7320 746f 204e 6f72 6120 4c75 2274  nks to Nora Lu"t
-00018fc0: 7a67 656e 646f 7266 0d0a 2020 666f 7220  zgendorf..  for 
-00018fd0: 7265 706f 7274 696e 6720 7072 6f62 6c65  reporting proble
-00018fe0: 6d73 2077 6974 6820 6060 6f76 6572 7361  ms with ``oversa
-00018ff0: 6d70 6c65 6060 2e0d 0a0d 0a56 352e 312e  mple``.....V5.1.
-00019000: 3130 3a20 4d43 2c20 4f78 666f 7264 2c20  10: MC, Oxford, 
-00019010: 3134 204f 6374 6f62 6572 2032 3031 340d  14 October 2014.
-00019020: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-00019030: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019040: 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978 6564  +++++....- Fixed
-00019050: 2062 7567 2069 6e20 7361 7669 6e67 206f   bug in saving o
-00019060: 7574 7075 7420 696e 7472 6f64 7563 6564  utput introduced
-00019070: 2069 6e20 7468 6520 7072 6576 696f 7573   in the previous
-00019080: 2076 6572 7369 6f6e 2e0d 0a0d 0a56 352e   version.....V5.
-00019090: 312e 393a 204d 432c 204c 6173 2056 6567  1.9: MC, Las Veg
-000190a0: 6173 2041 6972 706f 7274 2c20 3133 2053  as Airport, 13 S
-000190b0: 6570 7465 6d62 6572 2032 3031 340d 0a2b  eptember 2014..+
-000190c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000190d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000190e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-000190f0: 0a0d 0a2d 2050 7265 2d63 6f6d 7075 7465  ...- Pre-compute
-00019100: 2046 4654 2061 6e64 206f 7665 7273 616d   FFT and oversam
-00019110: 706c 696e 6720 6f66 2074 656d 706c 6174  pling of templat
-00019120: 6573 2e20 5468 6973 2073 7065 6564 7320  es. This speeds 
-00019130: 7570 2074 6865 0d0a 2020 6361 6c63 756c  up the..  calcul
-00019140: 6174 696f 6e20 666f 7220 7665 7279 206c  ation for very l
-00019150: 6f6e 6720 6f72 2068 6967 686c 7920 6f76  ong or highly ov
-00019160: 6572 7361 6d70 6c65 6420 7370 6563 7472  ersampled spectr
-00019170: 612e 2054 6861 6e6b 7320 746f 0d0a 2020  a. Thanks to..  
-00019180: 5265 6d63 6f20 7661 6e20 6465 6e20 426f  Remco van den Bo
-00019190: 7363 6820 666f 7220 7265 706f 7274 696e  sch for reportin
-000191a0: 6720 7369 7475 6174 696f 6e73 2077 6865  g situations whe
-000191b0: 7265 2074 6869 7320 6f70 7469 6d69 7a61  re this optimiza
-000191c0: 7469 6f6e 0d0a 2020 6d61 7920 6265 2075  tion..  may be u
-000191d0: 7365 6675 6c2e 0d0a 0d0a 5635 2e31 2e38  seful.....V5.1.8
-000191e0: 3a20 4d43 2c20 5574 6168 2c20 3130 2053  : MC, Utah, 10 S
-000191f0: 6570 7465 6d62 6572 2032 3031 340d 0a2b  eptember 2014..+
+00018e70: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2049 6e63  +++++++....- Inc
+00018e80: 6c75 6465 6420 6060 626f 756e 6473 6060  luded ``bounds``
+00018e90: 2c20 6060 6669 7865 6460 6020 616e 6420  , ``fixed`` and 
+00018ea0: 6060 6672 6163 7469 6f6e 6060 206b 6579  ``fraction`` key
+00018eb0: 776f 7264 732e 0d0a 0d0a 5635 2e31 2e31  words.....V5.1.1
+00018ec0: 383a 204d 432c 204f 7866 6f72 642c 2032  8: MC, Oxford, 2
+00018ed0: 3020 4170 7269 6c20 3230 3136 0d0a 2b2b  0 April 2016..++
+00018ee0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018ef0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018f00: 0d0a 0d0a 2d20 4669 7865 6420 6465 7072  ....- Fixed depr
+00018f10: 6563 6174 696f 6e20 7761 726e 696e 6720  ecation warning 
+00018f20: 696e 204e 756d 7079 2031 2e31 312e 2043  in Numpy 1.11. C
+00018f30: 6861 6e67 6564 206f 7264 6572 2066 726f  hanged order fro
+00018f40: 6d20 3120 746f 2033 0d0a 2020 6475 7269  m 1 to 3..  duri
+00018f50: 6e67 206f 7665 7273 616d 706c 696e 672e  ng oversampling.
+00018f60: 2057 6172 6e20 6966 2073 6967 6d61 2069   Warn if sigma i
+00018f70: 7320 756e 6465 722d 7361 6d70 6c65 642e  s under-sampled.
+00018f80: 0d0a 0d0a 5635 2e31 2e31 373a 204d 432c  ....V5.1.17: MC,
+00018f90: 204f 7866 6f72 642c 2032 3120 4a61 6e75   Oxford, 21 Janu
+00018fa0: 6172 7920 3230 3136 0d0a 2b2b 2b2b 2b2b  ary 2016..++++++
+00018fb0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00018fc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
+00018fd0: 0d0a 2d20 4578 7061 6e64 6564 2065 7870  ..- Expanded exp
+00018fe0: 6c61 6e61 7469 6f6e 206f 6620 7468 6520  lanation of the 
+00018ff0: 7265 6c61 7469 6f6e 7368 6970 2062 6574  relationship bet
+00019000: 7765 656e 206f 7574 7075 7420 7665 6c6f  ween output velo
+00019010: 6369 7479 2061 6e64 2072 6564 7368 6966  city and redshif
+00019020: 742e 0d0a 0d0a 5635 2e31 2e31 363a 204d  t.....V5.1.16: M
+00019030: 432c 204f 7866 6f72 642c 2039 204e 6f76  C, Oxford, 9 Nov
+00019040: 656d 6265 7220 3230 3135 0d0a 2b2b 2b2b  ember 2015..++++
+00019050: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019060: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019070: 0d0a 0d0a 2d20 4669 7865 6420 706f 7465  ....- Fixed pote
+00019080: 6e74 6961 6c6c 7920 6d69 736c 6561 6469  ntially misleadi
+00019090: 6e67 2074 7970 6f20 696e 2064 6f63 756d  ng typo in docum
+000190a0: 656e 7461 7469 6f6e 206f 6620 6060 6d6f  entation of ``mo
+000190b0: 6d65 6e74 7360 602e 0d0a 0d0a 5635 2e31  ments``.....V5.1
+000190c0: 2e31 353a 204d 432c 204f 7866 6f72 642c  .15: MC, Oxford,
+000190d0: 2032 3220 4f63 746f 6265 7220 3230 3135   22 October 2015
+000190e0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+000190f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019100: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5570 6461  ++++++....- Upda
+00019110: 7465 6420 646f 6375 6d65 6e74 6174 696f  ted documentatio
+00019120: 6e2e 2054 6861 6e6b 7320 746f 2050 6574  n. Thanks to Pet
+00019130: 6572 2057 6569 6c62 6163 6865 7220 2850  er Weilbacher (P
+00019140: 6f74 7364 616d 2920 666f 720d 0a20 2063  otsdam) for..  c
+00019150: 6f72 7265 6374 696f 6e73 2e0d 0a0d 0a56  orrections.....V
+00019160: 352e 312e 3134 3a20 4d43 2c20 4f78 666f  5.1.14: MC, Oxfo
+00019170: 7264 2c20 3139 204f 6374 6f62 6572 2032  rd, 19 October 2
+00019180: 3031 350d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  015..+++++++++++
+00019190: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000191a0: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2046  +++++++++....- F
+000191b0: 6978 6564 2064 6570 7265 6361 7469 6f6e  ixed deprecation
+000191c0: 2077 6172 6e69 6e67 2069 6e20 4e75 6d70   warning in Nump
+000191d0: 7920 312e 3130 2e0d 0a0d 0a56 352e 312e  y 1.10.....V5.1.
+000191e0: 3133 3a20 4d43 2c20 4f78 666f 7264 2c20  13: MC, Oxford, 
+000191f0: 3234 2041 7072 696c 2032 3031 350d 0a2b  24 April 2015..+
 00019200: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 00019210: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019220: 2b2b 0d0a 0d0a 2d20 4669 7865 6420 7072  ++....- Fixed pr
-00019230: 6f67 7261 6d20 7374 6f70 2077 6974 6820  ogram stop with 
-00019240: 6060 7265 6464 656e 696e 6760 6020 6b65  ``reddening`` ke
-00019250: 7977 6f72 642e 2054 6861 6e6b 7320 746f  yword. Thanks to
-00019260: 204d 6173 6174 616f 0d0a 2020 4f6e 6f64   Masatao..  Onod
-00019270: 6572 6120 666f 7220 7265 706f 7274 696e  era for reportin
-00019280: 6720 7468 6520 7072 6f62 6c65 6d2e 0d0a  g the problem...
-00019290: 0d0a 5635 2e31 2e37 3a20 4d43 2c20 4f78  ..V5.1.7: MC, Ox
-000192a0: 666f 7264 2c20 3320 5365 7074 656d 6265  ford, 3 Septembe
-000192b0: 7220 3230 3134 0d0a 2b2b 2b2b 2b2b 2b2b  r 2014..++++++++
-000192c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000192d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-000192e0: 2d20 5265 6c61 7865 6420 7265 7175 6972  - Relaxed requir
-000192f0: 656d 656e 7420 6f6e 2069 6e70 7574 206d  ement on input m
-00019300: 6178 696d 756d 2076 656c 6f63 6974 7920  aximum velocity 
-00019310: 7368 6966 742e 0d0a 2d20 4d69 6e6f 7220  shift...- Minor 
-00019320: 7265 6f72 6761 6e69 7a61 7469 6f6e 206f  reorganization o
-00019330: 6620 7468 6520 636f 6465 2073 7472 7563  f the code struc
-00019340: 7475 7265 2e0d 0a0d 0a56 352e 312e 363a  ture.....V5.1.6:
-00019350: 204d 432c 204f 7866 6f72 642c 2036 2041   MC, Oxford, 6 A
-00019360: 7567 7573 7420 3230 3134 0d0a 2b2b 2b2b  ugust 2014..++++
-00019370: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019380: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00019390: 0a2d 2043 6174 6368 2061 6e20 6164 6469  .- Catch an addi
-000193a0: 7469 6f6e 616c 2069 6e70 7574 2065 7272  tional input err
-000193b0: 6f72 2e20 5570 6461 7465 6420 646f 6375  or. Updated docu
-000193c0: 6d65 6e74 6174 696f 6e20 666f 7220 5079  mentation for Py
-000193d0: 7468 6f6e 2e0d 0a20 2049 6e63 6c75 6465  thon...  Include
-000193e0: 6420 7465 6d70 6c61 7465 7320 6060 6d61  d templates ``ma
-000193f0: 7472 6978 6060 2069 6e20 6f75 7470 7574  trix`` in output
-00019400: 2e20 4d6f 6469 6669 6564 2070 6c6f 7474  . Modified plott
-00019410: 696e 6720 636f 6c6f 7572 732e 0d0a 0d0a  ing colours.....
-00019420: 5635 2e31 2e35 3a20 4d43 2c20 4f78 666f  V5.1.5: MC, Oxfo
-00019430: 7264 2c20 3231 204a 756e 6520 3230 3134  rd, 21 June 2014
-00019440: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
-00019450: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019460: 2b2b 0d0a 0d0a 2d20 4669 7865 6420 6465  ++....- Fixed de
-00019470: 7072 6563 6174 696f 6e20 7761 726e 696e  precation warnin
-00019480: 672e 0d0a 0d0a 5635 2e31 2e34 3a20 4d43  g.....V5.1.4: MC
-00019490: 2c20 4f78 666f 7264 2c20 3235 204d 6179  , Oxford, 25 May
-000194a0: 2032 3031 340d 0a2b 2b2b 2b2b 2b2b 2b2b   2014..+++++++++
-000194b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000194c0: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5375 7070  ++++++....- Supp
-000194d0: 6f72 7420 626f 7468 2050 7974 686f 6e20  ort both Python 
-000194e0: 322e 3720 616e 6420 5079 7468 6f6e 2033  2.7 and Python 3
-000194f0: 2e0d 0a0d 0a56 352e 312e 333a 204d 432c  .....V5.1.3: MC,
-00019500: 204f 7866 6f72 642c 2037 204d 6179 2032   Oxford, 7 May 2
-00019510: 3031 340d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  014..+++++++++++
-00019520: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019530: 2b2b 2b0d 0a0d 0a2d 2041 6c6c 6f77 2066  +++....- Allow f
-00019540: 6f72 2061 6e20 696e 7075 7420 636f 7661  or an input cova
-00019550: 7269 616e 6365 206d 6174 7269 7820 696e  riance matrix in
-00019560: 7374 6561 6420 6f66 2061 6e20 6572 726f  stead of an erro
-00019570: 7220 7370 6563 7472 756d 2e0d 0a0d 0a56  r spectrum.....V
-00019580: 352e 312e 323a 204d 432c 204f 7866 6f72  5.1.2: MC, Oxfor
-00019590: 642c 2036 204d 6179 2032 3031 340d 0a2b  d, 6 May 2014..+
-000195a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000195b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-000195c0: 0a2d 2052 6570 6c61 6365 6420 5245 4249  .- Replaced REBI
-000195d0: 4e20 7769 7468 2049 4e54 4552 504f 4c41  N with INTERPOLA
-000195e0: 5445 202b 202f 4f56 4552 5341 4d50 4c45  TE + /OVERSAMPLE
-000195f0: 206b 6579 776f 7264 2e20 5468 6973 2069   keyword. This i
-00019600: 730d 0a20 2074 6f20 6163 636f 756e 7420  s..  to account 
-00019610: 666f 7220 7468 6520 6661 6374 2074 6861  for the fact tha
-00019620: 7420 7468 6520 4c69 6e65 2053 7072 6561  t the Line Sprea
-00019630: 6420 4675 6e63 7469 6f6e 206f 6620 7468  d Function of th
-00019640: 6520 6f62 7365 7276 6564 0d0a 2020 6761  e observed..  ga
-00019650: 6c61 7879 2073 7065 6374 7275 6d20 616c  laxy spectrum al
-00019660: 7265 6164 7920 696e 636c 7564 6573 2070  ready includes p
-00019670: 6978 656c 2063 6f6e 766f 6c75 7469 6f6e  ixel convolution
-00019680: 2e20 5468 616e 6b73 2074 6f20 4d69 6b65  . Thanks to Mike
-00019690: 0d0a 2020 426c 616e 746f 6e20 666f 7220  ..  Blanton for 
-000196a0: 7468 6520 7375 6767 6573 7469 6f6e 2e0d  the suggestion..
-000196b0: 0a0d 0a56 352e 312e 313a 204d 432c 2044  ...V5.1.1: MC, D
-000196c0: 616c 6c61 7320 4169 7270 6f72 742c 2039  allas Airport, 9
-000196d0: 2046 6562 7275 6172 7920 3230 3134 0d0a   February 2014..
-000196e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000196f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019700: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
-00019710: 2046 6978 6564 2074 7970 6f20 696e 2074   Fixed typo in t
-00019720: 6865 2064 6f63 756d 656e 7461 7469 6f6e  he documentation
-00019730: 206f 6620 6060 6e6e 6c73 5f66 6c61 6773   of ``nnls_flags
-00019740: 6060 2e0d 0a0d 0a56 352e 312e 303a 204d  ``.....V5.1.0: M
-00019750: 432c 204f 7866 6f72 642c 2039 204a 616e  C, Oxford, 9 Jan
-00019760: 7561 7279 2032 3031 340d 0a2b 2b2b 2b2b  uary 2014..+++++
-00019770: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019780: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-00019790: 0a2d 2041 6c6c 6f77 2066 6f72 2061 2064  .- Allow for a d
-000197a0: 6966 6665 7265 6e74 204c 4f53 5644 2066  ifferent LOSVD f
-000197b0: 6f72 2065 6163 6820 7465 6d70 6c61 7465  or each template
-000197c0: 2e20 5465 6d70 6c61 7465 7320 6361 6e20  . Templates can 
-000197d0: 6265 2073 7465 6c6c 6172 206f 720d 0a20  be stellar or.. 
-000197e0: 2063 616e 2062 6520 6761 7320 656d 6973   can be gas emis
-000197f0: 7369 6f6e 206c 696e 6573 2e20 4120 7050  sion lines. A pP
-00019800: 5846 2076 6572 7369 6f6e 2061 6461 7074  XF version adapt
-00019810: 6564 2066 6f72 206d 756c 7469 706c 6520  ed for multiple 
-00019820: 6b69 6e65 6d61 7469 630d 0a20 2063 6f6d  kinematic..  com
-00019830: 706f 6e65 6e74 7320 6578 6973 7465 6420  ponents existed 
-00019840: 666f 7220 7965 6172 732e 2049 7420 7761  for years. It wa
-00019850: 7320 7570 6461 7465 6420 696e 204a 414e  s updated in JAN
-00019860: 2f32 3031 3220 666f 7220 7468 6520 7061  /2012 for the pa
-00019870: 7065 7220 6279 0d0a 2020 4a6f 686e 7374  per by..  Johnst
-00019880: 6f6e 2065 7420 616c 2e20 2832 3031 332c  on et al. (2013,
-00019890: 204d 4e52 4153 292e 2054 6869 7320 7665   MNRAS). This ve
-000198a0: 7273 696f 6e20 6d65 7267 6573 2074 686f  rsion merges tho
-000198b0: 7365 2063 6861 6e67 6573 2077 6974 6820  se changes with 
-000198c0: 7468 650d 0a20 2070 7562 6c69 6320 7050  the..  public pP
-000198d0: 5846 2076 6572 7369 6f6e 2c20 6d61 6b69  XF version, maki
-000198e0: 6e67 2073 7572 6520 7468 6174 2061 6c6c  ng sure that all
-000198f0: 2070 7265 7669 6f75 7320 7050 5846 206f   previous pPXF o
-00019900: 7074 696f 6e73 2061 7265 2073 7469 6c6c  ptions are still
-00019910: 0d0a 2020 7375 7070 6f72 7465 642e 0d0a  ..  supported...
-00019920: 0d0a 5635 2e30 2e31 3a20 4d43 2c20 4f78  ..V5.0.1: MC, Ox
-00019930: 666f 7264 2c20 3132 2044 6563 656d 6265  ford, 12 Decembe
-00019940: 7220 3230 3133 0d0a 2b2b 2b2b 2b2b 2b2b  r 2013..++++++++
+00019220: 2b0d 0a0d 0a2d 2055 7064 6174 6564 2064  +....- Updated d
+00019230: 6f63 756d 656e 7461 7469 6f6e 2e0d 0a0d  ocumentation....
+00019240: 0a56 352e 312e 3132 3a20 4d43 2c20 4f78  .V5.1.12: MC, Ox
+00019250: 666f 7264 2c20 3235 2046 6562 7275 6172  ford, 25 Februar
+00019260: 7920 3230 3135 0d0a 2b2b 2b2b 2b2b 2b2b  y 2015..++++++++
+00019270: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019280: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+00019290: 0a2d 2055 7365 2060 6063 6f6c 6f72 3d60  .- Use ``color=`
+000192a0: 6020 696e 7374 6561 6420 6f66 2060 6063  ` instead of ``c
+000192b0: 3d60 6020 746f 2061 766f 6964 2061 206e  =`` to avoid a n
+000192c0: 6577 204d 6174 706c 6f74 6c69 6220 312e  ew Matplotlib 1.
+000192d0: 3420 6275 672e 0d0a 0d0a 5635 2e31 2e31  4 bug.....V5.1.1
+000192e0: 313a 204d 432c 2053 7964 6e65 792c 2035  1: MC, Sydney, 5
+000192f0: 2046 6562 7275 6172 7920 3230 3135 0d0a   February 2015..
+00019300: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019310: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019320: 2b2b 2b2b 0d0a 0d0a 2d20 5265 7665 7274  ++++....- Revert
+00019330: 6564 2063 6861 6e67 6520 696e 7472 6f64  ed change introd
+00019340: 7563 6564 2069 6e20 5635 2e31 2e32 2e20  uced in V5.1.2. 
+00019350: 5468 616e 6b73 2074 6f20 4e6f 7261 204c  Thanks to Nora L
+00019360: 7522 747a 6765 6e64 6f72 660d 0a20 2066  u"tzgendorf..  f
+00019370: 6f72 2072 6570 6f72 7469 6e67 2070 726f  or reporting pro
+00019380: 626c 656d 7320 7769 7468 2060 606f 7665  blems with ``ove
+00019390: 7273 616d 706c 6560 602e 0d0a 0d0a 5635  rsample``.....V5
+000193a0: 2e31 2e31 303a 204d 432c 204f 7866 6f72  .1.10: MC, Oxfor
+000193b0: 642c 2031 3420 4f63 746f 6265 7220 3230  d, 14 October 20
+000193c0: 3134 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  14..++++++++++++
+000193d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000193e0: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 4669  ++++++++....- Fi
+000193f0: 7865 6420 6275 6720 696e 2073 6176 696e  xed bug in savin
+00019400: 6720 6f75 7470 7574 2069 6e74 726f 6475  g output introdu
+00019410: 6365 6420 696e 2074 6865 2070 7265 7669  ced in the previ
+00019420: 6f75 7320 7665 7273 696f 6e2e 0d0a 0d0a  ous version.....
+00019430: 5635 2e31 2e39 3a20 4d43 2c20 4c61 7320  V5.1.9: MC, Las 
+00019440: 5665 6761 7320 4169 7270 6f72 742c 2031  Vegas Airport, 1
+00019450: 3320 5365 7074 656d 6265 7220 3230 3134  3 September 2014
+00019460: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+00019470: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019480: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019490: 2b2b 0d0a 0d0a 2d20 5072 652d 636f 6d70  ++....- Pre-comp
+000194a0: 7574 6520 4646 5420 616e 6420 6f76 6572  ute FFT and over
+000194b0: 7361 6d70 6c69 6e67 206f 6620 7465 6d70  sampling of temp
+000194c0: 6c61 7465 732e 2054 6869 7320 7370 6565  lates. This spee
+000194d0: 6473 2075 7020 7468 650d 0a20 2063 616c  ds up the..  cal
+000194e0: 6375 6c61 7469 6f6e 2066 6f72 2076 6572  culation for ver
+000194f0: 7920 6c6f 6e67 206f 7220 6869 6768 6c79  y long or highly
+00019500: 206f 7665 7273 616d 706c 6564 2073 7065   oversampled spe
+00019510: 6374 7261 2e20 5468 616e 6b73 2074 6f0d  ctra. Thanks to.
+00019520: 0a20 2052 656d 636f 2076 616e 2064 656e  .  Remco van den
+00019530: 2042 6f73 6368 2066 6f72 2072 6570 6f72   Bosch for repor
+00019540: 7469 6e67 2073 6974 7561 7469 6f6e 7320  ting situations 
+00019550: 7768 6572 6520 7468 6973 206f 7074 696d  where this optim
+00019560: 697a 6174 696f 6e0d 0a20 206d 6179 2062  ization..  may b
+00019570: 6520 7573 6566 756c 2e0d 0a0d 0a56 352e  e useful.....V5.
+00019580: 312e 383a 204d 432c 2055 7461 682c 2031  1.8: MC, Utah, 1
+00019590: 3020 5365 7074 656d 6265 7220 3230 3134  0 September 2014
+000195a0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+000195b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000195c0: 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978 6564  +++++....- Fixed
+000195d0: 2070 726f 6772 616d 2073 746f 7020 7769   program stop wi
+000195e0: 7468 2060 6072 6564 6465 6e69 6e67 6060  th ``reddening``
+000195f0: 206b 6579 776f 7264 2e20 5468 616e 6b73   keyword. Thanks
+00019600: 2074 6f20 4d61 7361 7461 6f0d 0a20 204f   to Masatao..  O
+00019610: 6e6f 6465 7261 2066 6f72 2072 6570 6f72  nodera for repor
+00019620: 7469 6e67 2074 6865 2070 726f 626c 656d  ting the problem
+00019630: 2e0d 0a0d 0a56 352e 312e 373a 204d 432c  .....V5.1.7: MC,
+00019640: 204f 7866 6f72 642c 2033 2053 6570 7465   Oxford, 3 Septe
+00019650: 6d62 6572 2032 3031 340d 0a2b 2b2b 2b2b  mber 2014..+++++
+00019660: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019670: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+00019680: 0a0d 0a2d 2052 656c 6178 6564 2072 6571  ...- Relaxed req
+00019690: 7569 7265 6d65 6e74 206f 6e20 696e 7075  uirement on inpu
+000196a0: 7420 6d61 7869 6d75 6d20 7665 6c6f 6369  t maximum veloci
+000196b0: 7479 2073 6869 6674 2e0d 0a2d 204d 696e  ty shift...- Min
+000196c0: 6f72 2072 656f 7267 616e 697a 6174 696f  or reorganizatio
+000196d0: 6e20 6f66 2074 6865 2063 6f64 6520 7374  n of the code st
+000196e0: 7275 6374 7572 652e 0d0a 0d0a 5635 2e31  ructure.....V5.1
+000196f0: 2e36 3a20 4d43 2c20 4f78 666f 7264 2c20  .6: MC, Oxford, 
+00019700: 3620 4175 6775 7374 2032 3031 340d 0a2b  6 August 2014..+
+00019710: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019720: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019730: 0d0a 0d0a 2d20 4361 7463 6820 616e 2061  ....- Catch an a
+00019740: 6464 6974 696f 6e61 6c20 696e 7075 7420  dditional input 
+00019750: 6572 726f 722e 2055 7064 6174 6564 2064  error. Updated d
+00019760: 6f63 756d 656e 7461 7469 6f6e 2066 6f72  ocumentation for
+00019770: 2050 7974 686f 6e2e 0d0a 2020 496e 636c   Python...  Incl
+00019780: 7564 6564 2074 656d 706c 6174 6573 2060  uded templates `
+00019790: 606d 6174 7269 7860 6020 696e 206f 7574  `matrix`` in out
+000197a0: 7075 742e 204d 6f64 6966 6965 6420 706c  put. Modified pl
+000197b0: 6f74 7469 6e67 2063 6f6c 6f75 7273 2e0d  otting colours..
+000197c0: 0a0d 0a56 352e 312e 353a 204d 432c 204f  ...V5.1.5: MC, O
+000197d0: 7866 6f72 642c 2032 3120 4a75 6e65 2032  xford, 21 June 2
+000197e0: 3031 340d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  014..+++++++++++
+000197f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019800: 2b2b 2b2b 2b0d 0a0d 0a2d 2046 6978 6564  +++++....- Fixed
+00019810: 2064 6570 7265 6361 7469 6f6e 2077 6172   deprecation war
+00019820: 6e69 6e67 2e0d 0a0d 0a56 352e 312e 343a  ning.....V5.1.4:
+00019830: 204d 432c 204f 7866 6f72 642c 2032 3520   MC, Oxford, 25 
+00019840: 4d61 7920 3230 3134 0d0a 2b2b 2b2b 2b2b  May 2014..++++++
+00019850: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019860: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2053  +++++++++....- S
+00019870: 7570 706f 7274 2062 6f74 6820 5079 7468  upport both Pyth
+00019880: 6f6e 2032 2e37 2061 6e64 2050 7974 686f  on 2.7 and Pytho
+00019890: 6e20 332e 0d0a 0d0a 5635 2e31 2e33 3a20  n 3.....V5.1.3: 
+000198a0: 4d43 2c20 4f78 666f 7264 2c20 3720 4d61  MC, Oxford, 7 Ma
+000198b0: 7920 3230 3134 0d0a 2b2b 2b2b 2b2b 2b2b  y 2014..++++++++
+000198c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+000198d0: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 416c 6c6f  ++++++....- Allo
+000198e0: 7720 666f 7220 616e 2069 6e70 7574 2063  w for an input c
+000198f0: 6f76 6172 6961 6e63 6520 6d61 7472 6978  ovariance matrix
+00019900: 2069 6e73 7465 6164 206f 6620 616e 2065   instead of an e
+00019910: 7272 6f72 2073 7065 6374 7275 6d2e 0d0a  rror spectrum...
+00019920: 0d0a 5635 2e31 2e32 3a20 4d43 2c20 4f78  ..V5.1.2: MC, Ox
+00019930: 666f 7264 2c20 3620 4d61 7920 3230 3134  ford, 6 May 2014
+00019940: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
 00019950: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019960: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-00019970: 2d20 4d69 6e6f 7220 636c 6561 6e69 6e67  - Minor cleaning
-00019980: 2061 6e64 2063 6f72 7265 6374 696f 6e73   and corrections
-00019990: 2e0d 0a0d 0a56 352e 302e 303a 204d 432c  .....V5.0.0: MC,
-000199a0: 204f 7866 6f72 642c 2036 2044 6563 656d   Oxford, 6 Decem
-000199b0: 6265 7220 3230 3133 0d0a 2b2b 2b2b 2b2b  ber 2013..++++++
-000199c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-000199d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-000199e0: 0a2d 2054 7261 6e73 6c61 7465 6420 6672  .- Translated fr
-000199f0: 6f6d 2049 444c 2069 6e74 6f20 5079 7468  om IDL into Pyth
-00019a00: 6f6e 2061 6e64 2074 6573 7465 6420 6167  on and tested ag
-00019a10: 6169 6e73 7420 7468 6520 6f72 6967 696e  ainst the origin
-00019a20: 616c 2076 6572 7369 6f6e 2e0d 0a0d 0a56  al version.....V
-00019a30: 342e 362e 363a 204d 432c 2050 6172 616e  4.6.6: MC, Paran
-00019a40: 616c 2c20 3820 4e6f 7665 6d62 6572 2032  al, 8 November 2
-00019a50: 3031 330d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  013..+++++++++++
-00019a60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019a70: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2055  +++++++++....- U
-00019a80: 7365 7320 4341 505f 5241 4e47 4520 746f  ses CAP_RANGE to
-00019a90: 2061 766f 6964 2070 6f74 656e 7469 616c   avoid potential
-00019aa0: 206e 616d 696e 6720 636f 6e66 6c69 6374   naming conflict
-00019ab0: 732e 0d0a 0d0a 5634 2e36 2e35 3a20 4d43  s.....V4.6.5: MC
-00019ac0: 2c20 4f78 666f 7264 2c20 3135 204e 6f76  , Oxford, 15 Nov
-00019ad0: 656d 6265 7220 3230 3132 0d0a 2b2b 2b2b  ember 2012..++++
-00019ae0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019af0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019b00: 0d0a 0d0a 2d20 4578 7061 6e64 6564 2064  ....- Expanded d
-00019b10: 6f63 756d 656e 7461 7469 6f6e 206f 6620  ocumentation of 
-00019b20: 5245 4755 4c20 6b65 7977 6f72 642e 0d0a  REGUL keyword...
-00019b30: 0d0a 5634 2e36 2e34 3a20 4d43 2c20 4f78  ..V4.6.4: MC, Ox
-00019b40: 666f 7264 2c20 3920 4465 6365 6d62 6572  ford, 9 December
-00019b50: 2032 3031 310d 0a2b 2b2b 2b2b 2b2b 2b2b   2011..+++++++++
-00019b60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019b70: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-00019b80: 496e 6372 6561 7365 6420 6f76 6572 7361  Increased oversa
-00019b90: 6d70 6c69 6e67 2066 6163 746f 7220 746f  mpling factor to
-00019ba0: 2033 3078 2c20 7768 656e 2074 6865 202f   30x, when the /
-00019bb0: 4f56 4552 5341 4d50 4c45 206b 6579 776f  OVERSAMPLE keywo
-00019bc0: 7264 0d0a 2020 6973 2075 7365 642e 2055  rd..  is used. U
-00019bd0: 7064 6174 6564 2063 6f72 7265 7370 6f6e  pdated correspon
-00019be0: 6469 6e67 2064 6f63 756d 656e 7461 7469  ding documentati
-00019bf0: 6f6e 2e20 5468 616e 6b73 2074 6f20 4e6f  on. Thanks to No
-00019c00: 7261 0d0a 2020 4c75 2274 7a67 656e 646f  ra..  Lu"tzgendo
-00019c10: 7266 2066 6f72 2074 6573 7420 6361 7365  rf for test case
-00019c20: 7320 696c 6c75 7374 7261 7469 6e67 2065  s illustrating e
-00019c30: 7272 6f72 7320 696e 2074 6865 2072 6563  rrors in the rec
-00019c40: 6f76 6572 6564 0d0a 2020 7665 6c6f 6369  overed..  veloci
-00019c50: 7479 2077 6865 6e20 7468 6520 7369 676d  ty when the sigm
-00019c60: 6120 6973 2073 6576 6572 656c 7920 756e  a is severely un
-00019c70: 6465 7273 616d 706c 6564 2e0d 0a0d 0a56  dersampled.....V
-00019c80: 342e 362e 333a 204d 432c 204f 7866 6f72  4.6.3: MC, Oxfor
-00019c90: 6420 3235 204f 6374 6f62 6572 2032 3031  d 25 October 201
-00019ca0: 310d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  1..+++++++++++++
-00019cb0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019cc0: 2b2b 2b2b 2b0d 0a0d 0a2d 2044 6f20 6e6f  +++++....- Do no
-00019cd0: 7420 6368 616e 6765 2054 454d 504c 4154  t change TEMPLAT
-00019ce0: 4553 2061 7272 6179 2069 6e20 6f75 7470  ES array in outp
-00019cf0: 7574 2077 6865 6e20 5245 4755 4c20 6973  ut when REGUL is
-00019d00: 206e 6f6e 7a65 726f 2e0d 0a20 2046 726f   nonzero...  Fro
-00019d10: 6d20 7468 6520 6665 6564 6261 636b 206f  m the feedback o
-00019d20: 6620 5269 6368 6172 6420 4d63 4465 726d  f Richard McDerm
-00019d30: 6964 2e0d 0a0d 0a56 342e 362e 323a 204d  id.....V4.6.2: M
-00019d40: 432c 204f 7866 6f72 642c 2031 3720 4f63  C, Oxford, 17 Oc
-00019d50: 746f 6265 7220 3230 3131 0d0a 2b2b 2b2b  tober 2011..++++
+00019960: 0d0a 0d0a 2d20 5265 706c 6163 6564 2052  ....- Replaced R
+00019970: 4542 494e 2077 6974 6820 494e 5445 5250  EBIN with INTERP
+00019980: 4f4c 4154 4520 2b20 2f4f 5645 5253 414d  OLATE + /OVERSAM
+00019990: 504c 4520 6b65 7977 6f72 642e 2054 6869  PLE keyword. Thi
+000199a0: 7320 6973 0d0a 2020 746f 2061 6363 6f75  s is..  to accou
+000199b0: 6e74 2066 6f72 2074 6865 2066 6163 7420  nt for the fact 
+000199c0: 7468 6174 2074 6865 204c 696e 6520 5370  that the Line Sp
+000199d0: 7265 6164 2046 756e 6374 696f 6e20 6f66  read Function of
+000199e0: 2074 6865 206f 6273 6572 7665 640d 0a20   the observed.. 
+000199f0: 2067 616c 6178 7920 7370 6563 7472 756d   galaxy spectrum
+00019a00: 2061 6c72 6561 6479 2069 6e63 6c75 6465   already include
+00019a10: 7320 7069 7865 6c20 636f 6e76 6f6c 7574  s pixel convolut
+00019a20: 696f 6e2e 2054 6861 6e6b 7320 746f 204d  ion. Thanks to M
+00019a30: 696b 650d 0a20 2042 6c61 6e74 6f6e 2066  ike..  Blanton f
+00019a40: 6f72 2074 6865 2073 7567 6765 7374 696f  or the suggestio
+00019a50: 6e2e 0d0a 0d0a 5635 2e31 2e31 3a20 4d43  n.....V5.1.1: MC
+00019a60: 2c20 4461 6c6c 6173 2041 6972 706f 7274  , Dallas Airport
+00019a70: 2c20 3920 4665 6272 7561 7279 2032 3031  , 9 February 201
+00019a80: 340d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  4..+++++++++++++
+00019a90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019aa0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
+00019ab0: 0d0a 2d20 4669 7865 6420 7479 706f 2069  ..- Fixed typo i
+00019ac0: 6e20 7468 6520 646f 6375 6d65 6e74 6174  n the documentat
+00019ad0: 696f 6e20 6f66 2060 606e 6e6c 735f 666c  ion of ``nnls_fl
+00019ae0: 6167 7360 602e 0d0a 0d0a 5635 2e31 2e30  ags``.....V5.1.0
+00019af0: 3a20 4d43 2c20 4f78 666f 7264 2c20 3920  : MC, Oxford, 9 
+00019b00: 4a61 6e75 6172 7920 3230 3134 0d0a 2b2b  January 2014..++
+00019b10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019b20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019b30: 0d0a 0d0a 2d20 416c 6c6f 7720 666f 7220  ....- Allow for 
+00019b40: 6120 6469 6666 6572 656e 7420 4c4f 5356  a different LOSV
+00019b50: 4420 666f 7220 6561 6368 2074 656d 706c  D for each templ
+00019b60: 6174 652e 2054 656d 706c 6174 6573 2063  ate. Templates c
+00019b70: 616e 2062 6520 7374 656c 6c61 7220 6f72  an be stellar or
+00019b80: 0d0a 2020 6361 6e20 6265 2067 6173 2065  ..  can be gas e
+00019b90: 6d69 7373 696f 6e20 6c69 6e65 732e 2041  mission lines. A
+00019ba0: 2070 5058 4620 7665 7273 696f 6e20 6164   pPXF version ad
+00019bb0: 6170 7465 6420 666f 7220 6d75 6c74 6970  apted for multip
+00019bc0: 6c65 206b 696e 656d 6174 6963 0d0a 2020  le kinematic..  
+00019bd0: 636f 6d70 6f6e 656e 7473 2065 7869 7374  components exist
+00019be0: 6564 2066 6f72 2079 6561 7273 2e20 4974  ed for years. It
+00019bf0: 2077 6173 2075 7064 6174 6564 2069 6e20   was updated in 
+00019c00: 4a41 4e2f 3230 3132 2066 6f72 2074 6865  JAN/2012 for the
+00019c10: 2070 6170 6572 2062 790d 0a20 204a 6f68   paper by..  Joh
+00019c20: 6e73 746f 6e20 6574 2061 6c2e 2028 3230  nston et al. (20
+00019c30: 3133 2c20 4d4e 5241 5329 2e20 5468 6973  13, MNRAS). This
+00019c40: 2076 6572 7369 6f6e 206d 6572 6765 7320   version merges 
+00019c50: 7468 6f73 6520 6368 616e 6765 7320 7769  those changes wi
+00019c60: 7468 2074 6865 0d0a 2020 7075 626c 6963  th the..  public
+00019c70: 2070 5058 4620 7665 7273 696f 6e2c 206d   pPXF version, m
+00019c80: 616b 696e 6720 7375 7265 2074 6861 7420  aking sure that 
+00019c90: 616c 6c20 7072 6576 696f 7573 2070 5058  all previous pPX
+00019ca0: 4620 6f70 7469 6f6e 7320 6172 6520 7374  F options are st
+00019cb0: 696c 6c0d 0a20 2073 7570 706f 7274 6564  ill..  supported
+00019cc0: 2e0d 0a0d 0a56 352e 302e 313a 204d 432c  .....V5.0.1: MC,
+00019cd0: 204f 7866 6f72 642c 2031 3220 4465 6365   Oxford, 12 Dece
+00019ce0: 6d62 6572 2032 3031 330d 0a2b 2b2b 2b2b  mber 2013..+++++
+00019cf0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019d00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+00019d10: 0a0d 0a2d 204d 696e 6f72 2063 6c65 616e  ...- Minor clean
+00019d20: 696e 6720 616e 6420 636f 7272 6563 7469  ing and correcti
+00019d30: 6f6e 732e 0d0a 0d0a 5635 2e30 2e30 3a20  ons.....V5.0.0: 
+00019d40: 4d43 2c20 4f78 666f 7264 2c20 3620 4465  MC, Oxford, 6 De
+00019d50: 6365 6d62 6572 2032 3031 330d 0a2b 2b2b  cember 2013..+++
 00019d60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019d70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-00019d80: 0a0d 0a2d 2049 6e63 6c75 6465 6420 6f70  ...- Included op
-00019d90: 7469 6f6e 2066 6f72 2033 4420 7265 6775  tion for 3D regu
-00019da0: 6c61 7269 7a61 7469 6f6e 2061 6e64 2075  larization and u
-00019db0: 7064 6174 6564 2064 6f63 756d 656e 7461  pdated documenta
-00019dc0: 7469 6f6e 206f 660d 0a20 2052 4547 554c  tion of..  REGUL
-00019dd0: 206b 6579 776f 7264 2e0d 0a0d 0a56 342e   keyword.....V4.
-00019de0: 362e 313a 204d 432c 204f 7866 6f72 642c  6.1: MC, Oxford,
-00019df0: 2032 3920 4a75 6c79 2032 3031 310d 0a2b   29 July 2011..+
+00019d70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019d80: 0d0a 0d0a 2d20 5472 616e 736c 6174 6564  ....- Translated
+00019d90: 2066 726f 6d20 4944 4c20 696e 746f 2050   from IDL into P
+00019da0: 7974 686f 6e20 616e 6420 7465 7374 6564  ython and tested
+00019db0: 2061 6761 696e 7374 2074 6865 206f 7269   against the ori
+00019dc0: 6769 6e61 6c20 7665 7273 696f 6e2e 0d0a  ginal version...
+00019dd0: 0d0a 5634 2e36 2e36 3a20 4d43 2c20 5061  ..V4.6.6: MC, Pa
+00019de0: 7261 6e61 6c2c 2038 204e 6f76 656d 6265  ranal, 8 Novembe
+00019df0: 7220 3230 3133 0d0a 2b2b 2b2b 2b2b 2b2b  r 2013..++++++++
 00019e00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019e10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-00019e20: 0a0d 0a2d 2055 7365 2043 6f79 6f74 6520  ...- Use Coyote 
-00019e30: 4772 6170 6869 6373 2028 6874 7470 3a2f  Graphics (http:/
-00019e40: 2f77 7777 2e69 646c 636f 796f 7465 2e63  /www.idlcoyote.c
-00019e50: 6f6d 2f29 2062 7920 4461 7669 6420 572e  om/) by David W.
-00019e60: 2046 616e 6e69 6e67 2e0d 0a20 2054 6865   Fanning...  The
-00019e70: 2072 6571 7569 7265 6420 726f 7574 696e   required routin
-00019e80: 6573 2061 7265 206e 6f77 2069 6e63 6c75  es are now inclu
-00019e90: 6465 6420 696e 204e 4153 4120 4944 4c20  ded in NASA IDL 
-00019ea0: 4173 7472 6f6e 6f6d 7920 4c69 6272 6172  Astronomy Librar
-00019eb0: 792e 0d0a 0d0a 5634 2e36 2e30 3a20 4d43  y.....V4.6.0: MC
-00019ec0: 2c20 4f78 666f 7264 2c20 3132 2041 7072  , Oxford, 12 Apr
-00019ed0: 696c 2032 3031 310d 0a2b 2b2b 2b2b 2b2b  il 2011..+++++++
-00019ee0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019ef0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-00019f00: 496d 706f 7274 616e 7420 6669 7820 746f  Important fix to
-00019f10: 202f 434c 4541 4e20 7072 6f63 6564 7572   /CLEAN procedur
-00019f20: 653a 2062 6164 2070 6978 656c 7320 6172  e: bad pixels ar
-00019f30: 6520 6e6f 7720 7072 6f70 6572 6c79 0d0a  e now properly..
-00019f40: 2020 7570 6461 7465 6420 6475 7269 6e67    updated during
-00019f50: 2074 6865 2033 7369 676d 6120 6974 6572   the 3sigma iter
-00019f60: 6174 696f 6e73 2e0d 0a0d 0a56 342e 352e  ations.....V4.5.
-00019f70: 303a 204d 432c 204f 7866 6f72 642c 2031  0: MC, Oxford, 1
-00019f80: 3320 4170 7269 6c20 3230 3130 0d0a 2b2b  3 April 2010..++
-00019f90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-00019fa0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-00019fb0: 0a0d 0a2d 2044 7261 6d61 7469 6320 7370  ...- Dramatic sp
-00019fc0: 6565 6420 7570 2069 6e20 7468 6520 636f  eed up in the co
-00019fd0: 6e76 6f6c 7574 696f 6e20 6f66 206c 6f6e  nvolution of lon
-00019fe0: 6720 7370 6563 7472 612e 0d0a 0d0a 5634  g spectra.....V4
-00019ff0: 2e34 2e30 3a20 4d43 2c20 4f78 666f 7264  .4.0: MC, Oxford
-0001a000: 2c20 3138 2053 6570 7465 6d62 6572 2032  , 18 September 2
-0001a010: 3030 390d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b  009..+++++++++++
-0001a020: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a030: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-0001a040: 496e 7472 6f64 7563 6564 2043 616c 7a65  Introduced Calze
-0001a050: 7474 6920 6574 2061 6c2e 2028 3230 3030  tti et al. (2000
-0001a060: 2920 7070 7866 5f52 4544 4445 4e49 4e47  ) ppxf_REDDENING
-0001a070: 5f43 5552 5645 2066 756e 6374 696f 6e20  _CURVE function 
-0001a080: 746f 0d0a 2020 6573 7469 6d61 7465 2074  to..  estimate t
-0001a090: 6865 2072 6564 6465 6e69 6e67 2066 726f  he reddening fro
-0001a0a0: 6d20 7468 6520 6669 742e 0d0a 0d0a 5634  m the fit.....V4
-0001a0b0: 2e33 2e30 3a20 4d43 2c20 4f78 666f 7264  .3.0: MC, Oxford
-0001a0c0: 2c20 3420 4d61 6368 2032 3030 390d 0a2b  , 4 Mach 2009..+
-0001a0d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a0e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
-0001a0f0: 0d0a 2d20 496e 7472 6f64 7563 6564 2052  ..- Introduced R
-0001a100: 4547 554c 206b 6579 776f 7264 2074 6f20  EGUL keyword to 
-0001a110: 7065 7266 6f72 6d20 6c69 6e65 6172 2072  perform linear r
-0001a120: 6567 756c 6172 697a 6174 696f 6e20 6f66  egularization of
-0001a130: 2057 4549 4748 5453 0d0a 2020 696e 206f   WEIGHTS..  in o
-0001a140: 6e65 206f 7220 7477 6f20 6469 6d65 6e73  ne or two dimens
-0001a150: 696f 6e73 2e0d 0a0d 0a56 342e 322e 333a  ions.....V4.2.3:
-0001a160: 204d 432c 204f 7866 6f72 642c 2032 3720   MC, Oxford, 27 
-0001a170: 4e6f 7665 6d62 6572 2032 3030 380d 0a2b  November 2008..+
-0001a180: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a190: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a1a0: 2b2b 2b0d 0a0d 0a2d 2043 6f72 7265 6374  +++....- Correct
-0001a1b0: 6564 2065 7272 6f72 206d 6573 7361 6765  ed error message
-0001a1c0: 2066 6f72 2074 6f6f 2062 6967 2076 656c   for too big vel
-0001a1d0: 6f63 6974 7920 7368 6966 742e 0d0a 0d0a  ocity shift.....
-0001a1e0: 5634 2e32 2e32 3a20 4d43 2c20 5769 6e64  V4.2.2: MC, Wind
-0001a1f0: 686f 656b 2c20 3320 4a75 6c79 2032 3030  hoek, 3 July 200
-0001a200: 380d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  8..+++++++++++++
-0001a210: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a220: 2b2b 2b2b 0d0a 0d0a 2d20 4164 6465 6420  ++++....- Added 
-0001a230: 6b65 7977 6f72 6420 504f 4c59 5745 4947  keyword POLYWEIG
-0001a240: 4854 532e 0d0a 0d0a 5634 2e32 2e31 3a20  HTS.....V4.2.1: 
-0001a250: 4d43 2c20 4f78 666f 7264 2c20 3137 204d  MC, Oxford, 17 M
-0001a260: 6179 2032 3030 380d 0a2b 2b2b 2b2b 2b2b  ay 2008..+++++++
-0001a270: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a280: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 5573  ++++++++....- Us
-0001a290: 6520 4c41 5f4c 4541 5354 5f53 5155 4152  e LA_LEAST_SQUAR
-0001a2a0: 4553 2028 4944 4c20 352e 3629 2069 6e73  ES (IDL 5.6) ins
-0001a2b0: 7465 6164 206f 6620 5356 4443 2077 6865  tead of SVDC whe
-0001a2c0: 6e20 6669 7474 696e 6720 6120 7369 6e67  n fitting a sing
-0001a2d0: 6c65 0d0a 2020 7465 6d70 6c61 7465 2e20  le..  template. 
-0001a2e0: 506c 6561 7365 206c 6574 206d 6520 6b6e  Please let me kn
-0001a2f0: 6f77 2069 6620 796f 7520 6e65 6564 2074  ow if you need t
-0001a300: 6f20 7573 6520 7050 5846 2077 6974 6820  o use pPXF with 
-0001a310: 616e 206f 6c64 6572 2049 444c 0d0a 2020  an older IDL..  
-0001a320: 7665 7273 696f 6e2e 0d0a 0d0a 5634 2e32  version.....V4.2
-0001a330: 2e30 3a20 4d43 2c20 4f78 666f 7264 2c20  .0: MC, Oxford, 
-0001a340: 3135 204d 6172 6368 2032 3030 380d 0a2b  15 March 2008..+
-0001a350: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a360: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a370: 0d0a 0d0a 2d20 496e 7472 6f64 7563 6564  ....- Introduced
-0001a380: 206f 7074 696f 6e61 6c20 6669 7474 696e   optional fittin
-0001a390: 6720 6f66 2053 4b59 2073 7065 6374 7275  g of SKY spectru
-0001a3a0: 6d2e 204d 616e 7920 7468 616e 6b73 2074  m. Many thanks t
-0001a3b0: 6f0d 0a20 2041 6e6e 652d 4d61 7269 6520  o..  Anne-Marie 
-0001a3c0: 5765 696a 6d61 6e73 2066 6f72 2074 6573  Weijmans for tes
-0001a3d0: 7469 6e67 2e0d 0a0d 0a56 342e 312e 373a  ting.....V4.1.7:
-0001a3e0: 204d 432c 204f 7866 6f72 642c 2036 204f   MC, Oxford, 6 O
-0001a3f0: 6374 6f62 6572 2032 3030 370d 0a2b 2b2b  ctober 2007..+++
-0001a400: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a410: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
-0001a420: 0a0d 0a2d 2055 7064 6174 6564 2064 6f63  ...- Updated doc
-0001a430: 756d 656e 7461 7469 6f6e 2077 6974 6820  umentation with 
-0001a440: 616e 2069 6d70 6f72 7461 6e74 206e 6f74  an important not
-0001a450: 6520 6f6e 2070 656e 616c 7479 2064 6574  e on penalty det
-0001a460: 6572 6d69 6e61 7469 6f6e 2e0d 0a0d 0a56  ermination.....V
-0001a470: 342e 312e 363a 204d 432c 204c 6569 6465  4.1.6: MC, Leide
-0001a480: 6e2c 2032 3020 4a61 6e75 6172 7920 3230  n, 20 January 20
-0001a490: 3036 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  06..++++++++++++
-0001a4a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a4b0: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2050 7269  +++++++....- Pri
-0001a4c0: 6e74 2074 6865 206e 756d 6265 7220 6f66  nt the number of
-0001a4d0: 206e 6f6e 7a65 726f 2074 656d 706c 6174   nonzero templat
-0001a4e0: 6573 2e20 446f 206e 6f74 2070 7269 6e74  es. Do not print
-0001a4f0: 206f 7574 6c69 6572 7320 696e 202f 5155   outliers in /QU
-0001a500: 4945 5420 6d6f 6465 2e0d 0a0d 0a56 342e  IET mode.....V4.
-0001a510: 312e 353a 204d 432c 204c 6569 6465 6e2c  1.5: MC, Leiden,
-0001a520: 2031 3020 4665 6272 7561 7279 2032 3030   10 February 200
-0001a530: 350d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  5..+++++++++++++
-0001a540: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a550: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2056 6572  +++++++....- Ver
-0001a560: 6966 7920 7468 6174 2047 4f4f 4450 4958  ify that GOODPIX
-0001a570: 454c 5320 6973 206d 6f6e 6f74 6f6e 6963  ELS is monotonic
-0001a580: 2061 6e64 2064 6f65 7320 6e6f 7420 636f   and does not co
-0001a590: 6e74 6169 6e20 6475 706c 6963 6174 6564  ntain duplicated
-0001a5a0: 0d0a 2020 7661 6c75 6573 2e20 4166 7465  ..  values. Afte
-0001a5b0: 7220 6665 6564 6261 636b 2066 726f 6d20  r feedback from 
-0001a5c0: 5269 6368 6172 6420 4d63 4465 726d 6964  Richard McDermid
-0001a5d0: 2e0d 0a0d 0a56 342e 312e 343a 204d 432c  .....V4.1.4: MC,
-0001a5e0: 204c 6569 6465 6e2c 2031 3220 4a61 6e75   Leiden, 12 Janu
-0001a5f0: 6172 7920 3230 3035 0d0a 2b2b 2b2b 2b2b  ary 2005..++++++
-0001a600: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a610: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-0001a620: 0a2d 204d 616b 6520 7375 7265 2069 6e70  .- Make sure inp
-0001a630: 7574 204e 4f49 5345 2069 7320 6120 706f  ut NOISE is a po
-0001a640: 7369 7469 7665 2076 6563 746f 722e 0d0a  sitive vector...
-0001a650: 0d0a 5634 2e31 2e33 3a20 4d43 2c20 5669  ..V4.1.3: MC, Vi
-0001a660: 6365 6e7a 612c 2033 3020 4465 6365 6d62  cenza, 30 Decemb
-0001a670: 6572 2032 3030 340d 0a2b 2b2b 2b2b 2b2b  er 2004..+++++++
-0001a680: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a690: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
-0001a6a0: 0d0a 2d20 5570 6461 7465 6420 646f 6375  ..- Updated docu
-0001a6b0: 6d65 6e74 6174 696f 6e2e 0d0a 0d0a 5634  mentation.....V4
-0001a6c0: 2e31 2e32 3a20 4d43 2c20 4c65 6964 656e  .1.2: MC, Leiden
-0001a6d0: 2c20 3131 204e 6f76 656d 6265 7220 3230  , 11 November 20
-0001a6e0: 3034 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  04..++++++++++++
-0001a6f0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a700: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 4861  ++++++++....- Ha
-0001a710: 6e64 6c65 2073 7065 6369 616c 2063 6173  ndle special cas
-0001a720: 6520 7768 6572 6520 6120 7369 6e67 6c65  e where a single
-0001a730: 2074 656d 706c 6174 6520 7769 7468 6f75   template withou
-0001a740: 7420 6164 6469 7469 7665 0d0a 2020 706f  t additive..  po
-0001a750: 6c79 6e6f 6d69 616c 7320 6973 2066 6974  lynomials is fit
-0001a760: 7465 6420 746f 2074 6865 2067 616c 6178  ted to the galax
-0001a770: 792e 0d0a 0d0a 5634 2e31 2e31 3a20 4d43  y.....V4.1.1: MC
-0001a780: 2c20 4c65 6964 656e 2c20 3231 2053 6570  , Leiden, 21 Sep
-0001a790: 7465 6d62 6572 2032 3030 340d 0a2b 2b2b  tember 2004..+++
+00019e10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+00019e20: 2d20 5573 6573 2043 4150 5f52 414e 4745  - Uses CAP_RANGE
+00019e30: 2074 6f20 6176 6f69 6420 706f 7465 6e74   to avoid potent
+00019e40: 6961 6c20 6e61 6d69 6e67 2063 6f6e 666c  ial naming confl
+00019e50: 6963 7473 2e0d 0a0d 0a56 342e 362e 353a  icts.....V4.6.5:
+00019e60: 204d 432c 204f 7866 6f72 642c 2031 3520   MC, Oxford, 15 
+00019e70: 4e6f 7665 6d62 6572 2032 3031 320d 0a2b  November 2012..+
+00019e80: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019e90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019ea0: 2b2b 2b0d 0a0d 0a2d 2045 7870 616e 6465  +++....- Expande
+00019eb0: 6420 646f 6375 6d65 6e74 6174 696f 6e20  d documentation 
+00019ec0: 6f66 2052 4547 554c 206b 6579 776f 7264  of REGUL keyword
+00019ed0: 2e0d 0a0d 0a56 342e 362e 343a 204d 432c  .....V4.6.4: MC,
+00019ee0: 204f 7866 6f72 642c 2039 2044 6563 656d   Oxford, 9 Decem
+00019ef0: 6265 7220 3230 3131 0d0a 2b2b 2b2b 2b2b  ber 2011..++++++
+00019f00: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+00019f10: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+00019f20: 0a2d 2049 6e63 7265 6173 6564 206f 7665  .- Increased ove
+00019f30: 7273 616d 706c 696e 6720 6661 6374 6f72  rsampling factor
+00019f40: 2074 6f20 3330 782c 2077 6865 6e20 7468   to 30x, when th
+00019f50: 6520 2f4f 5645 5253 414d 504c 4520 6b65  e /OVERSAMPLE ke
+00019f60: 7977 6f72 640d 0a20 2069 7320 7573 6564  yword..  is used
+00019f70: 2e20 5570 6461 7465 6420 636f 7272 6573  . Updated corres
+00019f80: 706f 6e64 696e 6720 646f 6375 6d65 6e74  ponding document
+00019f90: 6174 696f 6e2e 2054 6861 6e6b 7320 746f  ation. Thanks to
+00019fa0: 204e 6f72 610d 0a20 204c 7522 747a 6765   Nora..  Lu"tzge
+00019fb0: 6e64 6f72 6620 666f 7220 7465 7374 2063  ndorf for test c
+00019fc0: 6173 6573 2069 6c6c 7573 7472 6174 696e  ases illustratin
+00019fd0: 6720 6572 726f 7273 2069 6e20 7468 6520  g errors in the 
+00019fe0: 7265 636f 7665 7265 640d 0a20 2076 656c  recovered..  vel
+00019ff0: 6f63 6974 7920 7768 656e 2074 6865 2073  ocity when the s
+0001a000: 6967 6d61 2069 7320 7365 7665 7265 6c79  igma is severely
+0001a010: 2075 6e64 6572 7361 6d70 6c65 642e 0d0a   undersampled...
+0001a020: 0d0a 5634 2e36 2e33 3a20 4d43 2c20 4f78  ..V4.6.3: MC, Ox
+0001a030: 666f 7264 2032 3520 4f63 746f 6265 7220  ford 25 October 
+0001a040: 3230 3131 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2011..++++++++++
+0001a050: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a060: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 446f  ++++++++....- Do
+0001a070: 206e 6f74 2063 6861 6e67 6520 5445 4d50   not change TEMP
+0001a080: 4c41 5445 5320 6172 7261 7920 696e 206f  LATES array in o
+0001a090: 7574 7075 7420 7768 656e 2052 4547 554c  utput when REGUL
+0001a0a0: 2069 7320 6e6f 6e7a 6572 6f2e 0d0a 2020   is nonzero...  
+0001a0b0: 4672 6f6d 2074 6865 2066 6565 6462 6163  From the feedbac
+0001a0c0: 6b20 6f66 2052 6963 6861 7264 204d 6344  k of Richard McD
+0001a0d0: 6572 6d69 642e 0d0a 0d0a 5634 2e36 2e32  ermid.....V4.6.2
+0001a0e0: 3a20 4d43 2c20 4f78 666f 7264 2c20 3137  : MC, Oxford, 17
+0001a0f0: 204f 6374 6f62 6572 2032 3031 310d 0a2b   October 2011..+
+0001a100: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a110: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a120: 2b2b 0d0a 0d0a 2d20 496e 636c 7564 6564  ++....- Included
+0001a130: 206f 7074 696f 6e20 666f 7220 3344 2072   option for 3D r
+0001a140: 6567 756c 6172 697a 6174 696f 6e20 616e  egularization an
+0001a150: 6420 7570 6461 7465 6420 646f 6375 6d65  d updated docume
+0001a160: 6e74 6174 696f 6e20 6f66 0d0a 2020 5245  ntation of..  RE
+0001a170: 4755 4c20 6b65 7977 6f72 642e 0d0a 0d0a  GUL keyword.....
+0001a180: 5634 2e36 2e31 3a20 4d43 2c20 4f78 666f  V4.6.1: MC, Oxfo
+0001a190: 7264 2c20 3239 204a 756c 7920 3230 3131  rd, 29 July 2011
+0001a1a0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+0001a1b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a1c0: 2b2b 0d0a 0d0a 2d20 5573 6520 436f 796f  ++....- Use Coyo
+0001a1d0: 7465 2047 7261 7068 6963 7320 2868 7474  te Graphics (htt
+0001a1e0: 703a 2f2f 7777 772e 6964 6c63 6f79 6f74  p://www.idlcoyot
+0001a1f0: 652e 636f 6d2f 2920 6279 2044 6176 6964  e.com/) by David
+0001a200: 2057 2e20 4661 6e6e 696e 672e 0d0a 2020   W. Fanning...  
+0001a210: 5468 6520 7265 7175 6972 6564 2072 6f75  The required rou
+0001a220: 7469 6e65 7320 6172 6520 6e6f 7720 696e  tines are now in
+0001a230: 636c 7564 6564 2069 6e20 4e41 5341 2049  cluded in NASA I
+0001a240: 444c 2041 7374 726f 6e6f 6d79 204c 6962  DL Astronomy Lib
+0001a250: 7261 7279 2e0d 0a0d 0a56 342e 362e 303a  rary.....V4.6.0:
+0001a260: 204d 432c 204f 7866 6f72 642c 2031 3220   MC, Oxford, 12 
+0001a270: 4170 7269 6c20 3230 3131 0d0a 2b2b 2b2b  April 2011..++++
+0001a280: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a290: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+0001a2a0: 0a2d 2049 6d70 6f72 7461 6e74 2066 6978  .- Important fix
+0001a2b0: 2074 6f20 2f43 4c45 414e 2070 726f 6365   to /CLEAN proce
+0001a2c0: 6475 7265 3a20 6261 6420 7069 7865 6c73  dure: bad pixels
+0001a2d0: 2061 7265 206e 6f77 2070 726f 7065 726c   are now properl
+0001a2e0: 790d 0a20 2075 7064 6174 6564 2064 7572  y..  updated dur
+0001a2f0: 696e 6720 7468 6520 3373 6967 6d61 2069  ing the 3sigma i
+0001a300: 7465 7261 7469 6f6e 732e 0d0a 0d0a 5634  terations.....V4
+0001a310: 2e35 2e30 3a20 4d43 2c20 4f78 666f 7264  .5.0: MC, Oxford
+0001a320: 2c20 3133 2041 7072 696c 2032 3031 300d  , 13 April 2010.
+0001a330: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
+0001a340: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a350: 2b2b 0d0a 0d0a 2d20 4472 616d 6174 6963  ++....- Dramatic
+0001a360: 2073 7065 6564 2075 7020 696e 2074 6865   speed up in the
+0001a370: 2063 6f6e 766f 6c75 7469 6f6e 206f 6620   convolution of 
+0001a380: 6c6f 6e67 2073 7065 6374 7261 2e0d 0a0d  long spectra....
+0001a390: 0a56 342e 342e 303a 204d 432c 204f 7866  .V4.4.0: MC, Oxf
+0001a3a0: 6f72 642c 2031 3820 5365 7074 656d 6265  ord, 18 Septembe
+0001a3b0: 7220 3230 3039 0d0a 2b2b 2b2b 2b2b 2b2b  r 2009..++++++++
+0001a3c0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a3d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+0001a3e0: 0a2d 2049 6e74 726f 6475 6365 6420 4361  .- Introduced Ca
+0001a3f0: 6c7a 6574 7469 2065 7420 616c 2e20 2832  lzetti et al. (2
+0001a400: 3030 3029 2070 7078 665f 5245 4444 454e  000) ppxf_REDDEN
+0001a410: 494e 475f 4355 5256 4520 6675 6e63 7469  ING_CURVE functi
+0001a420: 6f6e 2074 6f0d 0a20 2065 7374 696d 6174  on to..  estimat
+0001a430: 6520 7468 6520 7265 6464 656e 696e 6720  e the reddening 
+0001a440: 6672 6f6d 2074 6865 2066 6974 2e0d 0a0d  from the fit....
+0001a450: 0a56 342e 332e 303a 204d 432c 204f 7866  .V4.3.0: MC, Oxf
+0001a460: 6f72 642c 2034 204d 6163 6820 3230 3039  ord, 4 Mach 2009
+0001a470: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+0001a480: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a490: 2b0d 0a0d 0a2d 2049 6e74 726f 6475 6365  +....- Introduce
+0001a4a0: 6420 5245 4755 4c20 6b65 7977 6f72 6420  d REGUL keyword 
+0001a4b0: 746f 2070 6572 666f 726d 206c 696e 6561  to perform linea
+0001a4c0: 7220 7265 6775 6c61 7269 7a61 7469 6f6e  r regularization
+0001a4d0: 206f 6620 5745 4947 4854 530d 0a20 2069   of WEIGHTS..  i
+0001a4e0: 6e20 6f6e 6520 6f72 2074 776f 2064 696d  n one or two dim
+0001a4f0: 656e 7369 6f6e 732e 0d0a 0d0a 5634 2e32  ensions.....V4.2
+0001a500: 2e33 3a20 4d43 2c20 4f78 666f 7264 2c20  .3: MC, Oxford, 
+0001a510: 3237 204e 6f76 656d 6265 7220 3230 3038  27 November 2008
+0001a520: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+0001a530: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a540: 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 436f 7272  ++++++....- Corr
+0001a550: 6563 7465 6420 6572 726f 7220 6d65 7373  ected error mess
+0001a560: 6167 6520 666f 7220 746f 6f20 6269 6720  age for too big 
+0001a570: 7665 6c6f 6369 7479 2073 6869 6674 2e0d  velocity shift..
+0001a580: 0a0d 0a56 342e 322e 323a 204d 432c 2057  ...V4.2.2: MC, W
+0001a590: 696e 6468 6f65 6b2c 2033 204a 756c 7920  indhoek, 3 July 
+0001a5a0: 3230 3038 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2008..++++++++++
+0001a5b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a5c0: 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2041 6464  +++++++....- Add
+0001a5d0: 6564 206b 6579 776f 7264 2050 4f4c 5957  ed keyword POLYW
+0001a5e0: 4549 4748 5453 2e0d 0a0d 0a56 342e 322e  EIGHTS.....V4.2.
+0001a5f0: 313a 204d 432c 204f 7866 6f72 642c 2031  1: MC, Oxford, 1
+0001a600: 3720 4d61 7920 3230 3038 0d0a 2b2b 2b2b  7 May 2008..++++
+0001a610: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a620: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+0001a630: 2055 7365 204c 415f 4c45 4153 545f 5351   Use LA_LEAST_SQ
+0001a640: 5541 5245 5320 2849 444c 2035 2e36 2920  UARES (IDL 5.6) 
+0001a650: 696e 7374 6561 6420 6f66 2053 5644 4320  instead of SVDC 
+0001a660: 7768 656e 2066 6974 7469 6e67 2061 2073  when fitting a s
+0001a670: 696e 676c 650d 0a20 2074 656d 706c 6174  ingle..  templat
+0001a680: 652e 2050 6c65 6173 6520 6c65 7420 6d65  e. Please let me
+0001a690: 206b 6e6f 7720 6966 2079 6f75 206e 6565   know if you nee
+0001a6a0: 6420 746f 2075 7365 2070 5058 4620 7769  d to use pPXF wi
+0001a6b0: 7468 2061 6e20 6f6c 6465 7220 4944 4c0d  th an older IDL.
+0001a6c0: 0a20 2076 6572 7369 6f6e 2e0d 0a0d 0a56  .  version.....V
+0001a6d0: 342e 322e 303a 204d 432c 204f 7866 6f72  4.2.0: MC, Oxfor
+0001a6e0: 642c 2031 3520 4d61 7263 6820 3230 3038  d, 15 March 2008
+0001a6f0: 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ..++++++++++++++
+0001a700: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a710: 2b2b 2b0d 0a0d 0a2d 2049 6e74 726f 6475  +++....- Introdu
+0001a720: 6365 6420 6f70 7469 6f6e 616c 2066 6974  ced optional fit
+0001a730: 7469 6e67 206f 6620 534b 5920 7370 6563  ting of SKY spec
+0001a740: 7472 756d 2e20 4d61 6e79 2074 6861 6e6b  trum. Many thank
+0001a750: 7320 746f 0d0a 2020 416e 6e65 2d4d 6172  s to..  Anne-Mar
+0001a760: 6965 2057 6569 6a6d 616e 7320 666f 7220  ie Weijmans for 
+0001a770: 7465 7374 696e 672e 0d0a 0d0a 5634 2e31  testing.....V4.1
+0001a780: 2e37 3a20 4d43 2c20 4f78 666f 7264 2c20  .7: MC, Oxford, 
+0001a790: 3620 4f63 746f 6265 7220 3230 3037 0d0a  6 October 2007..
 0001a7a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
 0001a7b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a7c0: 2b2b 0d0a 0d0a 2d20 496e 6372 6561 7365  ++....- Increase
-0001a7d0: 6420 6d61 7869 6d75 6d20 6e75 6d62 6572  d maximum number
-0001a7e0: 206f 6620 6974 6572 6174 696f 6e73 2049   of iterations I
-0001a7f0: 544d 4158 2069 6e20 4256 4c53 2e20 5468  TMAX in BVLS. Th
-0001a800: 616e 6b73 2074 6f0d 0a20 204a 6573 7573  anks to..  Jesus
-0001a810: 2046 616c 636f 6e2d 4261 7272 6f73 6f20   Falcon-Barroso 
-0001a820: 666f 7220 7265 706f 7274 696e 6720 7072  for reporting pr
-0001a830: 6f62 6c65 6d73 2e0d 0a2d 2049 6e74 726f  oblems...- Intro
-0001a840: 6475 6365 6420 6572 726f 7220 6d65 7373  duced error mess
-0001a850: 6167 6520 7768 656e 2076 656c 6f63 6974  age when velocit
-0001a860: 7920 7368 6966 7420 6973 2074 6f6f 2062  y shift is too b
-0001a870: 6967 2e0d 0a2d 2043 6f72 7265 6374 6564  ig...- Corrected
-0001a880: 206f 7574 7075 7420 7768 656e 204d 4f4d   output when MOM
-0001a890: 454e 5453 3d30 2e0d 0a0d 0a56 342e 312e  ENTS=0.....V4.1.
-0001a8a0: 303a 204d 432c 204c 6569 6465 6e2c 2033  0: MC, Leiden, 3
-0001a8b0: 2053 6570 7465 6d62 6572 2032 3030 340d   September 2004.
-0001a8c0: 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  .+++++++++++++++
-0001a8d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a8e0: 2b2b 2b2b 2b0d 0a0d 0a2d 2043 6f72 7265  +++++....- Corre
-0001a8f0: 6374 6564 2069 6d70 6c65 6d65 6e74 6174  cted implementat
-0001a900: 696f 6e20 6f66 2074 776f 2d73 6964 6564  ion of two-sided
-0001a910: 2066 6974 7469 6e67 206f 6620 7468 6520   fitting of the 
-0001a920: 4c4f 5356 442e 2054 6861 6e6b 730d 0a20  LOSVD. Thanks.. 
-0001a930: 2074 6f20 5374 6566 616e 2076 616e 2044   to Stefan van D
-0001a940: 6f6e 6765 6e20 666f 7220 7265 706f 7274  ongen for report
-0001a950: 696e 6720 7072 6f62 6c65 6d73 2e0d 0a0d  ing problems....
-0001a960: 0a56 342e 302e 303a 204d 432c 2056 6963  .V4.0.0: MC, Vic
-0001a970: 656e 7a61 2c20 3136 2041 7567 7573 7420  enza, 16 August 
-0001a980: 3230 3034 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2004..++++++++++
-0001a990: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001a9a0: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2049  +++++++++....- I
-0001a9b0: 6e74 726f 6475 6365 6420 6f70 7469 6f6e  ntroduced option
-0001a9c0: 616c 2074 776f 2d73 6964 6564 2066 6974  al two-sided fit
-0001a9d0: 7469 6e67 2061 7373 756d 696e 6720 6120  ting assuming a 
-0001a9e0: 7265 666c 6563 7469 6f6e 0d0a 2020 7379  reflection..  sy
-0001a9f0: 6d6d 6574 7269 6320 4c4f 5356 4420 666f  mmetric LOSVD fo
-0001aa00: 7220 7477 6f20 696e 7075 7420 7370 6563  r two input spec
-0001aa10: 7472 612e 0d0a 0d0a 5633 2e37 2e33 3a20  tra.....V3.7.3: 
-0001aa20: 4d43 2c20 4c65 6964 656e 2c20 3720 4175  MC, Leiden, 7 Au
-0001aa30: 6775 7374 2032 3030 340d 0a2b 2b2b 2b2b  gust 2004..+++++
-0001aa40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001aa50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
-0001aa60: 2d20 436f 7272 6563 7465 6420 6275 673a  - Corrected bug:
-0001aa70: 206b 6579 776f 7264 2045 5252 4f52 2077   keyword ERROR w
-0001aa80: 6173 2072 6574 7572 6e65 6420 696e 2070  as returned in p
-0001aa90: 6978 656c 7320 696e 7374 6561 6420 6f66  ixels instead of
-0001aaa0: 206b 6d2f 732e 0d0a 2d20 4465 6372 6561   km/s...- Decrea
-0001aab0: 7365 6420 6c6f 7765 7220 6c69 6d69 7420  sed lower limit 
-0001aac0: 6f6e 2066 6974 7465 6420 6469 7370 6572  on fitted disper
-0001aad0: 7369 6f6e 2e20 5468 616e 6b73 2074 6f20  sion. Thanks to 
-0001aae0: 4967 6f72 2056 2e20 4368 696c 696e 6761  Igor V. Chilinga
-0001aaf0: 7269 616e 2e0d 0a0d 0a56 332e 372e 323a  rian.....V3.7.2:
-0001ab00: 204d 432c 204c 6569 6465 6e2c 2032 3820   MC, Leiden, 28 
-0001ab10: 4170 7269 6c20 3230 3034 0d0a 2b2b 2b2b  April 2004..++++
-0001ab20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001ab30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-0001ab40: 0a2d 2043 6f72 7265 6374 6564 2070 726f  .- Corrected pro
-0001ab50: 6772 616d 2073 746f 7020 6166 7465 7220  gram stop after 
-0001ab60: 6669 7420 7768 656e 204d 4f4d 454e 5453  fit when MOMENTS
-0001ab70: 3d32 2e20 5468 6520 6275 6720 7761 7320  =2. The bug was 
-0001ab80: 696e 7472 6f64 7563 6564 2069 6e20 5633  introduced in V3
-0001ab90: 2e37 2e30 2e0d 0a0d 0a56 332e 372e 313a  .7.0.....V3.7.1:
-0001aba0: 204d 432c 204c 6569 6465 6e2c 2033 3120   MC, Leiden, 31 
-0001abb0: 4d61 7263 6820 3230 3034 0d0a 2b2b 2b2b  March 2004..++++
-0001abc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001abd0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
-0001abe0: 0a2d 2055 7064 6174 6564 2064 6f63 756d  .- Updated docum
-0001abf0: 656e 7461 7469 6f6e 2e0d 0a0d 0a56 332e  entation.....V3.
-0001ac00: 372e 303a 204d 432c 204c 6569 6465 6e2c  7.0: MC, Leiden,
-0001ac10: 2032 3320 4d61 7263 6820 3230 3034 0d0a   23 March 2004..
-0001ac20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001ac30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001ac40: 2b0d 0a0d 0a2d 2052 6576 6973 6564 2069  +....- Revised i
-0001ac50: 6d70 6c65 6d65 6e74 6174 696f 6e20 6f66  mplementation of
-0001ac60: 204d 4445 4752 4545 206f 7074 696f 6e2e   MDEGREE option.
-0001ac70: 204e 6f6e 6c69 6e65 6172 2069 6d70 6c65   Nonlinear imple
-0001ac80: 6d65 6e74 6174 696f 6e3a 0d0a 2020 7374  mentation:..  st
-0001ac90: 7261 6967 6874 666f 7277 6172 642c 2072  raightforward, r
-0001aca0: 6f62 7573 742c 2062 7574 2073 6c6f 7765  obust, but slowe
-0001acb0: 722e 0d0a 0d0a 5633 2e36 2e30 3a20 4d43  r.....V3.6.0: MC
-0001acc0: 2c20 4c65 6964 656e 2c20 3139 204d 6172  , Leiden, 19 Mar
-0001acd0: 6368 2032 3030 340d 0a2b 2b2b 2b2b 2b2b  ch 2004..+++++++
-0001ace0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001acf0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-0001ad00: 4164 6465 6420 4d44 4547 5245 4520 6f70  Added MDEGREE op
-0001ad10: 7469 6f6e 2066 6f72 206d 756c 7469 706c  tion for multipl
-0001ad20: 6963 6174 6976 6520 706f 6c79 6e6f 6d69  icative polynomi
-0001ad30: 616c 732e 204c 696e 6561 7220 696d 706c  als. Linear impl
-0001ad40: 656d 656e 7461 7469 6f6e 3a0d 0a20 2066  ementation:..  f
-0001ad50: 6173 742c 2077 6f72 6b73 2077 656c 6c20  ast, works well 
-0001ad60: 696e 206d 6f73 7420 6361 7365 732c 2062  in most cases, b
-0001ad70: 7574 2063 616e 2066 6169 6c20 696e 2063  ut can fail in c
-0001ad80: 6572 7461 696e 2063 6173 6573 2e0d 0a0d  ertain cases....
-0001ad90: 0a56 332e 352e 303a 204d 432c 204c 6569  .V3.5.0: MC, Lei
-0001ada0: 6465 6e2c 2031 3120 4465 6365 6d62 6572  den, 11 December
-0001adb0: 2032 3030 330d 0a2b 2b2b 2b2b 2b2b 2b2b   2003..+++++++++
-0001adc0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001add0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
-0001ade0: 2049 6e63 6c75 6465 6420 2f4f 5645 5253   Included /OVERS
-0001adf0: 414d 504c 4520 6f70 7469 6f6e 2e0d 0a0d  AMPLE option....
-0001ae00: 0a56 332e 342e 373a 204d 432c 204c 6569  .V3.4.7: MC, Lei
-0001ae10: 6465 6e2c 2038 2044 6563 656d 6265 7220  den, 8 December 
-0001ae20: 3230 3033 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2003..++++++++++
-0001ae30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001ae40: 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d 2046  +++++++++....- F
-0001ae50: 6972 7374 2072 656c 6561 7365 6420 7665  irst released ve
-0001ae60: 7273 696f 6e2e 0d0a 0d0a 5631 2e30 2e30  rsion.....V1.0.0
-0001ae70: 3a20 4c65 6964 656e 2c20 3130 204f 6374  : Leiden, 10 Oct
-0001ae80: 6f62 6572 2032 3030 310d 0a2b 2b2b 2b2b  ober 2001..+++++
-0001ae90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
-0001aea0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
-0001aeb0: 4372 6561 7465 6420 6279 204d 6963 6865  Created by Miche
-0001aec0: 6c65 2043 6170 7065 6c6c 6172 692e 0d0a  le Cappellari...
-0001aed0: 0d0a                                     ..
+0001a7c0: 2b2b 0d0a 0d0a 2d20 5570 6461 7465 6420  ++....- Updated 
+0001a7d0: 646f 6375 6d65 6e74 6174 696f 6e20 7769  documentation wi
+0001a7e0: 7468 2061 6e20 696d 706f 7274 616e 7420  th an important 
+0001a7f0: 6e6f 7465 206f 6e20 7065 6e61 6c74 7920  note on penalty 
+0001a800: 6465 7465 726d 696e 6174 696f 6e2e 0d0a  determination...
+0001a810: 0d0a 5634 2e31 2e36 3a20 4d43 2c20 4c65  ..V4.1.6: MC, Le
+0001a820: 6964 656e 2c20 3230 204a 616e 7561 7279  iden, 20 January
+0001a830: 2032 3030 360d 0a2b 2b2b 2b2b 2b2b 2b2b   2006..+++++++++
+0001a840: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a850: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
+0001a860: 5072 696e 7420 7468 6520 6e75 6d62 6572  Print the number
+0001a870: 206f 6620 6e6f 6e7a 6572 6f20 7465 6d70   of nonzero temp
+0001a880: 6c61 7465 732e 2044 6f20 6e6f 7420 7072  lates. Do not pr
+0001a890: 696e 7420 6f75 746c 6965 7273 2069 6e20  int outliers in 
+0001a8a0: 2f51 5549 4554 206d 6f64 652e 0d0a 0d0a  /QUIET mode.....
+0001a8b0: 5634 2e31 2e35 3a20 4d43 2c20 4c65 6964  V4.1.5: MC, Leid
+0001a8c0: 656e 2c20 3130 2046 6562 7275 6172 7920  en, 10 February 
+0001a8d0: 3230 3035 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b  2005..++++++++++
+0001a8e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a8f0: 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20  ++++++++++....- 
+0001a900: 5665 7269 6679 2074 6861 7420 474f 4f44  Verify that GOOD
+0001a910: 5049 5845 4c53 2069 7320 6d6f 6e6f 746f  PIXELS is monoto
+0001a920: 6e69 6320 616e 6420 646f 6573 206e 6f74  nic and does not
+0001a930: 2063 6f6e 7461 696e 2064 7570 6c69 6361   contain duplica
+0001a940: 7465 640d 0a20 2076 616c 7565 732e 2041  ted..  values. A
+0001a950: 6674 6572 2066 6565 6462 6163 6b20 6672  fter feedback fr
+0001a960: 6f6d 2052 6963 6861 7264 204d 6344 6572  om Richard McDer
+0001a970: 6d69 642e 0d0a 0d0a 5634 2e31 2e34 3a20  mid.....V4.1.4: 
+0001a980: 4d43 2c20 4c65 6964 656e 2c20 3132 204a  MC, Leiden, 12 J
+0001a990: 616e 7561 7279 2032 3030 350d 0a2b 2b2b  anuary 2005..+++
+0001a9a0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a9b0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001a9c0: 0d0a 0d0a 2d20 4d61 6b65 2073 7572 6520  ....- Make sure 
+0001a9d0: 696e 7075 7420 4e4f 4953 4520 6973 2061  input NOISE is a
+0001a9e0: 2070 6f73 6974 6976 6520 7665 6374 6f72   positive vector
+0001a9f0: 2e0d 0a0d 0a56 342e 312e 333a 204d 432c  .....V4.1.3: MC,
+0001aa00: 2056 6963 656e 7a61 2c20 3330 2044 6563   Vicenza, 30 Dec
+0001aa10: 656d 6265 7220 3230 3034 0d0a 2b2b 2b2b  ember 2004..++++
+0001aa20: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001aa30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001aa40: 2b0d 0a0d 0a2d 2055 7064 6174 6564 2064  +....- Updated d
+0001aa50: 6f63 756d 656e 7461 7469 6f6e 2e0d 0a0d  ocumentation....
+0001aa60: 0a56 342e 312e 323a 204d 432c 204c 6569  .V4.1.2: MC, Lei
+0001aa70: 6465 6e2c 2031 3120 4e6f 7665 6d62 6572  den, 11 November
+0001aa80: 2032 3030 340d 0a2b 2b2b 2b2b 2b2b 2b2b   2004..+++++++++
+0001aa90: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001aaa0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d 0a2d  +++++++++++....-
+0001aab0: 2048 616e 646c 6520 7370 6563 6961 6c20   Handle special 
+0001aac0: 6361 7365 2077 6865 7265 2061 2073 696e  case where a sin
+0001aad0: 676c 6520 7465 6d70 6c61 7465 2077 6974  gle template wit
+0001aae0: 686f 7574 2061 6464 6974 6976 650d 0a20  hout additive.. 
+0001aaf0: 2070 6f6c 796e 6f6d 6961 6c73 2069 7320   polynomials is 
+0001ab00: 6669 7474 6564 2074 6f20 7468 6520 6761  fitted to the ga
+0001ab10: 6c61 7879 2e0d 0a0d 0a56 342e 312e 313a  laxy.....V4.1.1:
+0001ab20: 204d 432c 204c 6569 6465 6e2c 2032 3120   MC, Leiden, 21 
+0001ab30: 5365 7074 656d 6265 7220 3230 3034 0d0a  September 2004..
+0001ab40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001ab50: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001ab60: 2b2b 2b2b 2b0d 0a0d 0a2d 2049 6e63 7265  +++++....- Incre
+0001ab70: 6173 6564 206d 6178 696d 756d 206e 756d  ased maximum num
+0001ab80: 6265 7220 6f66 2069 7465 7261 7469 6f6e  ber of iteration
+0001ab90: 7320 4954 4d41 5820 696e 2042 564c 532e  s ITMAX in BVLS.
+0001aba0: 2054 6861 6e6b 7320 746f 0d0a 2020 4a65   Thanks to..  Je
+0001abb0: 7375 7320 4661 6c63 6f6e 2d42 6172 726f  sus Falcon-Barro
+0001abc0: 736f 2066 6f72 2072 6570 6f72 7469 6e67  so for reporting
+0001abd0: 2070 726f 626c 656d 732e 0d0a 2d20 496e   problems...- In
+0001abe0: 7472 6f64 7563 6564 2065 7272 6f72 206d  troduced error m
+0001abf0: 6573 7361 6765 2077 6865 6e20 7665 6c6f  essage when velo
+0001ac00: 6369 7479 2073 6869 6674 2069 7320 746f  city shift is to
+0001ac10: 6f20 6269 672e 0d0a 2d20 436f 7272 6563  o big...- Correc
+0001ac20: 7465 6420 6f75 7470 7574 2077 6865 6e20  ted output when 
+0001ac30: 4d4f 4d45 4e54 533d 302e 0d0a 0d0a 5634  MOMENTS=0.....V4
+0001ac40: 2e31 2e30 3a20 4d43 2c20 4c65 6964 656e  .1.0: MC, Leiden
+0001ac50: 2c20 3320 5365 7074 656d 6265 7220 3230  , 3 September 20
+0001ac60: 3034 0d0a 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  04..++++++++++++
+0001ac70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001ac80: 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a 2d20 436f  ++++++++....- Co
+0001ac90: 7272 6563 7465 6420 696d 706c 656d 656e  rrected implemen
+0001aca0: 7461 7469 6f6e 206f 6620 7477 6f2d 7369  tation of two-si
+0001acb0: 6465 6420 6669 7474 696e 6720 6f66 2074  ded fitting of t
+0001acc0: 6865 204c 4f53 5644 2e20 5468 616e 6b73  he LOSVD. Thanks
+0001acd0: 0d0a 2020 746f 2053 7465 6661 6e20 7661  ..  to Stefan va
+0001ace0: 6e20 446f 6e67 656e 2066 6f72 2072 6570  n Dongen for rep
+0001acf0: 6f72 7469 6e67 2070 726f 626c 656d 732e  orting problems.
+0001ad00: 0d0a 0d0a 5634 2e30 2e30 3a20 4d43 2c20  ....V4.0.0: MC, 
+0001ad10: 5669 6365 6e7a 612c 2031 3620 4175 6775  Vicenza, 16 Augu
+0001ad20: 7374 2032 3030 340d 0a2b 2b2b 2b2b 2b2b  st 2004..+++++++
+0001ad30: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001ad40: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+0001ad50: 2d20 496e 7472 6f64 7563 6564 206f 7074  - Introduced opt
+0001ad60: 696f 6e61 6c20 7477 6f2d 7369 6465 6420  ional two-sided 
+0001ad70: 6669 7474 696e 6720 6173 7375 6d69 6e67  fitting assuming
+0001ad80: 2061 2072 6566 6c65 6374 696f 6e0d 0a20   a reflection.. 
+0001ad90: 2073 796d 6d65 7472 6963 204c 4f53 5644   symmetric LOSVD
+0001ada0: 2066 6f72 2074 776f 2069 6e70 7574 2073   for two input s
+0001adb0: 7065 6374 7261 2e0d 0a0d 0a56 332e 372e  pectra.....V3.7.
+0001adc0: 333a 204d 432c 204c 6569 6465 6e2c 2037  3: MC, Leiden, 7
+0001add0: 2041 7567 7573 7420 3230 3034 0d0a 2b2b   August 2004..++
+0001ade0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001adf0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d  +++++++++++++++.
+0001ae00: 0a0d 0a2d 2043 6f72 7265 6374 6564 2062  ...- Corrected b
+0001ae10: 7567 3a20 6b65 7977 6f72 6420 4552 524f  ug: keyword ERRO
+0001ae20: 5220 7761 7320 7265 7475 726e 6564 2069  R was returned i
+0001ae30: 6e20 7069 7865 6c73 2069 6e73 7465 6164  n pixels instead
+0001ae40: 206f 6620 6b6d 2f73 2e0d 0a2d 2044 6563   of km/s...- Dec
+0001ae50: 7265 6173 6564 206c 6f77 6572 206c 696d  reased lower lim
+0001ae60: 6974 206f 6e20 6669 7474 6564 2064 6973  it on fitted dis
+0001ae70: 7065 7273 696f 6e2e 2054 6861 6e6b 7320  persion. Thanks 
+0001ae80: 746f 2049 676f 7220 562e 2043 6869 6c69  to Igor V. Chili
+0001ae90: 6e67 6172 6961 6e2e 0d0a 0d0a 5633 2e37  ngarian.....V3.7
+0001aea0: 2e32 3a20 4d43 2c20 4c65 6964 656e 2c20  .2: MC, Leiden, 
+0001aeb0: 3238 2041 7072 696c 2032 3030 340d 0a2b  28 April 2004..+
+0001aec0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001aed0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001aee0: 0d0a 0d0a 2d20 436f 7272 6563 7465 6420  ....- Corrected 
+0001aef0: 7072 6f67 7261 6d20 7374 6f70 2061 6674  program stop aft
+0001af00: 6572 2066 6974 2077 6865 6e20 4d4f 4d45  er fit when MOME
+0001af10: 4e54 533d 322e 2054 6865 2062 7567 2077  NTS=2. The bug w
+0001af20: 6173 2069 6e74 726f 6475 6365 6420 696e  as introduced in
+0001af30: 2056 332e 372e 302e 0d0a 0d0a 5633 2e37   V3.7.0.....V3.7
+0001af40: 2e31 3a20 4d43 2c20 4c65 6964 656e 2c20  .1: MC, Leiden, 
+0001af50: 3331 204d 6172 6368 2032 3030 340d 0a2b  31 March 2004..+
+0001af60: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001af70: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001af80: 0d0a 0d0a 2d20 5570 6461 7465 6420 646f  ....- Updated do
+0001af90: 6375 6d65 6e74 6174 696f 6e2e 0d0a 0d0a  cumentation.....
+0001afa0: 5633 2e37 2e30 3a20 4d43 2c20 4c65 6964  V3.7.0: MC, Leid
+0001afb0: 656e 2c20 3233 204d 6172 6368 2032 3030  en, 23 March 200
+0001afc0: 340d 0a2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  4..+++++++++++++
+0001afd0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001afe0: 2b2b 2b2b 0d0a 0d0a 2d20 5265 7669 7365  ++++....- Revise
+0001aff0: 6420 696d 706c 656d 656e 7461 7469 6f6e  d implementation
+0001b000: 206f 6620 4d44 4547 5245 4520 6f70 7469   of MDEGREE opti
+0001b010: 6f6e 2e20 4e6f 6e6c 696e 6561 7220 696d  on. Nonlinear im
+0001b020: 706c 656d 656e 7461 7469 6f6e 3a0d 0a20  plementation:.. 
+0001b030: 2073 7472 6169 6768 7466 6f72 7761 7264   straightforward
+0001b040: 2c20 726f 6275 7374 2c20 6275 7420 736c  , robust, but sl
+0001b050: 6f77 6572 2e0d 0a0d 0a56 332e 362e 303a  ower.....V3.6.0:
+0001b060: 204d 432c 204c 6569 6465 6e2c 2031 3920   MC, Leiden, 19 
+0001b070: 4d61 7263 6820 3230 3034 0d0a 2b2b 2b2b  March 2004..++++
+0001b080: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001b090: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+0001b0a0: 0a2d 2041 6464 6564 204d 4445 4752 4545  .- Added MDEGREE
+0001b0b0: 206f 7074 696f 6e20 666f 7220 6d75 6c74   option for mult
+0001b0c0: 6970 6c69 6361 7469 7665 2070 6f6c 796e  iplicative polyn
+0001b0d0: 6f6d 6961 6c73 2e20 4c69 6e65 6172 2069  omials. Linear i
+0001b0e0: 6d70 6c65 6d65 6e74 6174 696f 6e3a 0d0a  mplementation:..
+0001b0f0: 2020 6661 7374 2c20 776f 726b 7320 7765    fast, works we
+0001b100: 6c6c 2069 6e20 6d6f 7374 2063 6173 6573  ll in most cases
+0001b110: 2c20 6275 7420 6361 6e20 6661 696c 2069  , but can fail i
+0001b120: 6e20 6365 7274 6169 6e20 6361 7365 732e  n certain cases.
+0001b130: 0d0a 0d0a 5633 2e35 2e30 3a20 4d43 2c20  ....V3.5.0: MC, 
+0001b140: 4c65 6964 656e 2c20 3131 2044 6563 656d  Leiden, 11 Decem
+0001b150: 6265 7220 3230 3033 0d0a 2b2b 2b2b 2b2b  ber 2003..++++++
+0001b160: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001b170: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a  ++++++++++++++..
+0001b180: 0d0a 2d20 496e 636c 7564 6564 202f 4f56  ..- Included /OV
+0001b190: 4552 5341 4d50 4c45 206f 7074 696f 6e2e  ERSAMPLE option.
+0001b1a0: 0d0a 0d0a 5633 2e34 2e37 3a20 4d43 2c20  ....V3.4.7: MC, 
+0001b1b0: 4c65 6964 656e 2c20 3820 4465 6365 6d62  Leiden, 8 Decemb
+0001b1c0: 6572 2032 3030 330d 0a2b 2b2b 2b2b 2b2b  er 2003..+++++++
+0001b1d0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001b1e0: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 0d0a 0d0a  ++++++++++++....
+0001b1f0: 2d20 4669 7273 7420 7265 6c65 6173 6564  - First released
+0001b200: 2076 6572 7369 6f6e 2e0d 0a0d 0a56 312e   version.....V1.
+0001b210: 302e 303a 204c 6569 6465 6e2c 2031 3020  0.0: Leiden, 10 
+0001b220: 4f63 746f 6265 7220 3230 3031 0d0a 2b2b  October 2001..++
+0001b230: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b  ++++++++++++++++
+0001b240: 2b2b 2b2b 2b2b 2b2b 2b2b 2b2b 2b0d 0a0d  +++++++++++++...
+0001b250: 0a2d 2043 7265 6174 6564 2062 7920 4d69  .- Created by Mi
+0001b260: 6368 656c 6520 4361 7070 656c 6c61 7269  chele Cappellari
+0001b270: 2e0d 0a0d 0a                             .....
```

### Comparing `ppxf-9.2.1/ppxf.egg-info/SOURCES.txt` & `ppxf-9.2.2/ppxf.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `ppxf-9.2.1/setup.py` & `ppxf-9.2.2/setup.py`

 * *Files identical despite different names*

